{"version":3,"file":"index-ztN1-iY7.js","sources":["../../../node_modules/.pnpm/@lit+reactive-element@2.1.2/node_modules/@lit/reactive-element/css-tag.js","../../../node_modules/.pnpm/@lit+reactive-element@2.1.2/node_modules/@lit/reactive-element/reactive-element.js","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/lit-html.js","../../../node_modules/.pnpm/lit-element@4.2.2/node_modules/lit-element/lit-element.js","../../../node_modules/.pnpm/@lit+reactive-element@2.1.2/node_modules/@lit/reactive-element/decorators/custom-element.js","../../../node_modules/.pnpm/@lit+reactive-element@2.1.2/node_modules/@lit/reactive-element/decorators/property.js","../../../node_modules/.pnpm/@lit+reactive-element@2.1.2/node_modules/@lit/reactive-element/decorators/state.js","../../../ui/src/ui/controllers/channels.ts","../../../ui/src/ui/controllers/config/form-utils.ts","../../../ui/src/ui/controllers/config.ts","../../../ui/src/ui/views/channels.nostr-profile-form.ts","../../../ui/src/ui/app-channels.ts","../../../src/shared/text/reasoning-tags.ts","../../../ui/src/ui/format.ts","../../../ui/src/ui/chat/message-extract.ts","../../../ui/src/ui/uuid.ts","../../../ui/src/ui/controllers/chat.ts","../../../ui/src/ui/controllers/sessions.ts","../../../ui/src/ui/app-tool-stream.ts","../../../ui/src/ui/app-scroll.ts","../../../ui/src/ui/controllers/logs.ts","../../../ui/src/ui/controllers/nodes.ts","../../../ui/src/ui/controllers/debug.ts","../../../ui/src/ui/app-polling.ts","../../../ui/src/ui/controllers/agent-identity.ts","../../../ui/src/ui/controllers/agent-skills.ts","../../../ui/src/ui/controllers/agents.ts","../../../ui/src/ui/controllers/cron.ts","../../../node_modules/.pnpm/@noble+ed25519@3.0.0/node_modules/@noble/ed25519/index.js","../../../ui/src/ui/device-identity.ts","../../../ui/src/ui/device-auth.ts","../../../ui/src/ui/controllers/devices.ts","../../../ui/src/ui/controllers/exec-approvals.ts","../../../ui/src/ui/controllers/presence.ts","../../../ui/src/ui/controllers/skills.ts","../../../ui/src/ui/navigation.ts","../../../ui/src/ui/storage.ts","../../../ui/src/ui/theme-transition.ts","../../../ui/src/ui/theme.ts","../../../ui/src/ui/app-settings.ts","../../../src/sessions/session-key-utils.ts","../../../ui/src/ui/app-chat.ts","../../../ui/src/ui/app-defaults.ts","../../../src/gateway/protocol/client-info.ts","../../../src/gateway/device-auth.ts","../../../ui/src/ui/gateway.ts","../../../ui/src/ui/controllers/exec-approval.ts","../../../ui/src/ui/assistant-identity.ts","../../../ui/src/ui/controllers/assistant-identity.ts","../../../ui/src/ui/app-gateway.ts","../../../ui/src/ui/app-lifecycle.ts","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/directive.js","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/directive-helpers.js","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/directives/repeat.js","../../../ui/src/ui/icons.ts","../../../ui/src/ui/app-render.helpers.ts","../../../ui/src/ui/controllers/agent-files.ts","../../../src/agents/tool-policy.ts","../../../ui/src/ui/presenter.ts","../../../ui/src/ui/views/agents.ts","../../../ui/src/ui/views/channels.shared.ts","../../../ui/src/ui/views/config-form.shared.ts","../../../ui/src/ui/views/config-form.node.ts","../../../ui/src/ui/views/config-form.render.ts","../../../ui/src/ui/views/config-form.analyze.ts","../../../ui/src/ui/views/channels.config.ts","../../../ui/src/ui/views/channels.discord.ts","../../../ui/src/ui/views/channels.googlechat.ts","../../../ui/src/ui/views/channels.imessage.ts","../../../ui/src/ui/views/channels.nostr.ts","../../../ui/src/ui/views/channels.signal.ts","../../../ui/src/ui/views/channels.slack.ts","../../../ui/src/ui/views/channels.telegram.ts","../../../ui/src/ui/views/channels.whatsapp.ts","../../../ui/src/ui/views/channels.ts","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/async-directive.js","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/directives/ref.js","../../../node_modules/.pnpm/lit-html@3.3.2/node_modules/lit-html/directives/unsafe-html.js","../../../node_modules/.pnpm/dompurify@3.3.1/node_modules/dompurify/dist/purify.es.mjs","../../../node_modules/.pnpm/marked@17.0.1/node_modules/marked/lib/marked.esm.js","../../../ui/src/ui/markdown.ts","../../../ui/src/ui/chat/copy-as-markdown.ts","../../../ui/src/ui/chat/message-normalizer.ts","../../../ui/src/ui/tool-display.ts","../../../ui/src/ui/chat/constants.ts","../../../ui/src/ui/chat/tool-helpers.ts","../../../ui/src/ui/chat/tool-cards.ts","../../../ui/src/ui/chat/grouped-render.ts","../../../ui/src/ui/views/markdown-sidebar.ts","../../../ui/src/ui/components/resizable-divider.ts","../../../ui/src/ui/views/chat.ts","../../../ui/src/ui/views/config.ts","../../../ui/src/ui/views/cron.ts","../../../ui/src/ui/views/debug.ts","../../../ui/src/ui/views/exec-approval.ts","../../../ui/src/ui/views/gateway-url-confirm.ts","../../../ui/src/ui/views/instances.ts","../../../ui/src/ui/views/logs.ts","../../../ui/src/ui/views/nodes.ts","../../../ui/src/ui/views/overview.ts","../../../ui/src/ui/views/sessions.ts","../../../ui/src/ui/views/skills.ts","../../../ui/src/ui/app-render.ts","../../../ui/src/ui/app.ts"],"sourcesContent":["/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1],t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map(t=>t instanceof CSSStyleSheet?t:t.styleSheet);else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(t=>this.enableUpdating=t),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(t=>t(this))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(t=>t.hostConnected?.())}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach(t=>t.hostDisconnected?.())}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e;const r=h.fromAttribute(s,t.type);this[e]=r??this._$Ej?.get(e)??r,this._$Em=null}}requestUpdate(t,s,i,e=!1,h){if(void 0!==t){const r=this.constructor;if(!1===e&&(h=this[t]),i??=r.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(r._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach(t=>t.hostUpdate?.()),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach(t=>t.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach(t=>this._$ET(t,this[t])),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.2\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t=>t,s=t.trustedTypes,e=s?s.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,h=\"$lit$\",o=`lit$${Math.random().toFixed(9).slice(2)}$`,n=\"?\"+o,r=`<${n}>`,l=document,c=()=>l.createComment(\"\"),a=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,u=Array.isArray,d=t=>u(t)||\"function\"==typeof t?.[Symbol.iterator],f=\"[ \\t\\n\\f\\r]\",v=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,_=/-->/g,m=/>/g,p=RegExp(`>|${f}(?:([^\\\\s\"'>=/]+)(${f}*=${f}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),g=/'/g,$=/\"/g,y=/^(?:script|style|textarea|title)$/i,x=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),b=x(1),w=x(2),T=x(3),E=Symbol.for(\"lit-noChange\"),A=Symbol.for(\"lit-nothing\"),C=new WeakMap,P=l.createTreeWalker(l,129);function V(t,i){if(!u(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==e?e.createHTML(i):i}const N=(t,i)=>{const s=t.length-1,e=[];let n,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=v;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,f=0;for(;f<s.length&&(c.lastIndex=f,u=c.exec(s),null!==u);)f=c.lastIndex,c===v?\"!--\"===u[1]?c=_:void 0!==u[1]?c=m:void 0!==u[2]?(y.test(u[2])&&(n=RegExp(\"</\"+u[2],\"g\")),c=p):void 0!==u[3]&&(c=p):c===p?\">\"===u[0]?(c=n??v,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?p:'\"'===u[3]?$:g):c===$||c===g?c=p:c===_||c===m?c=v:(c=p,n=void 0);const x=c===p&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===v?s+r:d>=0?(e.push(a),s.slice(0,d)+h+s.slice(d)+o+x):s+o+(-2===d?i:x)}return[V(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),e]};class S{constructor({strings:t,_$litType$:i},e){let r;this.parts=[];let l=0,a=0;const u=t.length-1,d=this.parts,[f,v]=N(t,i);if(this.el=S.createElement(f,e),P.currentNode=this.el.content,2===i||3===i){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=P.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(h)){const i=v[a++],s=r.getAttribute(t).split(o),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:l,name:e[2],strings:s,ctor:\".\"===e[1]?I:\"?\"===e[1]?L:\"@\"===e[1]?z:H}),r.removeAttribute(t)}else t.startsWith(o)&&(d.push({type:6,index:l}),r.removeAttribute(t));if(y.test(r.tagName)){const t=r.textContent.split(o),i=t.length-1;if(i>0){r.textContent=s?s.emptyScript:\"\";for(let s=0;s<i;s++)r.append(t[s],c()),P.nextNode(),d.push({type:2,index:++l});r.append(t[i],c())}}}else if(8===r.nodeType)if(r.data===n)d.push({type:2,index:l});else{let t=-1;for(;-1!==(t=r.data.indexOf(o,t+1));)d.push({type:7,index:l}),t+=o.length-1}l++}}static createElement(t,i){const s=l.createElement(\"template\");return s.innerHTML=t,s}}function M(t,i,s=t,e){if(i===E)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=a(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=M(t,h._$AS(t,i.values),h,e)),i}class R{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??l).importNode(i,!0);P.currentNode=e;let h=P.nextNode(),o=0,n=0,r=s[0];for(;void 0!==r;){if(o===r.index){let i;2===r.type?i=new k(h,h.nextSibling,this,t):1===r.type?i=new r.ctor(h,r.name,r.strings,this,t):6===r.type&&(i=new Z(h,this,t)),this._$AV.push(i),r=s[++n]}o!==r?.index&&(h=P.nextNode(),o++)}return P.currentNode=l,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class k{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=A,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=M(this,t,i),a(t)?t===A||null==t||\"\"===t?(this._$AH!==A&&this._$AR(),this._$AH=A):t!==this._$AH&&t!==E&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):d(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==A&&a(this._$AH)?this._$AA.nextSibling.data=t:this.T(l.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=S.createElement(V(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new R(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=C.get(t.strings);return void 0===i&&C.set(t.strings,i=new S(t)),i}k(t){u(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new k(this.O(c()),this.O(c()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,s){for(this._$AP?.(!1,!0,s);t!==this._$AB;){const s=i(t).nextSibling;i(t).remove(),t=s}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class H{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=A,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=A}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=M(this,t,i,0),o=!a(t)||t!==this._$AH&&t!==E,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=M(this,e[s+n],i,n),r===E&&(r=this._$AH[n]),o||=!a(r)||r!==this._$AH[n],r===A?t=A:t!==A&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===A?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class I extends H{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===A?void 0:t}}class L extends H{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==A)}}class z extends H{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=M(this,t,i,0)??A)===E)return;const s=this._$AH,e=t===A&&s!==A||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==A&&(s===A||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class Z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){M(this,t)}}const j={M:h,P:o,A:n,C:1,L:N,R,D:d,V:M,I:k,H,N:L,U:z,B:I,F:Z},B=t.litHtmlPolyfillSupport;B?.(S,k),(t.litHtmlVersions??=[]).push(\"3.3.2\");const D=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new k(i.insertBefore(c(),t),t,void 0,s??{})}return h._$AI(t),h};export{j as _$LH,b as html,T as mathml,E as noChange,A as nothing,D as render,w as svg};\n//# sourceMappingURL=lit-html.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.2\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=t=>(e,o)=>{void 0!==o?o.addInitializer(()=>{customElements.define(t,e)}):customElements.define(t,e)};export{t as customElement};\n//# sourceMappingURL=custom-element.js.map\n","import{notEqual as t,defaultConverter as e}from\"../reactive-element.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const o={attribute:!0,type:String,converter:e,reflect:!1,hasChanged:t},r=(t=o,e,r)=>{const{kind:n,metadata:i}=r;let s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),\"setter\"===n&&((t=Object.create(t)).wrapped=!0),s.set(r.name,t),\"accessor\"===n){const{name:o}=r;return{set(r){const n=e.get.call(this);e.set.call(this,r),this.requestUpdate(o,n,t,!0,r)},init(e){return void 0!==e&&this.C(o,void 0,t,e),e}}}if(\"setter\"===n){const{name:o}=r;return function(r){const n=this[o];e.call(this,r),this.requestUpdate(o,n,t,!0,r)}}throw Error(\"Unsupported decorator location: \"+n)};function n(t){return(e,o)=>\"object\"==typeof o?r(t,e,o):((t,e,o)=>{const r=e.hasOwnProperty(o);return e.constructor.createProperty(o,t),r?Object.getOwnPropertyDescriptor(e,o):void 0})(t,e,o)}export{n as property,r as standardProperty};\n//# sourceMappingURL=property.js.map\n","import{property as t}from\"./property.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */function r(r){return t({...r,state:!0,attribute:!1})}export{r as state};\n//# sourceMappingURL=state.js.map\n","import type { ChannelsStatusSnapshot } from \"../types\";\nimport type { ChannelsState } from \"./channels.types\";\n\nexport type { ChannelsState };\n\nexport async function loadChannels(state: ChannelsState, probe: boolean) {\n  if (!state.client || !state.connected) return;\n  if (state.channelsLoading) return;\n  state.channelsLoading = true;\n  state.channelsError = null;\n  try {\n    const res = (await state.client.request(\"channels.status\", {\n      probe,\n      timeoutMs: 8000,\n    })) as ChannelsStatusSnapshot;\n    state.channelsSnapshot = res;\n    state.channelsLastSuccess = Date.now();\n  } catch (err) {\n    state.channelsError = String(err);\n  } finally {\n    state.channelsLoading = false;\n  }\n}\n\nexport async function startWhatsAppLogin(state: ChannelsState, force: boolean) {\n  if (!state.client || !state.connected || state.whatsappBusy) return;\n  state.whatsappBusy = true;\n  try {\n    const res = (await state.client.request(\"web.login.start\", {\n      force,\n      timeoutMs: 30000,\n    })) as { message?: string; qrDataUrl?: string };\n    state.whatsappLoginMessage = res.message ?? null;\n    state.whatsappLoginQrDataUrl = res.qrDataUrl ?? null;\n    state.whatsappLoginConnected = null;\n  } catch (err) {\n    state.whatsappLoginMessage = String(err);\n    state.whatsappLoginQrDataUrl = null;\n    state.whatsappLoginConnected = null;\n  } finally {\n    state.whatsappBusy = false;\n  }\n}\n\nexport async function waitWhatsAppLogin(state: ChannelsState) {\n  if (!state.client || !state.connected || state.whatsappBusy) return;\n  state.whatsappBusy = true;\n  try {\n    const res = (await state.client.request(\"web.login.wait\", {\n      timeoutMs: 120000,\n    })) as { connected?: boolean; message?: string };\n    state.whatsappLoginMessage = res.message ?? null;\n    state.whatsappLoginConnected = res.connected ?? null;\n    if (res.connected) state.whatsappLoginQrDataUrl = null;\n  } catch (err) {\n    state.whatsappLoginMessage = String(err);\n    state.whatsappLoginConnected = null;\n  } finally {\n    state.whatsappBusy = false;\n  }\n}\n\nexport async function logoutWhatsApp(state: ChannelsState) {\n  if (!state.client || !state.connected || state.whatsappBusy) return;\n  state.whatsappBusy = true;\n  try {\n    await state.client.request(\"channels.logout\", { channel: \"whatsapp\" });\n    state.whatsappLoginMessage = \"Logged out.\";\n    state.whatsappLoginQrDataUrl = null;\n    state.whatsappLoginConnected = null;\n  } catch (err) {\n    state.whatsappLoginMessage = String(err);\n  } finally {\n    state.whatsappBusy = false;\n  }\n}\n","export function cloneConfigObject<T>(value: T): T {\n  if (typeof structuredClone === \"function\") {\n    return structuredClone(value);\n  }\n  return JSON.parse(JSON.stringify(value)) as T;\n}\n\nexport function serializeConfigForm(form: Record<string, unknown>): string {\n  return `${JSON.stringify(form, null, 2).trimEnd()}\\n`;\n}\n\nexport function setPathValue(\n  obj: Record<string, unknown> | unknown[],\n  path: Array<string | number>,\n  value: unknown,\n) {\n  if (path.length === 0) return;\n  let current: Record<string, unknown> | unknown[] = obj;\n  for (let i = 0; i < path.length - 1; i += 1) {\n    const key = path[i];\n    const nextKey = path[i + 1];\n    if (typeof key === \"number\") {\n      if (!Array.isArray(current)) return;\n      if (current[key] == null) {\n        current[key] =\n          typeof nextKey === \"number\" ? [] : ({} as Record<string, unknown>);\n      }\n      current = current[key] as Record<string, unknown> | unknown[];\n    } else {\n      if (typeof current !== \"object\" || current == null) return;\n      const record = current as Record<string, unknown>;\n      if (record[key] == null) {\n        record[key] =\n          typeof nextKey === \"number\" ? [] : ({} as Record<string, unknown>);\n      }\n      current = record[key] as Record<string, unknown> | unknown[];\n    }\n  }\n  const lastKey = path[path.length - 1];\n  if (typeof lastKey === \"number\") {\n    if (Array.isArray(current)) current[lastKey] = value;\n    return;\n  }\n  if (typeof current === \"object\" && current != null) {\n    (current as Record<string, unknown>)[lastKey] = value;\n  }\n}\n\nexport function removePathValue(\n  obj: Record<string, unknown> | unknown[],\n  path: Array<string | number>,\n) {\n  if (path.length === 0) return;\n  let current: Record<string, unknown> | unknown[] = obj;\n  for (let i = 0; i < path.length - 1; i += 1) {\n    const key = path[i];\n    if (typeof key === \"number\") {\n      if (!Array.isArray(current)) return;\n      current = current[key] as Record<string, unknown> | unknown[];\n    } else {\n      if (typeof current !== \"object\" || current == null) return;\n      current = (current as Record<string, unknown>)[key] as\n        | Record<string, unknown>\n        | unknown[];\n    }\n    if (current == null) return;\n  }\n  const lastKey = path[path.length - 1];\n  if (typeof lastKey === \"number\") {\n    if (Array.isArray(current)) current.splice(lastKey, 1);\n    return;\n  }\n  if (typeof current === \"object\" && current != null) {\n    delete (current as Record<string, unknown>)[lastKey];\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type {\n  ConfigSchemaResponse,\n  ConfigSnapshot,\n  ConfigUiHints,\n} from \"../types\";\nimport {\n  cloneConfigObject,\n  removePathValue,\n  serializeConfigForm,\n  setPathValue,\n} from \"./config/form-utils\";\n\nexport type ConfigState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  applySessionKey: string;\n  configLoading: boolean;\n  configRaw: string;\n  configRawOriginal: string;\n  configValid: boolean | null;\n  configIssues: unknown[];\n  configSaving: boolean;\n  configApplying: boolean;\n  updateRunning: boolean;\n  configSnapshot: ConfigSnapshot | null;\n  configSchema: unknown | null;\n  configSchemaVersion: string | null;\n  configSchemaLoading: boolean;\n  configUiHints: ConfigUiHints;\n  configForm: Record<string, unknown> | null;\n  configFormOriginal: Record<string, unknown> | null;\n  configFormDirty: boolean;\n  configFormMode: \"form\" | \"raw\";\n  configSearchQuery: string;\n  configActiveSection: string | null;\n  configActiveSubsection: string | null;\n  lastError: string | null;\n};\n\nexport async function loadConfig(state: ConfigState) {\n  if (!state.client || !state.connected) return;\n  state.configLoading = true;\n  state.lastError = null;\n  try {\n    const res = (await state.client.request(\"config.get\", {})) as ConfigSnapshot;\n    applyConfigSnapshot(state, res);\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.configLoading = false;\n  }\n}\n\nexport async function loadConfigSchema(state: ConfigState) {\n  if (!state.client || !state.connected) return;\n  if (state.configSchemaLoading) return;\n  state.configSchemaLoading = true;\n  try {\n    const res = (await state.client.request(\n      \"config.schema\",\n      {},\n    )) as ConfigSchemaResponse;\n    applyConfigSchema(state, res);\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.configSchemaLoading = false;\n  }\n}\n\nexport function applyConfigSchema(\n  state: ConfigState,\n  res: ConfigSchemaResponse,\n) {\n  state.configSchema = res.schema ?? null;\n  state.configUiHints = res.uiHints ?? {};\n  state.configSchemaVersion = res.version ?? null;\n}\n\nexport function applyConfigSnapshot(state: ConfigState, snapshot: ConfigSnapshot) {\n  state.configSnapshot = snapshot;\n  const rawFromSnapshot =\n    typeof snapshot.raw === \"string\"\n      ? snapshot.raw\n      : snapshot.config && typeof snapshot.config === \"object\"\n        ? serializeConfigForm(snapshot.config as Record<string, unknown>)\n        : state.configRaw;\n  if (!state.configFormDirty || state.configFormMode === \"raw\") {\n    state.configRaw = rawFromSnapshot;\n  } else if (state.configForm) {\n    state.configRaw = serializeConfigForm(state.configForm);\n  } else {\n    state.configRaw = rawFromSnapshot;\n  }\n  state.configValid = typeof snapshot.valid === \"boolean\" ? snapshot.valid : null;\n  state.configIssues = Array.isArray(snapshot.issues) ? snapshot.issues : [];\n\n  if (!state.configFormDirty) {\n    state.configForm = cloneConfigObject(snapshot.config ?? {});\n    state.configFormOriginal = cloneConfigObject(snapshot.config ?? {});\n    state.configRawOriginal = rawFromSnapshot;\n  }\n}\n\nexport async function saveConfig(state: ConfigState) {\n  if (!state.client || !state.connected) return;\n  state.configSaving = true;\n  state.lastError = null;\n  try {\n    const raw =\n      state.configFormMode === \"form\" && state.configForm\n        ? serializeConfigForm(state.configForm)\n        : state.configRaw;\n    const baseHash = state.configSnapshot?.hash;\n    if (!baseHash) {\n      state.lastError = \"Config hash missing; reload and retry.\";\n      return;\n    }\n    await state.client.request(\"config.set\", { raw, baseHash });\n    state.configFormDirty = false;\n    await loadConfig(state);\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.configSaving = false;\n  }\n}\n\nexport async function applyConfig(state: ConfigState) {\n  if (!state.client || !state.connected) return;\n  state.configApplying = true;\n  state.lastError = null;\n  try {\n    const raw =\n      state.configFormMode === \"form\" && state.configForm\n        ? serializeConfigForm(state.configForm)\n        : state.configRaw;\n    const baseHash = state.configSnapshot?.hash;\n    if (!baseHash) {\n      state.lastError = \"Config hash missing; reload and retry.\";\n      return;\n    }\n    await state.client.request(\"config.apply\", {\n      raw,\n      baseHash,\n      sessionKey: state.applySessionKey,\n    });\n    state.configFormDirty = false;\n    await loadConfig(state);\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.configApplying = false;\n  }\n}\n\nexport async function runUpdate(state: ConfigState) {\n  if (!state.client || !state.connected) return;\n  state.updateRunning = true;\n  state.lastError = null;\n  try {\n    await state.client.request(\"update.run\", {\n      sessionKey: state.applySessionKey,\n    });\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.updateRunning = false;\n  }\n}\n\nexport function updateConfigFormValue(\n  state: ConfigState,\n  path: Array<string | number>,\n  value: unknown,\n) {\n  const base = cloneConfigObject(\n    state.configForm ?? state.configSnapshot?.config ?? {},\n  );\n  setPathValue(base, path, value);\n  state.configForm = base;\n  state.configFormDirty = true;\n  if (state.configFormMode === \"form\") {\n    state.configRaw = serializeConfigForm(base);\n  }\n}\n\nexport function removeConfigFormValue(\n  state: ConfigState,\n  path: Array<string | number>,\n) {\n  const base = cloneConfigObject(\n    state.configForm ?? state.configSnapshot?.config ?? {},\n  );\n  removePathValue(base, path);\n  state.configForm = base;\n  state.configFormDirty = true;\n  if (state.configFormMode === \"form\") {\n    state.configRaw = serializeConfigForm(base);\n  }\n}\n","/**\n * Nostr Profile Edit Form\n *\n * Provides UI for editing and publishing Nostr profile (kind:0).\n */\n\nimport { html, nothing, type TemplateResult } from \"lit\";\n\nimport type { NostrProfile as NostrProfileType } from \"../types\";\n\n// ============================================================================\n// Types\n// ============================================================================\n\nexport interface NostrProfileFormState {\n  /** Current form values */\n  values: NostrProfileType;\n  /** Original values for dirty detection */\n  original: NostrProfileType;\n  /** Whether the form is currently submitting */\n  saving: boolean;\n  /** Whether import is in progress */\n  importing: boolean;\n  /** Last error message */\n  error: string | null;\n  /** Last success message */\n  success: string | null;\n  /** Validation errors per field */\n  fieldErrors: Record<string, string>;\n  /** Whether to show advanced fields */\n  showAdvanced: boolean;\n}\n\nexport interface NostrProfileFormCallbacks {\n  /** Called when a field value changes */\n  onFieldChange: (field: keyof NostrProfileType, value: string) => void;\n  /** Called when save is clicked */\n  onSave: () => void;\n  /** Called when import is clicked */\n  onImport: () => void;\n  /** Called when cancel is clicked */\n  onCancel: () => void;\n  /** Called when toggle advanced is clicked */\n  onToggleAdvanced: () => void;\n}\n\n// ============================================================================\n// Helpers\n// ============================================================================\n\nfunction isFormDirty(state: NostrProfileFormState): boolean {\n  const { values, original } = state;\n  return (\n    values.name !== original.name ||\n    values.displayName !== original.displayName ||\n    values.about !== original.about ||\n    values.picture !== original.picture ||\n    values.banner !== original.banner ||\n    values.website !== original.website ||\n    values.nip05 !== original.nip05 ||\n    values.lud16 !== original.lud16\n  );\n}\n\n// ============================================================================\n// Form Rendering\n// ============================================================================\n\nexport function renderNostrProfileForm(params: {\n  state: NostrProfileFormState;\n  callbacks: NostrProfileFormCallbacks;\n  accountId: string;\n}): TemplateResult {\n  const { state, callbacks, accountId } = params;\n  const isDirty = isFormDirty(state);\n\n  const renderField = (\n    field: keyof NostrProfileType,\n    label: string,\n    opts: {\n      type?: \"text\" | \"url\" | \"textarea\";\n      placeholder?: string;\n      maxLength?: number;\n      help?: string;\n    } = {}\n  ) => {\n    const { type = \"text\", placeholder, maxLength, help } = opts;\n    const value = state.values[field] ?? \"\";\n    const error = state.fieldErrors[field];\n\n    const inputId = `nostr-profile-${field}`;\n\n    if (type === \"textarea\") {\n      return html`\n        <div class=\"form-field\" style=\"margin-bottom: 12px;\">\n          <label for=\"${inputId}\" style=\"display: block; margin-bottom: 4px; font-weight: 500;\">\n            ${label}\n          </label>\n          <textarea\n            id=\"${inputId}\"\n            .value=${value}\n            placeholder=${placeholder ?? \"\"}\n            maxlength=${maxLength ?? 2000}\n            rows=\"3\"\n            style=\"width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px; resize: vertical; font-family: inherit;\"\n            @input=${(e: InputEvent) => {\n              const target = e.target as HTMLTextAreaElement;\n              callbacks.onFieldChange(field, target.value);\n            }}\n            ?disabled=${state.saving}\n          ></textarea>\n          ${help ? html`<div style=\"font-size: 12px; color: var(--text-muted); margin-top: 2px;\">${help}</div>` : nothing}\n          ${error ? html`<div style=\"font-size: 12px; color: var(--danger-color); margin-top: 2px;\">${error}</div>` : nothing}\n        </div>\n      `;\n    }\n\n    return html`\n      <div class=\"form-field\" style=\"margin-bottom: 12px;\">\n        <label for=\"${inputId}\" style=\"display: block; margin-bottom: 4px; font-weight: 500;\">\n          ${label}\n        </label>\n        <input\n          id=\"${inputId}\"\n          type=${type}\n          .value=${value}\n          placeholder=${placeholder ?? \"\"}\n          maxlength=${maxLength ?? 256}\n          style=\"width: 100%; padding: 8px; border: 1px solid var(--border-color); border-radius: 4px;\"\n          @input=${(e: InputEvent) => {\n            const target = e.target as HTMLInputElement;\n            callbacks.onFieldChange(field, target.value);\n          }}\n          ?disabled=${state.saving}\n        />\n        ${help ? html`<div style=\"font-size: 12px; color: var(--text-muted); margin-top: 2px;\">${help}</div>` : nothing}\n        ${error ? html`<div style=\"font-size: 12px; color: var(--danger-color); margin-top: 2px;\">${error}</div>` : nothing}\n      </div>\n    `;\n  };\n\n  const renderPicturePreview = () => {\n    const picture = state.values.picture;\n    if (!picture) return nothing;\n\n    return html`\n      <div style=\"margin-bottom: 12px;\">\n        <img\n          src=${picture}\n          alt=\"Profile picture preview\"\n          style=\"max-width: 80px; max-height: 80px; border-radius: 50%; object-fit: cover; border: 2px solid var(--border-color);\"\n          @error=${(e: Event) => {\n            const img = e.target as HTMLImageElement;\n            img.style.display = \"none\";\n          }}\n          @load=${(e: Event) => {\n            const img = e.target as HTMLImageElement;\n            img.style.display = \"block\";\n          }}\n        />\n      </div>\n    `;\n  };\n\n  return html`\n    <div class=\"nostr-profile-form\" style=\"padding: 16px; background: var(--bg-secondary); border-radius: 8px; margin-top: 12px;\">\n      <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;\">\n        <div style=\"font-weight: 600; font-size: 16px;\">编辑资料</div>\n        <div style=\"font-size: 12px; color: var(--text-muted);\">账户: ${accountId}</div>\n      </div>\n\n      ${state.error\n        ? html`<div class=\"callout danger\" style=\"margin-bottom: 12px;\">${state.error}</div>`\n        : nothing}\n\n      ${state.success\n        ? html`<div class=\"callout success\" style=\"margin-bottom: 12px;\">${state.success}</div>`\n        : nothing}\n\n      ${renderPicturePreview()}\n\n      ${renderField(\"name\", \"用户名\", {\n        placeholder: \"satoshi\",\n        maxLength: 256,\n        help: \"短用户名（例如：satoshi）\",\n      })}\n\n      ${renderField(\"displayName\", \"显示名称\", {\n        placeholder: \"Satoshi Nakamoto\",\n        maxLength: 256,\n        help: \"您的完整显示名称\",\n      })}\n\n      ${renderField(\"about\", \"简介\", {\n        type: \"textarea\",\n        placeholder: \"向别人介绍自己...\",\n        maxLength: 2000,\n        help: \"简短的个人简介或描述\",\n      })}\n\n      ${renderField(\"picture\", \"头像URL\", {\n        type: \"url\",\n        placeholder: \"https://example.com/avatar.jpg\",\n        help: \"您头像图片的HTTPS URL\",\n      })}\n\n      ${state.showAdvanced\n        ? html`\n            <div style=\"border-top: 1px solid var(--border-color); padding-top: 12px; margin-top: 12px;\">\n              <div style=\"font-weight: 500; margin-bottom: 12px; color: var(--text-muted);\">高级选项</div>\n\n              ${renderField(\"banner\", \"横幅URL\", {\n                type: \"url\",\n                placeholder: \"https://example.com/banner.jpg\",\n                help: \"横幅图片的HTTPS URL\",\n              })}\n\n              ${renderField(\"website\", \"网站\", {\n                type: \"url\",\n                placeholder: \"https://example.com\",\n                help: \"您的个人网站\",\n              })}\n\n              ${renderField(\"nip05\", \"NIP-05 标识\", {\n                placeholder: \"you@example.com\",\n                help: \"可验证的标识符（例如：you@domain.com）\",\n              })}\n\n              ${renderField(\"lud16\", \"闪电网络地址\", {\n                placeholder: \"you@getalby.com\",\n                help: \"用于打赏的闪电网络地址（LUD-16）\",\n              })}\n            </div>\n          `\n        : nothing}\n\n      <div style=\"display: flex; gap: 8px; margin-top: 16px; flex-wrap: wrap;\">\n        <button\n          class=\"btn primary\"\n          @click=${callbacks.onSave}\n          ?disabled=${state.saving || !isDirty}\n        >\n          ${state.saving ? \"保存中...\" : \"保存并发布\"}\n        </button>\n\n        <button\n          class=\"btn\"\n          @click=${callbacks.onImport}\n          ?disabled=${state.importing || state.saving}\n        >\n          ${state.importing ? \"导入中...\" : \"从转发器导入\"}\n        </button>\n\n        <button\n          class=\"btn\"\n          @click=${callbacks.onToggleAdvanced}\n        >\n          ${state.showAdvanced ? \"隐藏高级选项\" : \"显示高级选项\"}\n        </button>\n\n        <button\n          class=\"btn\"\n          @click=${callbacks.onCancel}\n          ?disabled=${state.saving}\n        >\n          取消\n        </button>\n      </div>\n\n      ${isDirty\n        ? html`<div style=\"font-size: 12px; color: var(--warning-color); margin-top: 8px;\">\n            您有未保存的更改\n          </div>`\n        : nothing}\n    </div>\n  `;\n}\n\n// ============================================================================\n// Factory\n// ============================================================================\n\n/**\n * Create initial form state from existing profile\n */\nexport function createNostrProfileFormState(\n  profile: NostrProfileType | undefined\n): NostrProfileFormState {\n  const values: NostrProfileType = {\n    name: profile?.name ?? \"\",\n    displayName: profile?.displayName ?? \"\",\n    about: profile?.about ?? \"\",\n    picture: profile?.picture ?? \"\",\n    banner: profile?.banner ?? \"\",\n    website: profile?.website ?? \"\",\n    nip05: profile?.nip05 ?? \"\",\n    lud16: profile?.lud16 ?? \"\",\n  };\n\n  return {\n    values,\n    original: { ...values },\n    saving: false,\n    importing: false,\n    error: null,\n    success: null,\n    fieldErrors: {},\n    showAdvanced: Boolean(\n      profile?.banner || profile?.website || profile?.nip05 || profile?.lud16\n    ),\n  };\n}\n","import {\n  loadChannels,\n  logoutWhatsApp,\n  startWhatsAppLogin,\n  waitWhatsAppLogin,\n} from \"./controllers/channels\";\nimport { loadConfig, saveConfig } from \"./controllers/config\";\nimport type { ClawdbotApp } from \"./app\";\nimport type { NostrProfile } from \"./types\";\nimport { createNostrProfileFormState } from \"./views/channels.nostr-profile-form\";\n\nexport async function handleWhatsAppStart(host: ClawdbotApp, force: boolean) {\n  await startWhatsAppLogin(host, force);\n  await loadChannels(host, true);\n}\n\nexport async function handleWhatsAppWait(host: ClawdbotApp) {\n  await waitWhatsAppLogin(host);\n  await loadChannels(host, true);\n}\n\nexport async function handleWhatsAppLogout(host: ClawdbotApp) {\n  await logoutWhatsApp(host);\n  await loadChannels(host, true);\n}\n\nexport async function handleChannelConfigSave(host: ClawdbotApp) {\n  await saveConfig(host);\n  await loadConfig(host);\n  await loadChannels(host, true);\n}\n\nexport async function handleChannelConfigReload(host: ClawdbotApp) {\n  await loadConfig(host);\n  await loadChannels(host, true);\n}\n\nfunction parseValidationErrors(details: unknown): Record<string, string> {\n  if (!Array.isArray(details)) return {};\n  const errors: Record<string, string> = {};\n  for (const entry of details) {\n    if (typeof entry !== \"string\") continue;\n    const [rawField, ...rest] = entry.split(\":\");\n    if (!rawField || rest.length === 0) continue;\n    const field = rawField.trim();\n    const message = rest.join(\":\").trim();\n    if (field && message) errors[field] = message;\n  }\n  return errors;\n}\n\nfunction resolveNostrAccountId(host: ClawdbotApp): string {\n  const accounts = host.channelsSnapshot?.channelAccounts?.nostr ?? [];\n  return accounts[0]?.accountId ?? host.nostrProfileAccountId ?? \"default\";\n}\n\nfunction buildNostrProfileUrl(accountId: string, suffix = \"\"): string {\n  return `/api/channels/nostr/${encodeURIComponent(accountId)}/profile${suffix}`;\n}\n\nfunction resolveGatewayHttpAuthHeader(host: OpenClawApp): string | null {\n  const deviceToken = host.hello?.auth?.deviceToken?.trim();\n  if (deviceToken) {\n    return `Bearer ${deviceToken}`;\n  }\n  const token = host.settings.token.trim();\n  if (token) {\n    return `Bearer ${token}`;\n  }\n  const password = host.password.trim();\n  if (password) {\n    return `Bearer ${password}`;\n  }\n  return null;\n}\n\nfunction buildGatewayHttpHeaders(host: OpenClawApp): Record<string, string> {\n  const authorization = resolveGatewayHttpAuthHeader(host);\n  return authorization ? { Authorization: authorization } : {};\n}\n\nexport function handleNostrProfileEdit(\n  host: ClawdbotApp,\n  accountId: string,\n  profile: NostrProfile | null,\n) {\n  host.nostrProfileAccountId = accountId;\n  host.nostrProfileFormState = createNostrProfileFormState(profile ?? undefined);\n}\n\nexport function handleNostrProfileCancel(host: ClawdbotApp) {\n  host.nostrProfileFormState = null;\n  host.nostrProfileAccountId = null;\n}\n\nexport function handleNostrProfileFieldChange(\n  host: ClawdbotApp,\n  field: keyof NostrProfile,\n  value: string,\n) {\n  const state = host.nostrProfileFormState;\n  if (!state) return;\n  host.nostrProfileFormState = {\n    ...state,\n    values: {\n      ...state.values,\n      [field]: value,\n    },\n    fieldErrors: {\n      ...state.fieldErrors,\n      [field]: \"\",\n    },\n  };\n}\n\nexport function handleNostrProfileToggleAdvanced(host: ClawdbotApp) {\n  const state = host.nostrProfileFormState;\n  if (!state) return;\n  host.nostrProfileFormState = {\n    ...state,\n    showAdvanced: !state.showAdvanced,\n  };\n}\n\nexport async function handleNostrProfileSave(host: ClawdbotApp) {\n  const state = host.nostrProfileFormState;\n  if (!state || state.saving) return;\n  const accountId = resolveNostrAccountId(host);\n\n  host.nostrProfileFormState = {\n    ...state,\n    saving: true,\n    error: null,\n    success: null,\n    fieldErrors: {},\n  };\n\n  try {\n    const response = await fetch(buildNostrProfileUrl(accountId), {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...buildGatewayHttpHeaders(host),\n      },\n      body: JSON.stringify(state.values),\n    });\n    const data = (await response.json().catch(() => null)) as\n      | { ok?: boolean; error?: string; details?: unknown; persisted?: boolean }\n      | null;\n\n    if (!response.ok || data?.ok === false || !data) {\n      const errorMessage = data?.error ?? `Profile update failed (${response.status})`;\n      host.nostrProfileFormState = {\n        ...state,\n        saving: false,\n        error: errorMessage,\n        success: null,\n        fieldErrors: parseValidationErrors(data?.details),\n      };\n      return;\n    }\n\n    if (!data.persisted) {\n      host.nostrProfileFormState = {\n        ...state,\n        saving: false,\n        error: \"Profile publish failed on all relays.\",\n        success: null,\n      };\n      return;\n    }\n\n    host.nostrProfileFormState = {\n      ...state,\n      saving: false,\n      error: null,\n      success: \"Profile published to relays.\",\n      fieldErrors: {},\n      original: { ...state.values },\n    };\n    await loadChannels(host, true);\n  } catch (err) {\n    host.nostrProfileFormState = {\n      ...state,\n      saving: false,\n      error: `Profile update failed: ${String(err)}`,\n      success: null,\n    };\n  }\n}\n\nexport async function handleNostrProfileImport(host: ClawdbotApp) {\n  const state = host.nostrProfileFormState;\n  if (!state || state.importing) return;\n  const accountId = resolveNostrAccountId(host);\n\n  host.nostrProfileFormState = {\n    ...state,\n    importing: true,\n    error: null,\n    success: null,\n  };\n\n  try {\n    const response = await fetch(buildNostrProfileUrl(accountId, \"/import\"), {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        ...buildGatewayHttpHeaders(host),\n      },\n      body: JSON.stringify({ autoMerge: true }),\n    });\n    const data = (await response.json().catch(() => null)) as\n      | { ok?: boolean; error?: string; imported?: NostrProfile; merged?: NostrProfile; saved?: boolean }\n      | null;\n\n    if (!response.ok || data?.ok === false || !data) {\n      const errorMessage = data?.error ?? `Profile import failed (${response.status})`;\n      host.nostrProfileFormState = {\n        ...state,\n        importing: false,\n        error: errorMessage,\n        success: null,\n      };\n      return;\n    }\n\n    const merged = data.merged ?? data.imported ?? null;\n    const nextValues = merged ? { ...state.values, ...merged } : state.values;\n    const showAdvanced = Boolean(\n      nextValues.banner || nextValues.website || nextValues.nip05 || nextValues.lud16,\n    );\n\n    host.nostrProfileFormState = {\n      ...state,\n      importing: false,\n      values: nextValues,\n      error: null,\n      success: data.saved\n        ? \"Profile imported from relays. Review and publish.\"\n        : \"Profile imported. Review and publish.\",\n      showAdvanced,\n    };\n\n    if (data.saved) {\n      await loadChannels(host, true);\n    }\n  } catch (err) {\n    host.nostrProfileFormState = {\n      ...state,\n      importing: false,\n      error: `Profile import failed: ${String(err)}`,\n      success: null,\n    };\n  }\n}\n","export type ReasoningTagMode = \"strict\" | \"preserve\";\nexport type ReasoningTagTrim = \"none\" | \"start\" | \"both\";\n\nconst QUICK_TAG_RE = /<\\s*\\/?\\s*(?:think(?:ing)?|thought|antthinking|final)\\b/i;\nconst FINAL_TAG_RE = /<\\s*\\/?\\s*final\\b[^>]*>/gi;\nconst THINKING_TAG_RE = /<\\s*(\\/?)\\s*(?:think(?:ing)?|thought|antthinking)\\b[^>]*>/gi;\n\nfunction applyTrim(value: string, mode: ReasoningTagTrim): string {\n  if (mode === \"none\") return value;\n  if (mode === \"start\") return value.trimStart();\n  return value.trim();\n}\n\nexport function stripReasoningTagsFromText(\n  text: string,\n  options?: {\n    mode?: ReasoningTagMode;\n    trim?: ReasoningTagTrim;\n  },\n): string {\n  if (!text) return text;\n  if (!QUICK_TAG_RE.test(text)) return text;\n\n  const mode = options?.mode ?? \"strict\";\n  const trimMode = options?.trim ?? \"both\";\n\n  let cleaned = text;\n  if (FINAL_TAG_RE.test(cleaned)) {\n    FINAL_TAG_RE.lastIndex = 0;\n    cleaned = cleaned.replace(FINAL_TAG_RE, \"\");\n  } else {\n    FINAL_TAG_RE.lastIndex = 0;\n  }\n\n  THINKING_TAG_RE.lastIndex = 0;\n  let result = \"\";\n  let lastIndex = 0;\n  let inThinking = false;\n\n  for (const match of cleaned.matchAll(THINKING_TAG_RE)) {\n    const idx = match.index ?? 0;\n    const isClose = match[1] === \"/\";\n\n    if (!inThinking) {\n      result += cleaned.slice(lastIndex, idx);\n      if (!isClose) {\n        inThinking = true;\n      }\n    } else if (isClose) {\n      inThinking = false;\n    }\n\n    lastIndex = idx + match[0].length;\n  }\n\n  if (!inThinking || mode === \"preserve\") {\n    result += cleaned.slice(lastIndex);\n  }\n\n  return applyTrim(result, trimMode);\n}\n","import { stripReasoningTagsFromText } from \"../../../src/shared/text/reasoning-tags.js\";\n\nexport function formatMs(ms?: number | null): string {\n  if (!ms && ms !== 0) return \"n/a\";\n  return new Date(ms).toLocaleString();\n}\n\nexport function formatAgo(ms?: number | null): string {\n  if (!ms && ms !== 0) return \"n/a\";\n  const diff = Date.now() - ms;\n  if (diff < 0) return \"just now\";\n  const sec = Math.round(diff / 1000);\n  if (sec < 60) return `${sec}s ago`;\n  const min = Math.round(sec / 60);\n  if (min < 60) return `${min}m ago`;\n  const hr = Math.round(min / 60);\n  if (hr < 48) return `${hr}h ago`;\n  const day = Math.round(hr / 24);\n  return `${day}d ago`;\n}\n\nexport function formatDurationMs(ms?: number | null): string {\n  if (!ms && ms !== 0) return \"n/a\";\n  if (ms < 1000) return `${ms}ms`;\n  const sec = Math.round(ms / 1000);\n  if (sec < 60) return `${sec}s`;\n  const min = Math.round(sec / 60);\n  if (min < 60) return `${min}m`;\n  const hr = Math.round(min / 60);\n  if (hr < 48) return `${hr}h`;\n  const day = Math.round(hr / 24);\n  return `${day}d`;\n}\n\nexport function formatList(values?: Array<string | null | undefined>): string {\n  if (!values || values.length === 0) return \"none\";\n  return values.filter((v): v is string => Boolean(v && v.trim())).join(\", \");\n}\n\nexport function clampText(value: string, max = 120): string {\n  if (value.length <= max) return value;\n  return `${value.slice(0, Math.max(0, max - 1))}…`;\n}\n\nexport function truncateText(value: string, max: number): {\n  text: string;\n  truncated: boolean;\n  total: number;\n} {\n  if (value.length <= max) {\n    return { text: value, truncated: false, total: value.length };\n  }\n  return {\n    text: value.slice(0, Math.max(0, max)),\n    truncated: true,\n    total: value.length,\n  };\n}\n\nexport function toNumber(value: string, fallback: number): number {\n  const n = Number(value);\n  return Number.isFinite(n) ? n : fallback;\n}\n\nexport function parseList(input: string): string[] {\n  return input\n    .split(/[,\\n]/)\n    .map((v) => v.trim())\n    .filter((v) => v.length > 0);\n}\n\nexport function stripThinkingTags(value: string): string {\n  return stripReasoningTagsFromText(value, { mode: \"preserve\", trim: \"start\" });\n}\n","import { stripThinkingTags } from \"../format\";\n\nconst ENVELOPE_PREFIX = /^\\[([^\\]]+)\\]\\s*/;\nconst ENVELOPE_CHANNELS = [\n  \"WebChat\",\n  \"WhatsApp\",\n  \"Telegram\",\n  \"Signal\",\n  \"Slack\",\n  \"Discord\",\n  \"iMessage\",\n  \"Teams\",\n  \"Matrix\",\n  \"Zalo\",\n  \"Zalo Personal\",\n  \"BlueBubbles\",\n];\n\nconst textCache = new WeakMap<object, string | null>();\nconst thinkingCache = new WeakMap<object, string | null>();\n\nfunction looksLikeEnvelopeHeader(header: string): boolean {\n  if (/\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}Z\\b/.test(header)) return true;\n  if (/\\d{4}-\\d{2}-\\d{2} \\d{2}:\\d{2}\\b/.test(header)) return true;\n  return ENVELOPE_CHANNELS.some((label) => header.startsWith(`${label} `));\n}\n\nexport function stripEnvelope(text: string): string {\n  const match = text.match(ENVELOPE_PREFIX);\n  if (!match) return text;\n  const header = match[1] ?? \"\";\n  if (!looksLikeEnvelopeHeader(header)) return text;\n  return text.slice(match[0].length);\n}\n\nexport function extractText(message: unknown): string | null {\n  const m = message as Record<string, unknown>;\n  const role = typeof m.role === \"string\" ? m.role : \"\";\n  const content = m.content;\n  if (typeof content === \"string\") {\n    const processed = role === \"assistant\" ? stripThinkingTags(content) : stripEnvelope(content);\n    return processed;\n  }\n  if (Array.isArray(content)) {\n    const parts = content\n      .map((p) => {\n        const item = p as Record<string, unknown>;\n        if (item.type === \"text\" && typeof item.text === \"string\") return item.text;\n        return null;\n      })\n      .filter((v): v is string => typeof v === \"string\");\n    if (parts.length > 0) {\n      const joined = parts.join(\"\\n\");\n      const processed = role === \"assistant\" ? stripThinkingTags(joined) : stripEnvelope(joined);\n      return processed;\n    }\n  }\n  if (typeof m.text === \"string\") {\n    const processed = role === \"assistant\" ? stripThinkingTags(m.text) : stripEnvelope(m.text);\n    return processed;\n  }\n  return null;\n}\n\nexport function extractTextCached(message: unknown): string | null {\n  if (!message || typeof message !== \"object\") return extractText(message);\n  const obj = message as object;\n  if (textCache.has(obj)) return textCache.get(obj) ?? null;\n  const value = extractText(message);\n  textCache.set(obj, value);\n  return value;\n}\n\nexport function extractThinking(message: unknown): string | null {\n  const m = message as Record<string, unknown>;\n  const content = m.content;\n  const parts: string[] = [];\n  if (Array.isArray(content)) {\n    for (const p of content) {\n      const item = p as Record<string, unknown>;\n      if (item.type === \"thinking\" && typeof item.thinking === \"string\") {\n        const cleaned = item.thinking.trim();\n        if (cleaned) parts.push(cleaned);\n      }\n    }\n  }\n  if (parts.length > 0) return parts.join(\"\\n\");\n\n  // Back-compat: older logs may still have <think> tags inside text blocks.\n  const rawText = extractRawText(message);\n  if (!rawText) return null;\n  const matches = [\n    ...rawText.matchAll(\n      /<\\s*think(?:ing)?\\s*>([\\s\\S]*?)<\\s*\\/\\s*think(?:ing)?\\s*>/gi,\n    ),\n  ];\n  const extracted = matches\n    .map((m) => (m[1] ?? \"\").trim())\n    .filter(Boolean);\n  return extracted.length > 0 ? extracted.join(\"\\n\") : null;\n}\n\nexport function extractThinkingCached(message: unknown): string | null {\n  if (!message || typeof message !== \"object\") return extractThinking(message);\n  const obj = message as object;\n  if (thinkingCache.has(obj)) return thinkingCache.get(obj) ?? null;\n  const value = extractThinking(message);\n  thinkingCache.set(obj, value);\n  return value;\n}\n\nexport function extractRawText(message: unknown): string | null {\n  const m = message as Record<string, unknown>;\n  const content = m.content;\n  if (typeof content === \"string\") return content;\n  if (Array.isArray(content)) {\n    const parts = content\n      .map((p) => {\n        const item = p as Record<string, unknown>;\n        if (item.type === \"text\" && typeof item.text === \"string\") return item.text;\n        return null;\n      })\n      .filter((v): v is string => typeof v === \"string\");\n    if (parts.length > 0) return parts.join(\"\\n\");\n  }\n  if (typeof m.text === \"string\") return m.text;\n  return null;\n}\n\nexport function formatReasoningMarkdown(text: string): string {\n  const trimmed = text.trim();\n  if (!trimmed) return \"\";\n  const lines = trimmed\n    .split(/\\r?\\n/)\n    .map((line) => line.trim())\n    .filter(Boolean)\n    .map((line) => `_${line}_`);\n  return lines.length ? [\"_推理过程:_\", ...lines].join(\"\\n\") : \"\";\n}\n","export type CryptoLike = {\n  randomUUID?: (() => string) | undefined;\n  getRandomValues?: ((array: Uint8Array) => Uint8Array) | undefined;\n};\n\nfunction uuidFromBytes(bytes: Uint8Array): string {\n  bytes[6] = (bytes[6] & 0x0f) | 0x40; // version 4\n  bytes[8] = (bytes[8] & 0x3f) | 0x80; // variant 1\n\n  let hex = \"\";\n  for (let i = 0; i < bytes.length; i++) {\n    hex += bytes[i]!.toString(16).padStart(2, \"0\");\n  }\n\n  return `${hex.slice(0, 8)}-${hex.slice(8, 12)}-${hex.slice(12, 16)}-${hex.slice(\n    16,\n    20,\n  )}-${hex.slice(20)}`;\n}\n\nfunction weakRandomBytes(): Uint8Array {\n  const bytes = new Uint8Array(16);\n  const now = Date.now();\n  for (let i = 0; i < bytes.length; i++) bytes[i] = Math.floor(Math.random() * 256);\n  bytes[0] ^= now & 0xff;\n  bytes[1] ^= (now >>> 8) & 0xff;\n  bytes[2] ^= (now >>> 16) & 0xff;\n  bytes[3] ^= (now >>> 24) & 0xff;\n  return bytes;\n}\n\nexport function generateUUID(cryptoLike: CryptoLike | null = globalThis.crypto): string {\n  if (cryptoLike && typeof cryptoLike.randomUUID === \"function\") return cryptoLike.randomUUID();\n\n  if (cryptoLike && typeof cryptoLike.getRandomValues === \"function\") {\n    const bytes = new Uint8Array(16);\n    cryptoLike.getRandomValues(bytes);\n    return uuidFromBytes(bytes);\n  }\n\n  return uuidFromBytes(weakRandomBytes());\n}\n","import { extractText } from \"../chat/message-extract\";\nimport type { GatewayBrowserClient } from \"../gateway\";\nimport { generateUUID } from \"../uuid\";\nimport type { ChatAttachment } from \"../ui-types\";\n\nexport type ChatState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  sessionKey: string;\n  chatLoading: boolean;\n  chatMessages: unknown[];\n  chatThinkingLevel: string | null;\n  chatSending: boolean;\n  chatMessage: string;\n  chatAttachments: ChatAttachment[];\n  chatRunId: string | null;\n  chatStream: string | null;\n  chatStreamStartedAt: number | null;\n  lastError: string | null;\n};\n\nexport type ChatEventPayload = {\n  runId: string;\n  sessionKey: string;\n  state: \"delta\" | \"final\" | \"aborted\" | \"error\";\n  message?: unknown;\n  errorMessage?: string;\n};\n\nexport async function loadChatHistory(state: ChatState) {\n  if (!state.client || !state.connected) return;\n  state.chatLoading = true;\n  state.lastError = null;\n  try {\n    const res = (await state.client.request(\"chat.history\", {\n      sessionKey: state.sessionKey,\n      limit: 200,\n    })) as { messages?: unknown[]; thinkingLevel?: string | null };\n    state.chatMessages = Array.isArray(res.messages) ? res.messages : [];\n    state.chatThinkingLevel = res.thinkingLevel ?? null;\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.chatLoading = false;\n  }\n}\n\nfunction dataUrlToBase64(dataUrl: string): { content: string; mimeType: string } | null {\n  const match = /^data:([^;]+);base64,(.+)$/.exec(dataUrl);\n  if (!match) return null;\n  return { mimeType: match[1], content: match[2] };\n}\n\nexport async function sendChatMessage(\n  state: ChatState,\n  message: string,\n  attachments?: ChatAttachment[],\n): Promise<boolean> {\n  if (!state.client || !state.connected) return false;\n  const msg = message.trim();\n  const hasAttachments = attachments && attachments.length > 0;\n  if (!msg && !hasAttachments) return false;\n\n  const now = Date.now();\n\n  // Build user message content blocks\n  const contentBlocks: Array<{ type: string; text?: string; source?: unknown }> = [];\n  if (msg) {\n    contentBlocks.push({ type: \"text\", text: msg });\n  }\n  // Add image previews to the message for display\n  if (hasAttachments) {\n    for (const att of attachments) {\n      contentBlocks.push({\n        type: \"image\",\n        source: { type: \"base64\", media_type: att.mimeType, data: att.dataUrl },\n      });\n    }\n  }\n\n  state.chatMessages = [\n    ...state.chatMessages,\n    {\n      role: \"user\",\n      content: contentBlocks,\n      timestamp: now,\n    },\n  ];\n\n  state.chatSending = true;\n  state.lastError = null;\n  const runId = generateUUID();\n  state.chatRunId = runId;\n  state.chatStream = \"\";\n  state.chatStreamStartedAt = now;\n\n  // Convert attachments to API format\n  const apiAttachments = hasAttachments\n    ? attachments\n        .map((att) => {\n          const parsed = dataUrlToBase64(att.dataUrl);\n          if (!parsed) return null;\n          return {\n            type: \"image\",\n            mimeType: parsed.mimeType,\n            content: parsed.content,\n          };\n        })\n        .filter((a): a is NonNullable<typeof a> => a !== null)\n    : undefined;\n\n  try {\n    await state.client.request(\"chat.send\", {\n      sessionKey: state.sessionKey,\n      message: msg,\n      deliver: false,\n      idempotencyKey: runId,\n      attachments: apiAttachments,\n    });\n    return true;\n  } catch (err) {\n    const error = String(err);\n    state.chatRunId = null;\n    state.chatStream = null;\n    state.chatStreamStartedAt = null;\n    state.lastError = error;\n    state.chatMessages = [\n      ...state.chatMessages,\n      {\n        role: \"assistant\",\n        content: [{ type: \"text\", text: \"Error: \" + error }],\n        timestamp: Date.now(),\n      },\n    ];\n    return false;\n  } finally {\n    state.chatSending = false;\n  }\n}\n\nexport async function abortChatRun(state: ChatState): Promise<boolean> {\n  if (!state.client || !state.connected) return false;\n  const runId = state.chatRunId;\n  try {\n    await state.client.request(\n      \"chat.abort\",\n      runId\n        ? { sessionKey: state.sessionKey, runId }\n        : { sessionKey: state.sessionKey },\n    );\n    return true;\n  } catch (err) {\n    state.lastError = String(err);\n    return false;\n  }\n}\n\nexport function handleChatEvent(\n  state: ChatState,\n  payload?: ChatEventPayload,\n) {\n  if (!payload) return null;\n  if (payload.sessionKey !== state.sessionKey) return null;\n\n  // Final from another run (e.g. sub-agent announce): refresh history to show new message.\n  // See https://github.com/clawdbot/clawdbot/issues/1909\n  if (\n    payload.runId &&\n    state.chatRunId &&\n    payload.runId !== state.chatRunId\n  ) {\n    if (payload.state === \"final\") return \"final\";\n    return null;\n  }\n\n  if (payload.state === \"delta\") {\n    const next = extractText(payload.message);\n    if (typeof next === \"string\") {\n      const current = state.chatStream ?? \"\";\n      if (!current || next.length >= current.length) {\n        state.chatStream = next;\n      }\n    }\n  } else if (payload.state === \"final\") {\n    state.chatStream = null;\n    state.chatRunId = null;\n    state.chatStreamStartedAt = null;\n  } else if (payload.state === \"aborted\") {\n    state.chatStream = null;\n    state.chatRunId = null;\n    state.chatStreamStartedAt = null;\n  } else if (payload.state === \"error\") {\n    state.chatStream = null;\n    state.chatRunId = null;\n    state.chatStreamStartedAt = null;\n    state.lastError = payload.errorMessage ?? \"chat error\";\n  }\n  return payload.state;\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport { toNumber } from \"../format\";\nimport type { SessionsListResult } from \"../types\";\n\nexport type SessionsState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  sessionsLoading: boolean;\n  sessionsResult: SessionsListResult | null;\n  sessionsError: string | null;\n  sessionsFilterActive: string;\n  sessionsFilterLimit: string;\n  sessionsIncludeGlobal: boolean;\n  sessionsIncludeUnknown: boolean;\n};\n\nexport async function loadSessions(state: SessionsState) {\n  if (!state.client || !state.connected) return;\n  if (state.sessionsLoading) return;\n  state.sessionsLoading = true;\n  state.sessionsError = null;\n  try {\n    const params: Record<string, unknown> = {\n      includeGlobal: state.sessionsIncludeGlobal,\n      includeUnknown: state.sessionsIncludeUnknown,\n    };\n    const activeMinutes = toNumber(state.sessionsFilterActive, 0);\n    const limit = toNumber(state.sessionsFilterLimit, 0);\n    if (activeMinutes > 0) params.activeMinutes = activeMinutes;\n    if (limit > 0) params.limit = limit;\n    const res = (await state.client.request(\"sessions.list\", params)) as\n      | SessionsListResult\n      | undefined;\n    if (res) state.sessionsResult = res;\n  } catch (err) {\n    state.sessionsError = String(err);\n  } finally {\n    state.sessionsLoading = false;\n  }\n}\n\nexport async function patchSession(\n  state: SessionsState,\n  key: string,\n  patch: {\n    label?: string | null;\n    thinkingLevel?: string | null;\n    verboseLevel?: string | null;\n    reasoningLevel?: string | null;\n  },\n) {\n  if (!state.client || !state.connected) return;\n  const params: Record<string, unknown> = { key };\n  if (\"label\" in patch) params.label = patch.label;\n  if (\"thinkingLevel\" in patch) params.thinkingLevel = patch.thinkingLevel;\n  if (\"verboseLevel\" in patch) params.verboseLevel = patch.verboseLevel;\n  if (\"reasoningLevel\" in patch) params.reasoningLevel = patch.reasoningLevel;\n  try {\n    await state.client.request(\"sessions.patch\", params);\n    await loadSessions(state);\n  } catch (err) {\n    state.sessionsError = String(err);\n  }\n}\n\nexport async function deleteSession(state: SessionsState, key: string) {\n  if (!state.client || !state.connected) return;\n  if (state.sessionsLoading) return;\n  const confirmed = window.confirm(\n    `Delete session \"${key}\"?\\n\\nDeletes the session entry and archives its transcript.`,\n  );\n  if (!confirmed) return;\n  state.sessionsLoading = true;\n  state.sessionsError = null;\n  try {\n    await state.client.request(\"sessions.delete\", { key, deleteTranscript: true });\n    await loadSessions(state);\n  } catch (err) {\n    state.sessionsError = String(err);\n  } finally {\n    state.sessionsLoading = false;\n  }\n}\n","import { truncateText } from \"./format\";\n\nconst TOOL_STREAM_LIMIT = 50;\nconst TOOL_STREAM_THROTTLE_MS = 80;\nconst TOOL_OUTPUT_CHAR_LIMIT = 120_000;\n\nexport type AgentEventPayload = {\n  runId: string;\n  seq: number;\n  stream: string;\n  ts: number;\n  sessionKey?: string;\n  data: Record<string, unknown>;\n};\n\nexport type ToolStreamEntry = {\n  toolCallId: string;\n  runId: string;\n  sessionKey?: string;\n  name: string;\n  args?: unknown;\n  output?: string;\n  startedAt: number;\n  updatedAt: number;\n  message: Record<string, unknown>;\n};\n\ntype ToolStreamHost = {\n  sessionKey: string;\n  chatRunId: string | null;\n  toolStreamById: Map<string, ToolStreamEntry>;\n  toolStreamOrder: string[];\n  chatToolMessages: Record<string, unknown>[];\n  toolStreamSyncTimer: number | null;\n};\n\nfunction extractToolOutputText(value: unknown): string | null {\n  if (!value || typeof value !== \"object\") return null;\n  const record = value as Record<string, unknown>;\n  if (typeof record.text === \"string\") return record.text;\n  const content = record.content;\n  if (!Array.isArray(content)) return null;\n  const parts = content\n    .map((item) => {\n      if (!item || typeof item !== \"object\") return null;\n      const entry = item as Record<string, unknown>;\n      if (entry.type === \"text\" && typeof entry.text === \"string\") return entry.text;\n      return null;\n    })\n    .filter((part): part is string => Boolean(part));\n  if (parts.length === 0) return null;\n  return parts.join(\"\\n\");\n}\n\nfunction formatToolOutput(value: unknown): string | null {\n  if (value === null || value === undefined) return null;\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return String(value);\n  }\n  const contentText = extractToolOutputText(value);\n  let text: string;\n  if (typeof value === \"string\") {\n    text = value;\n  } else if (contentText) {\n    text = contentText;\n  } else {\n    try {\n      text = JSON.stringify(value, null, 2);\n    } catch {\n      text = String(value);\n    }\n  }\n  const truncated = truncateText(text, TOOL_OUTPUT_CHAR_LIMIT);\n  if (!truncated.truncated) return truncated.text;\n  return `${truncated.text}\\n\\n… truncated (${truncated.total} chars, showing first ${truncated.text.length}).`;\n}\n\nfunction buildToolStreamMessage(entry: ToolStreamEntry): Record<string, unknown> {\n  const content: Array<Record<string, unknown>> = [];\n  content.push({\n    type: \"toolcall\",\n    name: entry.name,\n    arguments: entry.args ?? {},\n  });\n  if (entry.output) {\n    content.push({\n      type: \"toolresult\",\n      name: entry.name,\n      text: entry.output,\n    });\n  }\n  return {\n    role: \"assistant\",\n    toolCallId: entry.toolCallId,\n    runId: entry.runId,\n    content,\n    timestamp: entry.startedAt,\n  };\n}\n\nfunction trimToolStream(host: ToolStreamHost) {\n  if (host.toolStreamOrder.length <= TOOL_STREAM_LIMIT) return;\n  const overflow = host.toolStreamOrder.length - TOOL_STREAM_LIMIT;\n  const removed = host.toolStreamOrder.splice(0, overflow);\n  for (const id of removed) host.toolStreamById.delete(id);\n}\n\nfunction syncToolStreamMessages(host: ToolStreamHost) {\n  host.chatToolMessages = host.toolStreamOrder\n    .map((id) => host.toolStreamById.get(id)?.message)\n    .filter((msg): msg is Record<string, unknown> => Boolean(msg));\n}\n\nexport function flushToolStreamSync(host: ToolStreamHost) {\n  if (host.toolStreamSyncTimer != null) {\n    clearTimeout(host.toolStreamSyncTimer);\n    host.toolStreamSyncTimer = null;\n  }\n  syncToolStreamMessages(host);\n}\n\nexport function scheduleToolStreamSync(host: ToolStreamHost, force = false) {\n  if (force) {\n    flushToolStreamSync(host);\n    return;\n  }\n  if (host.toolStreamSyncTimer != null) return;\n  host.toolStreamSyncTimer = window.setTimeout(\n    () => flushToolStreamSync(host),\n    TOOL_STREAM_THROTTLE_MS,\n  );\n}\n\nexport function resetToolStream(host: ToolStreamHost) {\n  host.toolStreamById.clear();\n  host.toolStreamOrder = [];\n  host.chatToolMessages = [];\n  flushToolStreamSync(host);\n}\n\nexport type CompactionStatus = {\n  active: boolean;\n  startedAt: number | null;\n  completedAt: number | null;\n};\n\ntype CompactionHost = ToolStreamHost & {\n  compactionStatus?: CompactionStatus | null;\n  compactionClearTimer?: number | null;\n};\n\nconst COMPACTION_TOAST_DURATION_MS = 5000;\n\nexport function handleCompactionEvent(host: CompactionHost, payload: AgentEventPayload) {\n  const data = payload.data ?? {};\n  const phase = typeof data.phase === \"string\" ? data.phase : \"\";\n\n  // Clear any existing timer\n  if (host.compactionClearTimer != null) {\n    window.clearTimeout(host.compactionClearTimer);\n    host.compactionClearTimer = null;\n  }\n\n  if (phase === \"start\") {\n    host.compactionStatus = {\n      active: true,\n      startedAt: Date.now(),\n      completedAt: null,\n    };\n  } else if (phase === \"end\") {\n    host.compactionStatus = {\n      active: false,\n      startedAt: host.compactionStatus?.startedAt ?? null,\n      completedAt: Date.now(),\n    };\n    // Auto-clear the toast after duration\n    host.compactionClearTimer = window.setTimeout(() => {\n      host.compactionStatus = null;\n      host.compactionClearTimer = null;\n    }, COMPACTION_TOAST_DURATION_MS);\n  }\n}\n\nexport function handleAgentEvent(host: ToolStreamHost, payload?: AgentEventPayload) {\n  if (!payload) return;\n\n  // Handle compaction events\n  if (payload.stream === \"compaction\") {\n    handleCompactionEvent(host as CompactionHost, payload);\n    return;\n  }\n\n  if (payload.stream !== \"tool\") return;\n  const sessionKey =\n    typeof payload.sessionKey === \"string\" ? payload.sessionKey : undefined;\n  if (sessionKey && sessionKey !== host.sessionKey) return;\n  // Fallback: only accept session-less events for the active run.\n  if (!sessionKey && host.chatRunId && payload.runId !== host.chatRunId) return;\n  if (host.chatRunId && payload.runId !== host.chatRunId) return;\n  if (!host.chatRunId) return;\n\n  const data = payload.data ?? {};\n  const toolCallId = typeof data.toolCallId === \"string\" ? data.toolCallId : \"\";\n  if (!toolCallId) return;\n  const name = typeof data.name === \"string\" ? data.name : \"tool\";\n  const phase = typeof data.phase === \"string\" ? data.phase : \"\";\n  const args = phase === \"start\" ? data.args : undefined;\n  const output =\n    phase === \"update\"\n      ? formatToolOutput(data.partialResult)\n      : phase === \"result\"\n        ? formatToolOutput(data.result)\n        : undefined;\n\n  const now = Date.now();\n  let entry = host.toolStreamById.get(toolCallId);\n  if (!entry) {\n    entry = {\n      toolCallId,\n      runId: payload.runId,\n      sessionKey,\n      name,\n      args,\n      output,\n      startedAt: typeof payload.ts === \"number\" ? payload.ts : now,\n      updatedAt: now,\n      message: {},\n    };\n    host.toolStreamById.set(toolCallId, entry);\n    host.toolStreamOrder.push(toolCallId);\n  } else {\n    entry.name = name;\n    if (args !== undefined) entry.args = args;\n    if (output !== undefined) entry.output = output;\n    entry.updatedAt = now;\n  }\n\n  entry.message = buildToolStreamMessage(entry);\n  trimToolStream(host);\n  scheduleToolStreamSync(host, phase === \"result\");\n}\n","/** Distance (px) from the bottom within which we consider the user \"near bottom\". */\nconst NEAR_BOTTOM_THRESHOLD = 450;\n\ntype ScrollHost = {\n  updateComplete: Promise<unknown>;\n  querySelector: (selectors: string) => Element | null;\n  style: CSSStyleDeclaration;\n  chatScrollFrame: number | null;\n  chatScrollTimeout: number | null;\n  chatHasAutoScrolled: boolean;\n  chatUserNearBottom: boolean;\n  chatNewMessagesBelow: boolean;\n  logsScrollFrame: number | null;\n  logsAtBottom: boolean;\n  topbarObserver: ResizeObserver | null;\n};\n\nexport function scheduleChatScroll(host: ScrollHost, force = false) {\n  if (host.chatScrollFrame) {\n    cancelAnimationFrame(host.chatScrollFrame);\n  }\n  if (host.chatScrollTimeout != null) {\n    clearTimeout(host.chatScrollTimeout);\n    host.chatScrollTimeout = null;\n  }\n  const pickScrollTarget = () => {\n    const container = host.querySelector(\".chat-thread\") as HTMLElement | null;\n    if (container) {\n      const overflowY = getComputedStyle(container).overflowY;\n      const canScroll =\n        overflowY === \"auto\" ||\n        overflowY === \"scroll\" ||\n        container.scrollHeight - container.clientHeight > 1;\n      if (canScroll) {\n        return container;\n      }\n    }\n    return (document.scrollingElement ?? document.documentElement) as HTMLElement | null;\n  };\n  // Wait for Lit render to complete, then scroll\n  void host.updateComplete.then(() => {\n    host.chatScrollFrame = requestAnimationFrame(() => {\n      host.chatScrollFrame = null;\n      const target = pickScrollTarget();\n      if (!target) {\n        return;\n      }\n      const distanceFromBottom = target.scrollHeight - target.scrollTop - target.clientHeight;\n\n      // force=true only overrides when we haven't auto-scrolled yet (initial load).\n      // After initial load, respect the user's scroll position.\n      const effectiveForce = force && !host.chatHasAutoScrolled;\n      const shouldStick =\n        effectiveForce || host.chatUserNearBottom || distanceFromBottom < NEAR_BOTTOM_THRESHOLD;\n\n      if (!shouldStick) {\n        // User is scrolled up — flag that new content arrived below.\n        host.chatNewMessagesBelow = true;\n        return;\n      }\n      if (effectiveForce) {\n        host.chatHasAutoScrolled = true;\n      }\n      target.scrollTop = target.scrollHeight;\n      host.chatUserNearBottom = true;\n      host.chatNewMessagesBelow = false;\n      const retryDelay = effectiveForce ? 150 : 120;\n      host.chatScrollTimeout = window.setTimeout(() => {\n        host.chatScrollTimeout = null;\n        const latest = pickScrollTarget();\n        if (!latest) {\n          return;\n        }\n        const latestDistanceFromBottom =\n          latest.scrollHeight - latest.scrollTop - latest.clientHeight;\n        const shouldStickRetry =\n          effectiveForce ||\n          host.chatUserNearBottom ||\n          latestDistanceFromBottom < NEAR_BOTTOM_THRESHOLD;\n        if (!shouldStickRetry) {\n          return;\n        }\n        latest.scrollTop = latest.scrollHeight;\n        host.chatUserNearBottom = true;\n      }, retryDelay);\n    });\n  });\n}\n\nexport function scheduleLogsScroll(host: ScrollHost, force = false) {\n  if (host.logsScrollFrame) {\n    cancelAnimationFrame(host.logsScrollFrame);\n  }\n  void host.updateComplete.then(() => {\n    host.logsScrollFrame = requestAnimationFrame(() => {\n      host.logsScrollFrame = null;\n      const container = host.querySelector(\".log-stream\") as HTMLElement | null;\n      if (!container) {\n        return;\n      }\n      const distanceFromBottom =\n        container.scrollHeight - container.scrollTop - container.clientHeight;\n      const shouldStick = force || distanceFromBottom < 80;\n      if (!shouldStick) {\n        return;\n      }\n      container.scrollTop = container.scrollHeight;\n    });\n  });\n}\n\nexport function handleChatScroll(host: ScrollHost, event: Event) {\n  const container = event.currentTarget as HTMLElement | null;\n  if (!container) {\n    return;\n  }\n  const distanceFromBottom = container.scrollHeight - container.scrollTop - container.clientHeight;\n  host.chatUserNearBottom = distanceFromBottom < NEAR_BOTTOM_THRESHOLD;\n  // Clear the \"new messages below\" indicator when user scrolls back to bottom.\n  if (host.chatUserNearBottom) {\n    host.chatNewMessagesBelow = false;\n  }\n}\n\nexport function handleLogsScroll(host: ScrollHost, event: Event) {\n  const container = event.currentTarget as HTMLElement | null;\n  if (!container) {\n    return;\n  }\n  const distanceFromBottom = container.scrollHeight - container.scrollTop - container.clientHeight;\n  host.logsAtBottom = distanceFromBottom < 80;\n}\n\nexport function resetChatScroll(host: ScrollHost) {\n  host.chatHasAutoScrolled = false;\n  host.chatUserNearBottom = true;\n  host.chatNewMessagesBelow = false;\n}\n\nexport function exportLogs(lines: string[], label: string) {\n  if (lines.length === 0) {\n    return;\n  }\n  const blob = new Blob([`${lines.join(\"\\n\")}\\n`], { type: \"text/plain\" });\n  const url = URL.createObjectURL(blob);\n  const anchor = document.createElement(\"a\");\n  const stamp = new Date().toISOString().slice(0, 19).replace(/[:T]/g, \"-\");\n  anchor.href = url;\n  anchor.download = `openclaw-logs-${label}-${stamp}.log`;\n  anchor.click();\n  URL.revokeObjectURL(url);\n}\n\nexport function observeTopbar(host: ScrollHost) {\n  if (typeof ResizeObserver === \"undefined\") {\n    return;\n  }\n  const topbar = host.querySelector(\".topbar\");\n  if (!topbar) {\n    return;\n  }\n  const update = () => {\n    const { height } = topbar.getBoundingClientRect();\n    host.style.setProperty(\"--topbar-height\", `${height}px`);\n  };\n  update();\n  host.topbarObserver = new ResizeObserver(() => update());\n  host.topbarObserver.observe(topbar);\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { LogEntry, LogLevel } from \"../types\";\n\nexport type LogsState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  logsLoading: boolean;\n  logsError: string | null;\n  logsCursor: number | null;\n  logsFile: string | null;\n  logsEntries: LogEntry[];\n  logsTruncated: boolean;\n  logsLastFetchAt: number | null;\n  logsLimit: number;\n  logsMaxBytes: number;\n};\n\nconst LOG_BUFFER_LIMIT = 2000;\nconst LEVELS = new Set<LogLevel>([\n  \"trace\",\n  \"debug\",\n  \"info\",\n  \"warn\",\n  \"error\",\n  \"fatal\",\n]);\n\nfunction parseMaybeJsonString(value: unknown) {\n  if (typeof value !== \"string\") return null;\n  const trimmed = value.trim();\n  if (!trimmed.startsWith(\"{\") || !trimmed.endsWith(\"}\")) return null;\n  try {\n    const parsed = JSON.parse(trimmed) as unknown;\n    if (!parsed || typeof parsed !== \"object\") return null;\n    return parsed as Record<string, unknown>;\n  } catch {\n    return null;\n  }\n}\n\nfunction normalizeLevel(value: unknown): LogLevel | null {\n  if (typeof value !== \"string\") return null;\n  const lowered = value.toLowerCase() as LogLevel;\n  return LEVELS.has(lowered) ? lowered : null;\n}\n\nexport function parseLogLine(line: string): LogEntry {\n  if (!line.trim()) return { raw: line, message: line };\n  try {\n    const obj = JSON.parse(line) as Record<string, unknown>;\n    const meta =\n      obj && typeof obj._meta === \"object\" && obj._meta !== null\n        ? (obj._meta as Record<string, unknown>)\n        : null;\n    const time =\n      typeof obj.time === \"string\"\n        ? obj.time\n        : typeof meta?.date === \"string\"\n          ? meta?.date\n          : null;\n    const level = normalizeLevel(meta?.logLevelName ?? meta?.level);\n\n    const contextCandidate =\n      typeof obj[\"0\"] === \"string\"\n        ? (obj[\"0\"] as string)\n        : typeof meta?.name === \"string\"\n          ? (meta?.name as string)\n          : null;\n    const contextObj = parseMaybeJsonString(contextCandidate);\n    let subsystem: string | null = null;\n    if (contextObj) {\n      if (typeof contextObj.subsystem === \"string\") subsystem = contextObj.subsystem;\n      else if (typeof contextObj.module === \"string\") subsystem = contextObj.module;\n    }\n    if (!subsystem && contextCandidate && contextCandidate.length < 120) {\n      subsystem = contextCandidate;\n    }\n\n    let message: string | null = null;\n    if (typeof obj[\"1\"] === \"string\") message = obj[\"1\"] as string;\n    else if (!contextObj && typeof obj[\"0\"] === \"string\") message = obj[\"0\"] as string;\n    else if (typeof obj.message === \"string\") message = obj.message as string;\n\n    return {\n      raw: line,\n      time,\n      level,\n      subsystem,\n      message: message ?? line,\n      meta: meta ?? undefined,\n    };\n  } catch {\n    return { raw: line, message: line };\n  }\n}\n\nexport async function loadLogs(\n  state: LogsState,\n  opts?: { reset?: boolean; quiet?: boolean },\n) {\n  if (!state.client || !state.connected) return;\n  if (state.logsLoading && !opts?.quiet) return;\n  if (!opts?.quiet) state.logsLoading = true;\n  state.logsError = null;\n  try {\n    const res = await state.client.request(\"logs.tail\", {\n      cursor: opts?.reset ? undefined : state.logsCursor ?? undefined,\n      limit: state.logsLimit,\n      maxBytes: state.logsMaxBytes,\n    });\n    const payload = res as {\n      file?: string;\n      cursor?: number;\n      size?: number;\n      lines?: unknown;\n      truncated?: boolean;\n      reset?: boolean;\n    };\n    const lines = Array.isArray(payload.lines)\n      ? (payload.lines.filter((line) => typeof line === \"string\") as string[])\n      : [];\n    const entries = lines.map(parseLogLine);\n    const shouldReset = Boolean(opts?.reset || payload.reset || state.logsCursor == null);\n    state.logsEntries = shouldReset\n      ? entries\n      : [...state.logsEntries, ...entries].slice(-LOG_BUFFER_LIMIT);\n    if (typeof payload.cursor === \"number\") state.logsCursor = payload.cursor;\n    if (typeof payload.file === \"string\") state.logsFile = payload.file;\n    state.logsTruncated = Boolean(payload.truncated);\n    state.logsLastFetchAt = Date.now();\n  } catch (err) {\n    state.logsError = String(err);\n  } finally {\n    if (!opts?.quiet) state.logsLoading = false;\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\n\nexport type NodesState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  nodesLoading: boolean;\n  nodes: Array<Record<string, unknown>>;\n  lastError: string | null;\n};\n\nexport async function loadNodes(\n  state: NodesState,\n  opts?: { quiet?: boolean },\n) {\n  if (!state.client || !state.connected) return;\n  if (state.nodesLoading) return;\n  state.nodesLoading = true;\n  if (!opts?.quiet) state.lastError = null;\n  try {\n    const res = (await state.client.request(\"node.list\", {})) as {\n      nodes?: Array<Record<string, unknown>>;\n    };\n    state.nodes = Array.isArray(res.nodes) ? res.nodes : [];\n  } catch (err) {\n    if (!opts?.quiet) state.lastError = String(err);\n  } finally {\n    state.nodesLoading = false;\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { HealthSnapshot, StatusSummary } from \"../types\";\n\nexport type DebugState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  debugLoading: boolean;\n  debugStatus: StatusSummary | null;\n  debugHealth: HealthSnapshot | null;\n  debugModels: unknown[];\n  debugHeartbeat: unknown | null;\n  debugCallMethod: string;\n  debugCallParams: string;\n  debugCallResult: string | null;\n  debugCallError: string | null;\n};\n\nexport async function loadDebug(state: DebugState) {\n  if (!state.client || !state.connected) return;\n  if (state.debugLoading) return;\n  state.debugLoading = true;\n  try {\n    const [status, health, models, heartbeat] = await Promise.all([\n      state.client.request(\"status\", {}),\n      state.client.request(\"health\", {}),\n      state.client.request(\"models.list\", {}),\n      state.client.request(\"last-heartbeat\", {}),\n    ]);\n    state.debugStatus = status as StatusSummary;\n    state.debugHealth = health as HealthSnapshot;\n    const modelPayload = models as { models?: unknown[] } | undefined;\n    state.debugModels = Array.isArray(modelPayload?.models)\n      ? modelPayload?.models\n      : [];\n    state.debugHeartbeat = heartbeat as unknown;\n  } catch (err) {\n    state.debugCallError = String(err);\n  } finally {\n    state.debugLoading = false;\n  }\n}\n\nexport async function callDebugMethod(state: DebugState) {\n  if (!state.client || !state.connected) return;\n  state.debugCallError = null;\n  state.debugCallResult = null;\n  try {\n    const params = state.debugCallParams.trim()\n      ? (JSON.parse(state.debugCallParams) as unknown)\n      : {};\n    const res = await state.client.request(state.debugCallMethod.trim(), params);\n    state.debugCallResult = JSON.stringify(res, null, 2);\n  } catch (err) {\n    state.debugCallError = String(err);\n  }\n}\n","import { loadLogs } from \"./controllers/logs\";\nimport { loadNodes } from \"./controllers/nodes\";\nimport { loadDebug } from \"./controllers/debug\";\nimport type { ClawdbotApp } from \"./app\";\n\ntype PollingHost = {\n  nodesPollInterval: number | null;\n  logsPollInterval: number | null;\n  debugPollInterval: number | null;\n  tab: string;\n};\n\nexport function startNodesPolling(host: PollingHost) {\n  if (host.nodesPollInterval != null) return;\n  host.nodesPollInterval = window.setInterval(\n    () => void loadNodes(host as unknown as ClawdbotApp, { quiet: true }),\n    5000,\n  );\n}\n\nexport function stopNodesPolling(host: PollingHost) {\n  if (host.nodesPollInterval == null) return;\n  clearInterval(host.nodesPollInterval);\n  host.nodesPollInterval = null;\n}\n\nexport function startLogsPolling(host: PollingHost) {\n  if (host.logsPollInterval != null) return;\n  host.logsPollInterval = window.setInterval(() => {\n    if (host.tab !== \"logs\") return;\n    void loadLogs(host as unknown as ClawdbotApp, { quiet: true });\n  }, 2000);\n}\n\nexport function stopLogsPolling(host: PollingHost) {\n  if (host.logsPollInterval == null) return;\n  clearInterval(host.logsPollInterval);\n  host.logsPollInterval = null;\n}\n\nexport function startDebugPolling(host: PollingHost) {\n  if (host.debugPollInterval != null) return;\n  host.debugPollInterval = window.setInterval(() => {\n    if (host.tab !== \"debug\") return;\n    void loadDebug(host as unknown as ClawdbotApp);\n  }, 3000);\n}\n\nexport function stopDebugPolling(host: PollingHost) {\n  if (host.debugPollInterval == null) return;\n  clearInterval(host.debugPollInterval);\n  host.debugPollInterval = null;\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { AgentIdentityResult } from \"../types\";\n\nexport type AgentIdentityState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  agentIdentityLoading: boolean;\n  agentIdentityError: string | null;\n  agentIdentityById: Record<string, AgentIdentityResult>;\n};\n\nexport async function loadAgentIdentity(state: AgentIdentityState, agentId: string) {\n  if (!state.client || !state.connected || state.agentIdentityLoading) {\n    return;\n  }\n  if (state.agentIdentityById[agentId]) {\n    return;\n  }\n  state.agentIdentityLoading = true;\n  state.agentIdentityError = null;\n  try {\n    const res = await state.client.request<AgentIdentityResult | null>(\"agent.identity.get\", {\n      agentId,\n    });\n    if (res) {\n      state.agentIdentityById = { ...state.agentIdentityById, [agentId]: res };\n    }\n  } catch (err) {\n    state.agentIdentityError = String(err);\n  } finally {\n    state.agentIdentityLoading = false;\n  }\n}\n\nexport async function loadAgentIdentities(state: AgentIdentityState, agentIds: string[]) {\n  if (!state.client || !state.connected || state.agentIdentityLoading) {\n    return;\n  }\n  const missing = agentIds.filter((id) => !state.agentIdentityById[id]);\n  if (missing.length === 0) {\n    return;\n  }\n  state.agentIdentityLoading = true;\n  state.agentIdentityError = null;\n  try {\n    for (const agentId of missing) {\n      const res = await state.client.request<AgentIdentityResult | null>(\"agent.identity.get\", {\n        agentId,\n      });\n      if (res) {\n        state.agentIdentityById = { ...state.agentIdentityById, [agentId]: res };\n      }\n    }\n  } catch (err) {\n    state.agentIdentityError = String(err);\n  } finally {\n    state.agentIdentityLoading = false;\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { SkillStatusReport } from \"../types\";\n\nexport type AgentSkillsState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  agentSkillsLoading: boolean;\n  agentSkillsError: string | null;\n  agentSkillsReport: SkillStatusReport | null;\n  agentSkillsAgentId: string | null;\n};\n\nexport async function loadAgentSkills(state: AgentSkillsState, agentId: string) {\n  if (!state.client || !state.connected) {\n    return;\n  }\n  if (state.agentSkillsLoading) {\n    return;\n  }\n  state.agentSkillsLoading = true;\n  state.agentSkillsError = null;\n  try {\n    const res = await state.client.request(\"skills.status\", { agentId });\n    if (res) {\n      state.agentSkillsReport = res as SkillStatusReport;\n      state.agentSkillsAgentId = agentId;\n    }\n  } catch (err) {\n    state.agentSkillsError = String(err);\n  } finally {\n    state.agentSkillsLoading = false;\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { AgentsListResult } from \"../types\";\n\nexport type AgentsState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  agentsLoading: boolean;\n  agentsError: string | null;\n  agentsList: AgentsListResult | null;\n  agentsSelectedId: string | null;\n};\n\nexport async function loadAgents(state: AgentsState) {\n  if (!state.client || !state.connected) {\n    return;\n  }\n  if (state.agentsLoading) {\n    return;\n  }\n  state.agentsLoading = true;\n  state.agentsError = null;\n  try {\n    const res = await state.client.request(\"agents.list\", {});\n    if (res) {\n      state.agentsList = res;\n      const selected = state.agentsSelectedId;\n      const known = res.agents.some((entry) => entry.id === selected);\n      if (!selected || !known) {\n        state.agentsSelectedId = res.defaultId ?? res.agents[0]?.id ?? null;\n      }\n    }\n  } catch (err) {\n    state.agentsError = String(err);\n  } finally {\n    state.agentsLoading = false;\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway.ts\";\nimport type { CronJob, CronRunLogEntry, CronStatus } from \"../types.ts\";\nimport type { CronFormState } from \"../ui-types.ts\";\nimport { toNumber } from \"../format.ts\";\n\nexport type CronState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  cronLoading: boolean;\n  cronJobs: CronJob[];\n  cronStatus: CronStatus | null;\n  cronError: string | null;\n  cronForm: CronFormState;\n  cronRunsJobId: string | null;\n  cronRuns: CronRunLogEntry[];\n  cronBusy: boolean;\n};\n\nexport async function loadCronStatus(state: CronState) {\n  if (!state.client || !state.connected) {\n    return;\n  }\n  try {\n    const res = await state.client.request<CronStatus>(\"cron.status\", {});\n    state.cronStatus = res;\n  } catch (err) {\n    state.cronError = String(err);\n  }\n}\n\nexport async function loadCronJobs(state: CronState) {\n  if (!state.client || !state.connected) {\n    return;\n  }\n  if (state.cronLoading) {\n    return;\n  }\n  state.cronLoading = true;\n  state.cronError = null;\n  try {\n    const res = await state.client.request<{ jobs?: Array<CronJob> }>(\"cron.list\", {\n      includeDisabled: true,\n    });\n    state.cronJobs = Array.isArray(res.jobs) ? res.jobs : [];\n  } catch (err) {\n    state.cronError = String(err);\n  } finally {\n    state.cronLoading = false;\n  }\n}\n\nexport function buildCronSchedule(form: CronFormState) {\n  if (form.scheduleKind === \"at\") {\n    const ms = Date.parse(form.scheduleAt);\n    if (!Number.isFinite(ms)) {\n      throw new Error(\"Invalid run time.\");\n    }\n    return { kind: \"at\" as const, atMs: ms };\n  }\n  if (form.scheduleKind === \"every\") {\n    const amount = toNumber(form.everyAmount, 0);\n    if (amount <= 0) {\n      throw new Error(\"Invalid interval amount.\");\n    }\n    const unit = form.everyUnit;\n    const mult = unit === \"minutes\" ? 60_000 : unit === \"hours\" ? 3_600_000 : 86_400_000;\n    return { kind: \"every\" as const, everyMs: amount * mult };\n  }\n  const expr = form.cronExpr.trim();\n  if (!expr) {\n    throw new Error(\"Cron expression required.\");\n  }\n  return { kind: \"cron\" as const, expr, tz: form.cronTz.trim() || undefined };\n}\n\nexport function buildCronPayload(form: CronFormState) {\n  if (form.payloadKind === \"systemEvent\") {\n    const text = form.payloadText.trim();\n    if (!text) {\n      throw new Error(\"System event text required.\");\n    }\n    return { kind: \"systemEvent\" as const, text };\n  }\n  const message = form.payloadText.trim();\n  if (!message) {\n    throw new Error(\"Agent message required.\");\n  }\n  const payload: {\n    kind: \"agentTurn\";\n    message: string;\n    timeoutSeconds?: number;\n  } = { kind: \"agentTurn\", message };\n  const timeoutSeconds = toNumber(form.timeoutSeconds, 0);\n  if (timeoutSeconds > 0) {\n    payload.timeoutSeconds = timeoutSeconds;\n  }\n  return payload;\n}\n\nexport async function addCronJob(state: CronState) {\n  if (!state.client || !state.connected || state.cronBusy) {\n    return;\n  }\n  state.cronBusy = true;\n  state.cronError = null;\n  try {\n    const schedule = buildCronSchedule(state.cronForm);\n    const payload = buildCronPayload(state.cronForm);\n    const delivery =\n      state.cronForm.sessionTarget === \"isolated\" &&\n      state.cronForm.payloadKind === \"agentTurn\" &&\n      state.cronForm.deliveryMode !== \"legacy\"\n        ? {\n            mode:\n              state.cronForm.deliveryMode === \"announce\"\n                ? \"announce\"\n                : state.cronForm.deliveryMode === \"deliver\"\n                  ? \"deliver\"\n                  : \"none\",\n            channel: state.cronForm.deliveryChannel.trim() || \"last\",\n            to: state.cronForm.deliveryTo.trim() || undefined,\n          }\n        : undefined;\n    const legacyPrefix = state.cronForm.postToMainPrefix.trim() || \"Cron\";\n    const agentId = state.cronForm.agentId.trim();\n    const job = {\n      name: state.cronForm.name.trim(),\n      description: state.cronForm.description.trim() || undefined,\n      agentId: agentId || undefined,\n      enabled: state.cronForm.enabled,\n      schedule,\n      sessionTarget: state.cronForm.sessionTarget,\n      wakeMode: state.cronForm.wakeMode,\n      payload,\n      delivery,\n      isolation:\n        state.cronForm.sessionTarget === \"isolated\" && state.cronForm.deliveryMode === \"legacy\"\n          ? { postToMainPrefix: legacyPrefix }\n          : undefined,\n    };\n    if (!job.name) {\n      throw new Error(\"Name required.\");\n    }\n    await state.client.request(\"cron.add\", job);\n    state.cronForm = {\n      ...state.cronForm,\n      name: \"\",\n      description: \"\",\n      payloadText: \"\",\n    };\n    await loadCronJobs(state);\n    await loadCronStatus(state);\n  } catch (err) {\n    state.cronError = String(err);\n  } finally {\n    state.cronBusy = false;\n  }\n}\n\nexport async function toggleCronJob(state: CronState, job: CronJob, enabled: boolean) {\n  if (!state.client || !state.connected || state.cronBusy) {\n    return;\n  }\n  state.cronBusy = true;\n  state.cronError = null;\n  try {\n    await state.client.request(\"cron.update\", { id: job.id, patch: { enabled } });\n    await loadCronJobs(state);\n    await loadCronStatus(state);\n  } catch (err) {\n    state.cronError = String(err);\n  } finally {\n    state.cronBusy = false;\n  }\n}\n\nexport async function runCronJob(state: CronState, job: CronJob) {\n  if (!state.client || !state.connected || state.cronBusy) {\n    return;\n  }\n  state.cronBusy = true;\n  state.cronError = null;\n  try {\n    await state.client.request(\"cron.run\", { id: job.id, mode: \"force\" });\n    await loadCronRuns(state, job.id);\n  } catch (err) {\n    state.cronError = String(err);\n  } finally {\n    state.cronBusy = false;\n  }\n}\n\nexport async function removeCronJob(state: CronState, job: CronJob) {\n  if (!state.client || !state.connected || state.cronBusy) {\n    return;\n  }\n  state.cronBusy = true;\n  state.cronError = null;\n  try {\n    await state.client.request(\"cron.remove\", { id: job.id });\n    if (state.cronRunsJobId === job.id) {\n      state.cronRunsJobId = null;\n      state.cronRuns = [];\n    }\n    await loadCronJobs(state);\n    await loadCronStatus(state);\n  } catch (err) {\n    state.cronError = String(err);\n  } finally {\n    state.cronBusy = false;\n  }\n}\n\nexport async function loadCronRuns(state: CronState, jobId: string) {\n  if (!state.client || !state.connected) {\n    return;\n  }\n  try {\n    const res = await state.client.request<{ entries?: Array<CronRunLogEntry> }>(\"cron.runs\", {\n      id: jobId,\n      limit: 50,\n    });\n    state.cronRunsJobId = jobId;\n    state.cronRuns = Array.isArray(res.entries) ? res.entries : [];\n  } catch (err) {\n    state.cronError = String(err);\n  }\n}\n","/*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) */\n/**\n * 5KB JS implementation of ed25519 EdDSA signatures.\n * Compliant with RFC8032, FIPS 186-5 & ZIP215.\n * @module\n * @example\n * ```js\nimport * as ed from '@noble/ed25519';\n(async () => {\n  const secretKey = ed.utils.randomSecretKey();\n  const message = Uint8Array.from([0xab, 0xbc, 0xcd, 0xde]);\n  const pubKey = await ed.getPublicKeyAsync(secretKey); // Sync methods are also present\n  const signature = await ed.signAsync(message, secretKey);\n  const isValid = await ed.verifyAsync(signature, message, pubKey);\n})();\n```\n */\n/**\n * Curve params. ed25519 is twisted edwards curve. Equation is −x² + y² = -a + dx²y².\n * * P = `2n**255n - 19n` // field over which calculations are done\n * * N = `2n**252n + 27742317777372353535851937790883648493n` // group order, amount of curve points\n * * h = 8 // cofactor\n * * a = `Fp.create(BigInt(-1))` // equation param\n * * d = -121665/121666 a.k.a. `Fp.neg(121665 * Fp.inv(121666))` // equation param\n * * Gx, Gy are coordinates of Generator / base point\n */\nconst ed25519_CURVE = {\n    p: 0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffedn,\n    n: 0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3edn,\n    h: 8n,\n    a: 0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffecn,\n    d: 0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3n,\n    Gx: 0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,\n    Gy: 0x6666666666666666666666666666666666666666666666666666666666666658n,\n};\nconst { p: P, n: N, Gx, Gy, a: _a, d: _d, h } = ed25519_CURVE;\nconst L = 32; // field / group byte length\nconst L2 = 64;\n// Helpers and Precomputes sections are reused between libraries\n// ## Helpers\n// ----------\nconst captureTrace = (...args) => {\n    if ('captureStackTrace' in Error && typeof Error.captureStackTrace === 'function') {\n        Error.captureStackTrace(...args);\n    }\n};\nconst err = (message = '') => {\n    const e = new Error(message);\n    captureTrace(e, err);\n    throw e;\n};\nconst isBig = (n) => typeof n === 'bigint'; // is big integer\nconst isStr = (s) => typeof s === 'string'; // is string\nconst isBytes = (a) => a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n/** Asserts something is Uint8Array. */\nconst abytes = (value, length, title = '') => {\n    const bytes = isBytes(value);\n    const len = value?.length;\n    const needsLen = length !== undefined;\n    if (!bytes || (needsLen && len !== length)) {\n        const prefix = title && `\"${title}\" `;\n        const ofLen = needsLen ? ` of length ${length}` : '';\n        const got = bytes ? `length=${len}` : `type=${typeof value}`;\n        err(prefix + 'expected Uint8Array' + ofLen + ', got ' + got);\n    }\n    return value;\n};\n/** create Uint8Array */\nconst u8n = (len) => new Uint8Array(len);\nconst u8fr = (buf) => Uint8Array.from(buf);\nconst padh = (n, pad) => n.toString(16).padStart(pad, '0');\nconst bytesToHex = (b) => Array.from(abytes(b))\n    .map((e) => padh(e, 2))\n    .join('');\nconst C = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 }; // ASCII characters\nconst _ch = (ch) => {\n    if (ch >= C._0 && ch <= C._9)\n        return ch - C._0; // '2' => 50-48\n    if (ch >= C.A && ch <= C.F)\n        return ch - (C.A - 10); // 'B' => 66-(65-10)\n    if (ch >= C.a && ch <= C.f)\n        return ch - (C.a - 10); // 'b' => 98-(97-10)\n    return;\n};\nconst hexToBytes = (hex) => {\n    const e = 'hex invalid';\n    if (!isStr(hex))\n        return err(e);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        return err(e);\n    const array = u8n(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        // treat each char as ASCII\n        const n1 = _ch(hex.charCodeAt(hi)); // parse first char, multiply it by 16\n        const n2 = _ch(hex.charCodeAt(hi + 1)); // parse second char\n        if (n1 === undefined || n2 === undefined)\n            return err(e);\n        array[ai] = n1 * 16 + n2; // example: 'A9' => 10*16 + 9\n    }\n    return array;\n};\nconst cr = () => globalThis?.crypto; // WebCrypto is available in all modern environments\nconst subtle = () => cr()?.subtle ?? err('crypto.subtle must be defined, consider polyfill');\n// prettier-ignore\nconst concatBytes = (...arrs) => {\n    const r = u8n(arrs.reduce((sum, a) => sum + abytes(a).length, 0)); // create u8a of summed length\n    let pad = 0; // walk through each array,\n    arrs.forEach(a => { r.set(a, pad); pad += a.length; }); // ensure they have proper type\n    return r;\n};\n/** WebCrypto OS-level CSPRNG (random number generator). Will throw when not available. */\nconst randomBytes = (len = L) => {\n    const c = cr();\n    return c.getRandomValues(u8n(len));\n};\nconst big = BigInt;\nconst assertRange = (n, min, max, msg = 'bad number: out of range') => (isBig(n) && min <= n && n < max ? n : err(msg));\n/** modular division */\nconst M = (a, b = P) => {\n    const r = a % b;\n    return r >= 0n ? r : b + r;\n};\nconst modN = (a) => M(a, N);\n/** Modular inversion using euclidean GCD (non-CT). No negative exponent for now. */\n// prettier-ignore\nconst invert = (num, md) => {\n    if (num === 0n || md <= 0n)\n        err('no inverse n=' + num + ' mod=' + md);\n    let a = M(num, md), b = md, x = 0n, y = 1n, u = 1n, v = 0n;\n    while (a !== 0n) {\n        const q = b / a, r = b % a;\n        const m = x - u * q, n = y - v * q;\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    return b === 1n ? M(x, md) : err('no inverse'); // b is gcd at this point\n};\nconst callHash = (name) => {\n    // @ts-ignore\n    const fn = hashes[name];\n    if (typeof fn !== 'function')\n        err('hashes.' + name + ' not set');\n    return fn;\n};\nconst hash = (msg) => callHash('sha512')(msg);\nconst apoint = (p) => (p instanceof Point ? p : err('Point expected'));\n// ## End of Helpers\n// -----------------\nconst B256 = 2n ** 256n;\n/** Point in XYZT extended coordinates. */\nclass Point {\n    static BASE;\n    static ZERO;\n    X;\n    Y;\n    Z;\n    T;\n    constructor(X, Y, Z, T) {\n        const max = B256;\n        this.X = assertRange(X, 0n, max);\n        this.Y = assertRange(Y, 0n, max);\n        this.Z = assertRange(Z, 1n, max);\n        this.T = assertRange(T, 0n, max);\n        Object.freeze(this);\n    }\n    static CURVE() {\n        return ed25519_CURVE;\n    }\n    static fromAffine(p) {\n        return new Point(p.x, p.y, 1n, M(p.x * p.y));\n    }\n    /** RFC8032 5.1.3: Uint8Array to Point. */\n    static fromBytes(hex, zip215 = false) {\n        const d = _d;\n        // Copy array to not mess it up.\n        const normed = u8fr(abytes(hex, L));\n        // adjust first LE byte = last BE byte\n        const lastByte = hex[31];\n        normed[31] = lastByte & ~0x80;\n        const y = bytesToNumLE(normed);\n        // zip215=true:           0 <= y < 2^256\n        // zip215=false, RFC8032: 0 <= y < 2^255-19\n        const max = zip215 ? B256 : P;\n        assertRange(y, 0n, max);\n        const y2 = M(y * y); // y²\n        const u = M(y2 - 1n); // u=y²-1\n        const v = M(d * y2 + 1n); // v=dy²+1\n        let { isValid, value: x } = uvRatio(u, v); // (uv³)(uv⁷)^(p-5)/8; square root\n        if (!isValid)\n            err('bad point: y not sqrt'); // not square root: bad point\n        const isXOdd = (x & 1n) === 1n; // adjust sign of x coordinate\n        const isLastByteOdd = (lastByte & 0x80) !== 0; // x_0, last bit\n        if (!zip215 && x === 0n && isLastByteOdd)\n            err('bad point: x==0, isLastByteOdd'); // x=0, x_0=1\n        if (isLastByteOdd !== isXOdd)\n            x = M(-x);\n        return new Point(x, y, 1n, M(x * y)); // Z=1, T=xy\n    }\n    static fromHex(hex, zip215) {\n        return Point.fromBytes(hexToBytes(hex), zip215);\n    }\n    get x() {\n        return this.toAffine().x;\n    }\n    get y() {\n        return this.toAffine().y;\n    }\n    /** Checks if the point is valid and on-curve. */\n    assertValidity() {\n        const a = _a;\n        const d = _d;\n        const p = this;\n        if (p.is0())\n            return err('bad point: ZERO'); // TODO: optimize, with vars below?\n        // Equation in affine coordinates: ax² + y² = 1 + dx²y²\n        // Equation in projective coordinates (X/Z, Y/Z, Z):  (aX² + Y²)Z² = Z⁴ + dX²Y²\n        const { X, Y, Z, T } = p;\n        const X2 = M(X * X); // X²\n        const Y2 = M(Y * Y); // Y²\n        const Z2 = M(Z * Z); // Z²\n        const Z4 = M(Z2 * Z2); // Z⁴\n        const aX2 = M(X2 * a); // aX²\n        const left = M(Z2 * M(aX2 + Y2)); // (aX² + Y²)Z²\n        const right = M(Z4 + M(d * M(X2 * Y2))); // Z⁴ + dX²Y²\n        if (left !== right)\n            return err('bad point: equation left != right (1)');\n        // In Extended coordinates we also have T, which is x*y=T/Z: check X*Y == Z*T\n        const XY = M(X * Y);\n        const ZT = M(Z * T);\n        if (XY !== ZT)\n            return err('bad point: equation left != right (2)');\n        return this;\n    }\n    /** Equality check: compare points P&Q. */\n    equals(other) {\n        const { X: X1, Y: Y1, Z: Z1 } = this;\n        const { X: X2, Y: Y2, Z: Z2 } = apoint(other); // checks class equality\n        const X1Z2 = M(X1 * Z2);\n        const X2Z1 = M(X2 * Z1);\n        const Y1Z2 = M(Y1 * Z2);\n        const Y2Z1 = M(Y2 * Z1);\n        return X1Z2 === X2Z1 && Y1Z2 === Y2Z1;\n    }\n    is0() {\n        return this.equals(I);\n    }\n    /** Flip point over y coordinate. */\n    negate() {\n        return new Point(M(-this.X), this.Y, this.Z, M(-this.T));\n    }\n    /** Point doubling. Complete formula. Cost: `4M + 4S + 1*a + 6add + 1*2`. */\n    double() {\n        const { X: X1, Y: Y1, Z: Z1 } = this;\n        const a = _a;\n        // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended.html#doubling-dbl-2008-hwcd\n        const A = M(X1 * X1);\n        const B = M(Y1 * Y1);\n        const C = M(2n * M(Z1 * Z1));\n        const D = M(a * A);\n        const x1y1 = X1 + Y1;\n        const E = M(M(x1y1 * x1y1) - A - B);\n        const G = D + B;\n        const F = G - C;\n        const H = D - B;\n        const X3 = M(E * F);\n        const Y3 = M(G * H);\n        const T3 = M(E * H);\n        const Z3 = M(F * G);\n        return new Point(X3, Y3, Z3, T3);\n    }\n    /** Point addition. Complete formula. Cost: `8M + 1*k + 8add + 1*2`. */\n    add(other) {\n        const { X: X1, Y: Y1, Z: Z1, T: T1 } = this;\n        const { X: X2, Y: Y2, Z: Z2, T: T2 } = apoint(other); // doesn't check if other on-curve\n        const a = _a;\n        const d = _d;\n        // https://hyperelliptic.org/EFD/g1p/auto-twisted-extended-1.html#addition-add-2008-hwcd-3\n        const A = M(X1 * X2);\n        const B = M(Y1 * Y2);\n        const C = M(T1 * d * T2);\n        const D = M(Z1 * Z2);\n        const E = M((X1 + Y1) * (X2 + Y2) - A - B);\n        const F = M(D - C);\n        const G = M(D + C);\n        const H = M(B - a * A);\n        const X3 = M(E * F);\n        const Y3 = M(G * H);\n        const T3 = M(E * H);\n        const Z3 = M(F * G);\n        return new Point(X3, Y3, Z3, T3);\n    }\n    subtract(other) {\n        return this.add(apoint(other).negate());\n    }\n    /**\n     * Point-by-scalar multiplication. Scalar must be in range 1 <= n < CURVE.n.\n     * Uses {@link wNAF} for base point.\n     * Uses fake point to mitigate side-channel leakage.\n     * @param n scalar by which point is multiplied\n     * @param safe safe mode guards against timing attacks; unsafe mode is faster\n     */\n    multiply(n, safe = true) {\n        if (!safe && (n === 0n || this.is0()))\n            return I;\n        assertRange(n, 1n, N);\n        if (n === 1n)\n            return this;\n        if (this.equals(G))\n            return wNAF(n).p;\n        // init result point & fake point\n        let p = I;\n        let f = G;\n        for (let d = this; n > 0n; d = d.double(), n >>= 1n) {\n            // if bit is present, add to point\n            // if not present, add to fake, for timing safety\n            if (n & 1n)\n                p = p.add(d);\n            else if (safe)\n                f = f.add(d);\n        }\n        return p;\n    }\n    multiplyUnsafe(scalar) {\n        return this.multiply(scalar, false);\n    }\n    /** Convert point to 2d xy affine point. (X, Y, Z) ∋ (x=X/Z, y=Y/Z) */\n    toAffine() {\n        const { X, Y, Z } = this;\n        // fast-paths for ZERO point OR Z=1\n        if (this.equals(I))\n            return { x: 0n, y: 1n };\n        const iz = invert(Z, P);\n        // (Z * Z^-1) must be 1, otherwise bad math\n        if (M(Z * iz) !== 1n)\n            err('invalid inverse');\n        // x = X*Z^-1; y = Y*Z^-1\n        const x = M(X * iz);\n        const y = M(Y * iz);\n        return { x, y };\n    }\n    toBytes() {\n        const { x, y } = this.assertValidity().toAffine();\n        const b = numTo32bLE(y);\n        // store sign in first LE byte\n        b[31] |= x & 1n ? 0x80 : 0;\n        return b;\n    }\n    toHex() {\n        return bytesToHex(this.toBytes());\n    }\n    clearCofactor() {\n        return this.multiply(big(h), false);\n    }\n    isSmallOrder() {\n        return this.clearCofactor().is0();\n    }\n    isTorsionFree() {\n        // Multiply by big number N. We can't `mul(N)` because of checks. Instead, we `mul(N/2)*2+1`\n        let p = this.multiply(N / 2n, false).double();\n        if (N % 2n)\n            p = p.add(this);\n        return p.is0();\n    }\n}\n/** Generator / base point */\nconst G = new Point(Gx, Gy, 1n, M(Gx * Gy));\n/** Identity / zero point */\nconst I = new Point(0n, 1n, 1n, 0n);\n// Static aliases\nPoint.BASE = G;\nPoint.ZERO = I;\nconst numTo32bLE = (num) => hexToBytes(padh(assertRange(num, 0n, B256), L2)).reverse();\nconst bytesToNumLE = (b) => big('0x' + bytesToHex(u8fr(abytes(b)).reverse()));\nconst pow2 = (x, power) => {\n    // pow2(x, 4) == x^(2^4)\n    let r = x;\n    while (power-- > 0n) {\n        r *= r;\n        r %= P;\n    }\n    return r;\n};\n// prettier-ignore\nconst pow_2_252_3 = (x) => {\n    const x2 = (x * x) % P; // x^2,       bits 1\n    const b2 = (x2 * x) % P; // x^3,       bits 11\n    const b4 = (pow2(b2, 2n) * b2) % P; // x^(2^4-1), bits 1111\n    const b5 = (pow2(b4, 1n) * x) % P; // x^(2^5-1), bits 11111\n    const b10 = (pow2(b5, 5n) * b5) % P; // x^(2^10)\n    const b20 = (pow2(b10, 10n) * b10) % P; // x^(2^20)\n    const b40 = (pow2(b20, 20n) * b20) % P; // x^(2^40)\n    const b80 = (pow2(b40, 40n) * b40) % P; // x^(2^80)\n    const b160 = (pow2(b80, 80n) * b80) % P; // x^(2^160)\n    const b240 = (pow2(b160, 80n) * b80) % P; // x^(2^240)\n    const b250 = (pow2(b240, 10n) * b10) % P; // x^(2^250)\n    const pow_p_5_8 = (pow2(b250, 2n) * x) % P; // < To pow to (p+3)/8, multiply it by x.\n    return { pow_p_5_8, b2 };\n};\nconst RM1 = 0x2b8324804fc1df0b2b4d00993dfbd7a72f431806ad2fe478c4ee1b274a0ea0b0n; // √-1\n// for sqrt comp\n// prettier-ignore\nconst uvRatio = (u, v) => {\n    const v3 = M(v * v * v); // v³\n    const v7 = M(v3 * v3 * v); // v⁷\n    const pow = pow_2_252_3(u * v7).pow_p_5_8; // (uv⁷)^(p-5)/8\n    let x = M(u * v3 * pow); // (uv³)(uv⁷)^(p-5)/8\n    const vx2 = M(v * x * x); // vx²\n    const root1 = x; // First root candidate\n    const root2 = M(x * RM1); // Second root candidate; RM1 is √-1\n    const useRoot1 = vx2 === u; // If vx² = u (mod p), x is a square root\n    const useRoot2 = vx2 === M(-u); // If vx² = -u, set x <-- x * 2^((p-1)/4)\n    const noRoot = vx2 === M(-u * RM1); // There is no valid root, vx² = -u√-1\n    if (useRoot1)\n        x = root1;\n    if (useRoot2 || noRoot)\n        x = root2; // We return root2 anyway, for const-time\n    if ((M(x) & 1n) === 1n)\n        x = M(-x); // edIsNegative\n    return { isValid: useRoot1 || useRoot2, value: x };\n};\n// N == L, just weird naming\nconst modL_LE = (hash) => modN(bytesToNumLE(hash)); // modulo L; but little-endian\n/** hashes.sha512 should conform to the interface. */\n// TODO: rename\nconst sha512a = (...m) => hashes.sha512Async(concatBytes(...m)); // Async SHA512\nconst sha512s = (...m) => callHash('sha512')(concatBytes(...m));\n// RFC8032 5.1.5\nconst hash2extK = (hashed) => {\n    // slice creates a copy, unlike subarray\n    const head = hashed.slice(0, L);\n    head[0] &= 248; // Clamp bits: 0b1111_1000\n    head[31] &= 127; // 0b0111_1111\n    head[31] |= 64; // 0b0100_0000\n    const prefix = hashed.slice(L, L2); // secret key \"prefix\"\n    const scalar = modL_LE(head); // modular division over curve order\n    const point = G.multiply(scalar); // public key point\n    const pointBytes = point.toBytes(); // point serialized to Uint8Array\n    return { head, prefix, scalar, point, pointBytes };\n};\n// RFC8032 5.1.5; getPublicKey async, sync. Hash priv key and extract point.\nconst getExtendedPublicKeyAsync = (secretKey) => sha512a(abytes(secretKey, L)).then(hash2extK);\nconst getExtendedPublicKey = (secretKey) => hash2extK(sha512s(abytes(secretKey, L)));\n/** Creates 32-byte ed25519 public key from 32-byte secret key. Async. */\nconst getPublicKeyAsync = (secretKey) => getExtendedPublicKeyAsync(secretKey).then((p) => p.pointBytes);\n/** Creates 32-byte ed25519 public key from 32-byte secret key. To use, set `hashes.sha512` first. */\nconst getPublicKey = (priv) => getExtendedPublicKey(priv).pointBytes;\nconst hashFinishA = (res) => sha512a(res.hashable).then(res.finish);\nconst hashFinishS = (res) => res.finish(sha512s(res.hashable));\n// Code, shared between sync & async sign\nconst _sign = (e, rBytes, msg) => {\n    const { pointBytes: P, scalar: s } = e;\n    const r = modL_LE(rBytes); // r was created outside, reduce it modulo L\n    const R = G.multiply(r).toBytes(); // R = [r]B\n    const hashable = concatBytes(R, P, msg); // dom2(F, C) || R || A || PH(M)\n    const finish = (hashed) => {\n        // k = SHA512(dom2(F, C) || R || A || PH(M))\n        const S = modN(r + modL_LE(hashed) * s); // S = (r + k * s) mod L; 0 <= s < l\n        return abytes(concatBytes(R, numTo32bLE(S)), L2); // 64-byte sig: 32b R.x + 32b LE(S)\n    };\n    return { hashable, finish };\n};\n/**\n * Signs message using secret key. Async.\n * Follows RFC8032 5.1.6.\n */\nconst signAsync = async (message, secretKey) => {\n    const m = abytes(message);\n    const e = await getExtendedPublicKeyAsync(secretKey);\n    const rBytes = await sha512a(e.prefix, m); // r = SHA512(dom2(F, C) || prefix || PH(M))\n    return hashFinishA(_sign(e, rBytes, m)); // gen R, k, S, then 64-byte signature\n};\n/**\n * Signs message using secret key. To use, set `hashes.sha512` first.\n * Follows RFC8032 5.1.6.\n */\nconst sign = (message, secretKey) => {\n    const m = abytes(message);\n    const e = getExtendedPublicKey(secretKey);\n    const rBytes = sha512s(e.prefix, m); // r = SHA512(dom2(F, C) || prefix || PH(M))\n    return hashFinishS(_sign(e, rBytes, m)); // gen R, k, S, then 64-byte signature\n};\nconst defaultVerifyOpts = { zip215: true };\nconst _verify = (sig, msg, pub, opts = defaultVerifyOpts) => {\n    sig = abytes(sig, L2); // Signature hex str/Bytes, must be 64 bytes\n    msg = abytes(msg); // Message hex str/Bytes\n    pub = abytes(pub, L);\n    const { zip215 } = opts; // switch between zip215 and rfc8032 verif\n    let A;\n    let R;\n    let s;\n    let SB;\n    let hashable = Uint8Array.of();\n    try {\n        A = Point.fromBytes(pub, zip215); // public key A decoded\n        R = Point.fromBytes(sig.slice(0, L), zip215); // 0 <= R < 2^256: ZIP215 R can be >= P\n        s = bytesToNumLE(sig.slice(L, L2)); // Decode second half as an integer S\n        SB = G.multiply(s, false); // in the range 0 <= s < L\n        hashable = concatBytes(R.toBytes(), A.toBytes(), msg); // dom2(F, C) || R || A || PH(M)\n    }\n    catch (error) { }\n    const finish = (hashed) => {\n        // k = SHA512(dom2(F, C) || R || A || PH(M))\n        if (SB == null)\n            return false; // false if try-catch catched an error\n        if (!zip215 && A.isSmallOrder())\n            return false; // false for SBS: Strongly Binding Signature\n        const k = modL_LE(hashed); // decode in little-endian, modulo L\n        const RkA = R.add(A.multiply(k, false)); // [8]R + [8][k]A'\n        return RkA.add(SB.negate()).clearCofactor().is0(); // [8][S]B = [8]R + [8][k]A'\n    };\n    return { hashable, finish };\n};\n/** Verifies signature on message and public key. Async. Follows RFC8032 5.1.7. */\nconst verifyAsync = async (signature, message, publicKey, opts = defaultVerifyOpts) => hashFinishA(_verify(signature, message, publicKey, opts));\n/** Verifies signature on message and public key. To use, set `hashes.sha512` first. Follows RFC8032 5.1.7. */\nconst verify = (signature, message, publicKey, opts = defaultVerifyOpts) => hashFinishS(_verify(signature, message, publicKey, opts));\n/** Math, hex, byte helpers. Not in `utils` because utils share API with noble-curves. */\nconst etc = {\n    bytesToHex: bytesToHex,\n    hexToBytes: hexToBytes,\n    concatBytes: concatBytes,\n    mod: M,\n    invert: invert,\n    randomBytes: randomBytes,\n};\nconst hashes = {\n    sha512Async: async (message) => {\n        const s = subtle();\n        const m = concatBytes(message);\n        return u8n(await s.digest('SHA-512', m.buffer));\n    },\n    sha512: undefined,\n};\n// FIPS 186 B.4.1 compliant key generation produces private keys\n// with modulo bias being neglible. takes >N+16 bytes, returns (hash mod n-1)+1\nconst randomSecretKey = (seed = randomBytes(L)) => seed;\nconst keygen = (seed) => {\n    const secretKey = randomSecretKey(seed);\n    const publicKey = getPublicKey(secretKey);\n    return { secretKey, publicKey };\n};\nconst keygenAsync = async (seed) => {\n    const secretKey = randomSecretKey(seed);\n    const publicKey = await getPublicKeyAsync(secretKey);\n    return { secretKey, publicKey };\n};\n/** ed25519-specific key utilities. */\nconst utils = {\n    getExtendedPublicKeyAsync: getExtendedPublicKeyAsync,\n    getExtendedPublicKey: getExtendedPublicKey,\n    randomSecretKey: randomSecretKey,\n};\n// ## Precomputes\n// --------------\nconst W = 8; // W is window size\nconst scalarBits = 256;\nconst pwindows = Math.ceil(scalarBits / W) + 1; // 33 for W=8, NOT 32 - see wNAF loop\nconst pwindowSize = 2 ** (W - 1); // 128 for W=8\nconst precompute = () => {\n    const points = [];\n    let p = G;\n    let b = p;\n    for (let w = 0; w < pwindows; w++) {\n        b = p;\n        points.push(b);\n        for (let i = 1; i < pwindowSize; i++) {\n            b = b.add(p);\n            points.push(b);\n        } // i=1, bc we skip 0\n        p = b.double();\n    }\n    return points;\n};\nlet Gpows = undefined; // precomputes for base point G\n// const-time negate\nconst ctneg = (cnd, p) => {\n    const n = p.negate();\n    return cnd ? n : p;\n};\n/**\n * Precomputes give 12x faster getPublicKey(), 10x sign(), 2x verify() by\n * caching multiples of G (base point). Cache is stored in 32MB of RAM.\n * Any time `G.multiply` is done, precomputes are used.\n * Not used for getSharedSecret, which instead multiplies random pubkey `P.multiply`.\n *\n * w-ary non-adjacent form (wNAF) precomputation method is 10% slower than windowed method,\n * but takes 2x less RAM. RAM reduction is possible by utilizing `.subtract`.\n *\n * !! Precomputes can be disabled by commenting-out call of the wNAF() inside Point#multiply().\n */\nconst wNAF = (n) => {\n    const comp = Gpows || (Gpows = precompute());\n    let p = I;\n    let f = G; // f must be G, or could become I in the end\n    const pow_2_w = 2 ** W; // 256 for W=8\n    const maxNum = pow_2_w; // 256 for W=8\n    const mask = big(pow_2_w - 1); // 255 for W=8 == mask 0b11111111\n    const shiftBy = big(W); // 8 for W=8\n    for (let w = 0; w < pwindows; w++) {\n        let wbits = Number(n & mask); // extract W bits.\n        n >>= shiftBy; // shift number by W bits.\n        // We use negative indexes to reduce size of precomputed table by 2x.\n        // Instead of needing precomputes 0..256, we only calculate them for 0..128.\n        // If an index > 128 is found, we do (256-index) - where 256 is next window.\n        // Naive: index +127 => 127, +224 => 224\n        // Optimized: index +127 => 127, +224 => 256-32\n        if (wbits > pwindowSize) {\n            wbits -= maxNum;\n            n += 1n;\n        }\n        const off = w * pwindowSize;\n        const offF = off; // offsets, evaluate both\n        const offP = off + Math.abs(wbits) - 1;\n        const isEven = w % 2 !== 0; // conditions, evaluate both\n        const isNeg = wbits < 0;\n        if (wbits === 0) {\n            // off == I: can't add it. Adding random offF instead.\n            f = f.add(ctneg(isEven, comp[offF])); // bits are 0: add garbage to fake point\n        }\n        else {\n            p = p.add(ctneg(isNeg, comp[offP])); // bits are 1: add to result point\n        }\n    }\n    if (n !== 0n)\n        err('invalid wnaf');\n    return { p, f }; // return both real and fake points for JIT\n};\n// !! Remove the export to easily use in REPL / browser console\nexport { etc, getPublicKey, getPublicKeyAsync, hash, hashes, keygen, keygenAsync, Point, sign, signAsync, utils, verify, verifyAsync, };\n","import { getPublicKeyAsync, signAsync, utils } from \"@noble/ed25519\";\n\ntype StoredIdentity = {\n  version: 1;\n  deviceId: string;\n  publicKey: string;\n  privateKey: string;\n  createdAtMs: number;\n};\n\nexport type DeviceIdentity = {\n  deviceId: string;\n  publicKey: string;\n  privateKey: string;\n};\n\nconst STORAGE_KEY = \"clawdbot-device-identity-v1\";\n\nfunction base64UrlEncode(bytes: Uint8Array): string {\n  let binary = \"\";\n  for (const byte of bytes) binary += String.fromCharCode(byte);\n  return btoa(binary).replaceAll(\"+\", \"-\").replaceAll(\"/\", \"_\").replace(/=+$/g, \"\");\n}\n\nfunction base64UrlDecode(input: string): Uint8Array {\n  const normalized = input.replaceAll(\"-\", \"+\").replaceAll(\"_\", \"/\");\n  const padded = normalized + \"=\".repeat((4 - (normalized.length % 4)) % 4);\n  const binary = atob(padded);\n  const out = new Uint8Array(binary.length);\n  for (let i = 0; i < binary.length; i += 1) out[i] = binary.charCodeAt(i);\n  return out;\n}\n\nfunction bytesToHex(bytes: Uint8Array): string {\n  return Array.from(bytes)\n    .map((b) => b.toString(16).padStart(2, \"0\"))\n    .join(\"\");\n}\n\nasync function fingerprintPublicKey(publicKey: Uint8Array): Promise<string> {\n  const hash = await crypto.subtle.digest(\"SHA-256\", publicKey);\n  return bytesToHex(new Uint8Array(hash));\n}\n\nasync function generateIdentity(): Promise<DeviceIdentity> {\n  const privateKey = utils.randomSecretKey();\n  const publicKey = await getPublicKeyAsync(privateKey);\n  const deviceId = await fingerprintPublicKey(publicKey);\n  return {\n    deviceId,\n    publicKey: base64UrlEncode(publicKey),\n    privateKey: base64UrlEncode(privateKey),\n  };\n}\n\nexport async function loadOrCreateDeviceIdentity(): Promise<DeviceIdentity> {\n  try {\n    const raw = localStorage.getItem(STORAGE_KEY);\n    if (raw) {\n      const parsed = JSON.parse(raw) as StoredIdentity;\n      if (\n        parsed?.version === 1 &&\n        typeof parsed.deviceId === \"string\" &&\n        typeof parsed.publicKey === \"string\" &&\n        typeof parsed.privateKey === \"string\"\n      ) {\n        const derivedId = await fingerprintPublicKey(base64UrlDecode(parsed.publicKey));\n        if (derivedId !== parsed.deviceId) {\n          const updated: StoredIdentity = {\n            ...parsed,\n            deviceId: derivedId,\n          };\n          localStorage.setItem(STORAGE_KEY, JSON.stringify(updated));\n          return {\n            deviceId: derivedId,\n            publicKey: parsed.publicKey,\n            privateKey: parsed.privateKey,\n          };\n        }\n        return {\n          deviceId: parsed.deviceId,\n          publicKey: parsed.publicKey,\n          privateKey: parsed.privateKey,\n        };\n      }\n    }\n  } catch {\n    // fall through to regenerate\n  }\n\n  const identity = await generateIdentity();\n  const stored: StoredIdentity = {\n    version: 1,\n    deviceId: identity.deviceId,\n    publicKey: identity.publicKey,\n    privateKey: identity.privateKey,\n    createdAtMs: Date.now(),\n  };\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(stored));\n  return identity;\n}\n\nexport async function signDevicePayload(privateKeyBase64Url: string, payload: string) {\n  const key = base64UrlDecode(privateKeyBase64Url);\n  const data = new TextEncoder().encode(payload);\n  const sig = await signAsync(data, key);\n  return base64UrlEncode(sig);\n}\n","export type DeviceAuthEntry = {\n  token: string;\n  role: string;\n  scopes: string[];\n  updatedAtMs: number;\n};\n\ntype DeviceAuthStore = {\n  version: 1;\n  deviceId: string;\n  tokens: Record<string, DeviceAuthEntry>;\n};\n\nconst STORAGE_KEY = \"clawdbot.device.auth.v1\";\n\nfunction normalizeRole(role: string): string {\n  return role.trim();\n}\n\nfunction normalizeScopes(scopes: string[] | undefined): string[] {\n  if (!Array.isArray(scopes)) return [];\n  const out = new Set<string>();\n  for (const scope of scopes) {\n    const trimmed = scope.trim();\n    if (trimmed) out.add(trimmed);\n  }\n  return [...out].sort();\n}\n\nfunction readStore(): DeviceAuthStore | null {\n  try {\n    const raw = window.localStorage.getItem(STORAGE_KEY);\n    if (!raw) return null;\n    const parsed = JSON.parse(raw) as DeviceAuthStore;\n    if (!parsed || parsed.version !== 1) return null;\n    if (!parsed.deviceId || typeof parsed.deviceId !== \"string\") return null;\n    if (!parsed.tokens || typeof parsed.tokens !== \"object\") return null;\n    return parsed;\n  } catch {\n    return null;\n  }\n}\n\nfunction writeStore(store: DeviceAuthStore) {\n  try {\n    window.localStorage.setItem(STORAGE_KEY, JSON.stringify(store));\n  } catch {\n    // best-effort\n  }\n}\n\nexport function loadDeviceAuthToken(params: {\n  deviceId: string;\n  role: string;\n}): DeviceAuthEntry | null {\n  const store = readStore();\n  if (!store || store.deviceId !== params.deviceId) return null;\n  const role = normalizeRole(params.role);\n  const entry = store.tokens[role];\n  if (!entry || typeof entry.token !== \"string\") return null;\n  return entry;\n}\n\nexport function storeDeviceAuthToken(params: {\n  deviceId: string;\n  role: string;\n  token: string;\n  scopes?: string[];\n}): DeviceAuthEntry {\n  const role = normalizeRole(params.role);\n  const next: DeviceAuthStore = {\n    version: 1,\n    deviceId: params.deviceId,\n    tokens: {},\n  };\n  const existing = readStore();\n  if (existing && existing.deviceId === params.deviceId) {\n    next.tokens = { ...existing.tokens };\n  }\n  const entry: DeviceAuthEntry = {\n    token: params.token,\n    role,\n    scopes: normalizeScopes(params.scopes),\n    updatedAtMs: Date.now(),\n  };\n  next.tokens[role] = entry;\n  writeStore(next);\n  return entry;\n}\n\nexport function clearDeviceAuthToken(params: { deviceId: string; role: string }) {\n  const store = readStore();\n  if (!store || store.deviceId !== params.deviceId) return;\n  const role = normalizeRole(params.role);\n  if (!store.tokens[role]) return;\n  const next = { ...store, tokens: { ...store.tokens } };\n  delete next.tokens[role];\n  writeStore(next);\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport { loadOrCreateDeviceIdentity } from \"../device-identity\";\nimport { clearDeviceAuthToken, storeDeviceAuthToken } from \"../device-auth\";\n\nexport type DeviceTokenSummary = {\n  role: string;\n  scopes?: string[];\n  createdAtMs?: number;\n  rotatedAtMs?: number;\n  revokedAtMs?: number;\n  lastUsedAtMs?: number;\n};\n\nexport type PendingDevice = {\n  requestId: string;\n  deviceId: string;\n  displayName?: string;\n  role?: string;\n  remoteIp?: string;\n  isRepair?: boolean;\n  ts?: number;\n};\n\nexport type PairedDevice = {\n  deviceId: string;\n  displayName?: string;\n  roles?: string[];\n  scopes?: string[];\n  remoteIp?: string;\n  tokens?: DeviceTokenSummary[];\n  createdAtMs?: number;\n  approvedAtMs?: number;\n};\n\nexport type DevicePairingList = {\n  pending: PendingDevice[];\n  paired: PairedDevice[];\n};\n\nexport type DevicesState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  devicesLoading: boolean;\n  devicesError: string | null;\n  devicesList: DevicePairingList | null;\n};\n\nexport async function loadDevices(state: DevicesState, opts?: { quiet?: boolean }) {\n  if (!state.client || !state.connected) return;\n  if (state.devicesLoading) return;\n  state.devicesLoading = true;\n  if (!opts?.quiet) state.devicesError = null;\n  try {\n    const res = (await state.client.request(\"device.pair.list\", {})) as DevicePairingList | null;\n    state.devicesList = {\n      pending: Array.isArray(res?.pending) ? res!.pending : [],\n      paired: Array.isArray(res?.paired) ? res!.paired : [],\n    };\n  } catch (err) {\n    if (!opts?.quiet) state.devicesError = String(err);\n  } finally {\n    state.devicesLoading = false;\n  }\n}\n\nexport async function approveDevicePairing(state: DevicesState, requestId: string) {\n  if (!state.client || !state.connected) return;\n  try {\n    await state.client.request(\"device.pair.approve\", { requestId });\n    await loadDevices(state);\n  } catch (err) {\n    state.devicesError = String(err);\n  }\n}\n\nexport async function rejectDevicePairing(state: DevicesState, requestId: string) {\n  if (!state.client || !state.connected) return;\n  const confirmed = window.confirm(\"Reject this device pairing request?\");\n  if (!confirmed) return;\n  try {\n    await state.client.request(\"device.pair.reject\", { requestId });\n    await loadDevices(state);\n  } catch (err) {\n    state.devicesError = String(err);\n  }\n}\n\nexport async function rotateDeviceToken(\n  state: DevicesState,\n  params: { deviceId: string; role: string; scopes?: string[] },\n) {\n  if (!state.client || !state.connected) return;\n  try {\n    const res = (await state.client.request(\"device.token.rotate\", params)) as\n      | { token?: string; role?: string; deviceId?: string; scopes?: string[] }\n      | undefined;\n    if (res?.token) {\n      const identity = await loadOrCreateDeviceIdentity();\n      const role = res.role ?? params.role;\n      if (res.deviceId === identity.deviceId || params.deviceId === identity.deviceId) {\n        storeDeviceAuthToken({\n          deviceId: identity.deviceId,\n          role,\n          token: res.token,\n          scopes: res.scopes ?? params.scopes ?? [],\n        });\n      }\n      window.prompt(\"New device token (copy and store securely):\", res.token);\n    }\n    await loadDevices(state);\n  } catch (err) {\n    state.devicesError = String(err);\n  }\n}\n\nexport async function revokeDeviceToken(\n  state: DevicesState,\n  params: { deviceId: string; role: string },\n) {\n  if (!state.client || !state.connected) return;\n  const confirmed = window.confirm(\n    `Revoke token for ${params.deviceId} (${params.role})?`,\n  );\n  if (!confirmed) return;\n  try {\n    await state.client.request(\"device.token.revoke\", params);\n    const identity = await loadOrCreateDeviceIdentity();\n    if (params.deviceId === identity.deviceId) {\n      clearDeviceAuthToken({ deviceId: identity.deviceId, role: params.role });\n    }\n    await loadDevices(state);\n  } catch (err) {\n    state.devicesError = String(err);\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport { cloneConfigObject, removePathValue, setPathValue } from \"./config/form-utils\";\n\nexport type ExecApprovalsDefaults = {\n  security?: string;\n  ask?: string;\n  askFallback?: string;\n  autoAllowSkills?: boolean;\n};\n\nexport type ExecApprovalsAllowlistEntry = {\n  id?: string;\n  pattern: string;\n  lastUsedAt?: number;\n  lastUsedCommand?: string;\n  lastResolvedPath?: string;\n};\n\nexport type ExecApprovalsAgent = ExecApprovalsDefaults & {\n  allowlist?: ExecApprovalsAllowlistEntry[];\n};\n\nexport type ExecApprovalsFile = {\n  version?: number;\n  socket?: { path?: string };\n  defaults?: ExecApprovalsDefaults;\n  agents?: Record<string, ExecApprovalsAgent>;\n};\n\nexport type ExecApprovalsSnapshot = {\n  path: string;\n  exists: boolean;\n  hash: string;\n  file: ExecApprovalsFile;\n};\n\nexport type ExecApprovalsTarget =\n  | { kind: \"gateway\" }\n  | { kind: \"node\"; nodeId: string };\n\nexport type ExecApprovalsState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  execApprovalsLoading: boolean;\n  execApprovalsSaving: boolean;\n  execApprovalsDirty: boolean;\n  execApprovalsSnapshot: ExecApprovalsSnapshot | null;\n  execApprovalsForm: ExecApprovalsFile | null;\n  execApprovalsSelectedAgent: string | null;\n  lastError: string | null;\n};\n\nfunction resolveExecApprovalsRpc(target?: ExecApprovalsTarget | null): {\n  method: string;\n  params: Record<string, unknown>;\n} | null {\n  if (!target || target.kind === \"gateway\") {\n    return { method: \"exec.approvals.get\", params: {} };\n  }\n  const nodeId = target.nodeId.trim();\n  if (!nodeId) return null;\n  return { method: \"exec.approvals.node.get\", params: { nodeId } };\n}\n\nfunction resolveExecApprovalsSaveRpc(\n  target: ExecApprovalsTarget | null | undefined,\n  params: { file: ExecApprovalsFile; baseHash: string },\n): { method: string; params: Record<string, unknown> } | null {\n  if (!target || target.kind === \"gateway\") {\n    return { method: \"exec.approvals.set\", params };\n  }\n  const nodeId = target.nodeId.trim();\n  if (!nodeId) return null;\n  return { method: \"exec.approvals.node.set\", params: { ...params, nodeId } };\n}\n\nexport async function loadExecApprovals(\n  state: ExecApprovalsState,\n  target?: ExecApprovalsTarget | null,\n) {\n  if (!state.client || !state.connected) return;\n  if (state.execApprovalsLoading) return;\n  state.execApprovalsLoading = true;\n  state.lastError = null;\n  try {\n    const rpc = resolveExecApprovalsRpc(target);\n    if (!rpc) {\n      state.lastError = \"Select a node before loading exec approvals.\";\n      return;\n    }\n    const res = (await state.client.request(rpc.method, rpc.params)) as ExecApprovalsSnapshot;\n    applyExecApprovalsSnapshot(state, res);\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.execApprovalsLoading = false;\n  }\n}\n\nexport function applyExecApprovalsSnapshot(\n  state: ExecApprovalsState,\n  snapshot: ExecApprovalsSnapshot,\n) {\n  state.execApprovalsSnapshot = snapshot;\n  if (!state.execApprovalsDirty) {\n    state.execApprovalsForm = cloneConfigObject(snapshot.file ?? {});\n  }\n}\n\nexport async function saveExecApprovals(\n  state: ExecApprovalsState,\n  target?: ExecApprovalsTarget | null,\n) {\n  if (!state.client || !state.connected) return;\n  state.execApprovalsSaving = true;\n  state.lastError = null;\n  try {\n    const baseHash = state.execApprovalsSnapshot?.hash;\n    if (!baseHash) {\n      state.lastError = \"Exec approvals hash missing; reload and retry.\";\n      return;\n    }\n    const file =\n      state.execApprovalsForm ??\n      state.execApprovalsSnapshot?.file ??\n      {};\n    const rpc = resolveExecApprovalsSaveRpc(target, { file, baseHash });\n    if (!rpc) {\n      state.lastError = \"Select a node before saving exec approvals.\";\n      return;\n    }\n    await state.client.request(rpc.method, rpc.params);\n    state.execApprovalsDirty = false;\n    await loadExecApprovals(state, target);\n  } catch (err) {\n    state.lastError = String(err);\n  } finally {\n    state.execApprovalsSaving = false;\n  }\n}\n\nexport function updateExecApprovalsFormValue(\n  state: ExecApprovalsState,\n  path: Array<string | number>,\n  value: unknown,\n) {\n  const base = cloneConfigObject(\n    state.execApprovalsForm ?? state.execApprovalsSnapshot?.file ?? {},\n  );\n  setPathValue(base, path, value);\n  state.execApprovalsForm = base;\n  state.execApprovalsDirty = true;\n}\n\nexport function removeExecApprovalsFormValue(\n  state: ExecApprovalsState,\n  path: Array<string | number>,\n) {\n  const base = cloneConfigObject(\n    state.execApprovalsForm ?? state.execApprovalsSnapshot?.file ?? {},\n  );\n  removePathValue(base, path);\n  state.execApprovalsForm = base;\n  state.execApprovalsDirty = true;\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { PresenceEntry } from \"../types\";\n\nexport type PresenceState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  presenceLoading: boolean;\n  presenceEntries: PresenceEntry[];\n  presenceError: string | null;\n  presenceStatus: string | null;\n};\n\nexport async function loadPresence(state: PresenceState) {\n  if (!state.client || !state.connected) return;\n  if (state.presenceLoading) return;\n  state.presenceLoading = true;\n  state.presenceError = null;\n  state.presenceStatus = null;\n  try {\n    const res = (await state.client.request(\"system-presence\", {})) as\n      | PresenceEntry[]\n      | undefined;\n    if (Array.isArray(res)) {\n      state.presenceEntries = res;\n      state.presenceStatus = res.length === 0 ? \"No instances yet.\" : null;\n    } else {\n      state.presenceEntries = [];\n      state.presenceStatus = \"No presence payload.\";\n    }\n  } catch (err) {\n    state.presenceError = String(err);\n  } finally {\n    state.presenceLoading = false;\n  }\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type { SkillStatusReport } from \"../types\";\n\nexport type SkillsState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  skillsLoading: boolean;\n  skillsReport: SkillStatusReport | null;\n  skillsError: string | null;\n  skillsBusyKey: string | null;\n  skillEdits: Record<string, string>;\n  skillMessages: SkillMessageMap;\n};\n\nexport type SkillMessage = {\n  kind: \"success\" | \"error\";\n  message: string;\n};\n\nexport type SkillMessageMap = Record<string, SkillMessage>;\n\ntype LoadSkillsOptions = {\n  clearMessages?: boolean;\n};\n\nfunction setSkillMessage(state: SkillsState, key: string, message?: SkillMessage) {\n  if (!key.trim()) return;\n  const next = { ...state.skillMessages };\n  if (message) next[key] = message;\n  else delete next[key];\n  state.skillMessages = next;\n}\n\nfunction getErrorMessage(err: unknown) {\n  if (err instanceof Error) return err.message;\n  return String(err);\n}\n\nexport async function loadSkills(state: SkillsState, options?: LoadSkillsOptions) {\n  if (options?.clearMessages && Object.keys(state.skillMessages).length > 0) {\n    state.skillMessages = {};\n  }\n  if (!state.client || !state.connected) return;\n  if (state.skillsLoading) return;\n  state.skillsLoading = true;\n  state.skillsError = null;\n  try {\n    const res = (await state.client.request(\"skills.status\", {})) as\n      | SkillStatusReport\n      | undefined;\n    if (res) state.skillsReport = res;\n  } catch (err) {\n    state.skillsError = getErrorMessage(err);\n  } finally {\n    state.skillsLoading = false;\n  }\n}\n\nexport function updateSkillEdit(\n  state: SkillsState,\n  skillKey: string,\n  value: string,\n) {\n  state.skillEdits = { ...state.skillEdits, [skillKey]: value };\n}\n\nexport async function updateSkillEnabled(\n  state: SkillsState,\n  skillKey: string,\n  enabled: boolean,\n) {\n  if (!state.client || !state.connected) return;\n  state.skillsBusyKey = skillKey;\n  state.skillsError = null;\n  try {\n    await state.client.request(\"skills.update\", { skillKey, enabled });\n    await loadSkills(state);\n    setSkillMessage(state, skillKey, {\n      kind: \"success\",\n      message: enabled ? \"Skill enabled\" : \"Skill disabled\",\n    });\n  } catch (err) {\n    const message = getErrorMessage(err);\n    state.skillsError = message;\n    setSkillMessage(state, skillKey, {\n      kind: \"error\",\n      message,\n    });\n  } finally {\n    state.skillsBusyKey = null;\n  }\n}\n\nexport async function saveSkillApiKey(state: SkillsState, skillKey: string) {\n  if (!state.client || !state.connected) return;\n  state.skillsBusyKey = skillKey;\n  state.skillsError = null;\n  try {\n    const apiKey = state.skillEdits[skillKey] ?? \"\";\n    await state.client.request(\"skills.update\", { skillKey, apiKey });\n    await loadSkills(state);\n    setSkillMessage(state, skillKey, {\n      kind: \"success\",\n      message: \"API key saved\",\n    });\n  } catch (err) {\n    const message = getErrorMessage(err);\n    state.skillsError = message;\n    setSkillMessage(state, skillKey, {\n      kind: \"error\",\n      message,\n    });\n  } finally {\n    state.skillsBusyKey = null;\n  }\n}\n\nexport async function installSkill(\n  state: SkillsState,\n  skillKey: string,\n  name: string,\n  installId: string,\n) {\n  if (!state.client || !state.connected) return;\n  state.skillsBusyKey = skillKey;\n  state.skillsError = null;\n  try {\n    const result = (await state.client.request(\"skills.install\", {\n      name,\n      installId,\n      timeoutMs: 120000,\n    })) as { ok?: boolean; message?: string };\n    await loadSkills(state);\n    setSkillMessage(state, skillKey, {\n      kind: \"success\",\n      message: result?.message ?? \"Installed\",\n    });\n  } catch (err) {\n    const message = getErrorMessage(err);\n    state.skillsError = message;\n    setSkillMessage(state, skillKey, {\n      kind: \"error\",\n      message,\n    });\n  } finally {\n    state.skillsBusyKey = null;\n  }\n}\n","import type { IconName } from \"./icons.js\";\n\nexport const TAB_GROUPS = [\n  { label: \"对话\", tabs: [\"chat\"] },\n  {\n    label: \"控制\",\n    tabs: [\"overview\", \"channels\", \"instances\", \"sessions\", \"usage\", \"cron\"],\n  },\n  { label: \"代理\", tabs: [\"agents\", \"skills\", \"nodes\"] },\n  { label: \"设置\", tabs: [\"config\", \"debug\", \"logs\"] },\n] as const;\n\nexport type Tab =\n  | \"agents\"\n  | \"overview\"\n  | \"channels\"\n  | \"instances\"\n  | \"sessions\"\n  | \"usage\"\n  | \"cron\"\n  | \"skills\"\n  | \"nodes\"\n  | \"chat\"\n  | \"config\"\n  | \"debug\"\n  | \"logs\";\n\nconst TAB_PATHS: Record<Tab, string> = {\n  agents: \"/agents\",\n  overview: \"/overview\",\n  channels: \"/channels\",\n  instances: \"/instances\",\n  sessions: \"/sessions\",\n  usage: \"/usage\",\n  cron: \"/cron\",\n  skills: \"/skills\",\n  nodes: \"/nodes\",\n  chat: \"/chat\",\n  config: \"/config\",\n  debug: \"/debug\",\n  logs: \"/logs\",\n};\n\nconst PATH_TO_TAB = new Map(Object.entries(TAB_PATHS).map(([tab, path]) => [path, tab as Tab]));\n\nexport function normalizeBasePath(basePath: string): string {\n  if (!basePath) {\n    return \"\";\n  }\n  let base = basePath.trim();\n  if (!base.startsWith(\"/\")) {\n    base = `/${base}`;\n  }\n  if (base === \"/\") {\n    return \"\";\n  }\n  if (base.endsWith(\"/\")) {\n    base = base.slice(0, -1);\n  }\n  return base;\n}\n\nexport function normalizePath(path: string): string {\n  if (!path) {\n    return \"/\";\n  }\n  let normalized = path.trim();\n  if (!normalized.startsWith(\"/\")) {\n    normalized = `/${normalized}`;\n  }\n  if (normalized.length > 1 && normalized.endsWith(\"/\")) {\n    normalized = normalized.slice(0, -1);\n  }\n  return normalized;\n}\n\nexport function pathForTab(tab: Tab, basePath = \"\"): string {\n  const base = normalizeBasePath(basePath);\n  const path = TAB_PATHS[tab];\n  return base ? `${base}${path}` : path;\n}\n\nexport function tabFromPath(pathname: string, basePath = \"\"): Tab | null {\n  const base = normalizeBasePath(basePath);\n  let path = pathname || \"/\";\n  if (base) {\n    if (path === base) {\n      path = \"/\";\n    } else if (path.startsWith(`${base}/`)) {\n      path = path.slice(base.length);\n    }\n  }\n  let normalized = normalizePath(path).toLowerCase();\n  if (normalized.endsWith(\"/index.html\")) {\n    normalized = \"/\";\n  }\n  if (normalized === \"/\") {\n    return \"chat\";\n  }\n  return PATH_TO_TAB.get(normalized) ?? null;\n}\n\nexport function inferBasePathFromPathname(pathname: string): string {\n  let normalized = normalizePath(pathname);\n  if (normalized.endsWith(\"/index.html\")) {\n    normalized = normalizePath(normalized.slice(0, -\"/index.html\".length));\n  }\n  if (normalized === \"/\") {\n    return \"\";\n  }\n  const segments = normalized.split(\"/\").filter(Boolean);\n  if (segments.length === 0) {\n    return \"\";\n  }\n  for (let i = 0; i < segments.length; i++) {\n    const candidate = `/${segments.slice(i).join(\"/\")}`.toLowerCase();\n    if (PATH_TO_TAB.has(candidate)) {\n      const prefix = segments.slice(0, i);\n      return prefix.length ? `/${prefix.join(\"/\")}` : \"\";\n    }\n  }\n  return `/${segments.join(\"/\")}`;\n}\n\nexport function iconForTab(tab: Tab): IconName {\n  switch (tab) {\n    case \"agents\":\n      return \"folder\";\n    case \"chat\":\n      return \"messageSquare\";\n    case \"overview\":\n      return \"barChart\";\n    case \"channels\":\n      return \"link\";\n    case \"instances\":\n      return \"radio\";\n    case \"sessions\":\n      return \"fileText\";\n    case \"usage\":\n      return \"barChart\";\n    case \"cron\":\n      return \"loader\";\n    case \"skills\":\n      return \"zap\";\n    case \"nodes\":\n      return \"monitor\";\n    case \"config\":\n      return \"settings\";\n    case \"debug\":\n      return \"bug\";\n    case \"logs\":\n      return \"scrollText\";\n    default:\n      return \"folder\";\n  }\n}\n\nexport function titleForTab(tab: Tab) {\n  switch (tab) {\n    case \"agents\":\n      return \"代理\";\n    case \"overview\":\n      return \"概览\";\n    case \"channels\":\n      return \"通道\";\n    case \"instances\":\n      return \"实例\";\n    case \"sessions\":\n      return \"会话\";\n    case \"usage\":\n      return \"用量\";\n    case \"cron\":\n      return \"定时任务\";\n    case \"skills\":\n      return \"技能\";\n    case \"nodes\":\n      return \"节点\";\n    case \"chat\":\n      return \"对话\";\n    case \"config\":\n      return \"配置\";\n    case \"debug\":\n      return \"调试\";\n    case \"logs\":\n      return \"日志\";\n    default:\n      return \"控制\";\n  }\n}\n\nexport function subtitleForTab(tab: Tab) {\n  switch (tab) {\n    case \"agents\":\n      return \"管理代理工作区、工具和身份。\";\n    case \"overview\":\n      return \"网关状态、入口和快速健康检查。\";\n    case \"channels\":\n      return \"管理通道和设置。\";\n    case \"instances\":\n      return \"来自已连接客户端和节点的存在信标。\";\n    case \"sessions\":\n      return \"查看活跃会话并调整每会话默认设置。\";\n    case \"usage\":\n      return \"\";\n    case \"cron\":\n      return \"安排唤醒和定期代理运行。\";\n    case \"skills\":\n      return \"管理技能可用性和 API 密钥注入。\";\n    case \"nodes\":\n      return \"配对设备、功能和命令暴露。\";\n    case \"chat\":\n      return \"网关直连对话会话，用于快速操作。\";\n    case \"config\":\n      return \"安全编辑 ~/.openclaw/openclaw.json。\";\n    case \"debug\":\n      return \"网关快照、事件和手动 RPC 调用。\";\n    case \"logs\":\n      return \"实时追踪网关文件日志。\";\n    default:\n      return \"\";\n  }\n}\n","const KEY = \"clawdbot.control.settings.v1\";\n\nimport type { ThemeMode } from \"./theme\";\n\nexport type UiSettings = {\n  gatewayUrl: string;\n  token: string;\n  sessionKey: string;\n  lastActiveSessionKey: string;\n  theme: ThemeMode;\n  chatFocusMode: boolean;\n  chatShowThinking: boolean;\n  // 发送键偏好：true=回车发送（Shift+回车换行）；false=回车换行（Ctrl/⌘+回车发送）\n  sendOnEnter: boolean;\n  splitRatio: number; // Sidebar split ratio (0.4 to 0.7, default 0.6)\n  navCollapsed: boolean; // Collapsible sidebar state\n  navGroupsCollapsed: Record<string, boolean>; // Which nav groups are collapsed\n};\n\nexport function loadSettings(): UiSettings {\n  const defaultUrl = (() => {\n    const proto = location.protocol === \"https:\" ? \"wss\" : \"ws\";\n    return `${proto}://${location.host}`;\n  })();\n\n  const defaults: UiSettings = {\n    gatewayUrl: defaultUrl,\n    token: \"\",\n    sessionKey: \"main\",\n    lastActiveSessionKey: \"main\",\n    theme: \"system\",\n    chatFocusMode: false,\n    chatShowThinking: true,\n    sendOnEnter: true,\n    splitRatio: 0.6,\n    navCollapsed: false,\n    navGroupsCollapsed: {},\n  };\n\n  try {\n    const raw = localStorage.getItem(KEY);\n    if (!raw) return defaults;\n    const parsed = JSON.parse(raw) as Partial<UiSettings>;\n    return {\n      gatewayUrl:\n        typeof parsed.gatewayUrl === \"string\" && parsed.gatewayUrl.trim()\n          ? parsed.gatewayUrl.trim()\n          : defaults.gatewayUrl,\n      token: typeof parsed.token === \"string\" ? parsed.token : defaults.token,\n      sessionKey:\n        typeof parsed.sessionKey === \"string\" && parsed.sessionKey.trim()\n          ? parsed.sessionKey.trim()\n          : defaults.sessionKey,\n      lastActiveSessionKey:\n        typeof parsed.lastActiveSessionKey === \"string\" &&\n        parsed.lastActiveSessionKey.trim()\n          ? parsed.lastActiveSessionKey.trim()\n          : (typeof parsed.sessionKey === \"string\" &&\n              parsed.sessionKey.trim()) ||\n            defaults.lastActiveSessionKey,\n      theme:\n        parsed.theme === \"light\" ||\n        parsed.theme === \"dark\" ||\n        parsed.theme === \"system\"\n          ? parsed.theme\n          : defaults.theme,\n      chatFocusMode:\n        typeof parsed.chatFocusMode === \"boolean\"\n          ? parsed.chatFocusMode\n          : defaults.chatFocusMode,\n      chatShowThinking:\n        typeof parsed.chatShowThinking === \"boolean\"\n          ? parsed.chatShowThinking\n          : defaults.chatShowThinking,\n      sendOnEnter:\n        typeof (parsed as Partial<UiSettings>).sendOnEnter === \"boolean\"\n          ? (parsed as Partial<UiSettings>).sendOnEnter as boolean\n          : defaults.sendOnEnter,\n      splitRatio:\n        typeof parsed.splitRatio === \"number\" &&\n        parsed.splitRatio >= 0.4 &&\n        parsed.splitRatio <= 0.7\n          ? parsed.splitRatio\n          : defaults.splitRatio,\n      navCollapsed:\n        typeof parsed.navCollapsed === \"boolean\"\n          ? parsed.navCollapsed\n          : defaults.navCollapsed,\n      navGroupsCollapsed:\n        typeof parsed.navGroupsCollapsed === \"object\" &&\n        parsed.navGroupsCollapsed !== null\n          ? parsed.navGroupsCollapsed\n          : defaults.navGroupsCollapsed,\n    };\n  } catch {\n    return defaults;\n  }\n}\n\nexport function saveSettings(next: UiSettings) {\n  localStorage.setItem(KEY, JSON.stringify(next));\n}\n","import type { ThemeMode } from \"./theme\";\n\nexport type ThemeTransitionContext = {\n  element?: HTMLElement | null;\n  pointerClientX?: number;\n  pointerClientY?: number;\n};\n\nexport type ThemeTransitionOptions = {\n  nextTheme: ThemeMode;\n  applyTheme: () => void;\n  context?: ThemeTransitionContext;\n  currentTheme?: ThemeMode | null;\n};\n\ntype DocumentWithViewTransition = Document & {\n  startViewTransition?: (callback: () => void) => { finished: Promise<void> };\n};\n\nconst clamp01 = (value: number) => {\n  if (Number.isNaN(value)) return 0.5;\n  if (value <= 0) return 0;\n  if (value >= 1) return 1;\n  return value;\n};\n\nconst hasReducedMotionPreference = () => {\n  if (typeof window === \"undefined\" || typeof window.matchMedia !== \"function\") {\n    return false;\n  }\n  return window.matchMedia(\"(prefers-reduced-motion: reduce)\").matches ?? false;\n};\n\nconst cleanupThemeTransition = (root: HTMLElement) => {\n  root.classList.remove(\"theme-transition\");\n  root.style.removeProperty(\"--theme-switch-x\");\n  root.style.removeProperty(\"--theme-switch-y\");\n};\n\nexport const startThemeTransition = ({\n  nextTheme,\n  applyTheme,\n  context,\n  currentTheme,\n}: ThemeTransitionOptions) => {\n  if (currentTheme === nextTheme) return;\n\n  const documentReference = globalThis.document ?? null;\n  if (!documentReference) {\n    applyTheme();\n    return;\n  }\n\n  const root = documentReference.documentElement;\n  const document_ = documentReference as DocumentWithViewTransition;\n  const prefersReducedMotion = hasReducedMotionPreference();\n\n  const canUseViewTransition =\n    Boolean(document_.startViewTransition) && !prefersReducedMotion;\n\n  if (canUseViewTransition) {\n    let xPercent = 0.5;\n    let yPercent = 0.5;\n\n    if (\n      context?.pointerClientX !== undefined &&\n      context?.pointerClientY !== undefined &&\n      typeof window !== \"undefined\"\n    ) {\n      xPercent = clamp01(context.pointerClientX / window.innerWidth);\n      yPercent = clamp01(context.pointerClientY / window.innerHeight);\n    } else if (context?.element) {\n      const rect = context.element.getBoundingClientRect();\n      if (\n        rect.width > 0 &&\n        rect.height > 0 &&\n        typeof window !== \"undefined\"\n      ) {\n        xPercent = clamp01((rect.left + rect.width / 2) / window.innerWidth);\n        yPercent = clamp01((rect.top + rect.height / 2) / window.innerHeight);\n      }\n    }\n\n    root.style.setProperty(\"--theme-switch-x\", `${xPercent * 100}%`);\n    root.style.setProperty(\"--theme-switch-y\", `${yPercent * 100}%`);\n    root.classList.add(\"theme-transition\");\n\n    try {\n      const transition = document_.startViewTransition?.(() => {\n        applyTheme();\n      });\n      if (transition?.finished) {\n        void transition.finished.finally(() => cleanupThemeTransition(root));\n      } else {\n        cleanupThemeTransition(root);\n      }\n    } catch {\n      cleanupThemeTransition(root);\n      applyTheme();\n    }\n    return;\n  }\n\n  applyTheme();\n  cleanupThemeTransition(root);\n};\n","export type ThemeMode = \"system\" | \"light\" | \"dark\";\nexport type ResolvedTheme = \"light\" | \"dark\";\n\nexport function getSystemTheme(): ResolvedTheme {\n  if (typeof window === \"undefined\" || typeof window.matchMedia !== \"function\") {\n    return \"dark\";\n  }\n  return window.matchMedia(\"(prefers-color-scheme: dark)\").matches\n    ? \"dark\"\n    : \"light\";\n}\n\nexport function resolveTheme(mode: ThemeMode): ResolvedTheme {\n  if (mode === \"system\") return getSystemTheme();\n  return mode;\n}\n","import type { OpenClawApp } from \"./app.ts\";\nimport type { AgentsListResult } from \"./types.ts\";\nimport { refreshChat } from \"./app-chat.ts\";\nimport {\n  startLogsPolling,\n  stopLogsPolling,\n  startDebugPolling,\n  stopDebugPolling,\n} from \"./app-polling.ts\";\nimport { scheduleChatScroll, scheduleLogsScroll } from \"./app-scroll.ts\";\nimport { loadAgentIdentities, loadAgentIdentity } from \"./controllers/agent-identity.ts\";\nimport { loadAgentSkills } from \"./controllers/agent-skills.ts\";\nimport { loadAgents } from \"./controllers/agents.ts\";\nimport { loadChannels } from \"./controllers/channels.ts\";\nimport { loadConfig, loadConfigSchema } from \"./controllers/config.ts\";\nimport { loadCronJobs, loadCronStatus } from \"./controllers/cron.ts\";\nimport { loadDebug } from \"./controllers/debug.ts\";\nimport { loadDevices } from \"./controllers/devices.ts\";\nimport { loadExecApprovals } from \"./controllers/exec-approvals.ts\";\nimport { loadLogs } from \"./controllers/logs.ts\";\nimport { loadNodes } from \"./controllers/nodes.ts\";\nimport { loadPresence } from \"./controllers/presence.ts\";\nimport { loadSessions } from \"./controllers/sessions.ts\";\nimport { loadSkills } from \"./controllers/skills.ts\";\nimport {\n  inferBasePathFromPathname,\n  normalizeBasePath,\n  normalizePath,\n  pathForTab,\n  tabFromPath,\n  type Tab,\n} from \"./navigation.ts\";\nimport { saveSettings, type UiSettings } from \"./storage.ts\";\nimport { startThemeTransition, type ThemeTransitionContext } from \"./theme-transition.ts\";\nimport { resolveTheme, type ResolvedTheme, type ThemeMode } from \"./theme.ts\";\n\ntype SettingsHost = {\n  settings: UiSettings;\n  password?: string;\n  theme: ThemeMode;\n  themeResolved: ResolvedTheme;\n  applySessionKey: string;\n  sessionKey: string;\n  tab: Tab;\n  connected: boolean;\n  chatHasAutoScrolled: boolean;\n  logsAtBottom: boolean;\n  eventLog: unknown[];\n  eventLogBuffer: unknown[];\n  basePath: string;\n  agentsList?: AgentsListResult | null;\n  agentsSelectedId?: string | null;\n  agentsPanel?: \"overview\" | \"files\" | \"tools\" | \"skills\" | \"channels\" | \"cron\";\n  themeMedia: MediaQueryList | null;\n  themeMediaHandler: ((event: MediaQueryListEvent) => void) | null;\n  pendingGatewayUrl?: string | null;\n};\n\nexport function applySettings(host: SettingsHost, next: UiSettings) {\n  const normalized = {\n    ...next,\n    lastActiveSessionKey: next.lastActiveSessionKey?.trim() || next.sessionKey.trim() || \"main\",\n  };\n  host.settings = normalized;\n  saveSettings(normalized);\n  if (next.theme !== host.theme) {\n    host.theme = next.theme;\n    applyResolvedTheme(host, resolveTheme(next.theme));\n  }\n  host.applySessionKey = host.settings.lastActiveSessionKey;\n}\n\nexport function setLastActiveSessionKey(host: SettingsHost, next: string) {\n  const trimmed = next.trim();\n  if (!trimmed) {\n    return;\n  }\n  if (host.settings.lastActiveSessionKey === trimmed) {\n    return;\n  }\n  applySettings(host, { ...host.settings, lastActiveSessionKey: trimmed });\n}\n\nexport function applySettingsFromUrl(host: SettingsHost) {\n  if (!window.location.search) {\n    return;\n  }\n  const params = new URLSearchParams(window.location.search);\n  const tokenRaw = params.get(\"token\");\n  const passwordRaw = params.get(\"password\");\n  const sessionRaw = params.get(\"session\");\n  const gatewayUrlRaw = params.get(\"gatewayUrl\");\n  let shouldCleanUrl = false;\n\n  if (tokenRaw != null) {\n    params.delete(\"token\");\n    shouldCleanUrl = true;\n  }\n\n  if (passwordRaw != null) {\n    const password = passwordRaw.trim();\n    if (password) {\n      (host as { password: string }).password = password;\n    }\n    params.delete(\"password\");\n    shouldCleanUrl = true;\n  }\n\n  if (sessionRaw != null) {\n    const session = sessionRaw.trim();\n    if (session) {\n      host.sessionKey = session;\n      applySettings(host, {\n        ...host.settings,\n        sessionKey: session,\n        lastActiveSessionKey: session,\n      });\n    }\n  }\n\n  if (gatewayUrlRaw != null) {\n    const gatewayUrl = gatewayUrlRaw.trim();\n    if (gatewayUrl && gatewayUrl !== host.settings.gatewayUrl) {\n      host.pendingGatewayUrl = gatewayUrl;\n    }\n    params.delete(\"gatewayUrl\");\n    shouldCleanUrl = true;\n  }\n\n  if (!shouldCleanUrl) {\n    return;\n  }\n  const url = new URL(window.location.href);\n  url.search = params.toString();\n  window.history.replaceState({}, \"\", url.toString());\n}\n\nexport function setTab(host: SettingsHost, next: Tab) {\n  if (host.tab !== next) {\n    host.tab = next;\n  }\n  if (next === \"chat\") {\n    host.chatHasAutoScrolled = false;\n  }\n  if (next === \"logs\") {\n    startLogsPolling(host as unknown as Parameters<typeof startLogsPolling>[0]);\n  } else {\n    stopLogsPolling(host as unknown as Parameters<typeof stopLogsPolling>[0]);\n  }\n  if (next === \"debug\") {\n    startDebugPolling(host as unknown as Parameters<typeof startDebugPolling>[0]);\n  } else {\n    stopDebugPolling(host as unknown as Parameters<typeof stopDebugPolling>[0]);\n  }\n  void refreshActiveTab(host);\n  syncUrlWithTab(host, next, false);\n}\n\nexport function setTheme(host: SettingsHost, next: ThemeMode, context?: ThemeTransitionContext) {\n  const applyTheme = () => {\n    host.theme = next;\n    applySettings(host, { ...host.settings, theme: next });\n    applyResolvedTheme(host, resolveTheme(next));\n  };\n  startThemeTransition({\n    nextTheme: next,\n    applyTheme,\n    context,\n    currentTheme: host.theme,\n  });\n}\n\nexport async function refreshActiveTab(host: SettingsHost) {\n  if (host.tab === \"overview\") {\n    await loadOverview(host);\n  }\n  if (host.tab === \"channels\") {\n    await loadChannelsTab(host);\n  }\n  if (host.tab === \"instances\") {\n    await loadPresence(host as unknown as OpenClawApp);\n  }\n  if (host.tab === \"sessions\") {\n    await loadSessions(host as unknown as OpenClawApp);\n  }\n  if (host.tab === \"cron\") {\n    await loadCron(host);\n  }\n  if (host.tab === \"skills\") {\n    await loadSkills(host as unknown as OpenClawApp);\n  }\n  if (host.tab === \"agents\") {\n    await loadAgents(host as unknown as OpenClawApp);\n    await loadConfig(host as unknown as OpenClawApp);\n    const agentIds = host.agentsList?.agents?.map((entry) => entry.id) ?? [];\n    if (agentIds.length > 0) {\n      void loadAgentIdentities(host as unknown as OpenClawApp, agentIds);\n    }\n    const agentId =\n      host.agentsSelectedId ?? host.agentsList?.defaultId ?? host.agentsList?.agents?.[0]?.id;\n    if (agentId) {\n      void loadAgentIdentity(host as unknown as OpenClawApp, agentId);\n      if (host.agentsPanel === \"skills\") {\n        void loadAgentSkills(host as unknown as OpenClawApp, agentId);\n      }\n      if (host.agentsPanel === \"channels\") {\n        void loadChannels(host as unknown as OpenClawApp, false);\n      }\n      if (host.agentsPanel === \"cron\") {\n        void loadCron(host);\n      }\n    }\n  }\n  if (host.tab === \"nodes\") {\n    await loadNodes(host as unknown as OpenClawApp);\n    await loadDevices(host as unknown as OpenClawApp);\n    await loadConfig(host as unknown as OpenClawApp);\n    await loadExecApprovals(host as unknown as OpenClawApp);\n  }\n  if (host.tab === \"chat\") {\n    await refreshChat(host as unknown as Parameters<typeof refreshChat>[0]);\n    scheduleChatScroll(\n      host as unknown as Parameters<typeof scheduleChatScroll>[0],\n      !host.chatHasAutoScrolled,\n    );\n  }\n  if (host.tab === \"config\") {\n    await loadConfigSchema(host as unknown as OpenClawApp);\n    await loadConfig(host as unknown as OpenClawApp);\n  }\n  if (host.tab === \"debug\") {\n    await loadDebug(host as unknown as OpenClawApp);\n    host.eventLog = host.eventLogBuffer;\n  }\n  if (host.tab === \"logs\") {\n    host.logsAtBottom = true;\n    await loadLogs(host as unknown as OpenClawApp, { reset: true });\n    scheduleLogsScroll(host as unknown as Parameters<typeof scheduleLogsScroll>[0], true);\n  }\n}\n\nexport function inferBasePath() {\n  if (typeof window === \"undefined\") {\n    return \"\";\n  }\n  const configured = window.__OPENCLAW_CONTROL_UI_BASE_PATH__;\n  if (typeof configured === \"string\" && configured.trim()) {\n    return normalizeBasePath(configured);\n  }\n  return inferBasePathFromPathname(window.location.pathname);\n}\n\nexport function syncThemeWithSettings(host: SettingsHost) {\n  host.theme = host.settings.theme ?? \"system\";\n  applyResolvedTheme(host, resolveTheme(host.theme));\n}\n\nexport function applyResolvedTheme(host: SettingsHost, resolved: ResolvedTheme) {\n  host.themeResolved = resolved;\n  if (typeof document === \"undefined\") {\n    return;\n  }\n  const root = document.documentElement;\n  root.dataset.theme = resolved;\n  root.style.colorScheme = resolved;\n}\n\nexport function attachThemeListener(host: SettingsHost) {\n  if (typeof window === \"undefined\" || typeof window.matchMedia !== \"function\") {\n    return;\n  }\n  host.themeMedia = window.matchMedia(\"(prefers-color-scheme: dark)\");\n  host.themeMediaHandler = (event) => {\n    if (host.theme !== \"system\") {\n      return;\n    }\n    applyResolvedTheme(host, event.matches ? \"dark\" : \"light\");\n  };\n  if (typeof host.themeMedia.addEventListener === \"function\") {\n    host.themeMedia.addEventListener(\"change\", host.themeMediaHandler);\n    return;\n  }\n  const legacy = host.themeMedia as MediaQueryList & {\n    addListener: (cb: (event: MediaQueryListEvent) => void) => void;\n  };\n  legacy.addListener(host.themeMediaHandler);\n}\n\nexport function detachThemeListener(host: SettingsHost) {\n  if (!host.themeMedia || !host.themeMediaHandler) {\n    return;\n  }\n  if (typeof host.themeMedia.removeEventListener === \"function\") {\n    host.themeMedia.removeEventListener(\"change\", host.themeMediaHandler);\n    return;\n  }\n  const legacy = host.themeMedia as MediaQueryList & {\n    removeListener: (cb: (event: MediaQueryListEvent) => void) => void;\n  };\n  legacy.removeListener(host.themeMediaHandler);\n  host.themeMedia = null;\n  host.themeMediaHandler = null;\n}\n\nexport function syncTabWithLocation(host: SettingsHost, replace: boolean) {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n  const resolved = tabFromPath(window.location.pathname, host.basePath) ?? \"chat\";\n  setTabFromRoute(host, resolved);\n  syncUrlWithTab(host, resolved, replace);\n}\n\nexport function onPopState(host: SettingsHost) {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n  const resolved = tabFromPath(window.location.pathname, host.basePath);\n  if (!resolved) {\n    return;\n  }\n\n  const url = new URL(window.location.href);\n  const session = url.searchParams.get(\"session\")?.trim();\n  if (session) {\n    host.sessionKey = session;\n    applySettings(host, {\n      ...host.settings,\n      sessionKey: session,\n      lastActiveSessionKey: session,\n    });\n  }\n\n  setTabFromRoute(host, resolved);\n}\n\nexport function setTabFromRoute(host: SettingsHost, next: Tab) {\n  if (host.tab !== next) {\n    host.tab = next;\n  }\n  if (next === \"chat\") {\n    host.chatHasAutoScrolled = false;\n  }\n  if (next === \"logs\") {\n    startLogsPolling(host as unknown as Parameters<typeof startLogsPolling>[0]);\n  } else {\n    stopLogsPolling(host as unknown as Parameters<typeof stopLogsPolling>[0]);\n  }\n  if (next === \"debug\") {\n    startDebugPolling(host as unknown as Parameters<typeof startDebugPolling>[0]);\n  } else {\n    stopDebugPolling(host as unknown as Parameters<typeof stopDebugPolling>[0]);\n  }\n  if (host.connected) {\n    void refreshActiveTab(host);\n  }\n}\n\nexport function syncUrlWithTab(host: SettingsHost, tab: Tab, replace: boolean) {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n  const targetPath = normalizePath(pathForTab(tab, host.basePath));\n  const currentPath = normalizePath(window.location.pathname);\n  const url = new URL(window.location.href);\n\n  if (tab === \"chat\" && host.sessionKey) {\n    url.searchParams.set(\"session\", host.sessionKey);\n  } else {\n    url.searchParams.delete(\"session\");\n  }\n\n  if (currentPath !== targetPath) {\n    url.pathname = targetPath;\n  }\n\n  if (replace) {\n    window.history.replaceState({}, \"\", url.toString());\n  } else {\n    window.history.pushState({}, \"\", url.toString());\n  }\n}\n\nexport function syncUrlWithSessionKey(host: SettingsHost, sessionKey: string, replace: boolean) {\n  if (typeof window === \"undefined\") {\n    return;\n  }\n  const url = new URL(window.location.href);\n  url.searchParams.set(\"session\", sessionKey);\n  if (replace) {\n    window.history.replaceState({}, \"\", url.toString());\n  } else {\n    window.history.pushState({}, \"\", url.toString());\n  }\n}\n\nexport async function loadOverview(host: SettingsHost) {\n  await Promise.all([\n    loadChannels(host as unknown as OpenClawApp, false),\n    loadPresence(host as unknown as OpenClawApp),\n    loadSessions(host as unknown as OpenClawApp),\n    loadCronStatus(host as unknown as OpenClawApp),\n    loadDebug(host as unknown as OpenClawApp),\n  ]);\n}\n\nexport async function loadChannelsTab(host: SettingsHost) {\n  await Promise.all([\n    loadChannels(host as unknown as OpenClawApp, true),\n    loadConfigSchema(host as unknown as OpenClawApp),\n    loadConfig(host as unknown as OpenClawApp),\n  ]);\n}\n\nexport async function loadCron(host: SettingsHost) {\n  await Promise.all([\n    loadChannels(host as unknown as OpenClawApp, false),\n    loadCronStatus(host as unknown as OpenClawApp),\n    loadCronJobs(host as unknown as OpenClawApp),\n  ]);\n}\n","export type ParsedAgentSessionKey = {\n  agentId: string;\n  rest: string;\n};\n\nexport function parseAgentSessionKey(\n  sessionKey: string | undefined | null,\n): ParsedAgentSessionKey | null {\n  const raw = (sessionKey ?? \"\").trim();\n  if (!raw) {\n    return null;\n  }\n  const parts = raw.split(\":\").filter(Boolean);\n  if (parts.length < 3) {\n    return null;\n  }\n  if (parts[0] !== \"agent\") {\n    return null;\n  }\n  const agentId = parts[1]?.trim();\n  const rest = parts.slice(2).join(\":\");\n  if (!agentId || !rest) {\n    return null;\n  }\n  return { agentId, rest };\n}\n\nexport function isCronRunSessionKey(sessionKey: string | undefined | null): boolean {\n  const parsed = parseAgentSessionKey(sessionKey);\n  if (!parsed) {\n    return false;\n  }\n  return /^cron:[^:]+:run:[^:]+$/.test(parsed.rest);\n}\n\nexport function isCronSessionKey(sessionKey: string | undefined | null): boolean {\n  const parsed = parseAgentSessionKey(sessionKey);\n  if (!parsed) {\n    return false;\n  }\n  return parsed.rest.toLowerCase().startsWith(\"cron:\");\n}\n\nexport function isSubagentSessionKey(sessionKey: string | undefined | null): boolean {\n  const raw = (sessionKey ?? \"\").trim();\n  if (!raw) {\n    return false;\n  }\n  if (raw.toLowerCase().startsWith(\"subagent:\")) {\n    return true;\n  }\n  const parsed = parseAgentSessionKey(raw);\n  return Boolean((parsed?.rest ?? \"\").toLowerCase().startsWith(\"subagent:\"));\n}\n\nexport function getSubagentDepth(sessionKey: string | undefined | null): number {\n  const raw = (sessionKey ?? \"\").trim().toLowerCase();\n  if (!raw) {\n    return 0;\n  }\n  return raw.split(\":subagent:\").length - 1;\n}\n\nexport function isAcpSessionKey(sessionKey: string | undefined | null): boolean {\n  const raw = (sessionKey ?? \"\").trim();\n  if (!raw) {\n    return false;\n  }\n  const normalized = raw.toLowerCase();\n  if (normalized.startsWith(\"acp:\")) {\n    return true;\n  }\n  const parsed = parseAgentSessionKey(raw);\n  return Boolean((parsed?.rest ?? \"\").toLowerCase().startsWith(\"acp:\"));\n}\n\nconst THREAD_SESSION_MARKERS = [\":thread:\", \":topic:\"];\n\nexport function resolveThreadParentSessionKey(\n  sessionKey: string | undefined | null,\n): string | null {\n  const raw = (sessionKey ?? \"\").trim();\n  if (!raw) {\n    return null;\n  }\n  const normalized = raw.toLowerCase();\n  let idx = -1;\n  for (const marker of THREAD_SESSION_MARKERS) {\n    const candidate = normalized.lastIndexOf(marker);\n    if (candidate > idx) {\n      idx = candidate;\n    }\n  }\n  if (idx <= 0) {\n    return null;\n  }\n  const parent = raw.slice(0, idx).trim();\n  return parent ? parent : null;\n}\n","import { abortChatRun, loadChatHistory, sendChatMessage } from \"./controllers/chat\";\nimport { loadSessions } from \"./controllers/sessions\";\nimport { generateUUID } from \"./uuid\";\nimport { resetToolStream } from \"./app-tool-stream\";\nimport { scheduleChatScroll } from \"./app-scroll\";\nimport { setLastActiveSessionKey } from \"./app-settings\";\nimport { normalizeBasePath } from \"./navigation\";\nimport type { GatewayHelloOk } from \"./gateway\";\nimport { parseAgentSessionKey } from \"../../../src/sessions/session-key-utils.js\";\nimport type { ClawdbotApp } from \"./app\";\nimport type { ChatAttachment, ChatQueueItem } from \"./ui-types\";\n\ntype ChatHost = {\n  connected: boolean;\n  chatMessage: string;\n  chatAttachments: ChatAttachment[];\n  chatQueue: ChatQueueItem[];\n  chatRunId: string | null;\n  chatSending: boolean;\n  sessionKey: string;\n  basePath: string;\n  hello: GatewayHelloOk | null;\n  chatAvatarUrl: string | null;\n};\n\nexport function isChatBusy(host: ChatHost) {\n  return host.chatSending || Boolean(host.chatRunId);\n}\n\nexport function isChatStopCommand(text: string) {\n  const trimmed = text.trim();\n  if (!trimmed) return false;\n  const normalized = trimmed.toLowerCase();\n  if (normalized === \"/stop\") return true;\n  return (\n    normalized === \"stop\" ||\n    normalized === \"esc\" ||\n    normalized === \"abort\" ||\n    normalized === \"wait\" ||\n    normalized === \"exit\"\n  );\n}\n\nexport async function handleAbortChat(host: ChatHost) {\n  if (!host.connected) return;\n  host.chatMessage = \"\";\n  await abortChatRun(host as unknown as ClawdbotApp);\n}\n\nfunction enqueueChatMessage(host: ChatHost, text: string, attachments?: ChatAttachment[]) {\n  const trimmed = text.trim();\n  const hasAttachments = Boolean(attachments && attachments.length > 0);\n  if (!trimmed && !hasAttachments) return;\n  host.chatQueue = [\n    ...host.chatQueue,\n    {\n      id: generateUUID(),\n      text: trimmed,\n      createdAt: Date.now(),\n      attachments: hasAttachments ? attachments?.map((att) => ({ ...att })) : undefined,\n    },\n  ];\n}\n\nasync function sendChatMessageNow(\n  host: ChatHost,\n  message: string,\n  opts?: {\n    previousDraft?: string;\n    restoreDraft?: boolean;\n    attachments?: ChatAttachment[];\n    previousAttachments?: ChatAttachment[];\n    restoreAttachments?: boolean;\n  },\n) {\n  resetToolStream(host as unknown as Parameters<typeof resetToolStream>[0]);\n  const ok = await sendChatMessage(host as unknown as ClawdbotApp, message, opts?.attachments);\n  if (!ok && opts?.previousDraft != null) {\n    host.chatMessage = opts.previousDraft;\n  }\n  if (!ok && opts?.previousAttachments) {\n    host.chatAttachments = opts.previousAttachments;\n  }\n  if (ok) {\n    setLastActiveSessionKey(host as unknown as Parameters<typeof setLastActiveSessionKey>[0], host.sessionKey);\n  }\n  if (ok && opts?.restoreDraft && opts.previousDraft?.trim()) {\n    host.chatMessage = opts.previousDraft;\n  }\n  if (ok && opts?.restoreAttachments && opts.previousAttachments?.length) {\n    host.chatAttachments = opts.previousAttachments;\n  }\n  scheduleChatScroll(host as unknown as Parameters<typeof scheduleChatScroll>[0]);\n  if (ok && !host.chatRunId) {\n    void flushChatQueue(host);\n  }\n  return ok;\n}\n\nasync function flushChatQueue(host: ChatHost) {\n  if (!host.connected || isChatBusy(host)) return;\n  const [next, ...rest] = host.chatQueue;\n  if (!next) return;\n  host.chatQueue = rest;\n  const ok = await sendChatMessageNow(host, next.text, { attachments: next.attachments });\n  if (!ok) {\n    host.chatQueue = [next, ...host.chatQueue];\n  }\n}\n\nexport function removeQueuedMessage(host: ChatHost, id: string) {\n  host.chatQueue = host.chatQueue.filter((item) => item.id !== id);\n}\n\nexport async function handleSendChat(\n  host: ChatHost,\n  messageOverride?: string,\n  opts?: { restoreDraft?: boolean },\n) {\n  if (!host.connected) return;\n  const previousDraft = host.chatMessage;\n  const message = (messageOverride ?? host.chatMessage).trim();\n  const attachments = host.chatAttachments ?? [];\n  const attachmentsToSend = messageOverride == null ? attachments : [];\n  const hasAttachments = attachmentsToSend.length > 0;\n\n  // Allow sending with just attachments (no message text required)\n  if (!message && !hasAttachments) return;\n\n  if (isChatStopCommand(message)) {\n    await handleAbortChat(host);\n    return;\n  }\n\n  if (messageOverride == null) {\n    host.chatMessage = \"\";\n    // Clear attachments when sending\n    host.chatAttachments = [];\n  }\n\n  if (isChatBusy(host)) {\n    enqueueChatMessage(host, message, attachmentsToSend);\n    return;\n  }\n\n  await sendChatMessageNow(host, message, {\n    previousDraft: messageOverride == null ? previousDraft : undefined,\n    restoreDraft: Boolean(messageOverride && opts?.restoreDraft),\n    attachments: hasAttachments ? attachmentsToSend : undefined,\n    previousAttachments: messageOverride == null ? attachments : undefined,\n    restoreAttachments: Boolean(messageOverride && opts?.restoreDraft),\n  });\n}\n\nexport async function refreshChat(host: ChatHost) {\n  await Promise.all([\n    loadChatHistory(host as unknown as ClawdbotApp),\n    loadSessions(host as unknown as ClawdbotApp),\n    refreshChatAvatar(host),\n  ]);\n  scheduleChatScroll(host as unknown as Parameters<typeof scheduleChatScroll>[0]);\n}\n\nexport const flushChatQueueForEvent = flushChatQueue;\n\ntype SessionDefaultsSnapshot = {\n  defaultAgentId?: string;\n};\n\nfunction resolveAgentIdForSession(host: ChatHost): string | null {\n  const parsed = parseAgentSessionKey(host.sessionKey);\n  if (parsed?.agentId) return parsed.agentId;\n  const snapshot = host.hello?.snapshot as { sessionDefaults?: SessionDefaultsSnapshot } | undefined;\n  const fallback = snapshot?.sessionDefaults?.defaultAgentId?.trim();\n  return fallback || \"main\";\n}\n\nfunction buildAvatarMetaUrl(basePath: string, agentId: string): string {\n  const base = normalizeBasePath(basePath);\n  const encoded = encodeURIComponent(agentId);\n  return base ? `${base}/avatar/${encoded}?meta=1` : `/avatar/${encoded}?meta=1`;\n}\n\nexport async function refreshChatAvatar(host: ChatHost) {\n  if (!host.connected) {\n    host.chatAvatarUrl = null;\n    return;\n  }\n  const agentId = resolveAgentIdForSession(host);\n  if (!agentId) {\n    host.chatAvatarUrl = null;\n    return;\n  }\n  host.chatAvatarUrl = null;\n  const url = buildAvatarMetaUrl(host.basePath, agentId);\n  try {\n    const res = await fetch(url, { method: \"GET\" });\n    if (!res.ok) {\n      host.chatAvatarUrl = null;\n      return;\n    }\n    const data = (await res.json()) as { avatarUrl?: unknown };\n    const avatarUrl = typeof data.avatarUrl === \"string\" ? data.avatarUrl.trim() : \"\";\n    host.chatAvatarUrl = avatarUrl || null;\n  } catch {\n    host.chatAvatarUrl = null;\n  }\n}\n","import type { LogLevel } from \"./types.ts\";\nimport type { CronFormState } from \"./ui-types.ts\";\n\nexport const DEFAULT_LOG_LEVEL_FILTERS: Record<LogLevel, boolean> = {\n  trace: true,\n  debug: true,\n  info: true,\n  warn: true,\n  error: true,\n  fatal: true,\n};\n\nexport const DEFAULT_CRON_FORM: CronFormState = {\n  name: \"\",\n  description: \"\",\n  agentId: \"\",\n  enabled: true,\n  scheduleKind: \"every\",\n  scheduleAt: \"\",\n  everyAmount: \"30\",\n  everyUnit: \"minutes\",\n  cronExpr: \"0 7 * * *\",\n  cronTz: \"\",\n  sessionTarget: \"isolated\",\n  wakeMode: \"next-heartbeat\",\n  payloadKind: \"agentTurn\",\n  payloadText: \"\",\n  deliveryMode: \"announce\",\n  deliveryChannel: \"last\",\n  deliveryTo: \"\",\n  timeoutSeconds: \"\",\n  postToMainPrefix: \"Cron\",\n};\n","export const GATEWAY_CLIENT_IDS = {\n  WEBCHAT_UI: \"webchat-ui\",\n  CONTROL_UI: \"clawdbot-control-ui\",\n  WEBCHAT: \"webchat\",\n  CLI: \"cli\",\n  GATEWAY_CLIENT: \"gateway-client\",\n  MACOS_APP: \"clawdbot-macos\",\n  IOS_APP: \"clawdbot-ios\",\n  ANDROID_APP: \"clawdbot-android\",\n  NODE_HOST: \"node-host\",\n  TEST: \"test\",\n  FINGERPRINT: \"fingerprint\",\n  PROBE: \"clawdbot-probe\",\n} as const;\n\nexport type GatewayClientId = (typeof GATEWAY_CLIENT_IDS)[keyof typeof GATEWAY_CLIENT_IDS];\n\n// Back-compat naming (internal): these values are IDs, not display names.\nexport const GATEWAY_CLIENT_NAMES = GATEWAY_CLIENT_IDS;\nexport type GatewayClientName = GatewayClientId;\n\nexport const GATEWAY_CLIENT_MODES = {\n  WEBCHAT: \"webchat\",\n  CLI: \"cli\",\n  UI: \"ui\",\n  BACKEND: \"backend\",\n  NODE: \"node\",\n  PROBE: \"probe\",\n  TEST: \"test\",\n} as const;\n\nexport type GatewayClientMode = (typeof GATEWAY_CLIENT_MODES)[keyof typeof GATEWAY_CLIENT_MODES];\n\nexport type GatewayClientInfo = {\n  id: GatewayClientId;\n  displayName?: string;\n  version: string;\n  platform: string;\n  deviceFamily?: string;\n  modelIdentifier?: string;\n  mode: GatewayClientMode;\n  instanceId?: string;\n};\n\nconst GATEWAY_CLIENT_ID_SET = new Set<GatewayClientId>(Object.values(GATEWAY_CLIENT_IDS));\nconst GATEWAY_CLIENT_MODE_SET = new Set<GatewayClientMode>(Object.values(GATEWAY_CLIENT_MODES));\n\nexport function normalizeGatewayClientId(raw?: string | null): GatewayClientId | undefined {\n  const normalized = raw?.trim().toLowerCase();\n  if (!normalized) return undefined;\n  return GATEWAY_CLIENT_ID_SET.has(normalized as GatewayClientId)\n    ? (normalized as GatewayClientId)\n    : undefined;\n}\n\nexport function normalizeGatewayClientName(raw?: string | null): GatewayClientName | undefined {\n  return normalizeGatewayClientId(raw);\n}\n\nexport function normalizeGatewayClientMode(raw?: string | null): GatewayClientMode | undefined {\n  const normalized = raw?.trim().toLowerCase();\n  if (!normalized) return undefined;\n  return GATEWAY_CLIENT_MODE_SET.has(normalized as GatewayClientMode)\n    ? (normalized as GatewayClientMode)\n    : undefined;\n}\n","export type DeviceAuthPayloadParams = {\n  deviceId: string;\n  clientId: string;\n  clientMode: string;\n  role: string;\n  scopes: string[];\n  signedAtMs: number;\n  token?: string | null;\n  nonce?: string | null;\n  version?: \"v1\" | \"v2\";\n};\n\nexport function buildDeviceAuthPayload(params: DeviceAuthPayloadParams): string {\n  const version = params.version ?? (params.nonce ? \"v2\" : \"v1\");\n  const scopes = params.scopes.join(\",\");\n  const token = params.token ?? \"\";\n  const base = [\n    version,\n    params.deviceId,\n    params.clientId,\n    params.clientMode,\n    params.role,\n    scopes,\n    String(params.signedAtMs),\n    token,\n  ];\n  if (version === \"v2\") {\n    base.push(params.nonce ?? \"\");\n  }\n  return base.join(\"|\");\n}\n","import { generateUUID } from \"./uuid\";\nimport {\n  GATEWAY_CLIENT_MODES,\n  GATEWAY_CLIENT_NAMES,\n  type GatewayClientMode,\n  type GatewayClientName,\n} from \"../../../src/gateway/protocol/client-info.js\";\nimport { buildDeviceAuthPayload } from \"../../../src/gateway/device-auth.js\";\nimport { loadOrCreateDeviceIdentity, signDevicePayload } from \"./device-identity\";\nimport { clearDeviceAuthToken, loadDeviceAuthToken, storeDeviceAuthToken } from \"./device-auth\";\n\nexport type GatewayEventFrame = {\n  type: \"event\";\n  event: string;\n  payload?: unknown;\n  seq?: number;\n  stateVersion?: { presence: number; health: number };\n};\n\nexport type GatewayResponseFrame = {\n  type: \"res\";\n  id: string;\n  ok: boolean;\n  payload?: unknown;\n  error?: { code: string; message: string; details?: unknown };\n};\n\nexport type GatewayHelloOk = {\n  type: \"hello-ok\";\n  protocol: number;\n  features?: { methods?: string[]; events?: string[] };\n  snapshot?: unknown;\n  auth?: {\n    deviceToken?: string;\n    role?: string;\n    scopes?: string[];\n    issuedAtMs?: number;\n  };\n  policy?: { tickIntervalMs?: number };\n};\n\ntype Pending = {\n  resolve: (value: unknown) => void;\n  reject: (err: unknown) => void;\n};\n\nexport type GatewayBrowserClientOptions = {\n  url: string;\n  token?: string;\n  password?: string;\n  clientName?: GatewayClientName;\n  clientVersion?: string;\n  platform?: string;\n  mode?: GatewayClientMode;\n  instanceId?: string;\n  onHello?: (hello: GatewayHelloOk) => void;\n  onEvent?: (evt: GatewayEventFrame) => void;\n  onClose?: (info: { code: number; reason: string }) => void;\n  onGap?: (info: { expected: number; received: number }) => void;\n};\n\n// 4008 = application-defined code (browser rejects 1008 \"Policy Violation\")\nconst CONNECT_FAILED_CLOSE_CODE = 4008;\n\nexport class GatewayBrowserClient {\n  private ws: WebSocket | null = null;\n  private pending = new Map<string, Pending>();\n  private closed = false;\n  private lastSeq: number | null = null;\n  private connectNonce: string | null = null;\n  private connectSent = false;\n  private connectTimer: number | null = null;\n  private backoffMs = 800;\n\n  constructor(private opts: GatewayBrowserClientOptions) {}\n\n  start() {\n    this.closed = false;\n    this.connect();\n  }\n\n  stop() {\n    this.closed = true;\n    this.ws?.close();\n    this.ws = null;\n    this.flushPending(new Error(\"gateway client stopped\"));\n  }\n\n  get connected() {\n    return this.ws?.readyState === WebSocket.OPEN;\n  }\n\n  private connect() {\n    if (this.closed) return;\n    this.ws = new WebSocket(this.opts.url);\n    this.ws.onopen = () => this.queueConnect();\n    this.ws.onmessage = (ev) => this.handleMessage(String(ev.data ?? \"\"));\n    this.ws.onclose = (ev) => {\n      const reason = String(ev.reason ?? \"\");\n      this.ws = null;\n      this.flushPending(new Error(`gateway closed (${ev.code}): ${reason}`));\n      this.opts.onClose?.({ code: ev.code, reason });\n      this.scheduleReconnect();\n    };\n    this.ws.onerror = () => {\n      // ignored; close handler will fire\n    };\n  }\n\n  private scheduleReconnect() {\n    if (this.closed) return;\n    const delay = this.backoffMs;\n    this.backoffMs = Math.min(this.backoffMs * 1.7, 15_000);\n    window.setTimeout(() => this.connect(), delay);\n  }\n\n  private flushPending(err: Error) {\n    for (const [, p] of this.pending) p.reject(err);\n    this.pending.clear();\n  }\n\n  private async sendConnect() {\n    if (this.connectSent) return;\n    this.connectSent = true;\n    if (this.connectTimer !== null) {\n      window.clearTimeout(this.connectTimer);\n      this.connectTimer = null;\n    }\n\n    // crypto.subtle is only available in secure contexts (HTTPS, localhost).\n    // Over plain HTTP, we skip device identity and fall back to token-only auth.\n    // Gateways may reject this unless gateway.controlUi.allowInsecureAuth is enabled.\n    const isSecureContext = typeof crypto !== \"undefined\" && !!crypto.subtle;\n\n    const scopes = [\"operator.admin\", \"operator.approvals\", \"operator.pairing\"];\n    const role = \"operator\";\n    let deviceIdentity: Awaited<ReturnType<typeof loadOrCreateDeviceIdentity>> | null = null;\n    let canFallbackToShared = false;\n    let authToken = this.opts.token;\n\n    if (isSecureContext) {\n      deviceIdentity = await loadOrCreateDeviceIdentity();\n      const storedToken = loadDeviceAuthToken({\n        deviceId: deviceIdentity.deviceId,\n        role,\n      })?.token;\n      authToken = storedToken ?? this.opts.token;\n      canFallbackToShared = Boolean(storedToken && this.opts.token);\n    }\n    const auth =\n      authToken || this.opts.password\n        ? {\n            token: authToken,\n            password: this.opts.password,\n          }\n        : undefined;\n\n    let device:\n      | {\n          id: string;\n          publicKey: string;\n          signature: string;\n          signedAt: number;\n          nonce: string | undefined;\n        }\n      | undefined;\n\n    if (isSecureContext && deviceIdentity) {\n      const signedAtMs = Date.now();\n      const nonce = this.connectNonce ?? undefined;\n      const payload = buildDeviceAuthPayload({\n        deviceId: deviceIdentity.deviceId,\n        clientId: this.opts.clientName ?? GATEWAY_CLIENT_NAMES.CONTROL_UI,\n        clientMode: this.opts.mode ?? GATEWAY_CLIENT_MODES.WEBCHAT,\n        role,\n        scopes,\n        signedAtMs,\n        token: authToken ?? null,\n        nonce,\n      });\n      const signature = await signDevicePayload(deviceIdentity.privateKey, payload);\n      device = {\n        id: deviceIdentity.deviceId,\n        publicKey: deviceIdentity.publicKey,\n        signature,\n        signedAt: signedAtMs,\n        nonce,\n      };\n    }\n    const params = {\n      minProtocol: 3,\n      maxProtocol: 3,\n      client: {\n        id: this.opts.clientName ?? GATEWAY_CLIENT_NAMES.CONTROL_UI,\n        version: this.opts.clientVersion ?? \"dev\",\n        platform: this.opts.platform ?? navigator.platform ?? \"web\",\n        mode: this.opts.mode ?? GATEWAY_CLIENT_MODES.WEBCHAT,\n        instanceId: this.opts.instanceId,\n      },\n      role,\n      scopes,\n      device,\n      caps: [],\n      auth,\n      userAgent: navigator.userAgent,\n      locale: navigator.language,\n    };\n\n    void this.request<GatewayHelloOk>(\"connect\", params)\n      .then((hello) => {\n        if (hello?.auth?.deviceToken && deviceIdentity) {\n          storeDeviceAuthToken({\n            deviceId: deviceIdentity.deviceId,\n            role: hello.auth.role ?? role,\n            token: hello.auth.deviceToken,\n            scopes: hello.auth.scopes ?? [],\n          });\n        }\n        this.backoffMs = 800;\n        this.opts.onHello?.(hello);\n      })\n      .catch(() => {\n        if (canFallbackToShared && deviceIdentity) {\n          clearDeviceAuthToken({ deviceId: deviceIdentity.deviceId, role });\n        }\n        this.ws?.close(CONNECT_FAILED_CLOSE_CODE, \"connect failed\");\n      });\n  }\n\n  private handleMessage(raw: string) {\n    let parsed: unknown;\n    try {\n      parsed = JSON.parse(raw);\n    } catch {\n      return;\n    }\n\n    const frame = parsed as { type?: unknown };\n    if (frame.type === \"event\") {\n      const evt = parsed as GatewayEventFrame;\n      if (evt.event === \"connect.challenge\") {\n        const payload = evt.payload as { nonce?: unknown } | undefined;\n        const nonce = payload && typeof payload.nonce === \"string\" ? payload.nonce : null;\n        if (nonce) {\n          this.connectNonce = nonce;\n          void this.sendConnect();\n        }\n        return;\n      }\n      const seq = typeof evt.seq === \"number\" ? evt.seq : null;\n      if (seq !== null) {\n        if (this.lastSeq !== null && seq > this.lastSeq + 1) {\n          this.opts.onGap?.({ expected: this.lastSeq + 1, received: seq });\n        }\n        this.lastSeq = seq;\n      }\n      try {\n        this.opts.onEvent?.(evt);\n      } catch (err) {\n        console.error(\"[gateway] event handler error:\", err);\n      }\n      return;\n    }\n\n    if (frame.type === \"res\") {\n      const res = parsed as GatewayResponseFrame;\n      const pending = this.pending.get(res.id);\n      if (!pending) return;\n      this.pending.delete(res.id);\n      if (res.ok) pending.resolve(res.payload);\n      else pending.reject(new Error(res.error?.message ?? \"request failed\"));\n      return;\n    }\n  }\n\n  request<T = unknown>(method: string, params?: unknown): Promise<T> {\n    if (!this.ws || this.ws.readyState !== WebSocket.OPEN) {\n      return Promise.reject(new Error(\"gateway not connected\"));\n    }\n    const id = generateUUID();\n    const frame = { type: \"req\", id, method, params };\n    const p = new Promise<T>((resolve, reject) => {\n      this.pending.set(id, { resolve: (v) => resolve(v as T), reject });\n    });\n    this.ws.send(JSON.stringify(frame));\n    return p;\n  }\n\n  private queueConnect() {\n    this.connectNonce = null;\n    this.connectSent = false;\n    if (this.connectTimer !== null) window.clearTimeout(this.connectTimer);\n    this.connectTimer = window.setTimeout(() => {\n      void this.sendConnect();\n    }, 750);\n  }\n}\n","export type ExecApprovalRequestPayload = {\n  command: string;\n  cwd?: string | null;\n  host?: string | null;\n  security?: string | null;\n  ask?: string | null;\n  agentId?: string | null;\n  resolvedPath?: string | null;\n  sessionKey?: string | null;\n};\n\nexport type ExecApprovalRequest = {\n  id: string;\n  request: ExecApprovalRequestPayload;\n  createdAtMs: number;\n  expiresAtMs: number;\n};\n\nexport type ExecApprovalResolved = {\n  id: string;\n  decision?: string | null;\n  resolvedBy?: string | null;\n  ts?: number | null;\n};\n\nfunction isRecord(value: unknown): value is Record<string, unknown> {\n  return typeof value === \"object\" && value !== null;\n}\n\nexport function parseExecApprovalRequested(payload: unknown): ExecApprovalRequest | null {\n  if (!isRecord(payload)) return null;\n  const id = typeof payload.id === \"string\" ? payload.id.trim() : \"\";\n  const request = payload.request;\n  if (!id || !isRecord(request)) return null;\n  const command = typeof request.command === \"string\" ? request.command.trim() : \"\";\n  if (!command) return null;\n  const createdAtMs = typeof payload.createdAtMs === \"number\" ? payload.createdAtMs : 0;\n  const expiresAtMs = typeof payload.expiresAtMs === \"number\" ? payload.expiresAtMs : 0;\n  if (!createdAtMs || !expiresAtMs) return null;\n  return {\n    id,\n    request: {\n      command,\n      cwd: typeof request.cwd === \"string\" ? request.cwd : null,\n      host: typeof request.host === \"string\" ? request.host : null,\n      security: typeof request.security === \"string\" ? request.security : null,\n      ask: typeof request.ask === \"string\" ? request.ask : null,\n      agentId: typeof request.agentId === \"string\" ? request.agentId : null,\n      resolvedPath: typeof request.resolvedPath === \"string\" ? request.resolvedPath : null,\n      sessionKey: typeof request.sessionKey === \"string\" ? request.sessionKey : null,\n    },\n    createdAtMs,\n    expiresAtMs,\n  };\n}\n\nexport function parseExecApprovalResolved(payload: unknown): ExecApprovalResolved | null {\n  if (!isRecord(payload)) return null;\n  const id = typeof payload.id === \"string\" ? payload.id.trim() : \"\";\n  if (!id) return null;\n  return {\n    id,\n    decision: typeof payload.decision === \"string\" ? payload.decision : null,\n    resolvedBy: typeof payload.resolvedBy === \"string\" ? payload.resolvedBy : null,\n    ts: typeof payload.ts === \"number\" ? payload.ts : null,\n  };\n}\n\nexport function pruneExecApprovalQueue(queue: ExecApprovalRequest[]): ExecApprovalRequest[] {\n  const now = Date.now();\n  return queue.filter((entry) => entry.expiresAtMs > now);\n}\n\nexport function addExecApproval(\n  queue: ExecApprovalRequest[],\n  entry: ExecApprovalRequest,\n): ExecApprovalRequest[] {\n  const next = pruneExecApprovalQueue(queue).filter((item) => item.id !== entry.id);\n  next.push(entry);\n  return next;\n}\n\nexport function removeExecApproval(queue: ExecApprovalRequest[], id: string): ExecApprovalRequest[] {\n  return pruneExecApprovalQueue(queue).filter((entry) => entry.id !== id);\n}\n","const MAX_ASSISTANT_NAME = 50;\nconst MAX_ASSISTANT_AVATAR = 200;\n\nexport const DEFAULT_ASSISTANT_NAME = \"Assistant\";\nexport const DEFAULT_ASSISTANT_AVATAR = \"A\";\n\nexport type AssistantIdentity = {\n  agentId?: string | null;\n  name: string;\n  avatar: string | null;\n};\n\ndeclare global {\n  interface Window {\n    __CLAWDBOT_ASSISTANT_NAME__?: string;\n    __CLAWDBOT_ASSISTANT_AVATAR__?: string;\n  }\n}\n\nfunction coerceIdentityValue(value: string | undefined, maxLength: number): string | undefined {\n  if (typeof value !== \"string\") return undefined;\n  const trimmed = value.trim();\n  if (!trimmed) return undefined;\n  if (trimmed.length <= maxLength) return trimmed;\n  return trimmed.slice(0, maxLength);\n}\n\nexport function normalizeAssistantIdentity(\n  input?: Partial<AssistantIdentity> | null,\n): AssistantIdentity {\n  const name =\n    coerceIdentityValue(input?.name, MAX_ASSISTANT_NAME) ?? DEFAULT_ASSISTANT_NAME;\n  const avatar = coerceIdentityValue(input?.avatar ?? undefined, MAX_ASSISTANT_AVATAR) ?? null;\n  const agentId =\n    typeof input?.agentId === \"string\" && input.agentId.trim()\n      ? input.agentId.trim()\n      : null;\n  return { agentId, name, avatar };\n}\n\nexport function resolveInjectedAssistantIdentity(): AssistantIdentity {\n  if (typeof window === \"undefined\") {\n    return normalizeAssistantIdentity({});\n  }\n  return normalizeAssistantIdentity({\n    name: window.__CLAWDBOT_ASSISTANT_NAME__,\n    avatar: window.__CLAWDBOT_ASSISTANT_AVATAR__,\n  });\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport {\n  normalizeAssistantIdentity,\n  type AssistantIdentity,\n} from \"../assistant-identity\";\n\nexport type AssistantIdentityState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  sessionKey: string;\n  assistantName: string;\n  assistantAvatar: string | null;\n  assistantAgentId: string | null;\n};\n\nexport async function loadAssistantIdentity(\n  state: AssistantIdentityState,\n  opts?: { sessionKey?: string },\n) {\n  if (!state.client || !state.connected) return;\n  const sessionKey = opts?.sessionKey?.trim() || state.sessionKey.trim();\n  const params = sessionKey ? { sessionKey } : {};\n  try {\n    const res = (await state.client.request(\"agent.identity.get\", params)) as\n      | Partial<AssistantIdentity>\n      | undefined;\n    if (!res) return;\n    const normalized = normalizeAssistantIdentity(res);\n    state.assistantName = normalized.name;\n    state.assistantAvatar = normalized.avatar;\n    state.assistantAgentId = normalized.agentId ?? null;\n  } catch {\n    // Ignore errors; keep last known identity.\n  }\n}\n","import { loadChatHistory } from \"./controllers/chat\";\nimport { loadDevices } from \"./controllers/devices\";\nimport { loadNodes } from \"./controllers/nodes\";\nimport { loadAgents } from \"./controllers/agents\";\nimport type { GatewayEventFrame, GatewayHelloOk } from \"./gateway\";\nimport { GatewayBrowserClient } from \"./gateway\";\nimport type { EventLogEntry } from \"./app-events\";\nimport type { AgentsListResult, PresenceEntry, HealthSnapshot, StatusSummary } from \"./types\";\nimport type { Tab } from \"./navigation\";\nimport type { UiSettings } from \"./storage\";\nimport { handleAgentEvent, resetToolStream, type AgentEventPayload } from \"./app-tool-stream\";\nimport { flushChatQueueForEvent } from \"./app-chat\";\nimport {\n  applySettings,\n  loadCron,\n  refreshActiveTab,\n  setLastActiveSessionKey,\n} from \"./app-settings\";\nimport { handleChatEvent, type ChatEventPayload } from \"./controllers/chat\";\nimport {\n  addExecApproval,\n  parseExecApprovalRequested,\n  parseExecApprovalResolved,\n  removeExecApproval,\n} from \"./controllers/exec-approval\";\nimport type { ClawdbotApp } from \"./app\";\nimport type { ExecApprovalRequest } from \"./controllers/exec-approval\";\nimport { loadAssistantIdentity } from \"./controllers/assistant-identity\";\n\ntype GatewayHost = {\n  settings: UiSettings;\n  password: string;\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  hello: GatewayHelloOk | null;\n  lastError: string | null;\n  onboarding?: boolean;\n  eventLogBuffer: EventLogEntry[];\n  eventLog: EventLogEntry[];\n  tab: Tab;\n  presenceEntries: PresenceEntry[];\n  presenceError: string | null;\n  presenceStatus: StatusSummary | null;\n  agentsLoading: boolean;\n  agentsList: AgentsListResult | null;\n  agentsError: string | null;\n  debugHealth: HealthSnapshot | null;\n  assistantName: string;\n  assistantAvatar: string | null;\n  assistantAgentId: string | null;\n  sessionKey: string;\n  chatRunId: string | null;\n  execApprovalQueue: ExecApprovalRequest[];\n  execApprovalError: string | null;\n};\n\ntype SessionDefaultsSnapshot = {\n  defaultAgentId?: string;\n  mainKey?: string;\n  mainSessionKey?: string;\n  scope?: string;\n};\n\nfunction normalizeSessionKeyForDefaults(\n  value: string | undefined,\n  defaults: SessionDefaultsSnapshot,\n): string {\n  const raw = (value ?? \"\").trim();\n  const mainSessionKey = defaults.mainSessionKey?.trim();\n  if (!mainSessionKey) return raw;\n  if (!raw) return mainSessionKey;\n  const mainKey = defaults.mainKey?.trim() || \"main\";\n  const defaultAgentId = defaults.defaultAgentId?.trim();\n  const isAlias =\n    raw === \"main\" ||\n    raw === mainKey ||\n    (defaultAgentId &&\n      (raw === `agent:${defaultAgentId}:main` ||\n        raw === `agent:${defaultAgentId}:${mainKey}`));\n  return isAlias ? mainSessionKey : raw;\n}\n\nfunction applySessionDefaults(host: GatewayHost, defaults?: SessionDefaultsSnapshot) {\n  if (!defaults?.mainSessionKey) return;\n  const resolvedSessionKey = normalizeSessionKeyForDefaults(host.sessionKey, defaults);\n  const resolvedSettingsSessionKey = normalizeSessionKeyForDefaults(\n    host.settings.sessionKey,\n    defaults,\n  );\n  const resolvedLastActiveSessionKey = normalizeSessionKeyForDefaults(\n    host.settings.lastActiveSessionKey,\n    defaults,\n  );\n  const nextSessionKey = resolvedSessionKey || resolvedSettingsSessionKey || host.sessionKey;\n  const nextSettings = {\n    ...host.settings,\n    sessionKey: resolvedSettingsSessionKey || nextSessionKey,\n    lastActiveSessionKey: resolvedLastActiveSessionKey || nextSessionKey,\n  };\n  const shouldUpdateSettings =\n    nextSettings.sessionKey !== host.settings.sessionKey ||\n    nextSettings.lastActiveSessionKey !== host.settings.lastActiveSessionKey;\n  if (nextSessionKey !== host.sessionKey) {\n    host.sessionKey = nextSessionKey;\n  }\n  if (shouldUpdateSettings) {\n    applySettings(host as unknown as Parameters<typeof applySettings>[0], nextSettings);\n  }\n}\n\nexport function connectGateway(host: GatewayHost) {\n  host.lastError = null;\n  host.hello = null;\n  host.connected = false;\n  host.execApprovalQueue = [];\n  host.execApprovalError = null;\n\n  host.client?.stop();\n  host.client = new GatewayBrowserClient({\n    url: host.settings.gatewayUrl,\n    token: host.settings.token.trim() ? host.settings.token : undefined,\n    password: host.password.trim() ? host.password : undefined,\n    clientName: \"clawdbot-control-ui\",\n    mode: \"webchat\",\n    onHello: (hello) => {\n      host.connected = true;\n      host.lastError = null;\n      host.hello = hello;\n      applySnapshot(host, hello);\n      void loadAssistantIdentity(host as unknown as ClawdbotApp);\n      void loadAgents(host as unknown as ClawdbotApp);\n      void loadNodes(host as unknown as ClawdbotApp, { quiet: true });\n      void loadDevices(host as unknown as ClawdbotApp, { quiet: true });\n      void refreshActiveTab(host as unknown as Parameters<typeof refreshActiveTab>[0]);\n    },\n    onClose: ({ code, reason }) => {\n      host.connected = false;\n      // Code 1012 = Service Restart (expected during config saves, don't show as error)\n      if (code !== 1012) {\n        host.lastError = `disconnected (${code}): ${reason || \"no reason\"}`;\n      }\n    },\n    onEvent: (evt) => handleGatewayEvent(host, evt),\n    onGap: ({ expected, received }) => {\n      host.lastError = `event gap detected (expected seq ${expected}, got ${received}); refresh recommended`;\n    },\n  });\n  host.client.start();\n}\n\nexport function handleGatewayEvent(host: GatewayHost, evt: GatewayEventFrame) {\n  try {\n    handleGatewayEventUnsafe(host, evt);\n  } catch (err) {\n    console.error(\"[gateway] handleGatewayEvent error:\", evt.event, err);\n  }\n}\n\nfunction handleGatewayEventUnsafe(host: GatewayHost, evt: GatewayEventFrame) {\n  host.eventLogBuffer = [\n    { ts: Date.now(), event: evt.event, payload: evt.payload },\n    ...host.eventLogBuffer,\n  ].slice(0, 250);\n  if (host.tab === \"debug\") {\n    host.eventLog = host.eventLogBuffer;\n  }\n\n  if (evt.event === \"agent\") {\n    if (host.onboarding) return;\n    handleAgentEvent(\n      host as unknown as Parameters<typeof handleAgentEvent>[0],\n      evt.payload as AgentEventPayload | undefined,\n    );\n    return;\n  }\n\n  if (evt.event === \"chat\") {\n    const payload = evt.payload as ChatEventPayload | undefined;\n    if (payload?.sessionKey) {\n      setLastActiveSessionKey(\n        host as unknown as Parameters<typeof setLastActiveSessionKey>[0],\n        payload.sessionKey,\n      );\n    }\n    const state = handleChatEvent(host as unknown as ClawdbotApp, payload);\n    if (state === \"final\" || state === \"error\" || state === \"aborted\") {\n      resetToolStream(host as unknown as Parameters<typeof resetToolStream>[0]);\n      void flushChatQueueForEvent(\n        host as unknown as Parameters<typeof flushChatQueueForEvent>[0],\n      );\n    }\n    if (state === \"final\") void loadChatHistory(host as unknown as ClawdbotApp);\n    return;\n  }\n\n  if (evt.event === \"presence\") {\n    const payload = evt.payload as { presence?: PresenceEntry[] } | undefined;\n    if (payload?.presence && Array.isArray(payload.presence)) {\n      host.presenceEntries = payload.presence;\n      host.presenceError = null;\n      host.presenceStatus = null;\n    }\n    return;\n  }\n\n  if (evt.event === \"cron\" && host.tab === \"cron\") {\n    void loadCron(host as unknown as Parameters<typeof loadCron>[0]);\n  }\n\n  if (evt.event === \"device.pair.requested\" || evt.event === \"device.pair.resolved\") {\n    void loadDevices(host as unknown as ClawdbotApp, { quiet: true });\n  }\n\n  if (evt.event === \"exec.approval.requested\") {\n    const entry = parseExecApprovalRequested(evt.payload);\n    if (entry) {\n      host.execApprovalQueue = addExecApproval(host.execApprovalQueue, entry);\n      host.execApprovalError = null;\n      const delay = Math.max(0, entry.expiresAtMs - Date.now() + 500);\n      window.setTimeout(() => {\n        host.execApprovalQueue = removeExecApproval(host.execApprovalQueue, entry.id);\n      }, delay);\n    }\n    return;\n  }\n\n  if (evt.event === \"exec.approval.resolved\") {\n    const resolved = parseExecApprovalResolved(evt.payload);\n    if (resolved) {\n      host.execApprovalQueue = removeExecApproval(host.execApprovalQueue, resolved.id);\n    }\n  }\n}\n\nexport function applySnapshot(host: GatewayHost, hello: GatewayHelloOk) {\n  const snapshot = hello.snapshot as\n    | {\n        presence?: PresenceEntry[];\n        health?: HealthSnapshot;\n        sessionDefaults?: SessionDefaultsSnapshot;\n      }\n    | undefined;\n  if (snapshot?.presence && Array.isArray(snapshot.presence)) {\n    host.presenceEntries = snapshot.presence;\n  }\n  if (snapshot?.health) {\n    host.debugHealth = snapshot.health;\n  }\n  if (snapshot?.sessionDefaults) {\n    applySessionDefaults(host, snapshot.sessionDefaults);\n  }\n}\n","import type { Tab } from \"./navigation\";\nimport { connectGateway } from \"./app-gateway\";\nimport {\n  applySettingsFromUrl,\n  attachThemeListener,\n  detachThemeListener,\n  inferBasePath,\n  syncTabWithLocation,\n  syncThemeWithSettings,\n} from \"./app-settings\";\nimport { observeTopbar, scheduleChatScroll, scheduleLogsScroll } from \"./app-scroll\";\nimport {\n  startLogsPolling,\n  startNodesPolling,\n  stopLogsPolling,\n  stopNodesPolling,\n  startDebugPolling,\n  stopDebugPolling,\n} from \"./app-polling\";\n\ntype LifecycleHost = {\n  basePath: string;\n  tab: Tab;\n  chatHasAutoScrolled: boolean;\n  chatLoading: boolean;\n  chatMessages: unknown[];\n  chatToolMessages: unknown[];\n  chatStream: string;\n  logsAutoFollow: boolean;\n  logsAtBottom: boolean;\n  logsEntries: unknown[];\n  popStateHandler: () => void;\n  topbarObserver: ResizeObserver | null;\n};\n\nexport function handleConnected(host: LifecycleHost) {\n  host.basePath = inferBasePath();\n  syncTabWithLocation(\n    host as unknown as Parameters<typeof syncTabWithLocation>[0],\n    true,\n  );\n  syncThemeWithSettings(\n    host as unknown as Parameters<typeof syncThemeWithSettings>[0],\n  );\n  attachThemeListener(\n    host as unknown as Parameters<typeof attachThemeListener>[0],\n  );\n  window.addEventListener(\"popstate\", host.popStateHandler);\n  applySettingsFromUrl(\n    host as unknown as Parameters<typeof applySettingsFromUrl>[0],\n  );\n  connectGateway(host as unknown as Parameters<typeof connectGateway>[0]);\n  startNodesPolling(host as unknown as Parameters<typeof startNodesPolling>[0]);\n  if (host.tab === \"logs\") {\n    startLogsPolling(host as unknown as Parameters<typeof startLogsPolling>[0]);\n  }\n  if (host.tab === \"debug\") {\n    startDebugPolling(host as unknown as Parameters<typeof startDebugPolling>[0]);\n  }\n}\n\nexport function handleFirstUpdated(host: LifecycleHost) {\n  observeTopbar(host as unknown as Parameters<typeof observeTopbar>[0]);\n}\n\nexport function handleDisconnected(host: LifecycleHost) {\n  window.removeEventListener(\"popstate\", host.popStateHandler);\n  stopNodesPolling(host as unknown as Parameters<typeof stopNodesPolling>[0]);\n  stopLogsPolling(host as unknown as Parameters<typeof stopLogsPolling>[0]);\n  stopDebugPolling(host as unknown as Parameters<typeof stopDebugPolling>[0]);\n  detachThemeListener(\n    host as unknown as Parameters<typeof detachThemeListener>[0],\n  );\n  host.topbarObserver?.disconnect();\n  host.topbarObserver = null;\n}\n\nexport function handleUpdated(\n  host: LifecycleHost,\n  changed: Map<PropertyKey, unknown>,\n) {\n  if (\n    host.tab === \"chat\" &&\n    (changed.has(\"chatMessages\") ||\n      changed.has(\"chatToolMessages\") ||\n      changed.has(\"chatStream\") ||\n      changed.has(\"chatLoading\") ||\n      changed.has(\"tab\"))\n  ) {\n    const forcedByTab = changed.has(\"tab\");\n    const forcedByLoad =\n      changed.has(\"chatLoading\") &&\n      changed.get(\"chatLoading\") === true &&\n      host.chatLoading === false;\n    scheduleChatScroll(\n      host as unknown as Parameters<typeof scheduleChatScroll>[0],\n      forcedByTab || forcedByLoad || !host.chatHasAutoScrolled,\n    );\n  }\n  if (\n    host.tab === \"logs\" &&\n    (changed.has(\"logsEntries\") || changed.has(\"logsAutoFollow\") || changed.has(\"tab\"))\n  ) {\n    if (host.logsAutoFollow && host.logsAtBottom) {\n      scheduleLogsScroll(\n        host as unknown as Parameters<typeof scheduleLogsScroll>[0],\n        changed.has(\"tab\") || changed.has(\"logsAutoFollow\"),\n      );\n    }\n  }\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","import{_$LH as o}from\"./lit-html.js\";\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{I:t}=o,i=o=>o,n=o=>null===o||\"object\"!=typeof o&&\"function\"!=typeof o,e={HTML:1,SVG:2,MATHML:3},l=(o,t)=>void 0===t?void 0!==o?._$litType$:o?._$litType$===t,d=o=>null!=o?._$litType$?.h,c=o=>void 0!==o?._$litDirective$,f=o=>o?._$litDirective$,r=o=>void 0===o.strings,s=()=>document.createComment(\"\"),v=(o,n,e)=>{const l=o._$AA.parentNode,d=void 0===n?o._$AB:n._$AA;if(void 0===e){const i=l.insertBefore(s(),d),n=l.insertBefore(s(),d);e=new t(i,n,o,o.options)}else{const t=e._$AB.nextSibling,n=e._$AM,c=n!==o;if(c){let t;e._$AQ?.(o),e._$AM=o,void 0!==e._$AP&&(t=o._$AU)!==n._$AU&&e._$AP(t)}if(t!==d||c){let o=e._$AA;for(;o!==t;){const t=i(o).nextSibling;i(l).insertBefore(o,d),o=t}}}return e},u=(o,t,i=o)=>(o._$AI(t,i),o),m={},p=(o,t=m)=>o._$AH=t,M=o=>o._$AH,h=o=>{o._$AR(),o._$AA.remove()},j=o=>{o._$AR()};export{e as TemplateResultType,j as clearPart,M as getCommittedValue,f as getDirectiveClass,v as insertPart,d as isCompiledTemplateResult,c as isDirectiveResult,n as isPrimitive,r as isSingleExpression,l as isTemplateResult,h as removePart,u as setChildPartValue,p as setCommittedValue};\n//# sourceMappingURL=directive-helpers.js.map\n","import{noChange as e}from\"../lit-html.js\";import{directive as s,Directive as t,PartType as r}from\"../directive.js\";import{getCommittedValue as l,setChildPartValue as o,insertPart as i,removePart as n,setCommittedValue as f}from\"../directive-helpers.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst u=(e,s,t)=>{const r=new Map;for(let l=s;l<=t;l++)r.set(e[l],l);return r},c=s(class extends t{constructor(e){if(super(e),e.type!==r.CHILD)throw Error(\"repeat() can only be used in text expressions\")}dt(e,s,t){let r;void 0===t?t=s:void 0!==s&&(r=s);const l=[],o=[];let i=0;for(const s of e)l[i]=r?r(s,i):i,o[i]=t(s,i),i++;return{values:o,keys:l}}render(e,s,t){return this.dt(e,s,t).values}update(s,[t,r,c]){const d=l(s),{values:p,keys:a}=this.dt(t,r,c);if(!Array.isArray(d))return this.ut=a,p;const h=this.ut??=[],v=[];let m,y,x=0,j=d.length-1,k=0,w=p.length-1;for(;x<=j&&k<=w;)if(null===d[x])x++;else if(null===d[j])j--;else if(h[x]===a[k])v[k]=o(d[x],p[k]),x++,k++;else if(h[j]===a[w])v[w]=o(d[j],p[w]),j--,w--;else if(h[x]===a[w])v[w]=o(d[x],p[w]),i(s,v[w+1],d[x]),x++,w--;else if(h[j]===a[k])v[k]=o(d[j],p[k]),i(s,d[x],d[j]),j--,k++;else if(void 0===m&&(m=u(a,k,w),y=u(h,x,j)),m.has(h[x]))if(m.has(h[j])){const e=y.get(a[k]),t=void 0!==e?d[e]:null;if(null===t){const e=i(s,d[x]);o(e,p[k]),v[k]=e}else v[k]=o(t,p[k]),i(s,d[x],t),d[e]=null;k++}else n(d[j]),j--;else n(d[x]),x++;for(;k<=w;){const e=i(s,v[w+1]);o(e,p[k]),v[k++]=e}for(;x<=j;){const e=d[x++];null!==e&&n(e)}return this.ut=a,f(s,v),e}});export{c as repeat};\n//# sourceMappingURL=repeat.js.map\n","import { html, type TemplateResult } from \"lit\";\n\n// Lucide-style SVG icons\n// All icons use currentColor for stroke\n\nexport const icons = {\n  // Navigation icons\n  messageSquare: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\" />\n    </svg>\n  `,\n  barChart: html`\n    <svg viewBox=\"0 0 24 24\">\n      <line x1=\"12\" x2=\"12\" y1=\"20\" y2=\"10\" />\n      <line x1=\"18\" x2=\"18\" y1=\"20\" y2=\"4\" />\n      <line x1=\"6\" x2=\"6\" y1=\"20\" y2=\"16\" />\n    </svg>\n  `,\n  link: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\" />\n      <path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\" />\n    </svg>\n  `,\n  radio: html`\n    <svg viewBox=\"0 0 24 24\">\n      <circle cx=\"12\" cy=\"12\" r=\"2\" />\n      <path\n        d=\"M16.24 7.76a6 6 0 0 1 0 8.49m-8.48-.01a6 6 0 0 1 0-8.49m11.31-2.82a10 10 0 0 1 0 14.14m-14.14 0a10 10 0 0 1 0-14.14\"\n      />\n    </svg>\n  `,\n  fileText: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\" />\n      <polyline points=\"14 2 14 8 20 8\" />\n      <line x1=\"16\" x2=\"8\" y1=\"13\" y2=\"13\" />\n      <line x1=\"16\" x2=\"8\" y1=\"17\" y2=\"17\" />\n      <line x1=\"10\" x2=\"8\" y1=\"9\" y2=\"9\" />\n    </svg>\n  `,\n  zap: html`\n    <svg viewBox=\"0 0 24 24\"><polygon points=\"13 2 3 14 12 14 11 22 21 10 12 10 13 2\" /></svg>\n  `,\n  monitor: html`\n    <svg viewBox=\"0 0 24 24\">\n      <rect width=\"20\" height=\"14\" x=\"2\" y=\"3\" rx=\"2\" />\n      <line x1=\"8\" x2=\"16\" y1=\"21\" y2=\"21\" />\n      <line x1=\"12\" x2=\"12\" y1=\"17\" y2=\"21\" />\n    </svg>\n  `,\n  settings: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z\"\n      />\n      <circle cx=\"12\" cy=\"12\" r=\"3\" />\n    </svg>\n  `,\n  bug: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"m8 2 1.88 1.88\" />\n      <path d=\"M14.12 3.88 16 2\" />\n      <path d=\"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1\" />\n      <path d=\"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6\" />\n      <path d=\"M12 20v-9\" />\n      <path d=\"M6.53 9C4.6 8.8 3 7.1 3 5\" />\n      <path d=\"M6 13H2\" />\n      <path d=\"M3 21c0-2.1 1.7-3.9 3.8-4\" />\n      <path d=\"M20.97 5c0 2.1-1.6 3.8-3.5 4\" />\n      <path d=\"M22 13h-4\" />\n      <path d=\"M17.2 17c2.1.1 3.8 1.9 3.8 4\" />\n    </svg>\n  `,\n  scrollText: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M8 21h12a2 2 0 0 0 2-2v-2H10v2a2 2 0 1 1-4 0V5a2 2 0 1 0-4 0v3h4\" />\n      <path d=\"M19 17V5a2 2 0 0 0-2-2H4\" />\n      <path d=\"M15 8h-5\" />\n      <path d=\"M15 12h-5\" />\n    </svg>\n  `,\n  folder: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z\"\n      />\n    </svg>\n  `,\n\n  // UI icons\n  menu: html`\n    <svg viewBox=\"0 0 24 24\">\n      <line x1=\"4\" x2=\"20\" y1=\"12\" y2=\"12\" />\n      <line x1=\"4\" x2=\"20\" y1=\"6\" y2=\"6\" />\n      <line x1=\"4\" x2=\"20\" y1=\"18\" y2=\"18\" />\n    </svg>\n  `,\n  x: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M18 6 6 18\" />\n      <path d=\"m6 6 12 12\" />\n    </svg>\n  `,\n  check: html`\n    <svg viewBox=\"0 0 24 24\"><path d=\"M20 6 9 17l-5-5\" /></svg>\n  `,\n  arrowDown: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M12 5v14\" />\n      <path d=\"m19 12-7 7-7-7\" />\n    </svg>\n  `,\n  copy: html`\n    <svg viewBox=\"0 0 24 24\">\n      <rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\" />\n      <path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\" />\n    </svg>\n  `,\n  search: html`\n    <svg viewBox=\"0 0 24 24\">\n      <circle cx=\"11\" cy=\"11\" r=\"8\" />\n      <path d=\"m21 21-4.3-4.3\" />\n    </svg>\n  `,\n  brain: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z\" />\n      <path d=\"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z\" />\n      <path d=\"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4\" />\n      <path d=\"M17.599 6.5a3 3 0 0 0 .399-1.375\" />\n      <path d=\"M6.003 5.125A3 3 0 0 0 6.401 6.5\" />\n      <path d=\"M3.477 10.896a4 4 0 0 1 .585-.396\" />\n      <path d=\"M19.938 10.5a4 4 0 0 1 .585.396\" />\n      <path d=\"M6 18a4 4 0 0 1-1.967-.516\" />\n      <path d=\"M19.967 17.484A4 4 0 0 1 18 18\" />\n    </svg>\n  `,\n  book: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20\" />\n    </svg>\n  `,\n  loader: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M12 2v4\" />\n      <path d=\"m16.2 7.8 2.9-2.9\" />\n      <path d=\"M18 12h4\" />\n      <path d=\"m16.2 16.2 2.9 2.9\" />\n      <path d=\"M12 18v4\" />\n      <path d=\"m4.9 19.1 2.9-2.9\" />\n      <path d=\"M2 12h4\" />\n      <path d=\"m4.9 4.9 2.9 2.9\" />\n    </svg>\n  `,\n\n  // Tool icons\n  wrench: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"\n      />\n    </svg>\n  `,\n  fileCode: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z\" />\n      <polyline points=\"14 2 14 8 20 8\" />\n      <path d=\"m10 13-2 2 2 2\" />\n      <path d=\"m14 17 2-2-2-2\" />\n    </svg>\n  `,\n  edit: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" />\n      <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" />\n    </svg>\n  `,\n  penLine: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M12 20h9\" />\n      <path d=\"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z\" />\n    </svg>\n  `,\n  paperclip: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48\"\n      />\n    </svg>\n  `,\n  globe: html`\n    <svg viewBox=\"0 0 24 24\">\n      <circle cx=\"12\" cy=\"12\" r=\"10\" />\n      <path d=\"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20\" />\n      <path d=\"M2 12h20\" />\n    </svg>\n  `,\n  image: html`\n    <svg viewBox=\"0 0 24 24\">\n      <rect width=\"18\" height=\"18\" x=\"3\" y=\"3\" rx=\"2\" ry=\"2\" />\n      <circle cx=\"9\" cy=\"9\" r=\"2\" />\n      <path d=\"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21\" />\n    </svg>\n  `,\n  smartphone: html`\n    <svg viewBox=\"0 0 24 24\">\n      <rect width=\"14\" height=\"20\" x=\"5\" y=\"2\" rx=\"2\" ry=\"2\" />\n      <path d=\"M12 18h.01\" />\n    </svg>\n  `,\n  plug: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M12 22v-5\" />\n      <path d=\"M9 8V2\" />\n      <path d=\"M15 8V2\" />\n      <path d=\"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z\" />\n    </svg>\n  `,\n  circle: html`\n    <svg viewBox=\"0 0 24 24\"><circle cx=\"12\" cy=\"12\" r=\"10\" /></svg>\n  `,\n  puzzle: html`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"M19.439 7.85c-.049.322.059.648.289.878l1.568 1.568c.47.47.706 1.087.706 1.704s-.235 1.233-.706 1.704l-1.611 1.611a.98.98 0 0 1-.837.276c-.47-.07-.802-.48-.968-.925a2.501 2.501 0 1 0-3.214 3.214c.446.166.855.497.925.968a.979.979 0 0 1-.276.837l-1.61 1.61a2.404 2.404 0 0 1-1.705.707 2.402 2.402 0 0 1-1.704-.706l-1.568-1.568a1.026 1.026 0 0 0-.877-.29c-.493.074-.84.504-1.02.968a2.5 2.5 0 1 1-3.237-3.237c.464-.18.894-.527.967-1.02a1.026 1.026 0 0 0-.289-.877l-1.568-1.568A2.402 2.402 0 0 1 1.998 12c0-.617.236-1.234.706-1.704L4.23 8.77c.24-.24.581-.353.917-.303.515.076.874.54 1.02 1.02a2.5 2.5 0 1 0 3.237-3.237c-.48-.146-.944-.505-1.02-1.02a.98.98 0 0 1 .303-.917l1.526-1.526A2.402 2.402 0 0 1 11.998 2c.617 0 1.234.236 1.704.706l1.568 1.568c.23.23.556.338.877.29.493-.074.84-.504 1.02-.968a2.5 2.5 0 1 1 3.236 3.236c-.464.18-.894.527-.967 1.02Z\"\n      />\n    </svg>\n  `,\n} as const;\n\nexport type IconName = keyof typeof icons;\n\nexport function icon(name: IconName): TemplateResult {\n  return icons[name];\n}\n\nexport function renderIcon(name: IconName, className = \"nav-item__icon\"): TemplateResult {\n  return html`<span class=${className} aria-hidden=\"true\">${icons[name]}</span>`;\n}\n\n// Legacy function for compatibility\nexport function renderEmojiIcon(\n  iconContent: string | TemplateResult,\n  className: string,\n): TemplateResult {\n  return html`<span class=${className} aria-hidden=\"true\">${iconContent}</span>`;\n}\n\nexport function setEmojiIcon(target: HTMLElement | null, icon: string): void {\n  if (!target) {\n    return;\n  }\n  target.textContent = icon;\n}\n","import { html } from \"lit\";\nimport { repeat } from \"lit/directives/repeat.js\";\nimport type { AppViewState } from \"./app-view-state.ts\";\nimport type { ThemeTransitionContext } from \"./theme-transition.ts\";\nimport type { ThemeMode } from \"./theme.ts\";\nimport type { SessionsListResult } from \"./types.ts\";\nimport { refreshChat } from \"./app-chat.ts\";\nimport { syncUrlWithSessionKey } from \"./app-settings.ts\";\nimport { OpenClawApp } from \"./app.ts\";\nimport { ChatState, loadChatHistory } from \"./controllers/chat.ts\";\nimport { icons } from \"./icons.ts\";\nimport { iconForTab, pathForTab, titleForTab, type Tab } from \"./navigation.ts\";\n\nexport function renderTab(state: AppViewState, tab: Tab) {\n  const href = pathForTab(tab, state.basePath);\n  return html`\n    <a\n      href=${href}\n      class=\"nav-item ${state.tab === tab ? \"active\" : \"\"}\"\n      @click=${(event: MouseEvent) => {\n        if (\n          event.defaultPrevented ||\n          event.button !== 0 ||\n          event.metaKey ||\n          event.ctrlKey ||\n          event.shiftKey ||\n          event.altKey\n        ) {\n          return;\n        }\n        event.preventDefault();\n        state.setTab(tab);\n      }}\n      title=${titleForTab(tab)}\n    >\n      <span class=\"nav-item__icon\" aria-hidden=\"true\">${icons[iconForTab(tab)]}</span>\n      <span class=\"nav-item__text\">${titleForTab(tab)}</span>\n    </a>\n  `;\n}\n\nexport function renderChatControls(state: AppViewState) {\n  const mainSessionKey = resolveMainSessionKey(state.hello, state.sessionsResult);\n  const sessionOptions = resolveSessionOptions(\n    state.sessionKey,\n    state.sessionsResult,\n    mainSessionKey,\n  );\n  const disableThinkingToggle = state.onboarding;\n  const disableFocusToggle = state.onboarding;\n  const showThinking = state.onboarding ? false : state.settings.chatShowThinking;\n  const focusActive = state.onboarding ? true : state.settings.chatFocusMode;\n  // Refresh icon\n  const refreshIcon = html`\n    <svg\n      width=\"18\"\n      height=\"18\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      stroke-width=\"2\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    >\n      <path d=\"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8\"></path>\n      <path d=\"M21 3v5h-5\"></path>\n    </svg>\n  `;\n  const focusIcon = html`\n    <svg\n      width=\"18\"\n      height=\"18\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      stroke-width=\"2\"\n      stroke-linecap=\"round\"\n      stroke-linejoin=\"round\"\n    >\n      <path d=\"M4 7V4h3\"></path>\n      <path d=\"M20 7V4h-3\"></path>\n      <path d=\"M4 17v3h3\"></path>\n      <path d=\"M20 17v3h-3\"></path>\n      <circle cx=\"12\" cy=\"12\" r=\"3\"></circle>\n    </svg>\n  `;\n  return html`\n    <div class=\"chat-controls\">\n      <label class=\"field chat-controls__session\">\n        <select\n          .value=${state.sessionKey}\n          ?disabled=${!state.connected}\n          @change=${(e: Event) => {\n            const next = (e.target as HTMLSelectElement).value;\n            state.sessionKey = next;\n            state.chatMessage = \"\";\n            state.chatStream = null;\n            (state as unknown as OpenClawApp).chatStreamStartedAt = null;\n            state.chatRunId = null;\n            (state as unknown as OpenClawApp).resetToolStream();\n            (state as unknown as OpenClawApp).resetChatScroll();\n            state.applySettings({\n              ...state.settings,\n              sessionKey: next,\n              lastActiveSessionKey: next,\n            });\n            void state.loadAssistantIdentity();\n            syncUrlWithSessionKey(\n              state as unknown as Parameters<typeof syncUrlWithSessionKey>[0],\n              next,\n              true,\n            );\n            void loadChatHistory(state as unknown as ChatState);\n          }}\n        >\n          ${repeat(\n            sessionOptions,\n            (entry) => entry.key,\n            (entry) =>\n              html`<option value=${entry.key}>\n                ${entry.displayName ?? entry.key}\n              </option>`,\n          )}\n        </select>\n      </label>\n      <button\n        class=\"btn btn--sm btn--icon\"\n        ?disabled=${state.chatLoading || !state.connected}\n        @click=${() => {\n          (state as unknown as OpenClawApp).resetToolStream();\n          void refreshChat(state as unknown as Parameters<typeof refreshChat>[0]);\n        }}\n        title=\"刷新对话数据\"\n      >\n        ${refreshIcon}\n      </button>\n      <span class=\"chat-controls__separator\">|</span>\n      <button\n        class=\"btn btn--sm btn--icon ${showThinking ? \"active\" : \"\"}\"\n        ?disabled=${disableThinkingToggle}\n        @click=${() => {\n          if (disableThinkingToggle) {\n            return;\n          }\n          state.applySettings({\n            ...state.settings,\n            chatShowThinking: !state.settings.chatShowThinking,\n          });\n        }}\n        aria-pressed=${showThinking}\n        title=${\n          disableThinkingToggle\n            ? \"引导期间已禁用\"\n            : \"切换助手思考/工作输出\"\n        }\n      >\n        ${icons.brain}\n      </button>\n      <button\n        class=\"btn btn--sm btn--icon ${focusActive ? \"active\" : \"\"}\"\n        ?disabled=${disableFocusToggle}\n        @click=${() => {\n          if (disableFocusToggle) {\n            return;\n          }\n          state.applySettings({\n            ...state.settings,\n            chatFocusMode: !state.settings.chatFocusMode,\n          });\n        }}\n        aria-pressed=${focusActive}\n        title=${\n          disableFocusToggle\n            ? \"引导期间已禁用\"\n            : \"切换专注模式（隐藏侧栏 + 页面标题）\"\n        }\n      >\n        ${focusIcon}\n      </button>\n    </div>\n  `;\n}\n\ntype SessionDefaultsSnapshot = {\n  mainSessionKey?: string;\n  mainKey?: string;\n};\n\nfunction resolveMainSessionKey(\n  hello: AppViewState[\"hello\"],\n  sessions: SessionsListResult | null,\n): string | null {\n  const snapshot = hello?.snapshot as { sessionDefaults?: SessionDefaultsSnapshot } | undefined;\n  const mainSessionKey = snapshot?.sessionDefaults?.mainSessionKey?.trim();\n  if (mainSessionKey) {\n    return mainSessionKey;\n  }\n  const mainKey = snapshot?.sessionDefaults?.mainKey?.trim();\n  if (mainKey) {\n    return mainKey;\n  }\n  if (sessions?.sessions?.some((row) => row.key === \"main\")) {\n    return \"main\";\n  }\n  return null;\n}\n\nfunction resolveSessionDisplayName(key: string, row?: SessionsListResult[\"sessions\"][number]) {\n  const label = row?.label?.trim();\n  if (label) {\n    return `${label} (${key})`;\n  }\n  const displayName = row?.displayName?.trim();\n  if (displayName) {\n    return displayName;\n  }\n  return key;\n}\n\nfunction resolveSessionOptions(\n  sessionKey: string,\n  sessions: SessionsListResult | null,\n  mainSessionKey?: string | null,\n) {\n  const seen = new Set<string>();\n  const options: Array<{ key: string; displayName?: string }> = [];\n\n  const resolvedMain = mainSessionKey && sessions?.sessions?.find((s) => s.key === mainSessionKey);\n  const resolvedCurrent = sessions?.sessions?.find((s) => s.key === sessionKey);\n\n  // Add main session key first\n  if (mainSessionKey) {\n    seen.add(mainSessionKey);\n    options.push({\n      key: mainSessionKey,\n      displayName: resolveSessionDisplayName(mainSessionKey, resolvedMain || undefined),\n    });\n  }\n\n  // Add current session key next\n  if (!seen.has(sessionKey)) {\n    seen.add(sessionKey);\n    options.push({\n      key: sessionKey,\n      displayName: resolveSessionDisplayName(sessionKey, resolvedCurrent),\n    });\n  }\n\n  // Add sessions from the result\n  if (sessions?.sessions) {\n    for (const s of sessions.sessions) {\n      if (!seen.has(s.key)) {\n        seen.add(s.key);\n        options.push({\n          key: s.key,\n          displayName: resolveSessionDisplayName(s.key, s),\n        });\n      }\n    }\n  }\n\n  return options;\n}\n\nconst THEME_ORDER: ThemeMode[] = [\"system\", \"light\", \"dark\"];\n\nexport function renderThemeToggle(state: AppViewState) {\n  const index = Math.max(0, THEME_ORDER.indexOf(state.theme));\n  const applyTheme = (next: ThemeMode) => (event: MouseEvent) => {\n    const element = event.currentTarget as HTMLElement;\n    const context: ThemeTransitionContext = { element };\n    if (event.clientX || event.clientY) {\n      context.pointerClientX = event.clientX;\n      context.pointerClientY = event.clientY;\n    }\n    state.setTheme(next, context);\n  };\n\n  return html`\n    <div class=\"theme-toggle\" style=\"--theme-index: ${index};\">\n      <div class=\"theme-toggle__track\" role=\"group\" aria-label=\"Theme\">\n        <span class=\"theme-toggle__indicator\"></span>\n        <button\n          class=\"theme-toggle__button ${state.theme === \"system\" ? \"active\" : \"\"}\"\n          @click=${applyTheme(\"system\")}\n          aria-pressed=${state.theme === \"system\"}\n          aria-label=\"系统主题\"\n          title=\"系统\"\n        >\n          ${renderMonitorIcon()}\n        </button>\n        <button\n          class=\"theme-toggle__button ${state.theme === \"light\" ? \"active\" : \"\"}\"\n          @click=${applyTheme(\"light\")}\n          aria-pressed=${state.theme === \"light\"}\n          aria-label=\"浅色主题\"\n          title=\"浅色\"\n        >\n          ${renderSunIcon()}\n        </button>\n        <button\n          class=\"theme-toggle__button ${state.theme === \"dark\" ? \"active\" : \"\"}\"\n          @click=${applyTheme(\"dark\")}\n          aria-pressed=${state.theme === \"dark\"}\n          aria-label=\"深色主题\"\n          title=\"深色\"\n        >\n          ${renderMoonIcon()}\n        </button>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderSunIcon() {\n  return html`\n    <svg class=\"theme-icon\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <circle cx=\"12\" cy=\"12\" r=\"4\"></circle>\n      <path d=\"M12 2v2\"></path>\n      <path d=\"M12 20v2\"></path>\n      <path d=\"m4.93 4.93 1.41 1.41\"></path>\n      <path d=\"m17.66 17.66 1.41 1.41\"></path>\n      <path d=\"M2 12h2\"></path>\n      <path d=\"M20 12h2\"></path>\n      <path d=\"m6.34 17.66-1.41 1.41\"></path>\n      <path d=\"m19.07 4.93-1.41 1.41\"></path>\n    </svg>\n  `;\n}\n\nfunction renderMoonIcon() {\n  return html`\n    <svg class=\"theme-icon\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <path\n        d=\"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401\"\n      ></path>\n    </svg>\n  `;\n}\n\nfunction renderMonitorIcon() {\n  return html`\n    <svg class=\"theme-icon\" viewBox=\"0 0 24 24\" aria-hidden=\"true\">\n      <rect width=\"20\" height=\"14\" x=\"2\" y=\"3\" rx=\"2\"></rect>\n      <line x1=\"8\" x2=\"16\" y1=\"21\" y2=\"21\"></line>\n      <line x1=\"12\" x2=\"12\" y1=\"17\" y2=\"21\"></line>\n    </svg>\n  `;\n}\n","import type { GatewayBrowserClient } from \"../gateway\";\nimport type {\n  AgentFileEntry,\n  AgentsFilesGetResult,\n  AgentsFilesListResult,\n  AgentsFilesSetResult,\n} from \"../types\";\n\nexport type AgentFilesState = {\n  client: GatewayBrowserClient | null;\n  connected: boolean;\n  agentFilesLoading: boolean;\n  agentFilesError: string | null;\n  agentFilesList: AgentsFilesListResult | null;\n  agentFileContents: Record<string, string>;\n  agentFileDrafts: Record<string, string>;\n  agentFileActive: string | null;\n  agentFileSaving: boolean;\n};\n\nfunction mergeFileEntry(\n  list: AgentsFilesListResult | null,\n  entry: AgentFileEntry,\n): AgentsFilesListResult | null {\n  if (!list) {\n    return list;\n  }\n  const hasEntry = list.files.some((file) => file.name === entry.name);\n  const nextFiles = hasEntry\n    ? list.files.map((file) => (file.name === entry.name ? entry : file))\n    : [...list.files, entry];\n  return { ...list, files: nextFiles };\n}\n\nexport async function loadAgentFiles(state: AgentFilesState, agentId: string) {\n  if (!state.client || !state.connected || state.agentFilesLoading) {\n    return;\n  }\n  state.agentFilesLoading = true;\n  state.agentFilesError = null;\n  try {\n    const res = await state.client.request<AgentsFilesListResult | null>(\"agents.files.list\", {\n      agentId,\n    });\n    if (res) {\n      state.agentFilesList = res;\n      if (state.agentFileActive && !res.files.some((file) => file.name === state.agentFileActive)) {\n        state.agentFileActive = null;\n      }\n    }\n  } catch (err) {\n    state.agentFilesError = String(err);\n  } finally {\n    state.agentFilesLoading = false;\n  }\n}\n\nexport async function loadAgentFileContent(state: AgentFilesState, agentId: string, name: string) {\n  if (!state.client || !state.connected || state.agentFilesLoading) {\n    return;\n  }\n  if (Object.hasOwn(state.agentFileContents, name)) {\n    return;\n  }\n  state.agentFilesLoading = true;\n  state.agentFilesError = null;\n  try {\n    const res = await state.client.request<AgentsFilesGetResult | null>(\"agents.files.get\", {\n      agentId,\n      name,\n    });\n    if (res?.file) {\n      const content = res.file.content ?? \"\";\n      state.agentFilesList = mergeFileEntry(state.agentFilesList, res.file);\n      state.agentFileContents = { ...state.agentFileContents, [name]: content };\n      if (!Object.hasOwn(state.agentFileDrafts, name)) {\n        state.agentFileDrafts = { ...state.agentFileDrafts, [name]: content };\n      }\n    }\n  } catch (err) {\n    state.agentFilesError = String(err);\n  } finally {\n    state.agentFilesLoading = false;\n  }\n}\n\nexport async function saveAgentFile(\n  state: AgentFilesState,\n  agentId: string,\n  name: string,\n  content: string,\n) {\n  if (!state.client || !state.connected || state.agentFileSaving) {\n    return;\n  }\n  state.agentFileSaving = true;\n  state.agentFilesError = null;\n  try {\n    const res = await state.client.request<AgentsFilesSetResult | null>(\"agents.files.set\", {\n      agentId,\n      name,\n      content,\n    });\n    if (res?.file) {\n      state.agentFilesList = mergeFileEntry(state.agentFilesList, res.file);\n      state.agentFileContents = { ...state.agentFileContents, [name]: content };\n      state.agentFileDrafts = { ...state.agentFileDrafts, [name]: content };\n    }\n  } catch (err) {\n    state.agentFilesError = String(err);\n  } finally {\n    state.agentFileSaving = false;\n  }\n}\n","import type { AnyAgentTool } from \"./tools/common.js\";\n\nexport type ToolProfileId = \"minimal\" | \"coding\" | \"messaging\" | \"full\";\n\ntype ToolProfilePolicy = {\n  allow?: string[];\n  deny?: string[];\n};\n\nconst TOOL_NAME_ALIASES: Record<string, string> = {\n  bash: \"exec\",\n  \"apply-patch\": \"apply_patch\",\n};\n\nexport const TOOL_GROUPS: Record<string, string[]> = {\n  // NOTE: Keep canonical (lowercase) tool names here.\n  \"group:memory\": [\"memory_search\", \"memory_get\"],\n  \"group:web\": [\"web_search\", \"web_fetch\"],\n  // Basic workspace/file tools\n  \"group:fs\": [\"read\", \"write\", \"edit\", \"apply_patch\"],\n  // Host/runtime execution tools\n  \"group:runtime\": [\"exec\", \"process\"],\n  // Session management tools\n  \"group:sessions\": [\n    \"sessions_list\",\n    \"sessions_history\",\n    \"sessions_send\",\n    \"sessions_spawn\",\n    \"session_status\",\n  ],\n  // UI helpers\n  \"group:ui\": [\"browser\", \"canvas\"],\n  // Automation + infra\n  \"group:automation\": [\"cron\", \"gateway\"],\n  // Messaging surface\n  \"group:messaging\": [\"message\"],\n  // Nodes + device tools\n  \"group:nodes\": [\"nodes\"],\n  // All Clawdbot native tools (excludes provider plugins).\n  \"group:clawdbot\": [\n    \"browser\",\n    \"canvas\",\n    \"nodes\",\n    \"cron\",\n    \"message\",\n    \"gateway\",\n    \"agents_list\",\n    \"sessions_list\",\n    \"sessions_history\",\n    \"sessions_send\",\n    \"sessions_spawn\",\n    \"session_status\",\n    \"memory_search\",\n    \"memory_get\",\n    \"web_search\",\n    \"web_fetch\",\n    \"image\",\n  ],\n};\n\nconst OWNER_ONLY_TOOL_NAMES = new Set<string>([\"whatsapp_login\"]);\n\nconst TOOL_PROFILES: Record<ToolProfileId, ToolProfilePolicy> = {\n  minimal: {\n    allow: [\"session_status\"],\n  },\n  coding: {\n    allow: [\"group:fs\", \"group:runtime\", \"group:sessions\", \"group:memory\", \"image\"],\n  },\n  messaging: {\n    allow: [\n      \"group:messaging\",\n      \"sessions_list\",\n      \"sessions_history\",\n      \"sessions_send\",\n      \"session_status\",\n    ],\n  },\n  full: {},\n};\n\nexport function normalizeToolName(name: string) {\n  const normalized = name.trim().toLowerCase();\n  return TOOL_NAME_ALIASES[normalized] ?? normalized;\n}\n\nexport function isOwnerOnlyToolName(name: string) {\n  return OWNER_ONLY_TOOL_NAMES.has(normalizeToolName(name));\n}\n\nexport function applyOwnerOnlyToolPolicy(tools: AnyAgentTool[], senderIsOwner: boolean) {\n  const withGuard = tools.map((tool) => {\n    if (!isOwnerOnlyToolName(tool.name)) {\n      return tool;\n    }\n    if (senderIsOwner || !tool.execute) {\n      return tool;\n    }\n    return {\n      ...tool,\n      execute: async () => {\n        throw new Error(\"Tool restricted to owner senders.\");\n      },\n    };\n  });\n  if (senderIsOwner) {\n    return withGuard;\n  }\n  return withGuard.filter((tool) => !isOwnerOnlyToolName(tool.name));\n}\n\nexport function normalizeToolList(list?: string[]) {\n  if (!list) return [];\n  return list.map(normalizeToolName).filter(Boolean);\n}\n\nexport type ToolPolicyLike = {\n  allow?: string[];\n  deny?: string[];\n};\n\nexport type PluginToolGroups = {\n  all: string[];\n  byPlugin: Map<string, string[]>;\n};\n\nexport type AllowlistResolution = {\n  policy: ToolPolicyLike | undefined;\n  unknownAllowlist: string[];\n  strippedAllowlist: boolean;\n};\n\nexport function expandToolGroups(list?: string[]) {\n  const normalized = normalizeToolList(list);\n  const expanded: string[] = [];\n  for (const value of normalized) {\n    const group = TOOL_GROUPS[value];\n    if (group) {\n      expanded.push(...group);\n      continue;\n    }\n    expanded.push(value);\n  }\n  return Array.from(new Set(expanded));\n}\n\nexport function collectExplicitAllowlist(policies: Array<ToolPolicyLike | undefined>): string[] {\n  const entries: string[] = [];\n  for (const policy of policies) {\n    if (!policy?.allow) continue;\n    for (const value of policy.allow) {\n      if (typeof value !== \"string\") continue;\n      const trimmed = value.trim();\n      if (trimmed) entries.push(trimmed);\n    }\n  }\n  return entries;\n}\n\nexport function buildPluginToolGroups<T extends { name: string }>(params: {\n  tools: T[];\n  toolMeta: (tool: T) => { pluginId: string } | undefined;\n}): PluginToolGroups {\n  const all: string[] = [];\n  const byPlugin = new Map<string, string[]>();\n  for (const tool of params.tools) {\n    const meta = params.toolMeta(tool);\n    if (!meta) continue;\n    const name = normalizeToolName(tool.name);\n    all.push(name);\n    const pluginId = meta.pluginId.toLowerCase();\n    const list = byPlugin.get(pluginId) ?? [];\n    list.push(name);\n    byPlugin.set(pluginId, list);\n  }\n  return { all, byPlugin };\n}\n\nexport function expandPluginGroups(\n  list: string[] | undefined,\n  groups: PluginToolGroups,\n): string[] | undefined {\n  if (!list || list.length === 0) return list;\n  const expanded: string[] = [];\n  for (const entry of list) {\n    const normalized = normalizeToolName(entry);\n    if (normalized === \"group:plugins\") {\n      if (groups.all.length > 0) {\n        expanded.push(...groups.all);\n      } else {\n        expanded.push(normalized);\n      }\n      continue;\n    }\n    const tools = groups.byPlugin.get(normalized);\n    if (tools && tools.length > 0) {\n      expanded.push(...tools);\n      continue;\n    }\n    expanded.push(normalized);\n  }\n  return Array.from(new Set(expanded));\n}\n\nexport function expandPolicyWithPluginGroups(\n  policy: ToolPolicyLike | undefined,\n  groups: PluginToolGroups,\n): ToolPolicyLike | undefined {\n  if (!policy) return undefined;\n  return {\n    allow: expandPluginGroups(policy.allow, groups),\n    deny: expandPluginGroups(policy.deny, groups),\n  };\n}\n\nexport function stripPluginOnlyAllowlist(\n  policy: ToolPolicyLike | undefined,\n  groups: PluginToolGroups,\n  coreTools: Set<string>,\n): AllowlistResolution {\n  if (!policy?.allow || policy.allow.length === 0) {\n    return { policy, unknownAllowlist: [], strippedAllowlist: false };\n  }\n  const normalized = normalizeToolList(policy.allow);\n  if (normalized.length === 0) {\n    return { policy, unknownAllowlist: [], strippedAllowlist: false };\n  }\n  const pluginIds = new Set(groups.byPlugin.keys());\n  const pluginTools = new Set(groups.all);\n  const unknownAllowlist: string[] = [];\n  let hasCoreEntry = false;\n  for (const entry of normalized) {\n    const isPluginEntry =\n      entry === \"group:plugins\" || pluginIds.has(entry) || pluginTools.has(entry);\n    const expanded = expandToolGroups([entry]);\n    const isCoreEntry = expanded.some((tool) => coreTools.has(tool));\n    if (isCoreEntry) hasCoreEntry = true;\n    if (!isCoreEntry && !isPluginEntry) unknownAllowlist.push(entry);\n  }\n  const strippedAllowlist = !hasCoreEntry;\n  return {\n    policy: strippedAllowlist ? { ...policy, allow: undefined } : policy,\n    unknownAllowlist: Array.from(new Set(unknownAllowlist)),\n    strippedAllowlist,\n  };\n}\n\nexport function resolveToolProfilePolicy(profile?: string): ToolProfilePolicy | undefined {\n  if (!profile) return undefined;\n  const resolved = TOOL_PROFILES[profile as ToolProfileId];\n  if (!resolved) return undefined;\n  if (!resolved.allow && !resolved.deny) return undefined;\n  return {\n    allow: resolved.allow ? [...resolved.allow] : undefined,\n    deny: resolved.deny ? [...resolved.deny] : undefined,\n  };\n}\n","import type { CronJob, GatewaySessionRow, PresenceEntry } from \"./types.ts\";\nimport { formatAgo, formatDurationMs, formatMs } from \"./format.ts\";\n\nexport function formatPresenceSummary(entry: PresenceEntry): string {\n  const host = entry.host ?? \"unknown\";\n  const ip = entry.ip ? `(${entry.ip})` : \"\";\n  const mode = entry.mode ?? \"\";\n  const version = entry.version ?? \"\";\n  return `${host} ${ip} ${mode} ${version}`.trim();\n}\n\nexport function formatPresenceAge(entry: PresenceEntry): string {\n  const ts = entry.ts ?? null;\n  return ts ? formatAgo(ts) : \"n/a\";\n}\n\nexport function formatNextRun(ms?: number | null) {\n  if (!ms) {\n    return \"n/a\";\n  }\n  return `${formatMs(ms)} (${formatAgo(ms)})`;\n}\n\nexport function formatSessionTokens(row: GatewaySessionRow) {\n  if (row.totalTokens == null) {\n    return \"n/a\";\n  }\n  const total = row.totalTokens ?? 0;\n  const ctx = row.contextTokens ?? 0;\n  return ctx ? `${total} / ${ctx}` : String(total);\n}\n\nexport function formatEventPayload(payload: unknown): string {\n  if (payload == null) {\n    return \"\";\n  }\n  try {\n    return JSON.stringify(payload, null, 2);\n  } catch {\n    // oxlint-disable typescript/no-base-to-string\n    return String(payload);\n  }\n}\n\nexport function formatCronState(job: CronJob) {\n  const state = job.state ?? {};\n  const next = state.nextRunAtMs ? formatMs(state.nextRunAtMs) : \"n/a\";\n  const last = state.lastRunAtMs ? formatMs(state.lastRunAtMs) : \"n/a\";\n  const status = state.lastStatus ?? \"n/a\";\n  return `${status} · next ${next} · last ${last}`;\n}\n\nexport function formatCronSchedule(job: CronJob) {\n  const s = job.schedule;\n  if (s.kind === \"at\") {\n    const atMs = Date.parse(s.at);\n    return Number.isFinite(atMs) ? `At ${formatMs(atMs)}` : `At ${s.at}`;\n  }\n  if (s.kind === \"every\") {\n    return `Every ${formatDurationMs(s.everyMs)}`;\n  }\n  return `Cron ${s.expr}${s.tz ? ` (${s.tz})` : \"\"}`;\n}\n\nexport function formatCronPayload(job: CronJob) {\n  const p = job.payload;\n  if (p.kind === \"systemEvent\") {\n    return `System: ${p.text}`;\n  }\n  const base = `Agent: ${p.message}`;\n  const delivery = job.delivery;\n  if (delivery && delivery.mode !== \"none\") {\n    const target =\n      delivery.channel || delivery.to\n        ? ` (${delivery.channel ?? \"last\"}${delivery.to ? ` -> ${delivery.to}` : \"\"})`\n        : \"\";\n    return `${base} · ${delivery.mode}${target}`;\n  }\n  return base;\n}\n","import { html, nothing } from \"lit\";\nimport type {\n  AgentFileEntry,\n  AgentsFilesListResult,\n  AgentsListResult,\n  AgentIdentityResult,\n  ChannelAccountSnapshot,\n  ChannelsStatusSnapshot,\n  CronJob,\n  CronStatus,\n  SkillStatusEntry,\n  SkillStatusReport,\n} from \"../types\";\nimport {\n  expandToolGroups,\n  normalizeToolName,\n  resolveToolProfilePolicy,\n} from \"../../../../src/agents/tool-policy.js\";\nimport { formatAgo } from \"../format\";\nimport {\n  formatCronPayload,\n  formatCronSchedule,\n  formatCronState,\n  formatNextRun,\n} from \"../presenter\";\n\nexport type AgentsPanel = \"overview\" | \"files\" | \"tools\" | \"skills\" | \"channels\" | \"cron\";\n\nexport type AgentsProps = {\n  loading: boolean;\n  error: string | null;\n  agentsList: AgentsListResult | null;\n  selectedAgentId: string | null;\n  activePanel: AgentsPanel;\n  configForm: Record<string, unknown> | null;\n  configLoading: boolean;\n  configSaving: boolean;\n  configDirty: boolean;\n  channelsLoading: boolean;\n  channelsError: string | null;\n  channelsSnapshot: ChannelsStatusSnapshot | null;\n  channelsLastSuccess: number | null;\n  cronLoading: boolean;\n  cronStatus: CronStatus | null;\n  cronJobs: CronJob[];\n  cronError: string | null;\n  agentFilesLoading: boolean;\n  agentFilesError: string | null;\n  agentFilesList: AgentsFilesListResult | null;\n  agentFileActive: string | null;\n  agentFileContents: Record<string, string>;\n  agentFileDrafts: Record<string, string>;\n  agentFileSaving: boolean;\n  agentIdentityLoading: boolean;\n  agentIdentityError: string | null;\n  agentIdentityById: Record<string, AgentIdentityResult>;\n  agentSkillsLoading: boolean;\n  agentSkillsReport: SkillStatusReport | null;\n  agentSkillsError: string | null;\n  agentSkillsAgentId: string | null;\n  skillsFilter: string;\n  onRefresh: () => void;\n  onSelectAgent: (agentId: string) => void;\n  onSelectPanel: (panel: AgentsPanel) => void;\n  onLoadFiles: (agentId: string) => void;\n  onSelectFile: (name: string) => void;\n  onFileDraftChange: (name: string, content: string) => void;\n  onFileReset: (name: string) => void;\n  onFileSave: (name: string) => void;\n  onToolsProfileChange: (agentId: string, profile: string | null, clearAllow: boolean) => void;\n  onToolsOverridesChange: (agentId: string, alsoAllow: string[], deny: string[]) => void;\n  onConfigReload: () => void;\n  onConfigSave: () => void;\n  onModelChange: (agentId: string, modelId: string | null) => void;\n  onModelFallbacksChange: (agentId: string, fallbacks: string[]) => void;\n  onChannelsRefresh: () => void;\n  onCronRefresh: () => void;\n  onSkillsFilterChange: (next: string) => void;\n  onSkillsRefresh: () => void;\n  onAgentSkillToggle: (agentId: string, skillName: string, enabled: boolean) => void;\n  onAgentSkillsClear: (agentId: string) => void;\n  onAgentSkillsDisableAll: (agentId: string) => void;\n};\n\nconst TOOL_SECTIONS = [\n  {\n    id: \"fs\",\n    label: \"文件\",\n    tools: [\n      { id: \"read\", label: \"read\", description: \"读取文件内容\" },\n      { id: \"write\", label: \"write\", description: \"创建或覆盖文件\" },\n      { id: \"edit\", label: \"edit\", description: \"精确编辑\" },\n      { id: \"apply_patch\", label: \"apply_patch\", description: \"补丁文件 (OpenAI)\" },\n    ],\n  },\n  {\n    id: \"runtime\",\n    label: \"运行时\",\n    tools: [\n      { id: \"exec\", label: \"exec\", description: \"执行 Shell 命令\" },\n      { id: \"process\", label: \"process\", description: \"管理后台进程\" },\n    ],\n  },\n  {\n    id: \"web\",\n    label: \"网络\",\n    tools: [\n      { id: \"web_search\", label: \"web_search\", description: \"搜索网络\" },\n      { id: \"web_fetch\", label: \"web_fetch\", description: \"获取网络内容\" },\n    ],\n  },\n  {\n    id: \"memory\",\n    label: \"记忆\",\n    tools: [\n      { id: \"memory_search\", label: \"memory_search\", description: \"语义搜索\" },\n      { id: \"memory_get\", label: \"memory_get\", description: \"读取记忆文件\" },\n    ],\n  },\n  {\n    id: \"sessions\",\n    label: \"会话\",\n    tools: [\n      { id: \"sessions_list\", label: \"sessions_list\", description: \"列出会话\" },\n      { id: \"sessions_history\", label: \"sessions_history\", description: \"会话历史\" },\n      { id: \"sessions_send\", label: \"sessions_send\", description: \"发送到会话\" },\n      { id: \"sessions_spawn\", label: \"sessions_spawn\", description: \"派生子代理\" },\n      { id: \"session_status\", label: \"session_status\", description: \"会话状态\" },\n    ],\n  },\n  {\n    id: \"ui\",\n    label: \"界面\",\n    tools: [\n      { id: \"browser\", label: \"browser\", description: \"控制网页浏览器\" },\n      { id: \"canvas\", label: \"canvas\", description: \"控制画布\" },\n    ],\n  },\n  {\n    id: \"messaging\",\n    label: \"消息\",\n    tools: [{ id: \"message\", label: \"message\", description: \"发送消息\" }],\n  },\n  {\n    id: \"automation\",\n    label: \"自动化\",\n    tools: [\n      { id: \"cron\", label: \"cron\", description: \"定时任务\" },\n      { id: \"gateway\", label: \"gateway\", description: \"网关控制\" },\n    ],\n  },\n  {\n    id: \"nodes\",\n    label: \"节点\",\n    tools: [{ id: \"nodes\", label: \"nodes\", description: \"节点 + 设备\" }],\n  },\n  {\n    id: \"agents\",\n    label: \"代理\",\n    tools: [{ id: \"agents_list\", label: \"agents_list\", description: \"列出代理\" }],\n  },\n  {\n    id: \"media\",\n    label: \"媒体\",\n    tools: [{ id: \"image\", label: \"image\", description: \"图像理解\" }],\n  },\n];\n\nconst PROFILE_OPTIONS = [\n  { id: \"minimal\", label: \"最小\" },\n  { id: \"coding\", label: \"编码\" },\n  { id: \"messaging\", label: \"消息\" },\n  { id: \"full\", label: \"完整\" },\n] as const;\n\ntype ToolPolicy = {\n  allow?: string[];\n  deny?: string[];\n};\n\ntype AgentConfigEntry = {\n  id: string;\n  name?: string;\n  workspace?: string;\n  agentDir?: string;\n  model?: unknown;\n  skills?: string[];\n  tools?: {\n    profile?: string;\n    allow?: string[];\n    alsoAllow?: string[];\n    deny?: string[];\n  };\n};\n\ntype ConfigSnapshot = {\n  agents?: {\n    defaults?: { workspace?: string; model?: unknown; models?: Record<string, { alias?: string }> };\n    list?: AgentConfigEntry[];\n  };\n  tools?: {\n    profile?: string;\n    allow?: string[];\n    alsoAllow?: string[];\n    deny?: string[];\n  };\n};\n\nfunction normalizeAgentLabel(agent: { id: string; name?: string; identity?: { name?: string } }) {\n  return agent.name?.trim() || agent.identity?.name?.trim() || agent.id;\n}\n\nfunction isLikelyEmoji(value: string) {\n  const trimmed = value.trim();\n  if (!trimmed) {\n    return false;\n  }\n  if (trimmed.length > 16) {\n    return false;\n  }\n  let hasNonAscii = false;\n  for (let i = 0; i < trimmed.length; i += 1) {\n    if (trimmed.charCodeAt(i) > 127) {\n      hasNonAscii = true;\n      break;\n    }\n  }\n  if (!hasNonAscii) {\n    return false;\n  }\n  if (trimmed.includes(\"://\") || trimmed.includes(\"/\") || trimmed.includes(\".\")) {\n    return false;\n  }\n  return true;\n}\n\nfunction resolveAgentEmoji(\n  agent: { identity?: { emoji?: string; avatar?: string } },\n  agentIdentity?: AgentIdentityResult | null,\n) {\n  const identityEmoji = agentIdentity?.emoji?.trim();\n  if (identityEmoji && isLikelyEmoji(identityEmoji)) {\n    return identityEmoji;\n  }\n  const agentEmoji = agent.identity?.emoji?.trim();\n  if (agentEmoji && isLikelyEmoji(agentEmoji)) {\n    return agentEmoji;\n  }\n  const identityAvatar = agentIdentity?.avatar?.trim();\n  if (identityAvatar && isLikelyEmoji(identityAvatar)) {\n    return identityAvatar;\n  }\n  const avatar = agent.identity?.avatar?.trim();\n  if (avatar && isLikelyEmoji(avatar)) {\n    return avatar;\n  }\n  return \"\";\n}\n\nfunction agentBadgeText(agentId: string, defaultId: string | null) {\n  return defaultId && agentId === defaultId ? \"默认\" : null;\n}\n\nfunction formatBytes(bytes?: number) {\n  if (bytes == null || !Number.isFinite(bytes)) {\n    return \"-\";\n  }\n  if (bytes < 1024) {\n    return `${bytes} B`;\n  }\n  const units = [\"KB\", \"MB\", \"GB\", \"TB\"];\n  let size = bytes / 1024;\n  let unitIndex = 0;\n  while (size >= 1024 && unitIndex < units.length - 1) {\n    size /= 1024;\n    unitIndex += 1;\n  }\n  return `${size.toFixed(size < 10 ? 1 : 0)} ${units[unitIndex]}`;\n}\n\nfunction resolveAgentConfig(config: Record<string, unknown> | null, agentId: string) {\n  const cfg = config as ConfigSnapshot | null;\n  const list = cfg?.agents?.list ?? [];\n  const entry = list.find((agent) => agent?.id === agentId);\n  return {\n    entry,\n    defaults: cfg?.agents?.defaults,\n    globalTools: cfg?.tools,\n  };\n}\n\ntype AgentContext = {\n  workspace: string;\n  model: string;\n  identityName: string;\n  identityEmoji: string;\n  skillsLabel: string;\n  isDefault: boolean;\n};\n\nfunction buildAgentContext(\n  agent: AgentsListResult[\"agents\"][number],\n  configForm: Record<string, unknown> | null,\n  agentFilesList: AgentsFilesListResult | null,\n  defaultId: string | null,\n  agentIdentity?: AgentIdentityResult | null,\n): AgentContext {\n  const config = resolveAgentConfig(configForm, agent.id);\n  const workspaceFromFiles =\n    agentFilesList && agentFilesList.agentId === agent.id ? agentFilesList.workspace : null;\n  const workspace =\n    workspaceFromFiles || config.entry?.workspace || config.defaults?.workspace || \"default\";\n  const modelLabel = config.entry?.model\n    ? resolveModelLabel(config.entry?.model)\n    : resolveModelLabel(config.defaults?.model);\n  const identityName =\n    agentIdentity?.name?.trim() ||\n    agent.identity?.name?.trim() ||\n    agent.name?.trim() ||\n    config.entry?.name ||\n    agent.id;\n  const identityEmoji = resolveAgentEmoji(agent, agentIdentity) || \"-\";\n  const skillFilter = Array.isArray(config.entry?.skills) ? config.entry?.skills : null;\n  const skillCount = skillFilter?.length ?? null;\n  return {\n    workspace,\n    model: modelLabel,\n    identityName,\n    identityEmoji,\n    skillsLabel: skillFilter ? `已选择 ${skillCount} 个` : \"全部技能\",\n    isDefault: Boolean(defaultId && agent.id === defaultId),\n  };\n}\n\nfunction resolveModelLabel(model?: unknown): string {\n  if (!model) {\n    return \"-\";\n  }\n  if (typeof model === \"string\") {\n    return model.trim() || \"-\";\n  }\n  if (typeof model === \"object\" && model) {\n    const record = model as { primary?: string; fallbacks?: string[] };\n    const primary = record.primary?.trim();\n    if (primary) {\n      const fallbackCount = Array.isArray(record.fallbacks) ? record.fallbacks.length : 0;\n      return fallbackCount > 0 ? `${primary} (+${fallbackCount} 备选)` : primary;\n    }\n  }\n  return \"-\";\n}\n\nfunction normalizeModelValue(label: string): string {\n  const match = label.match(/^(.+) \\(\\+\\d+ 备选\\)$/);\n  return match ? match[1] : label;\n}\n\nfunction resolveModelPrimary(model?: unknown): string | null {\n  if (!model) {\n    return null;\n  }\n  if (typeof model === \"string\") {\n    const trimmed = model.trim();\n    return trimmed || null;\n  }\n  if (typeof model === \"object\" && model) {\n    const record = model as Record<string, unknown>;\n    const candidate =\n      typeof record.primary === \"string\"\n        ? record.primary\n        : typeof record.model === \"string\"\n          ? record.model\n          : typeof record.id === \"string\"\n            ? record.id\n            : typeof record.value === \"string\"\n              ? record.value\n              : null;\n    const primary = candidate?.trim();\n    return primary || null;\n  }\n  return null;\n}\n\nfunction resolveModelFallbacks(model?: unknown): string[] | null {\n  if (!model || typeof model === \"string\") {\n    return null;\n  }\n  if (typeof model === \"object\" && model) {\n    const record = model as Record<string, unknown>;\n    const fallbacks = Array.isArray(record.fallbacks)\n      ? record.fallbacks\n      : Array.isArray(record.fallback)\n        ? record.fallback\n        : null;\n    return fallbacks\n      ? fallbacks.filter((entry): entry is string => typeof entry === \"string\")\n      : null;\n  }\n  return null;\n}\n\nfunction parseFallbackList(value: string): string[] {\n  return value\n    .split(\",\")\n    .map((entry) => entry.trim())\n    .filter(Boolean);\n}\n\ntype ConfiguredModelOption = {\n  value: string;\n  label: string;\n};\n\nfunction resolveConfiguredModels(\n  configForm: Record<string, unknown> | null,\n): ConfiguredModelOption[] {\n  const cfg = configForm as ConfigSnapshot | null;\n  const models = cfg?.agents?.defaults?.models;\n  if (!models || typeof models !== \"object\") {\n    return [];\n  }\n  const options: ConfiguredModelOption[] = [];\n  for (const [modelId, modelRaw] of Object.entries(models)) {\n    const trimmed = modelId.trim();\n    if (!trimmed) {\n      continue;\n    }\n    const alias =\n      modelRaw && typeof modelRaw === \"object\" && \"alias\" in modelRaw\n        ? typeof (modelRaw as { alias?: unknown }).alias === \"string\"\n          ? (modelRaw as { alias?: string }).alias?.trim()\n          : undefined\n        : undefined;\n    const label = alias && alias !== trimmed ? `${alias} (${trimmed})` : trimmed;\n    options.push({ value: trimmed, label });\n  }\n  return options;\n}\n\nfunction buildModelOptions(configForm: Record<string, unknown> | null, current?: string | null) {\n  const options = resolveConfiguredModels(configForm);\n  const hasCurrent = current ? options.some((option) => option.value === current) : false;\n  if (current && !hasCurrent) {\n    options.unshift({ value: current, label: `当前 (${current})` });\n  }\n  if (options.length === 0) {\n    return html`\n      <option value=\"\" disabled>未配置模型</option>\n    `;\n  }\n  return options.map((option) => html`<option value=${option.value}>${option.label}</option>`);\n}\n\ntype CompiledPattern =\n  | { kind: \"all\" }\n  | { kind: \"exact\"; value: string }\n  | { kind: \"regex\"; value: RegExp };\n\nfunction compilePattern(pattern: string): CompiledPattern {\n  const normalized = normalizeToolName(pattern);\n  if (!normalized) {\n    return { kind: \"exact\", value: \"\" };\n  }\n  if (normalized === \"*\") {\n    return { kind: \"all\" };\n  }\n  if (!normalized.includes(\"*\")) {\n    return { kind: \"exact\", value: normalized };\n  }\n  const escaped = normalized.replace(/[.*+?^${}()|[\\\\]\\\\]/g, \"\\\\$&\");\n  return { kind: \"regex\", value: new RegExp(`^${escaped.replaceAll(\"\\\\*\", \".*\")}$`) };\n}\n\nfunction compilePatterns(patterns?: string[]): CompiledPattern[] {\n  if (!Array.isArray(patterns)) {\n    return [];\n  }\n  return expandToolGroups(patterns)\n    .map(compilePattern)\n    .filter((pattern) => {\n      return pattern.kind !== \"exact\" || pattern.value.length > 0;\n    });\n}\n\nfunction matchesAny(name: string, patterns: CompiledPattern[]) {\n  for (const pattern of patterns) {\n    if (pattern.kind === \"all\") {\n      return true;\n    }\n    if (pattern.kind === \"exact\" && name === pattern.value) {\n      return true;\n    }\n    if (pattern.kind === \"regex\" && pattern.value.test(name)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nfunction isAllowedByPolicy(name: string, policy?: ToolPolicy) {\n  if (!policy) {\n    return true;\n  }\n  const normalized = normalizeToolName(name);\n  const deny = compilePatterns(policy.deny);\n  if (matchesAny(normalized, deny)) {\n    return false;\n  }\n  const allow = compilePatterns(policy.allow);\n  if (allow.length === 0) {\n    return true;\n  }\n  if (matchesAny(normalized, allow)) {\n    return true;\n  }\n  if (normalized === \"apply_patch\" && matchesAny(\"exec\", allow)) {\n    return true;\n  }\n  return false;\n}\n\nfunction matchesList(name: string, list?: string[]) {\n  if (!Array.isArray(list) || list.length === 0) {\n    return false;\n  }\n  const normalized = normalizeToolName(name);\n  const patterns = compilePatterns(list);\n  if (matchesAny(normalized, patterns)) {\n    return true;\n  }\n  if (normalized === \"apply_patch\" && matchesAny(\"exec\", patterns)) {\n    return true;\n  }\n  return false;\n}\n\nexport function renderAgents(props: AgentsProps) {\n  const agents = props.agentsList?.agents ?? [];\n  const defaultId = props.agentsList?.defaultId ?? null;\n  const selectedId = props.selectedAgentId ?? defaultId ?? agents[0]?.id ?? null;\n  const selectedAgent = selectedId\n    ? (agents.find((agent) => agent.id === selectedId) ?? null)\n    : null;\n\n  return html`\n    <div class=\"agents-layout\">\n      <section class=\"card agents-sidebar\">\n        <div class=\"row\" style=\"justify-content: space-between;\">\n          <div>\n            <div class=\"card-title\">代理</div>\n            <div class=\"card-sub\">已配置 ${agents.length} 个。</div>\n          </div>\n          <button class=\"btn btn--sm\" ?disabled=${props.loading} @click=${props.onRefresh}>\n            ${props.loading ? \"加载中…\" : \"刷新\"}\n          </button>\n        </div>\n        ${\n          props.error\n            ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${props.error}</div>`\n            : nothing\n        }\n        <div class=\"agent-list\" style=\"margin-top: 12px;\">\n          ${\n            agents.length === 0\n              ? html`\n                  <div class=\"muted\">未找到代理。</div>\n                `\n              : agents.map((agent) => {\n                  const badge = agentBadgeText(agent.id, defaultId);\n                  const emoji = resolveAgentEmoji(agent, props.agentIdentityById[agent.id] ?? null);\n                  return html`\n                    <button\n                      type=\"button\"\n                      class=\"agent-row ${selectedId === agent.id ? \"active\" : \"\"}\"\n                      @click=${() => props.onSelectAgent(agent.id)}\n                    >\n                      <div class=\"agent-avatar\">\n                        ${emoji || normalizeAgentLabel(agent).slice(0, 1)}\n                      </div>\n                      <div class=\"agent-info\">\n                        <div class=\"agent-title\">${normalizeAgentLabel(agent)}</div>\n                        <div class=\"agent-sub mono\">${agent.id}</div>\n                      </div>\n                      ${badge ? html`<span class=\"agent-pill\">${badge}</span>` : nothing}\n                    </button>\n                  `;\n                })\n          }\n        </div>\n      </section>\n      <section class=\"agents-main\">\n        ${\n          !selectedAgent\n            ? html`\n                <div class=\"card\">\n                  <div class=\"card-title\">选择一个代理</div>\n                  <div class=\"card-sub\">选择一个代理以查看其工作区和工具。</div>\n                </div>\n              `\n            : html`\n              ${renderAgentHeader(\n                selectedAgent,\n                defaultId,\n                props.agentIdentityById[selectedAgent.id] ?? null,\n              )}\n              ${renderAgentTabs(props.activePanel, (panel) => props.onSelectPanel(panel))}\n              ${\n                props.activePanel === \"overview\"\n                  ? renderAgentOverview({\n                      agent: selectedAgent,\n                      defaultId,\n                      configForm: props.configForm,\n                      agentFilesList: props.agentFilesList,\n                      agentIdentity: props.agentIdentityById[selectedAgent.id] ?? null,\n                      agentIdentityError: props.agentIdentityError,\n                      agentIdentityLoading: props.agentIdentityLoading,\n                      configLoading: props.configLoading,\n                      configSaving: props.configSaving,\n                      configDirty: props.configDirty,\n                      onConfigReload: props.onConfigReload,\n                      onConfigSave: props.onConfigSave,\n                      onModelChange: props.onModelChange,\n                      onModelFallbacksChange: props.onModelFallbacksChange,\n                    })\n                  : nothing\n              }\n              ${\n                props.activePanel === \"files\"\n                  ? renderAgentFiles({\n                      agentId: selectedAgent.id,\n                      agentFilesList: props.agentFilesList,\n                      agentFilesLoading: props.agentFilesLoading,\n                      agentFilesError: props.agentFilesError,\n                      agentFileActive: props.agentFileActive,\n                      agentFileContents: props.agentFileContents,\n                      agentFileDrafts: props.agentFileDrafts,\n                      agentFileSaving: props.agentFileSaving,\n                      onLoadFiles: props.onLoadFiles,\n                      onSelectFile: props.onSelectFile,\n                      onFileDraftChange: props.onFileDraftChange,\n                      onFileReset: props.onFileReset,\n                      onFileSave: props.onFileSave,\n                    })\n                  : nothing\n              }\n              ${\n                props.activePanel === \"tools\"\n                  ? renderAgentTools({\n                      agentId: selectedAgent.id,\n                      configForm: props.configForm,\n                      configLoading: props.configLoading,\n                      configSaving: props.configSaving,\n                      configDirty: props.configDirty,\n                      onProfileChange: props.onToolsProfileChange,\n                      onOverridesChange: props.onToolsOverridesChange,\n                      onConfigReload: props.onConfigReload,\n                      onConfigSave: props.onConfigSave,\n                    })\n                  : nothing\n              }\n              ${\n                props.activePanel === \"skills\"\n                  ? renderAgentSkills({\n                      agentId: selectedAgent.id,\n                      report: props.agentSkillsReport,\n                      loading: props.agentSkillsLoading,\n                      error: props.agentSkillsError,\n                      activeAgentId: props.agentSkillsAgentId,\n                      configForm: props.configForm,\n                      configLoading: props.configLoading,\n                      configSaving: props.configSaving,\n                      configDirty: props.configDirty,\n                      filter: props.skillsFilter,\n                      onFilterChange: props.onSkillsFilterChange,\n                      onRefresh: props.onSkillsRefresh,\n                      onToggle: props.onAgentSkillToggle,\n                      onClear: props.onAgentSkillsClear,\n                      onDisableAll: props.onAgentSkillsDisableAll,\n                      onConfigReload: props.onConfigReload,\n                      onConfigSave: props.onConfigSave,\n                    })\n                  : nothing\n              }\n              ${\n                props.activePanel === \"channels\"\n                  ? renderAgentChannels({\n                      agent: selectedAgent,\n                      defaultId,\n                      configForm: props.configForm,\n                      agentFilesList: props.agentFilesList,\n                      agentIdentity: props.agentIdentityById[selectedAgent.id] ?? null,\n                      snapshot: props.channelsSnapshot,\n                      loading: props.channelsLoading,\n                      error: props.channelsError,\n                      lastSuccess: props.channelsLastSuccess,\n                      onRefresh: props.onChannelsRefresh,\n                    })\n                  : nothing\n              }\n              ${\n                props.activePanel === \"cron\"\n                  ? renderAgentCron({\n                      agent: selectedAgent,\n                      defaultId,\n                      configForm: props.configForm,\n                      agentFilesList: props.agentFilesList,\n                      agentIdentity: props.agentIdentityById[selectedAgent.id] ?? null,\n                      jobs: props.cronJobs,\n                      status: props.cronStatus,\n                      loading: props.cronLoading,\n                      error: props.cronError,\n                      onRefresh: props.onCronRefresh,\n                    })\n                  : nothing\n              }\n            `\n        }\n      </section>\n    </div>\n  `;\n}\n\nfunction renderAgentHeader(\n  agent: AgentsListResult[\"agents\"][number],\n  defaultId: string | null,\n  agentIdentity: AgentIdentityResult | null,\n) {\n  const badge = agentBadgeText(agent.id, defaultId);\n  const displayName = normalizeAgentLabel(agent);\n  const subtitle = agent.identity?.theme?.trim() || \"代理工作区和路由。\";\n  const emoji = resolveAgentEmoji(agent, agentIdentity);\n  return html`\n    <section class=\"card agent-header\">\n      <div class=\"agent-header-main\">\n        <div class=\"agent-avatar agent-avatar--lg\">\n          ${emoji || displayName.slice(0, 1)}\n        </div>\n        <div>\n          <div class=\"card-title\">${displayName}</div>\n          <div class=\"card-sub\">${subtitle}</div>\n        </div>\n      </div>\n      <div class=\"agent-header-meta\">\n        <div class=\"mono\">${agent.id}</div>\n        ${badge ? html`<span class=\"agent-pill\">${badge}</span>` : nothing}\n      </div>\n    </section>\n  `;\n}\n\nfunction renderAgentTabs(active: AgentsPanel, onSelect: (panel: AgentsPanel) => void) {\n  const tabs: Array<{ id: AgentsPanel; label: string }> = [\n    { id: \"overview\", label: \"概览\" },\n    { id: \"files\", label: \"文件\" },\n    { id: \"tools\", label: \"工具\" },\n    { id: \"skills\", label: \"技能\" },\n    { id: \"channels\", label: \"通道\" },\n    { id: \"cron\", label: \"定时任务\" },\n  ];\n  return html`\n    <div class=\"agent-tabs\">\n      ${tabs.map(\n        (tab) => html`\n          <button\n            class=\"agent-tab ${active === tab.id ? \"active\" : \"\"}\"\n            type=\"button\"\n            @click=${() => onSelect(tab.id)}\n          >\n            ${tab.label}\n          </button>\n        `,\n      )}\n    </div>\n  `;\n}\n\nfunction renderAgentOverview(params: {\n  agent: AgentsListResult[\"agents\"][number];\n  defaultId: string | null;\n  configForm: Record<string, unknown> | null;\n  agentFilesList: AgentsFilesListResult | null;\n  agentIdentity: AgentIdentityResult | null;\n  agentIdentityLoading: boolean;\n  agentIdentityError: string | null;\n  configLoading: boolean;\n  configSaving: boolean;\n  configDirty: boolean;\n  onConfigReload: () => void;\n  onConfigSave: () => void;\n  onModelChange: (agentId: string, modelId: string | null) => void;\n  onModelFallbacksChange: (agentId: string, fallbacks: string[]) => void;\n}) {\n  const {\n    agent,\n    configForm,\n    agentFilesList,\n    agentIdentity,\n    agentIdentityLoading,\n    agentIdentityError,\n    configLoading,\n    configSaving,\n    configDirty,\n    onConfigReload,\n    onConfigSave,\n    onModelChange,\n    onModelFallbacksChange,\n  } = params;\n  const config = resolveAgentConfig(configForm, agent.id);\n  const workspaceFromFiles =\n    agentFilesList && agentFilesList.agentId === agent.id ? agentFilesList.workspace : null;\n  const workspace =\n    workspaceFromFiles || config.entry?.workspace || config.defaults?.workspace || \"default\";\n  const model = config.entry?.model\n    ? resolveModelLabel(config.entry?.model)\n    : resolveModelLabel(config.defaults?.model);\n  const defaultModel = resolveModelLabel(config.defaults?.model);\n  const modelPrimary =\n    resolveModelPrimary(config.entry?.model) || (model !== \"-\" ? normalizeModelValue(model) : null);\n  const defaultPrimary =\n    resolveModelPrimary(config.defaults?.model) ||\n    (defaultModel !== \"-\" ? normalizeModelValue(defaultModel) : null);\n  const effectivePrimary = modelPrimary ?? defaultPrimary ?? null;\n  const modelFallbacks = resolveModelFallbacks(config.entry?.model);\n  const fallbackText = modelFallbacks ? modelFallbacks.join(\", \") : \"\";\n  const identityName =\n    agentIdentity?.name?.trim() ||\n    agent.identity?.name?.trim() ||\n    agent.name?.trim() ||\n    config.entry?.name ||\n    \"-\";\n  const resolvedEmoji = resolveAgentEmoji(agent, agentIdentity);\n  const identityEmoji = resolvedEmoji || \"-\";\n  const skillFilter = Array.isArray(config.entry?.skills) ? config.entry?.skills : null;\n  const skillCount = skillFilter?.length ?? null;\n  const identityStatus = agentIdentityLoading\n    ? \"加载中…\"\n    : agentIdentityError\n      ? \"不可用\"\n      : \"\";\n  const isDefault = Boolean(params.defaultId && agent.id === params.defaultId);\n\n  return html`\n    <section class=\"card\">\n      <div class=\"card-title\">概览</div>\n      <div class=\"card-sub\">工作区路径和身份元数据。</div>\n      <div class=\"agents-overview-grid\" style=\"margin-top: 16px;\">\n        <div class=\"agent-kv\">\n          <div class=\"label\">工作区</div>\n          <div class=\"mono\">${workspace}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">主模型</div>\n          <div class=\"mono\">${model}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">身份名称</div>\n          <div>${identityName}</div>\n          ${identityStatus ? html`<div class=\"agent-kv-sub muted\">${identityStatus}</div>` : nothing}\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">默认</div>\n          <div>${isDefault ? \"是\" : \"否\"}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">身份表情</div>\n          <div>${identityEmoji}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">技能过滤</div>\n          <div>${skillFilter ? `已选择 ${skillCount} 个` : \"全部技能\"}</div>\n        </div>\n      </div>\n\n      <div class=\"agent-model-select\" style=\"margin-top: 20px;\">\n        <div class=\"label\">模型选择</div>\n        <div class=\"row\" style=\"gap: 12px; flex-wrap: wrap;\">\n          <label class=\"field\" style=\"min-width: 260px; flex: 1;\">\n            <span>主模型</span>\n            <select\n              .value=${effectivePrimary ?? \"\"}\n              ?disabled=${!configForm || configLoading || configSaving}\n              @change=${(e: Event) =>\n                onModelChange(agent.id, (e.target as HTMLSelectElement).value || null)}\n            >\n              <option value=\"\">\n                ${defaultPrimary ? `继承默认 (${defaultPrimary})` : \"继承默认\"}\n              </option>\n              ${buildModelOptions(configForm, effectivePrimary ?? undefined)}\n            </select>\n          </label>\n          <label class=\"field\" style=\"min-width: 260px; flex: 1;\">\n            <span>备选模型（逗号分隔）</span>\n            <input\n              .value=${fallbackText}\n              ?disabled=${!configForm || configLoading || configSaving}\n              placeholder=\"提供商/模型, 提供商/模型\"\n              @input=${(e: Event) =>\n                onModelFallbacksChange(\n                  agent.id,\n                  parseFallbackList((e.target as HTMLInputElement).value),\n                )}\n            />\n          </label>\n        </div>\n        <div class=\"row\" style=\"justify-content: flex-end; gap: 8px;\">\n          <button\n            class=\"btn btn--sm\"\n            ?disabled=${configLoading}\n            @click=${onConfigReload}\n          >\n            重新加载配置\n          </button>\n          <button\n            class=\"btn btn--sm primary\"\n            ?disabled=${configSaving || !configDirty}\n            @click=${onConfigSave}\n          >\n            ${configSaving ? \"保存中…\" : \"保存\"}\n          </button>\n        </div>\n      </div>\n    </section>\n  `;\n}\n\nfunction renderAgentContextCard(context: AgentContext, subtitle: string) {\n  return html`\n    <section class=\"card\">\n      <div class=\"card-title\">代理上下文</div>\n      <div class=\"card-sub\">${subtitle}</div>\n      <div class=\"agents-overview-grid\" style=\"margin-top: 16px;\">\n        <div class=\"agent-kv\">\n          <div class=\"label\">工作区</div>\n          <div class=\"mono\">${context.workspace}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">主模型</div>\n          <div class=\"mono\">${context.model}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">身份名称</div>\n          <div>${context.identityName}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">身份表情</div>\n          <div>${context.identityEmoji}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">技能过滤</div>\n          <div>${context.skillsLabel}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">默认</div>\n          <div>${context.isDefault ? \"是\" : \"否\"}</div>\n        </div>\n      </div>\n    </section>\n  `;\n}\n\ntype ChannelSummaryEntry = {\n  id: string;\n  label: string;\n  accounts: ChannelAccountSnapshot[];\n};\n\nfunction resolveChannelLabel(snapshot: ChannelsStatusSnapshot, id: string) {\n  const meta = snapshot.channelMeta?.find((entry) => entry.id === id);\n  if (meta?.label) {\n    return meta.label;\n  }\n  return snapshot.channelLabels?.[id] ?? id;\n}\n\nfunction resolveChannelEntries(snapshot: ChannelsStatusSnapshot | null): ChannelSummaryEntry[] {\n  if (!snapshot) {\n    return [];\n  }\n  const ids = new Set<string>();\n  for (const id of snapshot.channelOrder ?? []) {\n    ids.add(id);\n  }\n  for (const entry of snapshot.channelMeta ?? []) {\n    ids.add(entry.id);\n  }\n  for (const id of Object.keys(snapshot.channelAccounts ?? {})) {\n    ids.add(id);\n  }\n  const ordered: string[] = [];\n  const seed = snapshot.channelOrder?.length ? snapshot.channelOrder : Array.from(ids);\n  for (const id of seed) {\n    if (!ids.has(id)) {\n      continue;\n    }\n    ordered.push(id);\n    ids.delete(id);\n  }\n  for (const id of ids) {\n    ordered.push(id);\n  }\n  return ordered.map((id) => ({\n    id,\n    label: resolveChannelLabel(snapshot, id),\n    accounts: snapshot.channelAccounts?.[id] ?? [],\n  }));\n}\n\nconst CHANNEL_EXTRA_FIELDS = [\"groupPolicy\", \"streamMode\", \"dmPolicy\"] as const;\n\nfunction resolveChannelConfigValue(\n  configForm: Record<string, unknown> | null,\n  channelId: string,\n): Record<string, unknown> | null {\n  if (!configForm) {\n    return null;\n  }\n  const channels = (configForm.channels ?? {}) as Record<string, unknown>;\n  const fromChannels = channels[channelId];\n  if (fromChannels && typeof fromChannels === \"object\") {\n    return fromChannels as Record<string, unknown>;\n  }\n  const fallback = configForm[channelId];\n  if (fallback && typeof fallback === \"object\") {\n    return fallback as Record<string, unknown>;\n  }\n  return null;\n}\n\nfunction formatChannelExtraValue(raw: unknown): string {\n  if (raw == null) {\n    return \"无\";\n  }\n  if (typeof raw === \"string\" || typeof raw === \"number\" || typeof raw === \"boolean\") {\n    return String(raw);\n  }\n  try {\n    return JSON.stringify(raw);\n  } catch {\n    return \"无\";\n  }\n}\n\nfunction resolveChannelExtras(\n  configForm: Record<string, unknown> | null,\n  channelId: string,\n): Array<{ label: string; value: string }> {\n  const value = resolveChannelConfigValue(configForm, channelId);\n  if (!value) {\n    return [];\n  }\n  return CHANNEL_EXTRA_FIELDS.flatMap((field) => {\n    if (!(field in value)) {\n      return [];\n    }\n    return [{ label: field, value: formatChannelExtraValue(value[field]) }];\n  });\n}\n\nfunction summarizeChannelAccounts(accounts: ChannelAccountSnapshot[]) {\n  let connected = 0;\n  let configured = 0;\n  let enabled = 0;\n  for (const account of accounts) {\n    const probeOk =\n      account.probe && typeof account.probe === \"object\" && \"ok\" in account.probe\n        ? Boolean((account.probe as { ok?: unknown }).ok)\n        : false;\n    const isConnected = account.connected === true || account.running === true || probeOk;\n    if (isConnected) {\n      connected += 1;\n    }\n    if (account.configured) {\n      configured += 1;\n    }\n    if (account.enabled) {\n      enabled += 1;\n    }\n  }\n  return {\n    total: accounts.length,\n    connected,\n    configured,\n    enabled,\n  };\n}\n\nfunction renderAgentChannels(params: {\n  agent: AgentsListResult[\"agents\"][number];\n  defaultId: string | null;\n  configForm: Record<string, unknown> | null;\n  agentFilesList: AgentsFilesListResult | null;\n  agentIdentity: AgentIdentityResult | null;\n  snapshot: ChannelsStatusSnapshot | null;\n  loading: boolean;\n  error: string | null;\n  lastSuccess: number | null;\n  onRefresh: () => void;\n}) {\n  const context = buildAgentContext(\n    params.agent,\n    params.configForm,\n    params.agentFilesList,\n    params.defaultId,\n    params.agentIdentity,\n  );\n  const entries = resolveChannelEntries(params.snapshot);\n  const lastSuccessLabel = params.lastSuccess ? formatAgo(params.lastSuccess) : \"从未\";\n  return html`\n    <section class=\"grid grid-cols-2\">\n      ${renderAgentContextCard(context, \"工作区、身份和模型配置。\")}\n      <section class=\"card\">\n        <div class=\"row\" style=\"justify-content: space-between;\">\n          <div>\n            <div class=\"card-title\">通道</div>\n            <div class=\"card-sub\">网关级通道状态快照。</div>\n          </div>\n          <button class=\"btn btn--sm\" ?disabled=${params.loading} @click=${params.onRefresh}>\n            ${params.loading ? \"刷新中…\" : \"刷新\"}\n          </button>\n        </div>\n        <div class=\"muted\" style=\"margin-top: 8px;\">\n          上次刷新：${lastSuccessLabel}\n        </div>\n        ${\n          params.error\n            ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${params.error}</div>`\n            : nothing\n        }\n        ${\n          !params.snapshot\n            ? html`\n                <div class=\"callout info\" style=\"margin-top: 12px\">加载通道以查看实时状态。</div>\n              `\n            : nothing\n        }\n        ${\n          entries.length === 0\n            ? html`\n                <div class=\"muted\" style=\"margin-top: 16px\">未找到通道。</div>\n              `\n            : html`\n              <div class=\"list\" style=\"margin-top: 16px;\">\n                ${entries.map((entry) => {\n                  const summary = summarizeChannelAccounts(entry.accounts);\n                  const status = summary.total\n                    ? `${summary.connected}/${summary.total} 已连接`\n                    : \"无账户\";\n                  const config = summary.configured\n                    ? `已配置 ${summary.configured} 个`\n                    : \"未配置\";\n                  const enabled = summary.total ? `已启用 ${summary.enabled} 个` : \"已禁用\";\n                  const extras = resolveChannelExtras(params.configForm, entry.id);\n                  return html`\n                    <div class=\"list-item\">\n                      <div class=\"list-main\">\n                        <div class=\"list-title\">${entry.label}</div>\n                        <div class=\"list-sub mono\">${entry.id}</div>\n                      </div>\n                      <div class=\"list-meta\">\n                        <div>${status}</div>\n                        <div>${config}</div>\n                        <div>${enabled}</div>\n                        ${\n                          extras.length > 0\n                            ? extras.map((extra) => html`<div>${extra.label}: ${extra.value}</div>`)\n                            : nothing\n                        }\n                      </div>\n                    </div>\n                  `;\n                })}\n              </div>\n            `\n        }\n      </section>\n    </section>\n  `;\n}\n\nfunction renderAgentCron(params: {\n  agent: AgentsListResult[\"agents\"][number];\n  defaultId: string | null;\n  configForm: Record<string, unknown> | null;\n  agentFilesList: AgentsFilesListResult | null;\n  agentIdentity: AgentIdentityResult | null;\n  jobs: CronJob[];\n  status: CronStatus | null;\n  loading: boolean;\n  error: string | null;\n  onRefresh: () => void;\n}) {\n  const context = buildAgentContext(\n    params.agent,\n    params.configForm,\n    params.agentFilesList,\n    params.defaultId,\n    params.agentIdentity,\n  );\n  const jobs = params.jobs.filter((job) => job.agentId === params.agent.id);\n  return html`\n    <section class=\"grid grid-cols-2\">\n      ${renderAgentContextCard(context, \"工作区和调度目标。\")}\n      <section class=\"card\">\n        <div class=\"row\" style=\"justify-content: space-between;\">\n          <div>\n            <div class=\"card-title\">调度器</div>\n            <div class=\"card-sub\">网关定时任务状态。</div>\n          </div>\n          <button class=\"btn btn--sm\" ?disabled=${params.loading} @click=${params.onRefresh}>\n            ${params.loading ? \"刷新中…\" : \"刷新\"}\n          </button>\n        </div>\n        <div class=\"stat-grid\" style=\"margin-top: 16px;\">\n          <div class=\"stat\">\n            <div class=\"stat-label\">已启用</div>\n            <div class=\"stat-value\">\n              ${params.status ? (params.status.enabled ? \"是\" : \"否\") : \"无\"}\n            </div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">任务</div>\n            <div class=\"stat-value\">${params.status?.jobs ?? \"无\"}</div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">下次唤醒</div>\n            <div class=\"stat-value\">${formatNextRun(params.status?.nextWakeAtMs ?? null)}</div>\n          </div>\n        </div>\n        ${\n          params.error\n            ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${params.error}</div>`\n            : nothing\n        }\n      </section>\n    </section>\n    <section class=\"card\">\n      <div class=\"card-title\">代理定时任务</div>\n      <div class=\"card-sub\">针对此代理的定时任务。</div>\n      ${\n        jobs.length === 0\n          ? html`\n              <div class=\"muted\" style=\"margin-top: 16px\">未分配任务。</div>\n            `\n          : html`\n              <div class=\"list\" style=\"margin-top: 16px;\">\n                ${jobs.map(\n                  (job) => html`\n                  <div class=\"list-item\">\n                    <div class=\"list-main\">\n                      <div class=\"list-title\">${job.name}</div>\n                      ${job.description ? html`<div class=\"list-sub\">${job.description}</div>` : nothing}\n                      <div class=\"chip-row\" style=\"margin-top: 6px;\">\n                        <span class=\"chip\">${formatCronSchedule(job)}</span>\n                        <span class=\"chip ${job.enabled ? \"chip-ok\" : \"chip-warn\"}\">\n                          ${job.enabled ? \"已启用\" : \"已禁用\"}\n                        </span>\n                        <span class=\"chip\">${job.sessionTarget}</span>\n                      </div>\n                    </div>\n                    <div class=\"list-meta\">\n                      <div class=\"mono\">${formatCronState(job)}</div>\n                      <div class=\"muted\">${formatCronPayload(job)}</div>\n                    </div>\n                  </div>\n                `,\n                )}\n              </div>\n            `\n      }\n    </section>\n  `;\n}\n\nfunction renderAgentFiles(params: {\n  agentId: string;\n  agentFilesList: AgentsFilesListResult | null;\n  agentFilesLoading: boolean;\n  agentFilesError: string | null;\n  agentFileActive: string | null;\n  agentFileContents: Record<string, string>;\n  agentFileDrafts: Record<string, string>;\n  agentFileSaving: boolean;\n  onLoadFiles: (agentId: string) => void;\n  onSelectFile: (name: string) => void;\n  onFileDraftChange: (name: string, content: string) => void;\n  onFileReset: (name: string) => void;\n  onFileSave: (name: string) => void;\n}) {\n  const list = params.agentFilesList?.agentId === params.agentId ? params.agentFilesList : null;\n  const files = list?.files ?? [];\n  const active = params.agentFileActive ?? null;\n  const activeEntry = active ? (files.find((file) => file.name === active) ?? null) : null;\n  const baseContent = active ? (params.agentFileContents[active] ?? \"\") : \"\";\n  const draft = active ? (params.agentFileDrafts[active] ?? baseContent) : \"\";\n  const isDirty = active ? draft !== baseContent : false;\n\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">核心文件</div>\n          <div class=\"card-sub\">引导人格、身份和工具指导。</div>\n        </div>\n        <button\n          class=\"btn btn--sm\"\n          ?disabled=${params.agentFilesLoading}\n          @click=${() => params.onLoadFiles(params.agentId)}\n        >\n          ${params.agentFilesLoading ? \"加载中…\" : \"刷新\"}\n        </button>\n      </div>\n      ${list ? html`<div class=\"muted mono\" style=\"margin-top: 8px;\">工作区：${list.workspace}</div>` : nothing}\n      ${\n        params.agentFilesError\n          ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${\n              params.agentFilesError\n            }</div>`\n          : nothing\n      }\n      ${\n        !list\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                加载代理工作区文件以编辑核心指令。\n              </div>\n            `\n          : html`\n              <div class=\"agent-files-grid\" style=\"margin-top: 16px;\">\n                <div class=\"agent-files-list\">\n                  ${\n                    files.length === 0\n                      ? html`\n                          <div class=\"muted\">未找到文件。</div>\n                        `\n                      : files.map((file) =>\n                          renderAgentFileRow(file, active, () => params.onSelectFile(file.name)),\n                        )\n                  }\n                </div>\n                <div class=\"agent-files-editor\">\n                  ${\n                    !activeEntry\n                      ? html`\n                          <div class=\"muted\">选择一个文件进行编辑。</div>\n                        `\n                      : html`\n                          <div class=\"agent-file-header\">\n                            <div>\n                              <div class=\"agent-file-title mono\">${activeEntry.name}</div>\n                              <div class=\"agent-file-sub mono\">${activeEntry.path}</div>\n                            </div>\n                            <div class=\"agent-file-actions\">\n                              <button\n                                class=\"btn btn--sm\"\n                                ?disabled=${!isDirty}\n                                @click=${() => params.onFileReset(activeEntry.name)}\n                              >\n                                重置\n                              </button>\n                              <button\n                                class=\"btn btn--sm primary\"\n                                ?disabled=${params.agentFileSaving || !isDirty}\n                                @click=${() => params.onFileSave(activeEntry.name)}\n                              >\n                                ${params.agentFileSaving ? \"保存中…\" : \"保存\"}\n                              </button>\n                            </div>\n                          </div>\n                          ${\n                            activeEntry.missing\n                              ? html`\n                                  <div class=\"callout info\" style=\"margin-top: 10px\">\n                                    此文件不存在。保存将在代理工作区中创建它。\n                                  </div>\n                                `\n                              : nothing\n                          }\n                          <label class=\"field\" style=\"margin-top: 12px;\">\n                            <span>内容</span>\n                            <textarea\n                              .value=${draft}\n                              @input=${(e: Event) =>\n                                params.onFileDraftChange(\n                                  activeEntry.name,\n                                  (e.target as HTMLTextAreaElement).value,\n                                )}\n                            ></textarea>\n                          </label>\n                        `\n                  }\n                </div>\n              </div>\n            `\n      }\n    </section>\n  `;\n}\n\nfunction renderAgentFileRow(file: AgentFileEntry, active: string | null, onSelect: () => void) {\n  const status = file.missing\n    ? \"缺失\"\n    : `${formatBytes(file.size)} · ${formatAgo(file.updatedAtMs ?? null)}`;\n  return html`\n    <button\n      type=\"button\"\n      class=\"agent-file-row ${active === file.name ? \"active\" : \"\"}\"\n      @click=${onSelect}\n    >\n      <div>\n        <div class=\"agent-file-name mono\">${file.name}</div>\n        <div class=\"agent-file-meta\">${status}</div>\n      </div>\n      ${\n        file.missing\n          ? html`\n              <span class=\"agent-pill warn\">缺失</span>\n            `\n          : nothing\n      }\n    </button>\n  `;\n}\n\nfunction renderAgentTools(params: {\n  agentId: string;\n  configForm: Record<string, unknown> | null;\n  configLoading: boolean;\n  configSaving: boolean;\n  configDirty: boolean;\n  onProfileChange: (agentId: string, profile: string | null, clearAllow: boolean) => void;\n  onOverridesChange: (agentId: string, alsoAllow: string[], deny: string[]) => void;\n  onConfigReload: () => void;\n  onConfigSave: () => void;\n}) {\n  const config = resolveAgentConfig(params.configForm, params.agentId);\n  const agentTools = config.entry?.tools ?? {};\n  const globalTools = config.globalTools ?? {};\n  const profile = agentTools.profile ?? globalTools.profile ?? \"full\";\n  const profileSource = agentTools.profile\n    ? \"代理覆盖\"\n    : globalTools.profile\n      ? \"全局默认\"\n      : \"默认\";\n  const hasAgentAllow = Array.isArray(agentTools.allow) && agentTools.allow.length > 0;\n  const hasGlobalAllow = Array.isArray(globalTools.allow) && globalTools.allow.length > 0;\n  const editable =\n    Boolean(params.configForm) && !params.configLoading && !params.configSaving && !hasAgentAllow;\n  const alsoAllow = hasAgentAllow\n    ? []\n    : Array.isArray(agentTools.alsoAllow)\n      ? agentTools.alsoAllow\n      : [];\n  const deny = hasAgentAllow ? [] : Array.isArray(agentTools.deny) ? agentTools.deny : [];\n  const basePolicy = hasAgentAllow\n    ? { allow: agentTools.allow ?? [], deny: agentTools.deny ?? [] }\n    : (resolveToolProfilePolicy(profile) ?? undefined);\n  const toolIds = TOOL_SECTIONS.flatMap((section) => section.tools.map((tool) => tool.id));\n\n  const resolveAllowed = (toolId: string) => {\n    const baseAllowed = isAllowedByPolicy(toolId, basePolicy);\n    const extraAllowed = matchesList(toolId, alsoAllow);\n    const denied = matchesList(toolId, deny);\n    const allowed = (baseAllowed || extraAllowed) && !denied;\n    return {\n      allowed,\n      baseAllowed,\n      denied,\n    };\n  };\n  const enabledCount = toolIds.filter((toolId) => resolveAllowed(toolId).allowed).length;\n\n  const updateTool = (toolId: string, nextEnabled: boolean) => {\n    const nextAllow = new Set(\n      alsoAllow.map((entry) => normalizeToolName(entry)).filter((entry) => entry.length > 0),\n    );\n    const nextDeny = new Set(\n      deny.map((entry) => normalizeToolName(entry)).filter((entry) => entry.length > 0),\n    );\n    const baseAllowed = resolveAllowed(toolId).baseAllowed;\n    const normalized = normalizeToolName(toolId);\n    if (nextEnabled) {\n      nextDeny.delete(normalized);\n      if (!baseAllowed) {\n        nextAllow.add(normalized);\n      }\n    } else {\n      nextAllow.delete(normalized);\n      nextDeny.add(normalized);\n    }\n    params.onOverridesChange(params.agentId, [...nextAllow], [...nextDeny]);\n  };\n\n  const updateAll = (nextEnabled: boolean) => {\n    const nextAllow = new Set(\n      alsoAllow.map((entry) => normalizeToolName(entry)).filter((entry) => entry.length > 0),\n    );\n    const nextDeny = new Set(\n      deny.map((entry) => normalizeToolName(entry)).filter((entry) => entry.length > 0),\n    );\n    for (const toolId of toolIds) {\n      const baseAllowed = resolveAllowed(toolId).baseAllowed;\n      const normalized = normalizeToolName(toolId);\n      if (nextEnabled) {\n        nextDeny.delete(normalized);\n        if (!baseAllowed) {\n          nextAllow.add(normalized);\n        }\n      } else {\n        nextAllow.delete(normalized);\n        nextDeny.add(normalized);\n      }\n    }\n    params.onOverridesChange(params.agentId, [...nextAllow], [...nextDeny]);\n  };\n\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">工具访问</div>\n          <div class=\"card-sub\">\n            此代理的配置文件及逐工具覆盖。\n            <span class=\"mono\">${enabledCount}/${toolIds.length}</span> 已启用。\n          </div>\n        </div>\n        <div class=\"row\" style=\"gap: 8px;\">\n          <button\n            class=\"btn btn--sm\"\n            ?disabled=${!editable}\n            @click=${() => updateAll(true)}\n          >\n            全部启用\n          </button>\n          <button\n            class=\"btn btn--sm\"\n            ?disabled=${!editable}\n            @click=${() => updateAll(false)}\n          >\n            全部禁用\n          </button>\n          <button\n            class=\"btn btn--sm\"\n            ?disabled=${params.configLoading}\n            @click=${params.onConfigReload}\n          >\n            重新加载配置\n          </button>\n          <button\n            class=\"btn btn--sm primary\"\n            ?disabled=${params.configSaving || !params.configDirty}\n            @click=${params.onConfigSave}\n          >\n            ${params.configSaving ? \"保存中…\" : \"保存\"}\n          </button>\n        </div>\n      </div>\n\n      ${\n        !params.configForm\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                加载网关配置以调整工具配置。\n              </div>\n            `\n          : nothing\n      }\n      ${\n        hasAgentAllow\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                此代理在配置中使用了显式允许列表。工具覆盖在配置选项卡中管理。\n              </div>\n            `\n          : nothing\n      }\n      ${\n        hasGlobalAllow\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                已设置全局 tools.allow。代理覆盖无法启用被全局阻止的工具。\n              </div>\n            `\n          : nothing\n      }\n\n      <div class=\"agent-tools-meta\" style=\"margin-top: 16px;\">\n        <div class=\"agent-kv\">\n          <div class=\"label\">配置文件</div>\n          <div class=\"mono\">${profile}</div>\n        </div>\n        <div class=\"agent-kv\">\n          <div class=\"label\">来源</div>\n          <div>${profileSource}</div>\n        </div>\n        ${\n          params.configDirty\n            ? html`\n                <div class=\"agent-kv\">\n                  <div class=\"label\">状态</div>\n                  <div class=\"mono\">未保存</div>\n                </div>\n              `\n            : nothing\n        }\n      </div>\n\n      <div class=\"agent-tools-presets\" style=\"margin-top: 16px;\">\n        <div class=\"label\">快速预设</div>\n        <div class=\"agent-tools-buttons\">\n          ${PROFILE_OPTIONS.map(\n            (option) => html`\n              <button\n                class=\"btn btn--sm ${profile === option.id ? \"active\" : \"\"}\"\n                ?disabled=${!editable}\n                @click=${() => params.onProfileChange(params.agentId, option.id, true)}\n              >\n                ${option.label}\n              </button>\n            `,\n          )}\n          <button\n            class=\"btn btn--sm\"\n            ?disabled=${!editable}\n            @click=${() => params.onProfileChange(params.agentId, null, false)}\n          >\n            继承\n          </button>\n        </div>\n      </div>\n\n      <div class=\"agent-tools-grid\" style=\"margin-top: 20px;\">\n        ${TOOL_SECTIONS.map(\n          (section) =>\n            html`\n            <div class=\"agent-tools-section\">\n              <div class=\"agent-tools-header\">${section.label}</div>\n              <div class=\"agent-tools-list\">\n                ${section.tools.map((tool) => {\n                  const { allowed } = resolveAllowed(tool.id);\n                  return html`\n                    <div class=\"agent-tool-row\">\n                      <div>\n                        <div class=\"agent-tool-title mono\">${tool.label}</div>\n                        <div class=\"agent-tool-sub\">${tool.description}</div>\n                      </div>\n                      <label class=\"cfg-toggle\">\n                        <input\n                          type=\"checkbox\"\n                          .checked=${allowed}\n                          ?disabled=${!editable}\n                          @change=${(e: Event) =>\n                            updateTool(tool.id, (e.target as HTMLInputElement).checked)}\n                        />\n                        <span class=\"cfg-toggle__track\"></span>\n                      </label>\n                    </div>\n                  `;\n                })}\n              </div>\n            </div>\n          `,\n        )}\n      </div>\n    </section>\n  `;\n}\n\ntype SkillGroup = {\n  id: string;\n  label: string;\n  skills: SkillStatusEntry[];\n};\n\nconst SKILL_SOURCE_GROUPS: Array<{ id: string; label: string; sources: string[] }> = [\n  { id: \"workspace\", label: \"工作区技能\", sources: [\"openclaw-workspace\"] },\n  { id: \"built-in\", label: \"内置技能\", sources: [\"openclaw-bundled\"] },\n  { id: \"installed\", label: \"已安装技能\", sources: [\"openclaw-managed\"] },\n  { id: \"extra\", label: \"额外技能\", sources: [\"openclaw-extra\"] },\n];\n\nfunction groupSkills(skills: SkillStatusEntry[]): SkillGroup[] {\n  const groups = new Map<string, SkillGroup>();\n  for (const def of SKILL_SOURCE_GROUPS) {\n    groups.set(def.id, { id: def.id, label: def.label, skills: [] });\n  }\n  const other: SkillGroup = { id: \"other\", label: \"其他技能\", skills: [] };\n  for (const skill of skills) {\n    const match = SKILL_SOURCE_GROUPS.find((group) => group.sources.includes(skill.source));\n    if (match) {\n      groups.get(match.id)?.skills.push(skill);\n    } else {\n      other.skills.push(skill);\n    }\n  }\n  const ordered = SKILL_SOURCE_GROUPS.map((group) => groups.get(group.id)).filter(\n    (group): group is SkillGroup => Boolean(group && group.skills.length > 0),\n  );\n  if (other.skills.length > 0) {\n    ordered.push(other);\n  }\n  return ordered;\n}\n\nfunction renderAgentSkills(params: {\n  agentId: string;\n  report: SkillStatusReport | null;\n  loading: boolean;\n  error: string | null;\n  activeAgentId: string | null;\n  configForm: Record<string, unknown> | null;\n  configLoading: boolean;\n  configSaving: boolean;\n  configDirty: boolean;\n  filter: string;\n  onFilterChange: (next: string) => void;\n  onRefresh: () => void;\n  onToggle: (agentId: string, skillName: string, enabled: boolean) => void;\n  onClear: (agentId: string) => void;\n  onDisableAll: (agentId: string) => void;\n  onConfigReload: () => void;\n  onConfigSave: () => void;\n}) {\n  const editable = Boolean(params.configForm) && !params.configLoading && !params.configSaving;\n  const config = resolveAgentConfig(params.configForm, params.agentId);\n  const allowlist = Array.isArray(config.entry?.skills) ? config.entry?.skills : undefined;\n  const allowSet = new Set((allowlist ?? []).map((name) => name.trim()).filter(Boolean));\n  const usingAllowlist = allowlist !== undefined;\n  const reportReady = Boolean(params.report && params.activeAgentId === params.agentId);\n  const rawSkills = reportReady ? (params.report?.skills ?? []) : [];\n  const filter = params.filter.trim().toLowerCase();\n  const filtered = filter\n    ? rawSkills.filter((skill) =>\n        [skill.name, skill.description, skill.source].join(\" \").toLowerCase().includes(filter),\n      )\n    : rawSkills;\n  const groups = groupSkills(filtered);\n  const enabledCount = usingAllowlist\n    ? rawSkills.filter((skill) => allowSet.has(skill.name)).length\n    : rawSkills.length;\n  const totalCount = rawSkills.length;\n\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">技能</div>\n          <div class=\"card-sub\">\n            代理级技能允许列表和工作区技能。\n            ${totalCount > 0 ? html`<span class=\"mono\">${enabledCount}/${totalCount}</span>` : nothing}\n          </div>\n        </div>\n        <div class=\"row\" style=\"gap: 8px;\">\n          <button class=\"btn btn--sm\" ?disabled=${!editable} @click=${() => params.onClear(params.agentId)}>\n            使用全部\n          </button>\n          <button class=\"btn btn--sm\" ?disabled=${!editable} @click=${() => params.onDisableAll(params.agentId)}>\n            全部禁用\n          </button>\n          <button\n            class=\"btn btn--sm\"\n            ?disabled=${params.configLoading}\n            @click=${params.onConfigReload}\n          >\n            重新加载配置\n          </button>\n          <button class=\"btn btn--sm\" ?disabled=${params.loading} @click=${params.onRefresh}>\n            ${params.loading ? \"加载中…\" : \"刷新\"}\n          </button>\n          <button\n            class=\"btn btn--sm primary\"\n            ?disabled=${params.configSaving || !params.configDirty}\n            @click=${params.onConfigSave}\n          >\n            ${params.configSaving ? \"保存中…\" : \"保存\"}\n          </button>\n        </div>\n      </div>\n\n      ${\n        !params.configForm\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                加载网关配置以设置代理级技能。\n              </div>\n            `\n          : nothing\n      }\n      ${\n        usingAllowlist\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">此代理使用自定义技能允许列表。</div>\n            `\n          : html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                所有技能已启用。禁用任何技能将创建代理级允许列表。\n              </div>\n            `\n      }\n      ${\n        !reportReady && !params.loading\n          ? html`\n              <div class=\"callout info\" style=\"margin-top: 12px\">\n                加载此代理的技能以查看工作区特定条目。\n              </div>\n            `\n          : nothing\n      }\n      ${\n        params.error\n          ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${params.error}</div>`\n          : nothing\n      }\n\n      <div class=\"filters\" style=\"margin-top: 14px;\">\n        <label class=\"field\" style=\"flex: 1;\">\n          <span>过滤</span>\n          <input\n            .value=${params.filter}\n            @input=${(e: Event) => params.onFilterChange((e.target as HTMLInputElement).value)}\n            placeholder=\"搜索技能\"\n          />\n        </label>\n        <div class=\"muted\">${filtered.length} 个显示</div>\n      </div>\n\n      ${\n        filtered.length === 0\n          ? html`\n              <div class=\"muted\" style=\"margin-top: 16px\">未找到技能。</div>\n            `\n          : html`\n              <div class=\"agent-skills-groups\" style=\"margin-top: 16px;\">\n                ${groups.map((group) =>\n                  renderAgentSkillGroup(group, {\n                    agentId: params.agentId,\n                    allowSet,\n                    usingAllowlist,\n                    editable,\n                    onToggle: params.onToggle,\n                  }),\n                )}\n              </div>\n            `\n      }\n    </section>\n  `;\n}\n\nfunction renderAgentSkillGroup(\n  group: SkillGroup,\n  params: {\n    agentId: string;\n    allowSet: Set<string>;\n    usingAllowlist: boolean;\n    editable: boolean;\n    onToggle: (agentId: string, skillName: string, enabled: boolean) => void;\n  },\n) {\n  const collapsedByDefault = group.id === \"workspace\" || group.id === \"built-in\";\n  return html`\n    <details class=\"agent-skills-group\" ?open=${!collapsedByDefault}>\n      <summary class=\"agent-skills-header\">\n        <span>${group.label}</span>\n        <span class=\"muted\">${group.skills.length}</span>\n      </summary>\n      <div class=\"list skills-grid\">\n        ${group.skills.map((skill) =>\n          renderAgentSkillRow(skill, {\n            agentId: params.agentId,\n            allowSet: params.allowSet,\n            usingAllowlist: params.usingAllowlist,\n            editable: params.editable,\n            onToggle: params.onToggle,\n          }),\n        )}\n      </div>\n    </details>\n  `;\n}\n\nfunction renderAgentSkillRow(\n  skill: SkillStatusEntry,\n  params: {\n    agentId: string;\n    allowSet: Set<string>;\n    usingAllowlist: boolean;\n    editable: boolean;\n    onToggle: (agentId: string, skillName: string, enabled: boolean) => void;\n  },\n) {\n  const enabled = params.usingAllowlist ? params.allowSet.has(skill.name) : true;\n  const missing = [\n    ...skill.missing.bins.map((b) => `bin:${b}`),\n    ...skill.missing.env.map((e) => `env:${e}`),\n    ...skill.missing.config.map((c) => `config:${c}`),\n    ...skill.missing.os.map((o) => `os:${o}`),\n  ];\n  const reasons: string[] = [];\n  if (skill.disabled) {\n    reasons.push(\"已禁用\");\n  }\n  if (skill.blockedByAllowlist) {\n    reasons.push(\"被允许列表阻止\");\n  }\n  return html`\n    <div class=\"list-item agent-skill-row\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">\n          ${skill.emoji ? `${skill.emoji} ` : \"\"}${skill.name}\n        </div>\n        <div class=\"list-sub\">${skill.description}</div>\n        <div class=\"chip-row\" style=\"margin-top: 6px;\">\n          <span class=\"chip\">${skill.source}</span>\n          <span class=\"chip ${skill.eligible ? \"chip-ok\" : \"chip-warn\"}\">\n            ${skill.eligible ? \"可用\" : \"已阻止\"}\n          </span>\n          ${\n            skill.disabled\n              ? html`\n                  <span class=\"chip chip-warn\">已禁用</span>\n                `\n              : nothing\n          }\n        </div>\n        ${\n          missing.length > 0\n            ? html`<div class=\"muted\" style=\"margin-top: 6px;\">缺失：${missing.join(\", \")}</div>`\n            : nothing\n        }\n        ${\n          reasons.length > 0\n            ? html`<div class=\"muted\" style=\"margin-top: 6px;\">原因：${reasons.join(\", \")}</div>`\n            : nothing\n        }\n      </div>\n      <div class=\"list-meta\">\n        <label class=\"cfg-toggle\">\n          <input\n            type=\"checkbox\"\n            .checked=${enabled}\n            ?disabled=${!params.editable}\n            @change=${(e: Event) =>\n              params.onToggle(params.agentId, skill.name, (e.target as HTMLInputElement).checked)}\n          />\n          <span class=\"cfg-toggle__track\"></span>\n        </label>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport type { ChannelAccountSnapshot } from \"../types\";\nimport type { ChannelKey, ChannelsProps } from \"./channels.types\";\n\nexport function formatDuration(ms?: number | null) {\n  if (!ms && ms !== 0) return \"n/a\";\n  const sec = Math.round(ms / 1000);\n  if (sec < 60) return `${sec}s`;\n  const min = Math.round(sec / 60);\n  if (min < 60) return `${min}m`;\n  const hr = Math.round(min / 60);\n  return `${hr}h`;\n}\n\nexport function channelEnabled(key: ChannelKey, props: ChannelsProps) {\n  const snapshot = props.snapshot;\n  const channels = snapshot?.channels as Record<string, unknown> | null;\n  if (!snapshot || !channels) return false;\n  const channelStatus = channels[key] as Record<string, unknown> | undefined;\n  const configured = typeof channelStatus?.configured === \"boolean\" && channelStatus.configured;\n  const running = typeof channelStatus?.running === \"boolean\" && channelStatus.running;\n  const connected = typeof channelStatus?.connected === \"boolean\" && channelStatus.connected;\n  const accounts = snapshot.channelAccounts?.[key] ?? [];\n  const accountActive = accounts.some(\n    (account) => account.configured || account.running || account.connected,\n  );\n  return configured || running || connected || accountActive;\n}\n\nexport function getChannelAccountCount(\n  key: ChannelKey,\n  channelAccounts?: Record<string, ChannelAccountSnapshot[]> | null,\n): number {\n  return channelAccounts?.[key]?.length ?? 0;\n}\n\nexport function renderChannelAccountCount(\n  key: ChannelKey,\n  channelAccounts?: Record<string, ChannelAccountSnapshot[]> | null,\n) {\n  const count = getChannelAccountCount(key, channelAccounts);\n  if (count < 2) return nothing;\n  return html`<div class=\"account-count\">账户 (${count})</div>`;\n}\n","import type { ConfigUiHints } from \"../types\";\n\nexport type JsonSchema = {\n  type?: string | string[];\n  title?: string;\n  description?: string;\n  properties?: Record<string, JsonSchema>;\n  items?: JsonSchema | JsonSchema[];\n  additionalProperties?: JsonSchema | boolean;\n  enum?: unknown[];\n  const?: unknown;\n  default?: unknown;\n  anyOf?: JsonSchema[];\n  oneOf?: JsonSchema[];\n  allOf?: JsonSchema[];\n  nullable?: boolean;\n};\n\nexport function schemaType(schema: JsonSchema): string | undefined {\n  if (!schema) return undefined;\n  if (Array.isArray(schema.type)) {\n    const filtered = schema.type.filter((t) => t !== \"null\");\n    return filtered[0] ?? schema.type[0];\n  }\n  return schema.type;\n}\n\nexport function defaultValue(schema?: JsonSchema): unknown {\n  if (!schema) return \"\";\n  if (schema.default !== undefined) return schema.default;\n  const type = schemaType(schema);\n  switch (type) {\n    case \"object\":\n      return {};\n    case \"array\":\n      return [];\n    case \"boolean\":\n      return false;\n    case \"number\":\n    case \"integer\":\n      return 0;\n    case \"string\":\n      return \"\";\n    default:\n      return \"\";\n  }\n}\n\nexport function pathKey(path: Array<string | number>): string {\n  return path.filter((segment) => typeof segment === \"string\").join(\".\");\n}\n\nexport function hintForPath(path: Array<string | number>, hints: ConfigUiHints) {\n  const key = pathKey(path);\n  const direct = hints[key];\n  if (direct) return direct;\n  const segments = key.split(\".\");\n  for (const [hintKey, hint] of Object.entries(hints)) {\n    if (!hintKey.includes(\"*\")) continue;\n    const hintSegments = hintKey.split(\".\");\n    if (hintSegments.length !== segments.length) continue;\n    let match = true;\n    for (let i = 0; i < segments.length; i += 1) {\n      if (hintSegments[i] !== \"*\" && hintSegments[i] !== segments[i]) {\n        match = false;\n        break;\n      }\n    }\n    if (match) return hint;\n  }\n  return undefined;\n}\n\nexport function humanize(raw: string) {\n  return raw\n    .replace(/_/g, \" \")\n    .replace(/([a-z0-9])([A-Z])/g, \"$1 $2\")\n    .replace(/\\s+/g, \" \")\n    .replace(/^./, (m) => m.toUpperCase());\n}\n\nexport function isSensitivePath(path: Array<string | number>): boolean {\n  const key = pathKey(path).toLowerCase();\n  return (\n    key.includes(\"token\") ||\n    key.includes(\"password\") ||\n    key.includes(\"secret\") ||\n    key.includes(\"apikey\") ||\n    key.endsWith(\"key\")\n  );\n}\n","import { html, nothing, type TemplateResult } from \"lit\";\nimport type { ConfigUiHints } from \"../types\";\nimport {\n  defaultValue,\n  hintForPath,\n  humanize,\n  isSensitivePath,\n  pathKey,\n  schemaType,\n  type JsonSchema,\n} from \"./config-form.shared\";\n\nconst META_KEYS = new Set([\"title\", \"description\", \"default\", \"nullable\"]);\n\nfunction isAnySchema(schema: JsonSchema): boolean {\n  const keys = Object.keys(schema ?? {}).filter((key) => !META_KEYS.has(key));\n  return keys.length === 0;\n}\n\nfunction jsonValue(value: unknown): string {\n  if (value === undefined) return \"\";\n  try {\n    return JSON.stringify(value, null, 2) ?? \"\";\n  } catch {\n    return \"\";\n  }\n}\n\n// SVG Icons as template literals\nconst icons = {\n  chevronDown: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"6 9 12 15 18 9\"></polyline></svg>`,\n  plus: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"12\" y1=\"5\" x2=\"12\" y2=\"19\"></line><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>`,\n  minus: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><line x1=\"5\" y1=\"12\" x2=\"19\" y2=\"12\"></line></svg>`,\n  trash: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><polyline points=\"3 6 5 6 21 6\"></polyline><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"></path></svg>`,\n  edit: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path><path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path></svg>`,\n};\n\nexport function renderNode(params: {\n  schema: JsonSchema;\n  value: unknown;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  unsupported: Set<string>;\n  disabled: boolean;\n  showLabel?: boolean;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult | typeof nothing {\n  const { schema, value, path, hints, unsupported, disabled, onPatch } = params;\n  const showLabel = params.showLabel ?? true;\n  const type = schemaType(schema);\n  const hint = hintForPath(path, hints);\n  const label = hint?.label ?? schema.title ?? humanize(String(path.at(-1)));\n  const help = hint?.help ?? schema.description;\n  const key = pathKey(path);\n\n  if (unsupported.has(key)) {\n    return html`<div class=\"cfg-field cfg-field--error\">\n      <div class=\"cfg-field__label\">${label}</div>\n      <div class=\"cfg-field__error\">不支持的模式节点。请使用原始模式。</div>\n    </div>`;\n  }\n\n  // Handle anyOf/oneOf unions\n  if (schema.anyOf || schema.oneOf) {\n    const variants = schema.anyOf ?? schema.oneOf ?? [];\n    const nonNull = variants.filter(\n      (v) => !(v.type === \"null\" || (Array.isArray(v.type) && v.type.includes(\"null\")))\n    );\n\n    if (nonNull.length === 1) {\n      return renderNode({ ...params, schema: nonNull[0] });\n    }\n\n    // Check if it's a set of literal values (enum-like)\n    const extractLiteral = (v: JsonSchema): unknown | undefined => {\n      if (v.const !== undefined) return v.const;\n      if (v.enum && v.enum.length === 1) return v.enum[0];\n      return undefined;\n    };\n    const literals = nonNull.map(extractLiteral);\n    const allLiterals = literals.every((v) => v !== undefined);\n\n    if (allLiterals && literals.length > 0 && literals.length <= 5) {\n      // Use segmented control for small sets\n      const resolvedValue = value ?? schema.default;\n      return html`\n        <div class=\"cfg-field\">\n          ${showLabel ? html`<label class=\"cfg-field__label\">${label}</label>` : nothing}\n          ${help ? html`<div class=\"cfg-field__help\">${help}</div>` : nothing}\n          <div class=\"cfg-segmented\">\n            ${literals.map((lit, idx) => html`\n              <button\n                type=\"button\"\n                class=\"cfg-segmented__btn ${lit === resolvedValue || String(lit) === String(resolvedValue) ? 'active' : ''}\"\n                ?disabled=${disabled}\n                @click=${() => onPatch(path, lit)}\n              >\n                ${String(lit)}\n              </button>\n            `)}\n          </div>\n        </div>\n      `;\n    }\n\n    if (allLiterals && literals.length > 5) {\n      // Use dropdown for larger sets\n      return renderSelect({ ...params, options: literals, value: value ?? schema.default });\n    }\n\n    // Handle mixed primitive types\n    const primitiveTypes = new Set(\n      nonNull.map((variant) => schemaType(variant)).filter(Boolean)\n    );\n    const normalizedTypes = new Set(\n      [...primitiveTypes].map((v) => (v === \"integer\" ? \"number\" : v))\n    );\n\n    if ([...normalizedTypes].every((v) => [\"string\", \"number\", \"boolean\"].includes(v as string))) {\n      const hasString = normalizedTypes.has(\"string\");\n      const hasNumber = normalizedTypes.has(\"number\");\n      const hasBoolean = normalizedTypes.has(\"boolean\");\n\n      if (hasBoolean && normalizedTypes.size === 1) {\n        return renderNode({\n          ...params,\n          schema: { ...schema, type: \"boolean\", anyOf: undefined, oneOf: undefined },\n        });\n      }\n\n      if (hasString || hasNumber) {\n        return renderTextInput({\n          ...params,\n          inputType: hasNumber && !hasString ? \"number\" : \"text\",\n        });\n      }\n    }\n  }\n\n  // Enum - use segmented for small, dropdown for large\n  if (schema.enum) {\n    const options = schema.enum;\n    if (options.length <= 5) {\n      const resolvedValue = value ?? schema.default;\n      return html`\n        <div class=\"cfg-field\">\n          ${showLabel ? html`<label class=\"cfg-field__label\">${label}</label>` : nothing}\n          ${help ? html`<div class=\"cfg-field__help\">${help}</div>` : nothing}\n          <div class=\"cfg-segmented\">\n            ${options.map((opt) => html`\n              <button\n                type=\"button\"\n                class=\"cfg-segmented__btn ${opt === resolvedValue || String(opt) === String(resolvedValue) ? 'active' : ''}\"\n                ?disabled=${disabled}\n                @click=${() => onPatch(path, opt)}\n              >\n                ${String(opt)}\n              </button>\n            `)}\n          </div>\n        </div>\n      `;\n    }\n    return renderSelect({ ...params, options, value: value ?? schema.default });\n  }\n\n  // Object type - collapsible section\n  if (type === \"object\") {\n    return renderObject(params);\n  }\n\n  // Array type\n  if (type === \"array\") {\n    return renderArray(params);\n  }\n\n  // Boolean - toggle row\n  if (type === \"boolean\") {\n    const displayValue = typeof value === \"boolean\" ? value : typeof schema.default === \"boolean\" ? schema.default : false;\n    return html`\n      <label class=\"cfg-toggle-row ${disabled ? 'disabled' : ''}\">\n        <div class=\"cfg-toggle-row__content\">\n          <span class=\"cfg-toggle-row__label\">${label}</span>\n          ${help ? html`<span class=\"cfg-toggle-row__help\">${help}</span>` : nothing}\n        </div>\n        <div class=\"cfg-toggle\">\n          <input\n            type=\"checkbox\"\n            .checked=${displayValue}\n            ?disabled=${disabled}\n            @change=${(e: Event) => onPatch(path, (e.target as HTMLInputElement).checked)}\n          />\n          <span class=\"cfg-toggle__track\"></span>\n        </div>\n      </label>\n    `;\n  }\n\n  // Number/Integer\n  if (type === \"number\" || type === \"integer\") {\n    return renderNumberInput(params);\n  }\n\n  // String\n  if (type === \"string\") {\n    return renderTextInput({ ...params, inputType: \"text\" });\n  }\n\n  // Fallback\n  return html`\n    <div class=\"cfg-field cfg-field--error\">\n      <div class=\"cfg-field__label\">${label}</div>\n      <div class=\"cfg-field__error\">不支持的类型: ${type}。请使用原始模式。</div>\n    </div>\n  `;\n}\n\nfunction renderTextInput(params: {\n  schema: JsonSchema;\n  value: unknown;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  disabled: boolean;\n  showLabel?: boolean;\n  inputType: \"text\" | \"number\";\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult {\n  const { schema, value, path, hints, disabled, onPatch, inputType } = params;\n  const showLabel = params.showLabel ?? true;\n  const hint = hintForPath(path, hints);\n  const label = hint?.label ?? schema.title ?? humanize(String(path.at(-1)));\n  const help = hint?.help ?? schema.description;\n  const isSensitive = hint?.sensitive ?? isSensitivePath(path);\n  const placeholder =\n    hint?.placeholder ??\n    (isSensitive ? \"••••\" : schema.default !== undefined ? `Default: ${schema.default}` : \"\");\n  const displayValue = value ?? \"\";\n\n  return html`\n    <div class=\"cfg-field\">\n      ${showLabel ? html`<label class=\"cfg-field__label\">${label}</label>` : nothing}\n      ${help ? html`<div class=\"cfg-field__help\">${help}</div>` : nothing}\n      <div class=\"cfg-input-wrap\">\n        <input\n          type=${isSensitive ? \"password\" : inputType}\n          class=\"cfg-input\"\n          placeholder=${placeholder}\n          .value=${displayValue == null ? \"\" : String(displayValue)}\n          ?disabled=${disabled}\n          @input=${(e: Event) => {\n            const raw = (e.target as HTMLInputElement).value;\n            if (inputType === \"number\") {\n              if (raw.trim() === \"\") {\n                onPatch(path, undefined);\n                return;\n              }\n              const parsed = Number(raw);\n              onPatch(path, Number.isNaN(parsed) ? raw : parsed);\n              return;\n            }\n            onPatch(path, raw);\n          }}\n        />\n        ${schema.default !== undefined ? html`\n          <button\n            type=\"button\"\n            class=\"cfg-input__reset\"\n            title=\"Reset to default\"\n            ?disabled=${disabled}\n            @click=${() => onPatch(path, schema.default)}\n          >↺</button>\n        ` : nothing}\n      </div>\n    </div>\n  `;\n}\n\nfunction renderNumberInput(params: {\n  schema: JsonSchema;\n  value: unknown;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  disabled: boolean;\n  showLabel?: boolean;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult {\n  const { schema, value, path, hints, disabled, onPatch } = params;\n  const showLabel = params.showLabel ?? true;\n  const hint = hintForPath(path, hints);\n  const label = hint?.label ?? schema.title ?? humanize(String(path.at(-1)));\n  const help = hint?.help ?? schema.description;\n  const displayValue = value ?? schema.default ?? \"\";\n  const numValue = typeof displayValue === \"number\" ? displayValue : 0;\n\n  return html`\n    <div class=\"cfg-field\">\n      ${showLabel ? html`<label class=\"cfg-field__label\">${label}</label>` : nothing}\n      ${help ? html`<div class=\"cfg-field__help\">${help}</div>` : nothing}\n      <div class=\"cfg-number\">\n        <button\n          type=\"button\"\n          class=\"cfg-number__btn\"\n          ?disabled=${disabled}\n          @click=${() => onPatch(path, numValue - 1)}\n        >−</button>\n        <input\n          type=\"number\"\n          class=\"cfg-number__input\"\n          .value=${displayValue == null ? \"\" : String(displayValue)}\n          ?disabled=${disabled}\n          @input=${(e: Event) => {\n            const raw = (e.target as HTMLInputElement).value;\n            const parsed = raw === \"\" ? undefined : Number(raw);\n            onPatch(path, parsed);\n          }}\n        />\n        <button\n          type=\"button\"\n          class=\"cfg-number__btn\"\n          ?disabled=${disabled}\n          @click=${() => onPatch(path, numValue + 1)}\n        >+</button>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderSelect(params: {\n  schema: JsonSchema;\n  value: unknown;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  disabled: boolean;\n  showLabel?: boolean;\n  options: unknown[];\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult {\n  const { schema, value, path, hints, disabled, options, onPatch } = params;\n  const showLabel = params.showLabel ?? true;\n  const hint = hintForPath(path, hints);\n  const label = hint?.label ?? schema.title ?? humanize(String(path.at(-1)));\n  const help = hint?.help ?? schema.description;\n  const resolvedValue = value ?? schema.default;\n  const currentIndex = options.findIndex(\n    (opt) => opt === resolvedValue || String(opt) === String(resolvedValue),\n  );\n  const unset = \"__unset__\";\n\n  return html`\n    <div class=\"cfg-field\">\n      ${showLabel ? html`<label class=\"cfg-field__label\">${label}</label>` : nothing}\n      ${help ? html`<div class=\"cfg-field__help\">${help}</div>` : nothing}\n      <select\n        class=\"cfg-select\"\n        ?disabled=${disabled}\n        .value=${currentIndex >= 0 ? String(currentIndex) : unset}\n        @change=${(e: Event) => {\n          const val = (e.target as HTMLSelectElement).value;\n          onPatch(path, val === unset ? undefined : options[Number(val)]);\n        }}\n      >\n        <option value=${unset}>Select...</option>\n        ${options.map((opt, idx) => html`\n          <option value=${String(idx)}>${String(opt)}</option>\n        `)}\n      </select>\n    </div>\n  `;\n}\n\nfunction renderObject(params: {\n  schema: JsonSchema;\n  value: unknown;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  unsupported: Set<string>;\n  disabled: boolean;\n  showLabel?: boolean;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult {\n  const { schema, value, path, hints, unsupported, disabled, onPatch } = params;\n  const showLabel = params.showLabel ?? true;\n  const hint = hintForPath(path, hints);\n  const label = hint?.label ?? schema.title ?? humanize(String(path.at(-1)));\n  const help = hint?.help ?? schema.description;\n\n  const fallback = value ?? schema.default;\n  const obj = fallback && typeof fallback === \"object\" && !Array.isArray(fallback)\n    ? (fallback as Record<string, unknown>)\n    : {};\n  const props = schema.properties ?? {};\n  const entries = Object.entries(props);\n\n  // Sort by hint order\n  const sorted = entries.sort((a, b) => {\n    const orderA = hintForPath([...path, a[0]], hints)?.order ?? 0;\n    const orderB = hintForPath([...path, b[0]], hints)?.order ?? 0;\n    if (orderA !== orderB) return orderA - orderB;\n    return a[0].localeCompare(b[0]);\n  });\n\n  const reserved = new Set(Object.keys(props));\n  const additional = schema.additionalProperties;\n  const allowExtra = Boolean(additional) && typeof additional === \"object\";\n\n  // For top-level, don't wrap in collapsible\n  if (path.length === 1) {\n    return html`\n      <div class=\"cfg-fields\">\n        ${sorted.map(([propKey, node]) =>\n          renderNode({\n            schema: node,\n            value: obj[propKey],\n            path: [...path, propKey],\n            hints,\n            unsupported,\n            disabled,\n            onPatch,\n          })\n        )}\n        ${allowExtra ? renderMapField({\n          schema: additional as JsonSchema,\n          value: obj,\n          path,\n          hints,\n          unsupported,\n          disabled,\n          reservedKeys: reserved,\n          onPatch,\n        }) : nothing}\n      </div>\n    `;\n  }\n\n  // Nested objects get collapsible treatment\n  return html`\n    <details class=\"cfg-object\" open>\n      <summary class=\"cfg-object__header\">\n        <span class=\"cfg-object__title\">${label}</span>\n        <span class=\"cfg-object__chevron\">${icons.chevronDown}</span>\n      </summary>\n      ${help ? html`<div class=\"cfg-object__help\">${help}</div>` : nothing}\n      <div class=\"cfg-object__content\">\n        ${sorted.map(([propKey, node]) =>\n          renderNode({\n            schema: node,\n            value: obj[propKey],\n            path: [...path, propKey],\n            hints,\n            unsupported,\n            disabled,\n            onPatch,\n          })\n        )}\n        ${allowExtra ? renderMapField({\n          schema: additional as JsonSchema,\n          value: obj,\n          path,\n          hints,\n          unsupported,\n          disabled,\n          reservedKeys: reserved,\n          onPatch,\n        }) : nothing}\n      </div>\n    </details>\n  `;\n}\n\nfunction renderArray(params: {\n  schema: JsonSchema;\n  value: unknown;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  unsupported: Set<string>;\n  disabled: boolean;\n  showLabel?: boolean;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult {\n  const { schema, value, path, hints, unsupported, disabled, onPatch } = params;\n  const showLabel = params.showLabel ?? true;\n  const hint = hintForPath(path, hints);\n  const label = hint?.label ?? schema.title ?? humanize(String(path.at(-1)));\n  const help = hint?.help ?? schema.description;\n\n  const itemsSchema = Array.isArray(schema.items) ? schema.items[0] : schema.items;\n  if (!itemsSchema) {\n    return html`\n      <div class=\"cfg-field cfg-field--error\">\n        <div class=\"cfg-field__label\">${label}</div>\n        <div class=\"cfg-field__error\">不支持的数组模式。请使用原始模式。</div>\n      </div>\n    `;\n  }\n\n  const arr = Array.isArray(value) ? value : Array.isArray(schema.default) ? schema.default : [];\n\n  return html`\n    <div class=\"cfg-array\">\n      <div class=\"cfg-array__header\">\n        ${showLabel ? html`<span class=\"cfg-array__label\">${label}</span>` : nothing}\n        <span class=\"cfg-array__count\">${arr.length} item${arr.length !== 1 ? 's' : ''}</span>\n        <button\n          type=\"button\"\n          class=\"cfg-array__add\"\n          ?disabled=${disabled}\n          @click=${() => {\n            const next = [...arr, defaultValue(itemsSchema)];\n            onPatch(path, next);\n          }}\n        >\n          <span class=\"cfg-array__add-icon\">${icons.plus}</span>\n          Add\n        </button>\n      </div>\n      ${help ? html`<div class=\"cfg-array__help\">${help}</div>` : nothing}\n\n      ${arr.length === 0 ? html`\n        <div class=\"cfg-array__empty\">\n          No items yet. Click \"Add\" to create one.\n        </div>\n      ` : html`\n        <div class=\"cfg-array__items\">\n          ${arr.map((item, idx) => html`\n            <div class=\"cfg-array__item\">\n              <div class=\"cfg-array__item-header\">\n                <span class=\"cfg-array__item-index\">#${idx + 1}</span>\n                <button\n                  type=\"button\"\n                  class=\"cfg-array__item-remove\"\n                  title=\"Remove item\"\n                  ?disabled=${disabled}\n                  @click=${() => {\n                    const next = [...arr];\n                    next.splice(idx, 1);\n                    onPatch(path, next);\n                  }}\n                >\n                  ${icons.trash}\n                </button>\n              </div>\n              <div class=\"cfg-array__item-content\">\n                ${renderNode({\n                  schema: itemsSchema,\n                  value: item,\n                  path: [...path, idx],\n                  hints,\n                  unsupported,\n                  disabled,\n                  showLabel: false,\n                  onPatch,\n                })}\n              </div>\n            </div>\n          `)}\n        </div>\n      `}\n    </div>\n  `;\n}\n\nfunction renderMapField(params: {\n  schema: JsonSchema;\n  value: Record<string, unknown>;\n  path: Array<string | number>;\n  hints: ConfigUiHints;\n  unsupported: Set<string>;\n  disabled: boolean;\n  reservedKeys: Set<string>;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n}): TemplateResult {\n  const { schema, value, path, hints, unsupported, disabled, reservedKeys, onPatch } = params;\n  const anySchema = isAnySchema(schema);\n  const entries = Object.entries(value ?? {}).filter(([key]) => !reservedKeys.has(key));\n\n  return html`\n    <div class=\"cfg-map\">\n      <div class=\"cfg-map__header\">\n        <span class=\"cfg-map__label\">Custom entries</span>\n        <button\n          type=\"button\"\n          class=\"cfg-map__add\"\n          ?disabled=${disabled}\n          @click=${() => {\n            const next = { ...(value ?? {}) };\n            let index = 1;\n            let key = `custom-${index}`;\n            while (key in next) {\n              index += 1;\n              key = `custom-${index}`;\n            }\n            next[key] = anySchema ? {} : defaultValue(schema);\n            onPatch(path, next);\n          }}\n        >\n          <span class=\"cfg-map__add-icon\">${icons.plus}</span>\n          Add Entry\n        </button>\n      </div>\n\n      ${entries.length === 0 ? html`\n        <div class=\"cfg-map__empty\">No custom entries.</div>\n      ` : html`\n        <div class=\"cfg-map__items\">\n          ${entries.map(([key, entryValue]) => {\n            const valuePath = [...path, key];\n            const fallback = jsonValue(entryValue);\n            return html`\n              <div class=\"cfg-map__item\">\n                <div class=\"cfg-map__item-key\">\n                  <input\n                    type=\"text\"\n                    class=\"cfg-input cfg-input--sm\"\n                    placeholder=\"Key\"\n                    .value=${key}\n                    ?disabled=${disabled}\n                    @change=${(e: Event) => {\n                      const nextKey = (e.target as HTMLInputElement).value.trim();\n                      if (!nextKey || nextKey === key) return;\n                      const next = { ...(value ?? {}) };\n                      if (nextKey in next) return;\n                      next[nextKey] = next[key];\n                      delete next[key];\n                      onPatch(path, next);\n                    }}\n                  />\n                </div>\n                <div class=\"cfg-map__item-value\">\n                  ${anySchema\n                    ? html`\n                        <textarea\n                          class=\"cfg-textarea cfg-textarea--sm\"\n                          placeholder=\"JSON value\"\n                          rows=\"2\"\n                          .value=${fallback}\n                          ?disabled=${disabled}\n                          @change=${(e: Event) => {\n                            const target = e.target as HTMLTextAreaElement;\n                            const raw = target.value.trim();\n                            if (!raw) {\n                              onPatch(valuePath, undefined);\n                              return;\n                            }\n                            try {\n                              onPatch(valuePath, JSON.parse(raw));\n                            } catch {\n                              target.value = fallback;\n                            }\n                          }}\n                        ></textarea>\n                      `\n                    : renderNode({\n                        schema,\n                        value: entryValue,\n                        path: valuePath,\n                        hints,\n                        unsupported,\n                        disabled,\n                        showLabel: false,\n                        onPatch,\n                      })}\n                </div>\n                <button\n                  type=\"button\"\n                  class=\"cfg-map__item-remove\"\n                  title=\"Remove entry\"\n                  ?disabled=${disabled}\n                  @click=${() => {\n                    const next = { ...(value ?? {}) };\n                    delete next[key];\n                    onPatch(path, next);\n                  }}\n                >\n                  ${icons.trash}\n                </button>\n              </div>\n            `;\n          })}\n        </div>\n      `}\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\nimport type { ConfigUiHints } from \"../types\";\nimport { icons } from \"../icons\";\nimport {\n  hintForPath,\n  humanize,\n  schemaType,\n  type JsonSchema,\n} from \"./config-form.shared\";\nimport { renderNode } from \"./config-form.node\";\n\nexport type ConfigFormProps = {\n  schema: JsonSchema | null;\n  uiHints: ConfigUiHints;\n  value: Record<string, unknown> | null;\n  disabled?: boolean;\n  unsupportedPaths?: string[];\n  searchQuery?: string;\n  activeSection?: string | null;\n  activeSubsection?: string | null;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n};\n\n// SVG Icons for section cards (Lucide-style)\nconst sectionIcons = {\n  env: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"></path></svg>`,\n  update: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"></path><polyline points=\"7 10 12 15 17 10\"></polyline><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"></line></svg>`,\n  agents: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z\"></path><circle cx=\"8\" cy=\"14\" r=\"1\"></circle><circle cx=\"16\" cy=\"14\" r=\"1\"></circle></svg>`,\n  auth: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\"></rect><path d=\"M7 11V7a5 5 0 0 1 10 0v4\"></path></svg>`,\n  channels: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"></path></svg>`,\n  messages: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"></path><polyline points=\"22,6 12,13 2,6\"></polyline></svg>`,\n  commands: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><polyline points=\"4 17 10 11 4 5\"></polyline><line x1=\"12\" y1=\"19\" x2=\"20\" y2=\"19\"></line></svg>`,\n  hooks: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"></path><path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"></path></svg>`,\n  skills: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\"></polygon></svg>`,\n  tools: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"></path></svg>`,\n  gateway: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"2\" y1=\"12\" x2=\"22\" y2=\"12\"></line><path d=\"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z\"></path></svg>`,\n  wizard: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M15 4V2\"></path><path d=\"M15 16v-2\"></path><path d=\"M8 9h2\"></path><path d=\"M20 9h2\"></path><path d=\"M17.8 11.8 19 13\"></path><path d=\"M15 9h0\"></path><path d=\"M17.8 6.2 19 5\"></path><path d=\"m3 21 9-9\"></path><path d=\"M12.2 6.2 11 5\"></path></svg>`,\n  // Additional sections\n  meta: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M12 20h9\"></path><path d=\"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z\"></path></svg>`,\n  logging: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"></path><polyline points=\"14 2 14 8 20 8\"></polyline><line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"></line><line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"></line><polyline points=\"10 9 9 9 8 9\"></polyline></svg>`,\n  browser: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><circle cx=\"12\" cy=\"12\" r=\"4\"></circle><line x1=\"21.17\" y1=\"8\" x2=\"12\" y2=\"8\"></line><line x1=\"3.95\" y1=\"6.06\" x2=\"8.54\" y2=\"14\"></line><line x1=\"10.88\" y1=\"21.94\" x2=\"15.46\" y2=\"14\"></line></svg>`,\n  ui: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\"></line><line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\"></line></svg>`,\n  models: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\"></path><polyline points=\"3.27 6.96 12 12.01 20.73 6.96\"></polyline><line x1=\"12\" y1=\"22.08\" x2=\"12\" y2=\"12\"></line></svg>`,\n  bindings: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><rect x=\"2\" y=\"2\" width=\"20\" height=\"8\" rx=\"2\" ry=\"2\"></rect><rect x=\"2\" y=\"14\" width=\"20\" height=\"8\" rx=\"2\" ry=\"2\"></rect><line x1=\"6\" y1=\"6\" x2=\"6.01\" y2=\"6\"></line><line x1=\"6\" y1=\"18\" x2=\"6.01\" y2=\"18\"></line></svg>`,\n  broadcast: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M4.9 19.1C1 15.2 1 8.8 4.9 4.9\"></path><path d=\"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5\"></path><circle cx=\"12\" cy=\"12\" r=\"2\"></circle><path d=\"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5\"></path><path d=\"M19.1 4.9C23 8.8 23 15.1 19.1 19\"></path></svg>`,\n  audio: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M9 18V5l12-2v13\"></path><circle cx=\"6\" cy=\"18\" r=\"3\"></circle><circle cx=\"18\" cy=\"16\" r=\"3\"></circle></svg>`,\n  session: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"></path><circle cx=\"9\" cy=\"7\" r=\"4\"></circle><path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"></path><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"></path></svg>`,\n  cron: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>`,\n  web: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"2\" y1=\"12\" x2=\"22\" y2=\"12\"></line><path d=\"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z\"></path></svg>`,\n  discovery: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><circle cx=\"11\" cy=\"11\" r=\"8\"></circle><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"></line></svg>`,\n  canvasHost: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"></circle><polyline points=\"21 15 16 10 5 21\"></polyline></svg>`,\n  talk: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\"></path><path d=\"M19 10v2a7 7 0 0 1-14 0v-2\"></path><line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\"></line><line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\"></line></svg>`,\n  plugins: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M12 2v6\"></path><path d=\"m4.93 10.93 4.24 4.24\"></path><path d=\"M2 12h6\"></path><path d=\"m4.93 13.07 4.24-4.24\"></path><path d=\"M12 22v-6\"></path><path d=\"m19.07 13.07-4.24-4.24\"></path><path d=\"M22 12h-6\"></path><path d=\"m19.07 10.93-4.24 4.24\"></path></svg>`,\n  default: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"1.5\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"></path><polyline points=\"14 2 14 8 20 8\"></polyline></svg>`,\n};\n\n// Section metadata\nexport const SECTION_META: Record<string, { label: string; description: string }> = {\n  env: { label: \"环境变量\", description: \"传递给网关进程的环境变量\" },\n  update: { label: \"更新\", description: \"自动更新设置和发布渠道\" },\n  agents: { label: \"代理\", description: \"代理配置、模型和身份\" },\n  auth: { label: \"身份验证\", description: \"API密钥和身份验证配置文件\" },\n  channels: { label: \"通道\", description: \"消息通道（Telegram、Discord、Slack等）\" },\n  messages: { label: \"消息\", description: \"消息处理和路由设置\" },\n  commands: { label: \"命令\", description: \"自定义斜杠命令\" },\n  hooks: { label: \"钩子\", description: \"Webhooks和事件钩子\" },\n  skills: { label: \"技能\", description: \"技能包和能力\" },\n  tools: { label: \"工具\", description: \"工具配置（浏览器、搜索等）\" },\n  gateway: { label: \"网关\", description: \"网关服务器设置（端口、身份验证、绑定）\" },\n  wizard: { label: \"设置向导\", description: \"设置向导状态和历史记录\" },\n  // 其他部分\n  diagnostics: { label: \"诊断\", description: \"诊断设置\" },\n  meta: { label: \"元数据\", description: \"网关元数据和版本信息\" },\n  logging: { label: \"日志\", description: \"日志级别和输出配置\" },\n  browser: { label: \"浏览器\", description: \"浏览器自动化设置\" },\n  ui: { label: \"用户界面\", description: \"用户界面偏好设置\" },\n  models: { label: \"模型\", description: \"AI模型配置和提供商\" },\n  bindings: { label: \"绑定\", description: \"键绑定和快捷键\" },\n  broadcast: { label: \"广播\", description: \"广播和通知设置\" },\n  audio: { label: \"音频\", description: \"音频输入/输出设置\" },\n  session: { label: \"会话\", description: \"会话管理和持久化\" },\n  cron: { label: \"定时任务\", description: \"计划任务和自动化\" },\n  web: { label: \"Web\", description: \"Web服务器和API设置\" },\n  discovery: { label: \"发现\", description: \"服务发现和网络\" },\n  canvasHost: { label: \"Canvas主机\", description: \"Canvas渲染和显示\" },\n  talk: { label: \"语音\", description: \"语音和语音设置\" },\n  plugins: { label: \"插件\", description: \"插件管理和扩展\" },\n};\n\nfunction getSectionIcon(key: string) {\n  return sectionIcons[key as keyof typeof sectionIcons] ?? sectionIcons.default;\n}\n\nfunction matchesSearch(key: string, schema: JsonSchema, query: string): boolean {\n  if (!query) return true;\n  const q = query.toLowerCase();\n  const meta = SECTION_META[key];\n\n  // Check key name\n  if (key.toLowerCase().includes(q)) return true;\n\n  // Check label and description\n  if (meta) {\n    if (meta.label.toLowerCase().includes(q)) return true;\n    if (meta.description.toLowerCase().includes(q)) return true;\n  }\n\n  return schemaMatches(schema, q);\n}\n\nfunction schemaMatches(schema: JsonSchema, query: string): boolean {\n  if (schema.title?.toLowerCase().includes(query)) return true;\n  if (schema.description?.toLowerCase().includes(query)) return true;\n  if (schema.enum?.some((value) => String(value).toLowerCase().includes(query))) return true;\n\n  if (schema.properties) {\n    for (const [propKey, propSchema] of Object.entries(schema.properties)) {\n      if (propKey.toLowerCase().includes(query)) return true;\n      if (schemaMatches(propSchema, query)) return true;\n    }\n  }\n\n  if (schema.items) {\n    const items = Array.isArray(schema.items) ? schema.items : [schema.items];\n    for (const item of items) {\n      if (item && schemaMatches(item, query)) return true;\n    }\n  }\n\n  if (schema.additionalProperties && typeof schema.additionalProperties === \"object\") {\n    if (schemaMatches(schema.additionalProperties, query)) return true;\n  }\n\n  const unions = schema.anyOf ?? schema.oneOf ?? schema.allOf;\n  if (unions) {\n    for (const entry of unions) {\n      if (entry && schemaMatches(entry, query)) return true;\n    }\n  }\n\n  return false;\n}\n\nexport function renderConfigForm(props: ConfigFormProps) {\n  if (!props.schema) {\n    return html`<div class=\"muted\">模式不可用。</div>`;\n  }\n  const schema = props.schema;\n  const value = props.value ?? {};\n  if (schemaType(schema) !== \"object\" || !schema.properties) {\n    return html`<div class=\"callout danger\">不支持的模式。使用原始模式。</div>`;\n  }\n  const unsupported = new Set(props.unsupportedPaths ?? []);\n  const properties = schema.properties;\n  const searchQuery = props.searchQuery ?? \"\";\n  const activeSection = props.activeSection;\n  const activeSubsection = props.activeSubsection ?? null;\n\n  const entries = Object.entries(properties).sort((a, b) => {\n    const orderA = hintForPath([a[0]], props.uiHints)?.order ?? 50;\n    const orderB = hintForPath([b[0]], props.uiHints)?.order ?? 50;\n    if (orderA !== orderB) return orderA - orderB;\n    return a[0].localeCompare(b[0]);\n  });\n\n  const filteredEntries = entries.filter(([key, node]) => {\n    if (activeSection && key !== activeSection) return false;\n    if (searchQuery && !matchesSearch(key, node, searchQuery)) return false;\n    return true;\n  });\n\n  let subsectionContext:\n    | { sectionKey: string; subsectionKey: string; schema: JsonSchema }\n    | null = null;\n  if (activeSection && activeSubsection && filteredEntries.length === 1) {\n    const sectionSchema = filteredEntries[0]?.[1];\n    if (\n      sectionSchema &&\n      schemaType(sectionSchema) === \"object\" &&\n      sectionSchema.properties &&\n      sectionSchema.properties[activeSubsection]\n    ) {\n      subsectionContext = {\n        sectionKey: activeSection,\n        subsectionKey: activeSubsection,\n        schema: sectionSchema.properties[activeSubsection],\n      };\n    }\n  }\n\n  if (filteredEntries.length === 0) {\n    return html`\n      <div class=\"config-empty\">\n        <div class=\"config-empty__icon\">${icons.search}</div>\n        <div class=\"config-empty__text\">\n          ${searchQuery\n            ? `没有匹配\"${searchQuery}\"的设置`\n            : \"此部分中没有设置\"}\n        </div>\n      </div>\n    `;\n  }\n\n  return html`\n    <div class=\"config-form config-form--modern\">\n      ${subsectionContext\n        ? (() => {\n            const { sectionKey, subsectionKey, schema: node } = subsectionContext;\n            const hint = hintForPath([sectionKey, subsectionKey], props.uiHints);\n            const label = hint?.label ?? node.title ?? humanize(subsectionKey);\n            const description = hint?.help ?? node.description ?? \"\";\n            const sectionValue = (value as Record<string, unknown>)[sectionKey];\n            const scopedValue =\n              sectionValue && typeof sectionValue === \"object\"\n                ? (sectionValue as Record<string, unknown>)[subsectionKey]\n                : undefined;\n            const id = `config-section-${sectionKey}-${subsectionKey}`;\n            return html`\n              <section class=\"config-section-card\" id=${id}>\n                <div class=\"config-section-card__header\">\n                  <span class=\"config-section-card__icon\">${getSectionIcon(sectionKey)}</span>\n                  <div class=\"config-section-card__titles\">\n                    <h3 class=\"config-section-card__title\">${label}</h3>\n                    ${description\n                      ? html`<p class=\"config-section-card__desc\">${description}</p>`\n                      : nothing}\n                  </div>\n                </div>\n                <div class=\"config-section-card__content\">\n                  ${renderNode({\n                    schema: node,\n                    value: scopedValue,\n                    path: [sectionKey, subsectionKey],\n                    hints: props.uiHints,\n                    unsupported,\n                    disabled: props.disabled ?? false,\n                    showLabel: false,\n                    onPatch: props.onPatch,\n                  })}\n                </div>\n              </section>\n            `;\n          })()\n        : filteredEntries.map(([key, node]) => {\n            const meta = SECTION_META[key] ?? {\n              label: key.charAt(0).toUpperCase() + key.slice(1),\n              description: node.description ?? \"\",\n            };\n\n            return html`\n              <section class=\"config-section-card\" id=\"config-section-${key}\">\n                <div class=\"config-section-card__header\">\n                  <span class=\"config-section-card__icon\">${getSectionIcon(key)}</span>\n                  <div class=\"config-section-card__titles\">\n                    <h3 class=\"config-section-card__title\">${meta.label}</h3>\n                    ${meta.description\n                      ? html`<p class=\"config-section-card__desc\">${meta.description}</p>`\n                      : nothing}\n                  </div>\n                </div>\n                <div class=\"config-section-card__content\">\n                  ${renderNode({\n                    schema: node,\n                    value: (value as Record<string, unknown>)[key],\n                    path: [key],\n                    hints: props.uiHints,\n                    unsupported,\n                    disabled: props.disabled ?? false,\n                    showLabel: false,\n                    onPatch: props.onPatch,\n                  })}\n                </div>\n              </section>\n            `;\n          })}\n    </div>\n  `;\n}\n","import { pathKey, schemaType, type JsonSchema } from \"./config-form.shared\";\n\nexport type ConfigSchemaAnalysis = {\n  schema: JsonSchema | null;\n  unsupportedPaths: string[];\n};\n\nconst META_KEYS = new Set([\"title\", \"description\", \"default\", \"nullable\"]);\n\nfunction isAnySchema(schema: JsonSchema): boolean {\n  const keys = Object.keys(schema ?? {}).filter((key) => !META_KEYS.has(key));\n  return keys.length === 0;\n}\n\nfunction normalizeEnum(values: unknown[]): { enumValues: unknown[]; nullable: boolean } {\n  const filtered = values.filter((value) => value != null);\n  const nullable = filtered.length !== values.length;\n  const enumValues: unknown[] = [];\n  for (const value of filtered) {\n    if (!enumValues.some((existing) => Object.is(existing, value))) {\n      enumValues.push(value);\n    }\n  }\n  return { enumValues, nullable };\n}\n\nexport function analyzeConfigSchema(raw: unknown): ConfigSchemaAnalysis {\n  if (!raw || typeof raw !== \"object\") {\n    return { schema: null, unsupportedPaths: [\"<root>\"] };\n  }\n  return normalizeSchemaNode(raw as JsonSchema, []);\n}\n\nfunction normalizeSchemaNode(\n  schema: JsonSchema,\n  path: Array<string | number>,\n): ConfigSchemaAnalysis {\n  const unsupported = new Set<string>();\n  const normalized: JsonSchema = { ...schema };\n  const pathLabel = pathKey(path) || \"<root>\";\n\n  if (schema.anyOf || schema.oneOf || schema.allOf) {\n    const union = normalizeUnion(schema, path);\n    if (union) return union;\n    return { schema, unsupportedPaths: [pathLabel] };\n  }\n\n  const nullable = Array.isArray(schema.type) && schema.type.includes(\"null\");\n  const type =\n    schemaType(schema) ??\n    (schema.properties || schema.additionalProperties ? \"object\" : undefined);\n  normalized.type = type ?? schema.type;\n  normalized.nullable = nullable || schema.nullable;\n\n  if (normalized.enum) {\n    const { enumValues, nullable: enumNullable } = normalizeEnum(normalized.enum);\n    normalized.enum = enumValues;\n    if (enumNullable) normalized.nullable = true;\n    if (enumValues.length === 0) unsupported.add(pathLabel);\n  }\n\n  if (type === \"object\") {\n    const properties = schema.properties ?? {};\n    const normalizedProps: Record<string, JsonSchema> = {};\n    for (const [key, value] of Object.entries(properties)) {\n      const res = normalizeSchemaNode(value, [...path, key]);\n      if (res.schema) normalizedProps[key] = res.schema;\n      for (const entry of res.unsupportedPaths) unsupported.add(entry);\n    }\n    normalized.properties = normalizedProps;\n\n    if (schema.additionalProperties === true) {\n      unsupported.add(pathLabel);\n    } else if (schema.additionalProperties === false) {\n      normalized.additionalProperties = false;\n    } else if (\n      schema.additionalProperties &&\n      typeof schema.additionalProperties === \"object\"\n    ) {\n      if (!isAnySchema(schema.additionalProperties as JsonSchema)) {\n        const res = normalizeSchemaNode(\n          schema.additionalProperties as JsonSchema,\n          [...path, \"*\"],\n        );\n        normalized.additionalProperties =\n          res.schema ?? (schema.additionalProperties as JsonSchema);\n        if (res.unsupportedPaths.length > 0) unsupported.add(pathLabel);\n      }\n    }\n  } else if (type === \"array\") {\n    const itemsSchema = Array.isArray(schema.items)\n      ? schema.items[0]\n      : schema.items;\n    if (!itemsSchema) {\n      unsupported.add(pathLabel);\n    } else {\n      const res = normalizeSchemaNode(itemsSchema, [...path, \"*\"]);\n      normalized.items = res.schema ?? itemsSchema;\n      if (res.unsupportedPaths.length > 0) unsupported.add(pathLabel);\n    }\n  } else if (\n    type !== \"string\" &&\n    type !== \"number\" &&\n    type !== \"integer\" &&\n    type !== \"boolean\" &&\n    !normalized.enum\n  ) {\n    unsupported.add(pathLabel);\n  }\n\n  return {\n    schema: normalized,\n    unsupportedPaths: Array.from(unsupported),\n  };\n}\n\nfunction normalizeUnion(\n  schema: JsonSchema,\n  path: Array<string | number>,\n): ConfigSchemaAnalysis | null {\n  if (schema.allOf) return null;\n  const union = schema.anyOf ?? schema.oneOf;\n  if (!union) return null;\n\n  const literals: unknown[] = [];\n  const remaining: JsonSchema[] = [];\n  let nullable = false;\n\n  for (const entry of union) {\n    if (!entry || typeof entry !== \"object\") return null;\n    if (Array.isArray(entry.enum)) {\n      const { enumValues, nullable: enumNullable } = normalizeEnum(entry.enum);\n      literals.push(...enumValues);\n      if (enumNullable) nullable = true;\n      continue;\n    }\n    if (\"const\" in entry) {\n      if (entry.const == null) {\n        nullable = true;\n        continue;\n      }\n      literals.push(entry.const);\n      continue;\n    }\n    if (schemaType(entry) === \"null\") {\n      nullable = true;\n      continue;\n    }\n    remaining.push(entry);\n  }\n\n  if (literals.length > 0 && remaining.length === 0) {\n    const unique: unknown[] = [];\n    for (const value of literals) {\n      if (!unique.some((existing) => Object.is(existing, value))) {\n        unique.push(value);\n      }\n    }\n    return {\n      schema: {\n        ...schema,\n        enum: unique,\n        nullable,\n        anyOf: undefined,\n        oneOf: undefined,\n        allOf: undefined,\n      },\n      unsupportedPaths: [],\n    };\n  }\n\n  if (remaining.length === 1) {\n    const res = normalizeSchemaNode(remaining[0], path);\n    if (res.schema) {\n      res.schema.nullable = nullable || res.schema.nullable;\n    }\n    return res;\n  }\n\n  const primitiveTypes = [\"string\", \"number\", \"integer\", \"boolean\"];\n  if (\n    remaining.length > 0 &&\n    literals.length === 0 &&\n    remaining.every((entry) => entry.type && primitiveTypes.includes(String(entry.type)))\n  ) {\n    return {\n      schema: {\n        ...schema,\n        nullable,\n      },\n      unsupportedPaths: [],\n    };\n  }\n\n  return null;\n}\n","import { html } from \"lit\";\n\nimport type { ConfigUiHints } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport {\n  analyzeConfigSchema,\n  renderNode,\n  schemaType,\n  type JsonSchema,\n} from \"./config-form\";\n\ntype ChannelConfigFormProps = {\n  channelId: string;\n  configValue: Record<string, unknown> | null;\n  schema: unknown | null;\n  uiHints: ConfigUiHints;\n  disabled: boolean;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n};\n\nfunction resolveSchemaNode(\n  schema: JsonSchema | null,\n  path: Array<string | number>,\n): JsonSchema | null {\n  let current = schema;\n  for (const key of path) {\n    if (!current) return null;\n    const type = schemaType(current);\n    if (type === \"object\") {\n      const properties = current.properties ?? {};\n      if (typeof key === \"string\" && properties[key]) {\n        current = properties[key];\n        continue;\n      }\n      const additional = current.additionalProperties;\n      if (typeof key === \"string\" && additional && typeof additional === \"object\") {\n        current = additional as JsonSchema;\n        continue;\n      }\n      return null;\n    }\n    if (type === \"array\") {\n      if (typeof key !== \"number\") return null;\n      const items = Array.isArray(current.items) ? current.items[0] : current.items;\n      current = items ?? null;\n      continue;\n    }\n    return null;\n  }\n  return current;\n}\n\nfunction resolveChannelValue(\n  config: Record<string, unknown>,\n  channelId: string,\n): Record<string, unknown> {\n  const channels = (config.channels ?? {}) as Record<string, unknown>;\n  const fromChannels = channels[channelId];\n  const fallback = config[channelId];\n  const resolved =\n    (fromChannels && typeof fromChannels === \"object\"\n      ? (fromChannels as Record<string, unknown>)\n      : null) ??\n    (fallback && typeof fallback === \"object\"\n      ? (fallback as Record<string, unknown>)\n      : null);\n  return resolved ?? {};\n}\n\nconst EXTRA_CHANNEL_FIELDS = [\"groupPolicy\", \"streamMode\", \"dmPolicy\"] as const;\n\nfunction formatExtraValue(raw: unknown): string {\n  if (raw == null) {\n    return \"n/a\";\n  }\n  if (typeof raw === \"string\" || typeof raw === \"number\" || typeof raw === \"boolean\") {\n    return String(raw);\n  }\n  try {\n    return JSON.stringify(raw);\n  } catch {\n    return \"n/a\";\n  }\n}\n\nfunction renderExtraChannelFields(value: Record<string, unknown>) {\n  const entries = EXTRA_CHANNEL_FIELDS.flatMap((field) => {\n    if (!(field in value)) {\n      return [];\n    }\n    return [[field, value[field]]] as Array<[string, unknown]>;\n  });\n  if (entries.length === 0) {\n    return null;\n  }\n  return html`\n    <div class=\"status-list\" style=\"margin-top: 12px;\">\n      ${entries.map(\n        ([field, raw]) => html`\n          <div>\n            <span class=\"label\">${field}</span>\n            <span>${formatExtraValue(raw)}</span>\n          </div>\n        `,\n      )}\n    </div>\n  `;\n}\n\nexport function renderChannelConfigForm(props: ChannelConfigFormProps) {\n  const analysis = analyzeConfigSchema(props.schema);\n  const normalized = analysis.schema;\n  if (!normalized) {\n    return html`<div class=\"callout danger\">模式不可用。请使用原始模式。</div>`;\n  }\n  const node = resolveSchemaNode(normalized, [\"channels\", props.channelId]);\n  if (!node) {\n    return html`<div class=\"callout danger\">通道配置模式不可用。</div>`;\n  }\n  const configValue = props.configValue ?? {};\n  const value = resolveChannelValue(configValue, props.channelId);\n  return html`\n    <div class=\"config-form\">\n      ${renderNode({\n        schema: node,\n        value,\n        path: [\"channels\", props.channelId],\n        hints: props.uiHints,\n        unsupported: new Set(analysis.unsupportedPaths),\n        disabled: props.disabled,\n        showLabel: false,\n        onPatch: props.onPatch,\n      })}\n    </div>\n    ${renderExtraChannelFields(value)}\n  `;\n}\n\nexport function renderChannelConfigSection(params: {\n  channelId: string;\n  props: ChannelsProps;\n}) {\n  const { channelId, props } = params;\n  const disabled = props.configSaving || props.configSchemaLoading;\n  return html`\n    <div style=\"margin-top: 16px;\">\n      ${props.configSchemaLoading\n        ? html`<div class=\"muted\">正在加载配置模式…</div>`\n        : renderChannelConfigForm({\n            channelId,\n            configValue: props.configForm,\n            schema: props.configSchema,\n            uiHints: props.configUiHints,\n            disabled,\n            onPatch: props.onConfigPatch,\n          })}\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button\n          class=\"btn primary\"\n          ?disabled=${disabled || !props.configFormDirty}\n          @click=${() => props.onConfigSave()}\n        >\n          ${props.configSaving ? \"保存中…\" : \"保存\"}\n        </button>\n        <button\n          class=\"btn\"\n          ?disabled=${disabled}\n          @click=${() => props.onConfigReload()}\n        >\n          重新加载\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { DiscordStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\n\nexport function renderDiscordCard(params: {\n  props: ChannelsProps;\n  discord?: DiscordStatus | null;\n  accountCountLabel: unknown;\n}) {\n  const { props, discord, accountCountLabel } = params;\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">Discord</div>\n      <div class=\"card-sub\">机器人状态和频道配置。</div>\n      ${accountCountLabel}\n\n      <div class=\"status-list\" style=\"margin-top: 16px;\">\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${discord?.configured ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${discord?.running ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后启动</span>\n          <span>${discord?.lastStartAt ? formatAgo(discord.lastStartAt) : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后探测</span>\n          <span>${discord?.lastProbeAt ? formatAgo(discord.lastProbeAt) : \"无\"}</span>\n        </div>\n      </div>\n\n      ${discord?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${discord.lastError}\n          </div>`\n        : nothing}\n\n      ${discord?.probe\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            探测 ${discord.probe.ok ? \"成功\" : \"失败\"} ·\n            ${discord.probe.status ?? \"\"} ${discord.probe.error ?? \"\"}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: \"discord\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          探测\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { GoogleChatStatus } from \"../types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\nimport type { ChannelsProps } from \"./channels.types\";\n\nexport function renderGoogleChatCard(params: {\n  props: ChannelsProps;\n  googleChat?: GoogleChatStatus | null;\n  accountCountLabel: unknown;\n}) {\n  const { props, googleChat, accountCountLabel } = params;\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">Google Chat</div>\n      <div class=\"card-sub\">Chat API webhook 状态和频道配置。</div>\n      ${accountCountLabel}\n\n      <div class=\"status-list\" style=\"margin-top: 16px;\">\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${googleChat ? (googleChat.configured ? \"是\" : \"否\") : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${googleChat ? (googleChat.running ? \"是\" : \"否\") : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">凭证</span>\n          <span>${googleChat?.credentialSource ?? \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">受众</span>\n          <span>\n            ${googleChat?.audienceType\n              ? `${googleChat.audienceType}${googleChat.audience ? ` · ${googleChat.audience}` : \"\"}`\n              : \"无\"}\n          </span>\n        </div>\n        <div>\n          <span class=\"label\">最后启动</span>\n          <span>${googleChat?.lastStartAt ? formatAgo(googleChat.lastStartAt) : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后探测</span>\n          <span>${googleChat?.lastProbeAt ? formatAgo(googleChat.lastProbeAt) : \"无\"}</span>\n        </div>\n      </div>\n\n      ${googleChat?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${googleChat.lastError}\n          </div>`\n        : nothing}\n\n      ${googleChat?.probe\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            探测 ${googleChat.probe.ok ? \"成功\" : \"失败\"} ·\n            ${googleChat.probe.status ?? \"\"} ${googleChat.probe.error ?? \"\"}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: \"googlechat\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          探测\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { IMessageStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\n\nexport function renderIMessageCard(params: {\n  props: ChannelsProps;\n  imessage?: IMessageStatus | null;\n  accountCountLabel: unknown;\n}) {\n  const { props, imessage, accountCountLabel } = params;\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">iMessage</div>\n      <div class=\"card-sub\">macOS 桥接状态和频道配置。</div>\n      ${accountCountLabel}\n\n      <div class=\"status-list\" style=\"margin-top: 16px;\">\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${imessage?.configured ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${imessage?.running ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后启动</span>\n          <span>${imessage?.lastStartAt ? formatAgo(imessage.lastStartAt) : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后探测</span>\n          <span>${imessage?.lastProbeAt ? formatAgo(imessage.lastProbeAt) : \"无\"}</span>\n        </div>\n      </div>\n\n      ${imessage?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${imessage.lastError}\n          </div>`\n        : nothing}\n\n      ${imessage?.probe\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            探测 ${imessage.probe.ok ? \"成功\" : \"失败\"} ·\n            ${imessage.probe.error ?? \"\"}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: \"imessage\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          探测\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { ChannelAccountSnapshot, NostrStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\nimport {\n  renderNostrProfileForm,\n  type NostrProfileFormState,\n  type NostrProfileFormCallbacks,\n} from \"./channels.nostr-profile-form\";\n\n/**\n * Truncate a pubkey for display (shows first and last 8 chars)\n */\nfunction truncatePubkey(pubkey: string | null | undefined): string {\n  if (!pubkey) return \"无\";\n  if (pubkey.length <= 20) return pubkey;\n  return `${pubkey.slice(0, 8)}...${pubkey.slice(-8)}`;\n}\n\nexport function renderNostrCard(params: {\n  props: ChannelsProps;\n  nostr?: NostrStatus | null;\n  nostrAccounts: ChannelAccountSnapshot[];\n  accountCountLabel: unknown;\n  /** Profile form state (optional - if provided, shows form) */\n  profileFormState?: NostrProfileFormState | null;\n  /** Profile form callbacks */\n  profileFormCallbacks?: NostrProfileFormCallbacks | null;\n  /** Called when Edit Profile is clicked */\n  onEditProfile?: () => void;\n}) {\n  const {\n    props,\n    nostr,\n    nostrAccounts,\n    accountCountLabel,\n    profileFormState,\n    profileFormCallbacks,\n    onEditProfile,\n  } = params;\n  const primaryAccount = nostrAccounts[0];\n  const summaryConfigured = nostr?.configured ?? primaryAccount?.configured ?? false;\n  const summaryRunning = nostr?.running ?? primaryAccount?.running ?? false;\n  const summaryPublicKey =\n    nostr?.publicKey ??\n    (primaryAccount as { publicKey?: string } | undefined)?.publicKey;\n  const summaryLastStartAt = nostr?.lastStartAt ?? primaryAccount?.lastStartAt ?? null;\n  const summaryLastError = nostr?.lastError ?? primaryAccount?.lastError ?? null;\n  const hasMultipleAccounts = nostrAccounts.length > 1;\n  const showingForm = profileFormState !== null && profileFormState !== undefined;\n\n  const renderAccountCard = (account: ChannelAccountSnapshot) => {\n    const publicKey = (account as { publicKey?: string }).publicKey;\n    const profile = (account as { profile?: { name?: string; displayName?: string } }).profile;\n    const displayName = profile?.displayName ?? profile?.name ?? account.name ?? account.accountId;\n\n    return html`\n      <div class=\"account-card\">\n        <div class=\"account-card-header\">\n          <div class=\"account-card-title\">${displayName}</div>\n          <div class=\"account-card-id\">${account.accountId}</div>\n        </div>\n        <div class=\"status-list account-card-status\">\n          <div>\n            <span class=\"label\">运行中</span>\n            <span>${account.running ? \"是\" : \"否\"}</span>\n          </div>\n          <div>\n            <span class=\"label\">已配置</span>\n            <span>${account.configured ? \"是\" : \"否\"}</span>\n          </div>\n          <div>\n            <span class=\"label\">公钥</span>\n            <span class=\"monospace\" title=\"${publicKey ?? \"\"}\">${truncatePubkey(publicKey)}</span>\n          </div>\n          <div>\n            <span class=\"label\">最后入站</span>\n            <span>${account.lastInboundAt ? formatAgo(account.lastInboundAt) : \"无\"}</span>\n          </div>\n          ${account.lastError\n            ? html`\n                <div class=\"account-card-error\">${account.lastError}</div>\n              `\n            : nothing}\n        </div>\n      </div>\n    `;\n  };\n\n  const renderProfileSection = () => {\n    // If showing form, render the form instead of the read-only view\n    if (showingForm && profileFormCallbacks) {\n      return renderNostrProfileForm({\n        state: profileFormState,\n        callbacks: profileFormCallbacks,\n        accountId: nostrAccounts[0]?.accountId ?? \"default\",\n      });\n    }\n\n    const profile =\n      (primaryAccount as\n        | {\n            profile?: {\n              name?: string;\n              displayName?: string;\n              about?: string;\n              picture?: string;\n              nip05?: string;\n            };\n          }\n        | undefined)?.profile ?? nostr?.profile;\n    const { name, displayName, about, picture, nip05 } = profile ?? {};\n    const hasAnyProfileData = name || displayName || about || picture || nip05;\n\n    return html`\n      <div style=\"margin-top: 16px; padding: 12px; background: var(--bg-secondary); border-radius: 8px;\">\n        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\n          <div style=\"font-weight: 500;\">资料</div>\n          ${summaryConfigured\n            ? html`\n                <button\n                  class=\"btn btn-sm\"\n                  @click=${onEditProfile}\n                  style=\"font-size: 12px; padding: 4px 8px;\"\n                >\n                  编辑资料\n                </button>\n              `\n            : nothing}\n        </div>\n        ${hasAnyProfileData\n          ? html`\n              <div class=\"status-list\">\n                ${picture\n                  ? html`\n                      <div style=\"margin-bottom: 8px;\">\n                        <img\n                          src=${picture}\n                          alt=\"Profile picture\"\n                          style=\"width: 48px; height: 48px; border-radius: 50%; object-fit: cover; border: 2px solid var(--border-color);\"\n                          @error=${(e: Event) => {\n                            (e.target as HTMLImageElement).style.display = \"none\";\n                          }}\n                        />\n                      </div>\n                    `\n                  : nothing}\n                ${name ? html`<div><span class=\"label\">姓名</span><span>${name}</span></div>` : nothing}\n                ${displayName\n                  ? html`<div><span class=\"label\">显示名称</span><span>${displayName}</span></div>`\n                  : nothing}\n                ${about\n                  ? html`<div><span class=\"label\">关于</span><span style=\"max-width: 300px; overflow: hidden; text-overflow: ellipsis;\">${about}</span></div>`\n                  : nothing}\n                ${nip05 ? html`<div><span class=\"label\">NIP-05</span><span>${nip05}</span></div>` : nothing}\n              </div>\n            `\n          : html`\n              <div style=\"color: var(--text-muted); font-size: 13px;\">\n                未设置资料。点击\"编辑资料\"来添加您的姓名、简介和头像。\n              </div>\n            `}\n      </div>\n    `;\n  };\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">Nostr</div>\n      <div class=\"card-sub\">通过 Nostr 中继（NIP-04）的去中心化私信。</div>\n      ${accountCountLabel}\n\n      ${hasMultipleAccounts\n        ? html`\n            <div class=\"account-card-list\">\n              ${nostrAccounts.map((account) => renderAccountCard(account))}\n            </div>\n          `\n        : html`\n            <div class=\"status-list\" style=\"margin-top: 16px;\">\n              <div>\n                <span class=\"label\">已配置</span>\n                <span>${summaryConfigured ? \"是\" : \"否\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">运行中</span>\n                <span>${summaryRunning ? \"是\" : \"否\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">公钥</span>\n                <span class=\"monospace\" title=\"${summaryPublicKey ?? \"\"}\"\n                  >${truncatePubkey(summaryPublicKey)}</span\n                >\n              </div>\n              <div>\n                <span class=\"label\">最后启动</span>\n                <span>${summaryLastStartAt ? formatAgo(summaryLastStartAt) : \"无\"}</span>\n              </div>\n            </div>\n          `}\n\n      ${summaryLastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${summaryLastError}</div>`\n        : nothing}\n\n      ${renderProfileSection()}\n\n      ${renderChannelConfigSection({ channelId: \"nostr\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(false)}>刷新</button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { SignalStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\n\nexport function renderSignalCard(params: {\n  props: ChannelsProps;\n  signal?: SignalStatus | null;\n  accountCountLabel: unknown;\n}) {\n  const { props, signal, accountCountLabel } = params;\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">Signal</div>\n      <div class=\"card-sub\">signal-cli 状态和频道配置。</div>\n      ${accountCountLabel}\n\n      <div class=\"status-list\" style=\"margin-top: 16px;\">\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${signal?.configured ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${signal?.running ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">基础URL</span>\n          <span>${signal?.baseUrl ?? \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后启动</span>\n          <span>${signal?.lastStartAt ? formatAgo(signal.lastStartAt) : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后探测</span>\n          <span>${signal?.lastProbeAt ? formatAgo(signal.lastProbeAt) : \"无\"}</span>\n        </div>\n      </div>\n\n      ${signal?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${signal.lastError}\n          </div>`\n        : nothing}\n\n      ${signal?.probe\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            探测 ${signal.probe.ok ? \"成功\" : \"失败\"} ·\n            ${signal.probe.status ?? \"\"} ${signal.probe.error ?? \"\"}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: \"signal\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          探测\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { SlackStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\n\nexport function renderSlackCard(params: {\n  props: ChannelsProps;\n  slack?: SlackStatus | null;\n  accountCountLabel: unknown;\n}) {\n  const { props, slack, accountCountLabel } = params;\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">Slack</div>\n      <div class=\"card-sub\">套接字模式状态和频道配置。</div>\n      ${accountCountLabel}\n\n      <div class=\"status-list\" style=\"margin-top: 16px;\">\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${slack?.configured ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${slack?.running ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后启动</span>\n          <span>${slack?.lastStartAt ? formatAgo(slack.lastStartAt) : \"无\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后探测</span>\n          <span>${slack?.lastProbeAt ? formatAgo(slack.lastProbeAt) : \"无\"}</span>\n        </div>\n      </div>\n\n      ${slack?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${slack.lastError}\n          </div>`\n        : nothing}\n\n      ${slack?.probe\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            探测 ${slack.probe.ok ? \"成功\" : \"失败\"} ·\n            ${slack.probe.status ?? \"\"} ${slack.probe.error ?? \"\"}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: \"slack\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          探测\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { ChannelAccountSnapshot, TelegramStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\n\nexport function renderTelegramCard(params: {\n  props: ChannelsProps;\n  telegram?: TelegramStatus;\n  telegramAccounts: ChannelAccountSnapshot[];\n  accountCountLabel: unknown;\n}) {\n  const { props, telegram, telegramAccounts, accountCountLabel } = params;\n  const hasMultipleAccounts = telegramAccounts.length > 1;\n\n  const renderAccountCard = (account: ChannelAccountSnapshot) => {\n    const probe = account.probe as { bot?: { username?: string } } | undefined;\n    const botUsername = probe?.bot?.username;\n    const label = account.name || account.accountId;\n    return html`\n      <div class=\"account-card\">\n        <div class=\"account-card-header\">\n          <div class=\"account-card-title\">\n            ${botUsername ? `@${botUsername}` : label}\n          </div>\n          <div class=\"account-card-id\">${account.accountId}</div>\n        </div>\n        <div class=\"status-list account-card-status\">\n          <div>\n            <span class=\"label\">运行中</span>\n            <span>${account.running ? \"是\" : \"否\"}</span>\n          </div>\n          <div>\n            <span class=\"label\">已配置</span>\n            <span>${account.configured ? \"是\" : \"否\"}</span>\n          </div>\n          <div>\n            <span class=\"label\">最后入站</span>\n            <span>${account.lastInboundAt ? formatAgo(account.lastInboundAt) : \"无\"}</span>\n          </div>\n          ${account.lastError\n            ? html`\n                <div class=\"account-card-error\">\n                  ${account.lastError}\n                </div>\n              `\n            : nothing}\n        </div>\n      </div>\n    `;\n  };\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">Telegram</div>\n      <div class=\"card-sub\">机器人状态和频道配置。</div>\n      ${accountCountLabel}\n\n      ${hasMultipleAccounts\n        ? html`\n            <div class=\"account-card-list\">\n              ${telegramAccounts.map((account) => renderAccountCard(account))}\n            </div>\n          `\n        : html`\n            <div class=\"status-list\" style=\"margin-top: 16px;\">\n              <div>\n                <span class=\"label\">已配置</span>\n                <span>${telegram?.configured ? \"是\" : \"否\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">运行中</span>\n                <span>${telegram?.running ? \"是\" : \"否\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">模式</span>\n                <span>${telegram?.mode ?? \"无\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">最后启动</span>\n                <span>${telegram?.lastStartAt ? formatAgo(telegram.lastStartAt) : \"无\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">最后探测</span>\n                <span>${telegram?.lastProbeAt ? formatAgo(telegram.lastProbeAt) : \"无\"}</span>\n              </div>\n            </div>\n          `}\n\n      ${telegram?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${telegram.lastError}\n          </div>`\n        : nothing}\n\n      ${telegram?.probe\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            探测 ${telegram.probe.ok ? \"成功\" : \"失败\"} ·\n            ${telegram.probe.status ?? \"\"} ${telegram.probe.error ?? \"\"}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: \"telegram\", props })}\n\n      <div class=\"row\" style=\"margin-top: 12px;\">\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          探测\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type { WhatsAppStatus } from \"../types\";\nimport type { ChannelsProps } from \"./channels.types\";\nimport { renderChannelConfigSection } from \"./channels.config\";\nimport { formatDuration } from \"./channels.shared\";\n\nexport function renderWhatsAppCard(params: {\n  props: ChannelsProps;\n  whatsapp?: WhatsAppStatus;\n  accountCountLabel: unknown;\n}) {\n  const { props, whatsapp, accountCountLabel } = params;\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">WhatsApp</div>\n      <div class=\"card-sub\">链接 WhatsApp Web 并监控连接健康状况。</div>\n      ${accountCountLabel}\n\n      <div class=\"status-list\" style=\"margin-top: 16px;\">\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${whatsapp?.configured ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">已链接</span>\n          <span>${whatsapp?.linked ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${whatsapp?.running ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">已连接</span>\n          <span>${whatsapp?.connected ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后连接</span>\n          <span>\n            ${whatsapp?.lastConnectedAt\n              ? formatAgo(whatsapp.lastConnectedAt)\n              : \"无\"}\n          </span>\n        </div>\n        <div>\n          <span class=\"label\">最后消息</span>\n          <span>\n            ${whatsapp?.lastMessageAt ? formatAgo(whatsapp.lastMessageAt) : \"无\"}\n          </span>\n        </div>\n        <div>\n          <span class=\"label\">认证时长</span>\n          <span>\n            ${whatsapp?.authAgeMs != null\n              ? formatDuration(whatsapp.authAgeMs)\n              : \"无\"}\n          </span>\n        </div>\n      </div>\n\n      ${whatsapp?.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${whatsapp.lastError}\n          </div>`\n        : nothing}\n\n      ${props.whatsappMessage\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            ${props.whatsappMessage}\n          </div>`\n        : nothing}\n\n      ${props.whatsappQrDataUrl\n        ? html`<div class=\"qr-wrap\">\n            <img src=${props.whatsappQrDataUrl} alt=\"WhatsApp QR\" />\n          </div>`\n        : nothing}\n\n      <div class=\"row\" style=\"margin-top: 14px; flex-wrap: wrap;\">\n        <button\n          class=\"btn primary\"\n          ?disabled=${props.whatsappBusy}\n          @click=${() => props.onWhatsAppStart(false)}\n        >\n          ${props.whatsappBusy ? \"工作中…\" : \"显示二维码\"}\n        </button>\n        <button\n          class=\"btn\"\n          ?disabled=${props.whatsappBusy}\n          @click=${() => props.onWhatsAppStart(true)}\n        >\n          重新链接\n        </button>\n        <button\n          class=\"btn\"\n          ?disabled=${props.whatsappBusy}\n          @click=${() => props.onWhatsAppWait()}\n        >\n          等待扫描\n        </button>\n        <button\n          class=\"btn danger\"\n          ?disabled=${props.whatsappBusy}\n          @click=${() => props.onWhatsAppLogout()}\n        >\n          登出\n        </button>\n        <button class=\"btn\" @click=${() => props.onRefresh(true)}>\n          刷新\n        </button>\n      </div>\n\n      ${renderChannelConfigSection({ channelId: \"whatsapp\", props })}\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport type {\n  ChannelAccountSnapshot,\n  ChannelUiMetaEntry,\n  ChannelsStatusSnapshot,\n  DiscordStatus,\n  GoogleChatStatus,\n  IMessageStatus,\n  NostrProfile,\n  NostrStatus,\n  SignalStatus,\n  SlackStatus,\n  TelegramStatus,\n  WhatsAppStatus,\n} from \"../types\";\nimport type {\n  ChannelKey,\n  ChannelsChannelData,\n  ChannelsProps,\n} from \"./channels.types\";\nimport { channelEnabled, renderChannelAccountCount } from \"./channels.shared\";\nimport { renderChannelConfigSection } from \"./channels.config\";\nimport { renderDiscordCard } from \"./channels.discord\";\nimport { renderGoogleChatCard } from \"./channels.googlechat\";\nimport { renderIMessageCard } from \"./channels.imessage\";\nimport { renderNostrCard } from \"./channels.nostr\";\nimport { renderSignalCard } from \"./channels.signal\";\nimport { renderSlackCard } from \"./channels.slack\";\nimport { renderTelegramCard } from \"./channels.telegram\";\nimport { renderWhatsAppCard } from \"./channels.whatsapp\";\n\nexport function renderChannels(props: ChannelsProps) {\n  const channels = props.snapshot?.channels as Record<string, unknown> | null;\n  const whatsapp = (channels?.whatsapp ?? undefined) as\n    | WhatsAppStatus\n    | undefined;\n  const telegram = (channels?.telegram ?? undefined) as\n    | TelegramStatus\n    | undefined;\n  const discord = (channels?.discord ?? null) as DiscordStatus | null;\n  const googlechat = (channels?.googlechat ?? null) as GoogleChatStatus | null;\n  const slack = (channels?.slack ?? null) as SlackStatus | null;\n  const signal = (channels?.signal ?? null) as SignalStatus | null;\n  const imessage = (channels?.imessage ?? null) as IMessageStatus | null;\n  const nostr = (channels?.nostr ?? null) as NostrStatus | null;\n  const channelOrder = resolveChannelOrder(props.snapshot);\n  const orderedChannels = channelOrder\n    .map((key, index) => ({\n      key,\n      enabled: channelEnabled(key, props),\n      order: index,\n    }))\n    .sort((a, b) => {\n      if (a.enabled !== b.enabled) return a.enabled ? -1 : 1;\n      return a.order - b.order;\n    });\n\n  return html`\n    <section class=\"grid grid-cols-2\">\n      ${orderedChannels.map((channel) =>\n        renderChannel(channel.key, props, {\n          whatsapp,\n          telegram,\n          discord,\n          googlechat,\n          slack,\n          signal,\n          imessage,\n          nostr,\n          channelAccounts: props.snapshot?.channelAccounts ?? null,\n        }),\n      )}\n    </section>\n\n    <section class=\"card\" style=\"margin-top: 18px;\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">通道健康状况</div>\n          <div class=\"card-sub\">来自网关的通道状态快照。</div>\n        </div>\n        <div class=\"muted\">${props.lastSuccessAt ? formatAgo(props.lastSuccessAt) : \"无\"}</div>\n      </div>\n      ${props.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${props.lastError}\n          </div>`\n        : nothing}\n      <pre class=\"code-block\" style=\"margin-top: 12px;\">\n${props.snapshot ? JSON.stringify(props.snapshot, null, 2) : \"暂无快照。\"}\n      </pre>\n    </section>\n  `;\n}\n\nfunction resolveChannelOrder(snapshot: ChannelsStatusSnapshot | null): ChannelKey[] {\n  if (snapshot?.channelMeta?.length) {\n    return snapshot.channelMeta.map((entry) => entry.id) as ChannelKey[];\n  }\n  if (snapshot?.channelOrder?.length) {\n    return snapshot.channelOrder;\n  }\n  return [\n    \"whatsapp\",\n    \"telegram\",\n    \"discord\",\n    \"googlechat\",\n    \"slack\",\n    \"signal\",\n    \"imessage\",\n    \"nostr\",\n  ];\n}\n\nfunction renderChannel(\n  key: ChannelKey,\n  props: ChannelsProps,\n  data: ChannelsChannelData,\n) {\n  const accountCountLabel = renderChannelAccountCount(\n    key,\n    data.channelAccounts,\n  );\n  switch (key) {\n    case \"whatsapp\":\n      return renderWhatsAppCard({\n        props,\n        whatsapp: data.whatsapp,\n        accountCountLabel,\n      });\n    case \"telegram\":\n      return renderTelegramCard({\n        props,\n        telegram: data.telegram,\n        telegramAccounts: data.channelAccounts?.telegram ?? [],\n        accountCountLabel,\n      });\n    case \"discord\":\n      return renderDiscordCard({\n        props,\n        discord: data.discord,\n        accountCountLabel,\n      });\n    case \"googlechat\":\n      return renderGoogleChatCard({\n        props,\n        googleChat: data.googlechat,\n        accountCountLabel,\n      });\n    case \"slack\":\n      return renderSlackCard({\n        props,\n        slack: data.slack,\n        accountCountLabel,\n      });\n    case \"signal\":\n      return renderSignalCard({\n        props,\n        signal: data.signal,\n        accountCountLabel,\n      });\n    case \"imessage\":\n      return renderIMessageCard({\n        props,\n        imessage: data.imessage,\n        accountCountLabel,\n      });\n    case \"nostr\": {\n      const nostrAccounts = data.channelAccounts?.nostr ?? [];\n      const primaryAccount = nostrAccounts[0];\n      const accountId = primaryAccount?.accountId ?? \"default\";\n      const profile =\n        (primaryAccount as { profile?: NostrProfile | null } | undefined)?.profile ?? null;\n      const showForm =\n        props.nostrProfileAccountId === accountId ? props.nostrProfileFormState : null;\n      const profileFormCallbacks = showForm\n        ? {\n            onFieldChange: props.onNostrProfileFieldChange,\n            onSave: props.onNostrProfileSave,\n            onImport: props.onNostrProfileImport,\n            onCancel: props.onNostrProfileCancel,\n            onToggleAdvanced: props.onNostrProfileToggleAdvanced,\n          }\n        : null;\n      return renderNostrCard({\n        props,\n        nostr: data.nostr,\n        nostrAccounts,\n        accountCountLabel,\n        profileFormState: showForm,\n        profileFormCallbacks,\n        onEditProfile: () => props.onNostrProfileEdit(accountId, profile),\n      });\n    }\n    default:\n      return renderGenericChannelCard(key, props, data.channelAccounts ?? {});\n  }\n}\n\nfunction renderGenericChannelCard(\n  key: ChannelKey,\n  props: ChannelsProps,\n  channelAccounts: Record<string, ChannelAccountSnapshot[]>,\n) {\n  const label = resolveChannelLabel(props.snapshot, key);\n  const status = props.snapshot?.channels?.[key] as Record<string, unknown> | undefined;\n  const configured = typeof status?.configured === \"boolean\" ? status.configured : undefined;\n  const running = typeof status?.running === \"boolean\" ? status.running : undefined;\n  const connected = typeof status?.connected === \"boolean\" ? status.connected : undefined;\n  const lastError = typeof status?.lastError === \"string\" ? status.lastError : undefined;\n  const accounts = channelAccounts[key] ?? [];\n  const accountCountLabel = renderChannelAccountCount(key, channelAccounts);\n\n  return html`\n    <div class=\"card\">\n      <div class=\"card-title\">${label}</div>\n      <div class=\"card-sub\">通道状态和配置。</div>\n      ${accountCountLabel}\n\n      ${accounts.length > 0\n        ? html`\n            <div class=\"account-card-list\">\n              ${accounts.map((account) => renderGenericAccount(account))}\n            </div>\n          `\n        : html`\n            <div class=\"status-list\" style=\"margin-top: 16px;\">\n              <div>\n                <span class=\"label\">已配置</span>\n                <span>${configured == null ? \"无\" : configured ? \"是\" : \"否\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">运行中</span>\n                <span>${running == null ? \"无\" : running ? \"是\" : \"否\"}</span>\n              </div>\n              <div>\n                <span class=\"label\">已连接</span>\n                <span>${connected == null ? \"无\" : connected ? \"是\" : \"否\"}</span>\n              </div>\n            </div>\n          `}\n\n      ${lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${lastError}\n          </div>`\n        : nothing}\n\n      ${renderChannelConfigSection({ channelId: key, props })}\n    </div>\n  `;\n}\n\nfunction resolveChannelMetaMap(\n  snapshot: ChannelsStatusSnapshot | null,\n): Record<string, ChannelUiMetaEntry> {\n  if (!snapshot?.channelMeta?.length) return {};\n  return Object.fromEntries(snapshot.channelMeta.map((entry) => [entry.id, entry]));\n}\n\nfunction resolveChannelLabel(\n  snapshot: ChannelsStatusSnapshot | null,\n  key: string,\n): string {\n  const meta = resolveChannelMetaMap(snapshot)[key];\n  return meta?.label ?? snapshot?.channelLabels?.[key] ?? key;\n}\n\nconst RECENT_ACTIVITY_THRESHOLD_MS = 10 * 60 * 1000; // 10 minutes\n\nfunction hasRecentActivity(account: ChannelAccountSnapshot): boolean {\n  if (!account.lastInboundAt) return false;\n  return Date.now() - account.lastInboundAt < RECENT_ACTIVITY_THRESHOLD_MS;\n}\n\nfunction deriveRunningStatus(account: ChannelAccountSnapshot): \"是\" | \"否\" | \"活跃\" {\n  if (account.running) return \"是\";\n  // If we have recent inbound activity, the channel is effectively running\n  if (hasRecentActivity(account)) return \"活跃\";\n  return \"否\";\n}\n\nfunction deriveConnectedStatus(account: ChannelAccountSnapshot): \"是\" | \"否\" | \"活跃\" | \"无\" {\n  if (account.connected === true) return \"是\";\n  if (account.connected === false) return \"否\";\n  // If connected is null/undefined but we have recent activity, show as active\n  if (hasRecentActivity(account)) return \"活跃\";\n  return \"无\";\n}\n\nfunction renderGenericAccount(account: ChannelAccountSnapshot) {\n  const runningStatus = deriveRunningStatus(account);\n  const connectedStatus = deriveConnectedStatus(account);\n\n  return html`\n    <div class=\"account-card\">\n      <div class=\"account-card-header\">\n        <div class=\"account-card-title\">${account.name || account.accountId}</div>\n        <div class=\"account-card-id\">${account.accountId}</div>\n      </div>\n      <div class=\"status-list account-card-status\">\n        <div>\n          <span class=\"label\">运行中</span>\n          <span>${runningStatus}</span>\n        </div>\n        <div>\n          <span class=\"label\">已配置</span>\n          <span>${account.configured ? \"是\" : \"否\"}</span>\n        </div>\n        <div>\n          <span class=\"label\">已连接</span>\n          <span>${connectedStatus}</span>\n        </div>\n        <div>\n          <span class=\"label\">最后入站</span>\n          <span>${account.lastInboundAt ? formatAgo(account.lastInboundAt) : \"无\"}</span>\n        </div>\n        ${account.lastError\n          ? html`\n              <div class=\"account-card-error\">\n                ${account.lastError}\n              </div>\n            `\n          : nothing}\n      </div>\n    </div>\n  `;\n}\n","import{isSingleExpression as i}from\"./directive-helpers.js\";import{Directive as t,PartType as e}from\"./directive.js\";export{directive}from\"./directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=(i,t)=>{const e=i._$AN;if(void 0===e)return!1;for(const i of e)i._$AO?.(t,!1),s(i,t);return!0},o=i=>{let t,e;do{if(void 0===(t=i._$AM))break;e=t._$AN,e.delete(i),i=t}while(0===e?.size)},r=i=>{for(let t;t=i._$AM;i=t){let e=t._$AN;if(void 0===e)t._$AN=e=new Set;else if(e.has(i))break;e.add(i),c(t)}};function h(i){void 0!==this._$AN?(o(this),this._$AM=i,r(this)):this._$AM=i}function n(i,t=!1,e=0){const r=this._$AH,h=this._$AN;if(void 0!==h&&0!==h.size)if(t)if(Array.isArray(r))for(let i=e;i<r.length;i++)s(r[i],!1),o(r[i]);else null!=r&&(s(r,!1),o(r));else s(this,i)}const c=i=>{i.type==e.CHILD&&(i._$AP??=n,i._$AQ??=h)};class f extends t{constructor(){super(...arguments),this._$AN=void 0}_$AT(i,t,e){super._$AT(i,t,e),r(this),this.isConnected=i._$AU}_$AO(i,t=!0){i!==this.isConnected&&(this.isConnected=i,i?this.reconnected?.():this.disconnected?.()),t&&(s(this,i),o(this))}setValue(t){if(i(this._$Ct))this._$Ct._$AI(t,this);else{const i=[...this._$Ct._$AH];i[this._$Ci]=t,this._$Ct._$AI(i,this,0)}}disconnected(){}reconnected(){}}export{f as AsyncDirective,t as Directive,e as PartType};\n//# sourceMappingURL=async-directive.js.map\n","import{nothing as t}from\"../lit-html.js\";import{AsyncDirective as i}from\"../async-directive.js\";import{directive as s}from\"../directive.js\";\n/**\n * @license\n * Copyright 2020 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const e=()=>new h;class h{}const o=new WeakMap,n=s(class extends i{render(i){return t}update(i,[s]){const e=s!==this.G;return e&&void 0!==this.G&&this.rt(void 0),(e||this.lt!==this.ct)&&(this.G=s,this.ht=i.options?.host,this.rt(this.ct=i.element)),t}rt(t){if(this.isConnected||(t=void 0),\"function\"==typeof this.G){const i=this.ht??globalThis;let s=o.get(i);void 0===s&&(s=new WeakMap,o.set(i,s)),void 0!==s.get(this.G)&&this.G.call(this.ht,void 0),s.set(this.G,t),void 0!==t&&this.G.call(this.ht,t)}else this.G.value=t}get lt(){return\"function\"==typeof this.G?o.get(this.ht??globalThis)?.get(this.G):this.G?.value}disconnected(){this.lt===this.ct&&this.rt(void 0)}reconnected(){this.rt(this.ct)}});export{e as createRef,n as ref};\n//# sourceMappingURL=ref.js.map\n","import{nothing as t,noChange as i}from\"../lit-html.js\";import{directive as r,Directive as s,PartType as n}from\"../directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class e extends s{constructor(i){if(super(i),this.it=t,i.type!==n.CHILD)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(r){if(r===t||null==r)return this._t=void 0,this.it=r;if(r===i)return r;if(\"string\"!=typeof r)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(r===this.it)return this._t;this.it=r;const s=[r];return s.raw=s,this._t={_$litType$:this.constructor.resultType,strings:s,values:[]}}}e.directiveName=\"unsafeHTML\",e.resultType=1;const o=r(e);export{e as UnsafeHTMLDirective,o as unsafeHTML};\n//# sourceMappingURL=unsafe-html.js.map\n","/*! @license DOMPurify 3.3.1 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.1/LICENSE */\n\nconst {\n  entries,\n  setPrototypeOf,\n  isFrozen,\n  getPrototypeOf,\n  getOwnPropertyDescriptor\n} = Object;\nlet {\n  freeze,\n  seal,\n  create\n} = Object; // eslint-disable-line import/no-mutable-exports\nlet {\n  apply,\n  construct\n} = typeof Reflect !== 'undefined' && Reflect;\nif (!freeze) {\n  freeze = function freeze(x) {\n    return x;\n  };\n}\nif (!seal) {\n  seal = function seal(x) {\n    return x;\n  };\n}\nif (!apply) {\n  apply = function apply(func, thisArg) {\n    for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n      args[_key - 2] = arguments[_key];\n    }\n    return func.apply(thisArg, args);\n  };\n}\nif (!construct) {\n  construct = function construct(Func) {\n    for (var _len2 = arguments.length, args = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n      args[_key2 - 1] = arguments[_key2];\n    }\n    return new Func(...args);\n  };\n}\nconst arrayForEach = unapply(Array.prototype.forEach);\nconst arrayLastIndexOf = unapply(Array.prototype.lastIndexOf);\nconst arrayPop = unapply(Array.prototype.pop);\nconst arrayPush = unapply(Array.prototype.push);\nconst arraySplice = unapply(Array.prototype.splice);\nconst stringToLowerCase = unapply(String.prototype.toLowerCase);\nconst stringToString = unapply(String.prototype.toString);\nconst stringMatch = unapply(String.prototype.match);\nconst stringReplace = unapply(String.prototype.replace);\nconst stringIndexOf = unapply(String.prototype.indexOf);\nconst stringTrim = unapply(String.prototype.trim);\nconst objectHasOwnProperty = unapply(Object.prototype.hasOwnProperty);\nconst regExpTest = unapply(RegExp.prototype.test);\nconst typeErrorCreate = unconstruct(TypeError);\n/**\n * Creates a new function that calls the given function with a specified thisArg and arguments.\n *\n * @param func - The function to be wrapped and called.\n * @returns A new function that calls the given function with a specified thisArg and arguments.\n */\nfunction unapply(func) {\n  return function (thisArg) {\n    if (thisArg instanceof RegExp) {\n      thisArg.lastIndex = 0;\n    }\n    for (var _len3 = arguments.length, args = new Array(_len3 > 1 ? _len3 - 1 : 0), _key3 = 1; _key3 < _len3; _key3++) {\n      args[_key3 - 1] = arguments[_key3];\n    }\n    return apply(func, thisArg, args);\n  };\n}\n/**\n * Creates a new function that constructs an instance of the given constructor function with the provided arguments.\n *\n * @param func - The constructor function to be wrapped and called.\n * @returns A new function that constructs an instance of the given constructor function with the provided arguments.\n */\nfunction unconstruct(Func) {\n  return function () {\n    for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n    return construct(Func, args);\n  };\n}\n/**\n * Add properties to a lookup table\n *\n * @param set - The set to which elements will be added.\n * @param array - The array containing elements to be added to the set.\n * @param transformCaseFunc - An optional function to transform the case of each element before adding to the set.\n * @returns The modified set with added elements.\n */\nfunction addToSet(set, array) {\n  let transformCaseFunc = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : stringToLowerCase;\n  if (setPrototypeOf) {\n    // Make 'in' and truthy checks like Boolean(set.constructor)\n    // independent of any properties defined on Object.prototype.\n    // Prevent prototype setters from intercepting set as a this value.\n    setPrototypeOf(set, null);\n  }\n  let l = array.length;\n  while (l--) {\n    let element = array[l];\n    if (typeof element === 'string') {\n      const lcElement = transformCaseFunc(element);\n      if (lcElement !== element) {\n        // Config presets (e.g. tags.js, attrs.js) are immutable.\n        if (!isFrozen(array)) {\n          array[l] = lcElement;\n        }\n        element = lcElement;\n      }\n    }\n    set[element] = true;\n  }\n  return set;\n}\n/**\n * Clean up an array to harden against CSPP\n *\n * @param array - The array to be cleaned.\n * @returns The cleaned version of the array\n */\nfunction cleanArray(array) {\n  for (let index = 0; index < array.length; index++) {\n    const isPropertyExist = objectHasOwnProperty(array, index);\n    if (!isPropertyExist) {\n      array[index] = null;\n    }\n  }\n  return array;\n}\n/**\n * Shallow clone an object\n *\n * @param object - The object to be cloned.\n * @returns A new object that copies the original.\n */\nfunction clone(object) {\n  const newObject = create(null);\n  for (const [property, value] of entries(object)) {\n    const isPropertyExist = objectHasOwnProperty(object, property);\n    if (isPropertyExist) {\n      if (Array.isArray(value)) {\n        newObject[property] = cleanArray(value);\n      } else if (value && typeof value === 'object' && value.constructor === Object) {\n        newObject[property] = clone(value);\n      } else {\n        newObject[property] = value;\n      }\n    }\n  }\n  return newObject;\n}\n/**\n * This method automatically checks if the prop is function or getter and behaves accordingly.\n *\n * @param object - The object to look up the getter function in its prototype chain.\n * @param prop - The property name for which to find the getter function.\n * @returns The getter function found in the prototype chain or a fallback function.\n */\nfunction lookupGetter(object, prop) {\n  while (object !== null) {\n    const desc = getOwnPropertyDescriptor(object, prop);\n    if (desc) {\n      if (desc.get) {\n        return unapply(desc.get);\n      }\n      if (typeof desc.value === 'function') {\n        return unapply(desc.value);\n      }\n    }\n    object = getPrototypeOf(object);\n  }\n  function fallbackValue() {\n    return null;\n  }\n  return fallbackValue;\n}\n\nconst html$1 = freeze(['a', 'abbr', 'acronym', 'address', 'area', 'article', 'aside', 'audio', 'b', 'bdi', 'bdo', 'big', 'blink', 'blockquote', 'body', 'br', 'button', 'canvas', 'caption', 'center', 'cite', 'code', 'col', 'colgroup', 'content', 'data', 'datalist', 'dd', 'decorator', 'del', 'details', 'dfn', 'dialog', 'dir', 'div', 'dl', 'dt', 'element', 'em', 'fieldset', 'figcaption', 'figure', 'font', 'footer', 'form', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'head', 'header', 'hgroup', 'hr', 'html', 'i', 'img', 'input', 'ins', 'kbd', 'label', 'legend', 'li', 'main', 'map', 'mark', 'marquee', 'menu', 'menuitem', 'meter', 'nav', 'nobr', 'ol', 'optgroup', 'option', 'output', 'p', 'picture', 'pre', 'progress', 'q', 'rp', 'rt', 'ruby', 's', 'samp', 'search', 'section', 'select', 'shadow', 'slot', 'small', 'source', 'spacer', 'span', 'strike', 'strong', 'style', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'template', 'textarea', 'tfoot', 'th', 'thead', 'time', 'tr', 'track', 'tt', 'u', 'ul', 'var', 'video', 'wbr']);\nconst svg$1 = freeze(['svg', 'a', 'altglyph', 'altglyphdef', 'altglyphitem', 'animatecolor', 'animatemotion', 'animatetransform', 'circle', 'clippath', 'defs', 'desc', 'ellipse', 'enterkeyhint', 'exportparts', 'filter', 'font', 'g', 'glyph', 'glyphref', 'hkern', 'image', 'inputmode', 'line', 'lineargradient', 'marker', 'mask', 'metadata', 'mpath', 'part', 'path', 'pattern', 'polygon', 'polyline', 'radialgradient', 'rect', 'stop', 'style', 'switch', 'symbol', 'text', 'textpath', 'title', 'tref', 'tspan', 'view', 'vkern']);\nconst svgFilters = freeze(['feBlend', 'feColorMatrix', 'feComponentTransfer', 'feComposite', 'feConvolveMatrix', 'feDiffuseLighting', 'feDisplacementMap', 'feDistantLight', 'feDropShadow', 'feFlood', 'feFuncA', 'feFuncB', 'feFuncG', 'feFuncR', 'feGaussianBlur', 'feImage', 'feMerge', 'feMergeNode', 'feMorphology', 'feOffset', 'fePointLight', 'feSpecularLighting', 'feSpotLight', 'feTile', 'feTurbulence']);\n// List of SVG elements that are disallowed by default.\n// We still need to know them so that we can do namespace\n// checks properly in case one wants to add them to\n// allow-list.\nconst svgDisallowed = freeze(['animate', 'color-profile', 'cursor', 'discard', 'font-face', 'font-face-format', 'font-face-name', 'font-face-src', 'font-face-uri', 'foreignobject', 'hatch', 'hatchpath', 'mesh', 'meshgradient', 'meshpatch', 'meshrow', 'missing-glyph', 'script', 'set', 'solidcolor', 'unknown', 'use']);\nconst mathMl$1 = freeze(['math', 'menclose', 'merror', 'mfenced', 'mfrac', 'mglyph', 'mi', 'mlabeledtr', 'mmultiscripts', 'mn', 'mo', 'mover', 'mpadded', 'mphantom', 'mroot', 'mrow', 'ms', 'mspace', 'msqrt', 'mstyle', 'msub', 'msup', 'msubsup', 'mtable', 'mtd', 'mtext', 'mtr', 'munder', 'munderover', 'mprescripts']);\n// Similarly to SVG, we want to know all MathML elements,\n// even those that we disallow by default.\nconst mathMlDisallowed = freeze(['maction', 'maligngroup', 'malignmark', 'mlongdiv', 'mscarries', 'mscarry', 'msgroup', 'mstack', 'msline', 'msrow', 'semantics', 'annotation', 'annotation-xml', 'mprescripts', 'none']);\nconst text = freeze(['#text']);\n\nconst html = freeze(['accept', 'action', 'align', 'alt', 'autocapitalize', 'autocomplete', 'autopictureinpicture', 'autoplay', 'background', 'bgcolor', 'border', 'capture', 'cellpadding', 'cellspacing', 'checked', 'cite', 'class', 'clear', 'color', 'cols', 'colspan', 'controls', 'controlslist', 'coords', 'crossorigin', 'datetime', 'decoding', 'default', 'dir', 'disabled', 'disablepictureinpicture', 'disableremoteplayback', 'download', 'draggable', 'enctype', 'enterkeyhint', 'exportparts', 'face', 'for', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'id', 'inert', 'inputmode', 'integrity', 'ismap', 'kind', 'label', 'lang', 'list', 'loading', 'loop', 'low', 'max', 'maxlength', 'media', 'method', 'min', 'minlength', 'multiple', 'muted', 'name', 'nonce', 'noshade', 'novalidate', 'nowrap', 'open', 'optimum', 'part', 'pattern', 'placeholder', 'playsinline', 'popover', 'popovertarget', 'popovertargetaction', 'poster', 'preload', 'pubdate', 'radiogroup', 'readonly', 'rel', 'required', 'rev', 'reversed', 'role', 'rows', 'rowspan', 'spellcheck', 'scope', 'selected', 'shape', 'size', 'sizes', 'slot', 'span', 'srclang', 'start', 'src', 'srcset', 'step', 'style', 'summary', 'tabindex', 'title', 'translate', 'type', 'usemap', 'valign', 'value', 'width', 'wrap', 'xmlns', 'slot']);\nconst svg = freeze(['accent-height', 'accumulate', 'additive', 'alignment-baseline', 'amplitude', 'ascent', 'attributename', 'attributetype', 'azimuth', 'basefrequency', 'baseline-shift', 'begin', 'bias', 'by', 'class', 'clip', 'clippathunits', 'clip-path', 'clip-rule', 'color', 'color-interpolation', 'color-interpolation-filters', 'color-profile', 'color-rendering', 'cx', 'cy', 'd', 'dx', 'dy', 'diffuseconstant', 'direction', 'display', 'divisor', 'dur', 'edgemode', 'elevation', 'end', 'exponent', 'fill', 'fill-opacity', 'fill-rule', 'filter', 'filterunits', 'flood-color', 'flood-opacity', 'font-family', 'font-size', 'font-size-adjust', 'font-stretch', 'font-style', 'font-variant', 'font-weight', 'fx', 'fy', 'g1', 'g2', 'glyph-name', 'glyphref', 'gradientunits', 'gradienttransform', 'height', 'href', 'id', 'image-rendering', 'in', 'in2', 'intercept', 'k', 'k1', 'k2', 'k3', 'k4', 'kerning', 'keypoints', 'keysplines', 'keytimes', 'lang', 'lengthadjust', 'letter-spacing', 'kernelmatrix', 'kernelunitlength', 'lighting-color', 'local', 'marker-end', 'marker-mid', 'marker-start', 'markerheight', 'markerunits', 'markerwidth', 'maskcontentunits', 'maskunits', 'max', 'mask', 'mask-type', 'media', 'method', 'mode', 'min', 'name', 'numoctaves', 'offset', 'operator', 'opacity', 'order', 'orient', 'orientation', 'origin', 'overflow', 'paint-order', 'path', 'pathlength', 'patterncontentunits', 'patterntransform', 'patternunits', 'points', 'preservealpha', 'preserveaspectratio', 'primitiveunits', 'r', 'rx', 'ry', 'radius', 'refx', 'refy', 'repeatcount', 'repeatdur', 'restart', 'result', 'rotate', 'scale', 'seed', 'shape-rendering', 'slope', 'specularconstant', 'specularexponent', 'spreadmethod', 'startoffset', 'stddeviation', 'stitchtiles', 'stop-color', 'stop-opacity', 'stroke-dasharray', 'stroke-dashoffset', 'stroke-linecap', 'stroke-linejoin', 'stroke-miterlimit', 'stroke-opacity', 'stroke', 'stroke-width', 'style', 'surfacescale', 'systemlanguage', 'tabindex', 'tablevalues', 'targetx', 'targety', 'transform', 'transform-origin', 'text-anchor', 'text-decoration', 'text-rendering', 'textlength', 'type', 'u1', 'u2', 'unicode', 'values', 'viewbox', 'visibility', 'version', 'vert-adv-y', 'vert-origin-x', 'vert-origin-y', 'width', 'word-spacing', 'wrap', 'writing-mode', 'xchannelselector', 'ychannelselector', 'x', 'x1', 'x2', 'xmlns', 'y', 'y1', 'y2', 'z', 'zoomandpan']);\nconst mathMl = freeze(['accent', 'accentunder', 'align', 'bevelled', 'close', 'columnsalign', 'columnlines', 'columnspan', 'denomalign', 'depth', 'dir', 'display', 'displaystyle', 'encoding', 'fence', 'frame', 'height', 'href', 'id', 'largeop', 'length', 'linethickness', 'lspace', 'lquote', 'mathbackground', 'mathcolor', 'mathsize', 'mathvariant', 'maxsize', 'minsize', 'movablelimits', 'notation', 'numalign', 'open', 'rowalign', 'rowlines', 'rowspacing', 'rowspan', 'rspace', 'rquote', 'scriptlevel', 'scriptminsize', 'scriptsizemultiplier', 'selection', 'separator', 'separators', 'stretchy', 'subscriptshift', 'supscriptshift', 'symmetric', 'voffset', 'width', 'xmlns']);\nconst xml = freeze(['xlink:href', 'xml:id', 'xlink:title', 'xml:space', 'xmlns:xlink']);\n\n// eslint-disable-next-line unicorn/better-regex\nconst MUSTACHE_EXPR = seal(/\\{\\{[\\w\\W]*|[\\w\\W]*\\}\\}/gm); // Specify template detection regex for SAFE_FOR_TEMPLATES mode\nconst ERB_EXPR = seal(/<%[\\w\\W]*|[\\w\\W]*%>/gm);\nconst TMPLIT_EXPR = seal(/\\$\\{[\\w\\W]*/gm); // eslint-disable-line unicorn/better-regex\nconst DATA_ATTR = seal(/^data-[\\-\\w.\\u00B7-\\uFFFF]+$/); // eslint-disable-line no-useless-escape\nconst ARIA_ATTR = seal(/^aria-[\\-\\w]+$/); // eslint-disable-line no-useless-escape\nconst IS_ALLOWED_URI = seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\\-]+(?:[^a-z+.\\-:]|$))/i // eslint-disable-line no-useless-escape\n);\nconst IS_SCRIPT_OR_DATA = seal(/^(?:\\w+script|data):/i);\nconst ATTR_WHITESPACE = seal(/[\\u0000-\\u0020\\u00A0\\u1680\\u180E\\u2000-\\u2029\\u205F\\u3000]/g // eslint-disable-line no-control-regex\n);\nconst DOCTYPE_NAME = seal(/^html$/i);\nconst CUSTOM_ELEMENT = seal(/^[a-z][.\\w]*(-[.\\w]+)+$/i);\n\nvar EXPRESSIONS = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  ARIA_ATTR: ARIA_ATTR,\n  ATTR_WHITESPACE: ATTR_WHITESPACE,\n  CUSTOM_ELEMENT: CUSTOM_ELEMENT,\n  DATA_ATTR: DATA_ATTR,\n  DOCTYPE_NAME: DOCTYPE_NAME,\n  ERB_EXPR: ERB_EXPR,\n  IS_ALLOWED_URI: IS_ALLOWED_URI,\n  IS_SCRIPT_OR_DATA: IS_SCRIPT_OR_DATA,\n  MUSTACHE_EXPR: MUSTACHE_EXPR,\n  TMPLIT_EXPR: TMPLIT_EXPR\n});\n\n/* eslint-disable @typescript-eslint/indent */\n// https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\nconst NODE_TYPE = {\n  element: 1,\n  attribute: 2,\n  text: 3,\n  cdataSection: 4,\n  entityReference: 5,\n  // Deprecated\n  entityNode: 6,\n  // Deprecated\n  progressingInstruction: 7,\n  comment: 8,\n  document: 9,\n  documentType: 10,\n  documentFragment: 11,\n  notation: 12 // Deprecated\n};\nconst getGlobal = function getGlobal() {\n  return typeof window === 'undefined' ? null : window;\n};\n/**\n * Creates a no-op policy for internal use only.\n * Don't export this function outside this module!\n * @param trustedTypes The policy factory.\n * @param purifyHostElement The Script element used to load DOMPurify (to determine policy name suffix).\n * @return The policy created (or null, if Trusted Types\n * are not supported or creating the policy failed).\n */\nconst _createTrustedTypesPolicy = function _createTrustedTypesPolicy(trustedTypes, purifyHostElement) {\n  if (typeof trustedTypes !== 'object' || typeof trustedTypes.createPolicy !== 'function') {\n    return null;\n  }\n  // Allow the callers to control the unique policy name\n  // by adding a data-tt-policy-suffix to the script element with the DOMPurify.\n  // Policy creation with duplicate names throws in Trusted Types.\n  let suffix = null;\n  const ATTR_NAME = 'data-tt-policy-suffix';\n  if (purifyHostElement && purifyHostElement.hasAttribute(ATTR_NAME)) {\n    suffix = purifyHostElement.getAttribute(ATTR_NAME);\n  }\n  const policyName = 'dompurify' + (suffix ? '#' + suffix : '');\n  try {\n    return trustedTypes.createPolicy(policyName, {\n      createHTML(html) {\n        return html;\n      },\n      createScriptURL(scriptUrl) {\n        return scriptUrl;\n      }\n    });\n  } catch (_) {\n    // Policy creation failed (most likely another DOMPurify script has\n    // already run). Skip creating the policy, as this will only cause errors\n    // if TT are enforced.\n    console.warn('TrustedTypes policy ' + policyName + ' could not be created.');\n    return null;\n  }\n};\nconst _createHooksMap = function _createHooksMap() {\n  return {\n    afterSanitizeAttributes: [],\n    afterSanitizeElements: [],\n    afterSanitizeShadowDOM: [],\n    beforeSanitizeAttributes: [],\n    beforeSanitizeElements: [],\n    beforeSanitizeShadowDOM: [],\n    uponSanitizeAttribute: [],\n    uponSanitizeElement: [],\n    uponSanitizeShadowNode: []\n  };\n};\nfunction createDOMPurify() {\n  let window = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : getGlobal();\n  const DOMPurify = root => createDOMPurify(root);\n  DOMPurify.version = '3.3.1';\n  DOMPurify.removed = [];\n  if (!window || !window.document || window.document.nodeType !== NODE_TYPE.document || !window.Element) {\n    // Not running in a browser, provide a factory function\n    // so that you can pass your own Window\n    DOMPurify.isSupported = false;\n    return DOMPurify;\n  }\n  let {\n    document\n  } = window;\n  const originalDocument = document;\n  const currentScript = originalDocument.currentScript;\n  const {\n    DocumentFragment,\n    HTMLTemplateElement,\n    Node,\n    Element,\n    NodeFilter,\n    NamedNodeMap = window.NamedNodeMap || window.MozNamedAttrMap,\n    HTMLFormElement,\n    DOMParser,\n    trustedTypes\n  } = window;\n  const ElementPrototype = Element.prototype;\n  const cloneNode = lookupGetter(ElementPrototype, 'cloneNode');\n  const remove = lookupGetter(ElementPrototype, 'remove');\n  const getNextSibling = lookupGetter(ElementPrototype, 'nextSibling');\n  const getChildNodes = lookupGetter(ElementPrototype, 'childNodes');\n  const getParentNode = lookupGetter(ElementPrototype, 'parentNode');\n  // As per issue #47, the web-components registry is inherited by a\n  // new document created via createHTMLDocument. As per the spec\n  // (http://w3c.github.io/webcomponents/spec/custom/#creating-and-passing-registries)\n  // a new empty registry is used when creating a template contents owner\n  // document, so we use that as our parent document to ensure nothing\n  // is inherited.\n  if (typeof HTMLTemplateElement === 'function') {\n    const template = document.createElement('template');\n    if (template.content && template.content.ownerDocument) {\n      document = template.content.ownerDocument;\n    }\n  }\n  let trustedTypesPolicy;\n  let emptyHTML = '';\n  const {\n    implementation,\n    createNodeIterator,\n    createDocumentFragment,\n    getElementsByTagName\n  } = document;\n  const {\n    importNode\n  } = originalDocument;\n  let hooks = _createHooksMap();\n  /**\n   * Expose whether this browser supports running the full DOMPurify.\n   */\n  DOMPurify.isSupported = typeof entries === 'function' && typeof getParentNode === 'function' && implementation && implementation.createHTMLDocument !== undefined;\n  const {\n    MUSTACHE_EXPR,\n    ERB_EXPR,\n    TMPLIT_EXPR,\n    DATA_ATTR,\n    ARIA_ATTR,\n    IS_SCRIPT_OR_DATA,\n    ATTR_WHITESPACE,\n    CUSTOM_ELEMENT\n  } = EXPRESSIONS;\n  let {\n    IS_ALLOWED_URI: IS_ALLOWED_URI$1\n  } = EXPRESSIONS;\n  /**\n   * We consider the elements and attributes below to be safe. Ideally\n   * don't add any new ones but feel free to remove unwanted ones.\n   */\n  /* allowed element names */\n  let ALLOWED_TAGS = null;\n  const DEFAULT_ALLOWED_TAGS = addToSet({}, [...html$1, ...svg$1, ...svgFilters, ...mathMl$1, ...text]);\n  /* Allowed attribute names */\n  let ALLOWED_ATTR = null;\n  const DEFAULT_ALLOWED_ATTR = addToSet({}, [...html, ...svg, ...mathMl, ...xml]);\n  /*\n   * Configure how DOMPurify should handle custom elements and their attributes as well as customized built-in elements.\n   * @property {RegExp|Function|null} tagNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any custom elements)\n   * @property {RegExp|Function|null} attributeNameCheck one of [null, regexPattern, predicate]. Default: `null` (disallow any attributes not on the allow list)\n   * @property {boolean} allowCustomizedBuiltInElements allow custom elements derived from built-ins if they pass CUSTOM_ELEMENT_HANDLING.tagNameCheck. Default: `false`.\n   */\n  let CUSTOM_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeNameCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    allowCustomizedBuiltInElements: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: false\n    }\n  }));\n  /* Explicitly forbidden tags (overrides ALLOWED_TAGS/ADD_TAGS) */\n  let FORBID_TAGS = null;\n  /* Explicitly forbidden attributes (overrides ALLOWED_ATTR/ADD_ATTR) */\n  let FORBID_ATTR = null;\n  /* Config object to store ADD_TAGS/ADD_ATTR functions (when used as functions) */\n  const EXTRA_ELEMENT_HANDLING = Object.seal(create(null, {\n    tagCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    },\n    attributeCheck: {\n      writable: true,\n      configurable: false,\n      enumerable: true,\n      value: null\n    }\n  }));\n  /* Decide if ARIA attributes are okay */\n  let ALLOW_ARIA_ATTR = true;\n  /* Decide if custom data attributes are okay */\n  let ALLOW_DATA_ATTR = true;\n  /* Decide if unknown protocols are okay */\n  let ALLOW_UNKNOWN_PROTOCOLS = false;\n  /* Decide if self-closing tags in attributes are allowed.\n   * Usually removed due to a mXSS issue in jQuery 3.0 */\n  let ALLOW_SELF_CLOSE_IN_ATTR = true;\n  /* Output should be safe for common template engines.\n   * This means, DOMPurify removes data attributes, mustaches and ERB\n   */\n  let SAFE_FOR_TEMPLATES = false;\n  /* Output should be safe even for XML used within HTML and alike.\n   * This means, DOMPurify removes comments when containing risky content.\n   */\n  let SAFE_FOR_XML = true;\n  /* Decide if document with <html>... should be returned */\n  let WHOLE_DOCUMENT = false;\n  /* Track whether config is already set on this instance of DOMPurify. */\n  let SET_CONFIG = false;\n  /* Decide if all elements (e.g. style, script) must be children of\n   * document.body. By default, browsers might move them to document.head */\n  let FORCE_BODY = false;\n  /* Decide if a DOM `HTMLBodyElement` should be returned, instead of a html\n   * string (or a TrustedHTML object if Trusted Types are supported).\n   * If `WHOLE_DOCUMENT` is enabled a `HTMLHtmlElement` will be returned instead\n   */\n  let RETURN_DOM = false;\n  /* Decide if a DOM `DocumentFragment` should be returned, instead of a html\n   * string  (or a TrustedHTML object if Trusted Types are supported) */\n  let RETURN_DOM_FRAGMENT = false;\n  /* Try to return a Trusted Type object instead of a string, return a string in\n   * case Trusted Types are not supported  */\n  let RETURN_TRUSTED_TYPE = false;\n  /* Output should be free from DOM clobbering attacks?\n   * This sanitizes markups named with colliding, clobberable built-in DOM APIs.\n   */\n  let SANITIZE_DOM = true;\n  /* Achieve full DOM Clobbering protection by isolating the namespace of named\n   * properties and JS variables, mitigating attacks that abuse the HTML/DOM spec rules.\n   *\n   * HTML/DOM spec rules that enable DOM Clobbering:\n   *   - Named Access on Window (§7.3.3)\n   *   - DOM Tree Accessors (§3.1.5)\n   *   - Form Element Parent-Child Relations (§4.10.3)\n   *   - Iframe srcdoc / Nested WindowProxies (§4.8.5)\n   *   - HTMLCollection (§4.2.10.2)\n   *\n   * Namespace isolation is implemented by prefixing `id` and `name` attributes\n   * with a constant string, i.e., `user-content-`\n   */\n  let SANITIZE_NAMED_PROPS = false;\n  const SANITIZE_NAMED_PROPS_PREFIX = 'user-content-';\n  /* Keep element content when removing element? */\n  let KEEP_CONTENT = true;\n  /* If a `Node` is passed to sanitize(), then performs sanitization in-place instead\n   * of importing it into a new Document and returning a sanitized copy */\n  let IN_PLACE = false;\n  /* Allow usage of profiles like html, svg and mathMl */\n  let USE_PROFILES = {};\n  /* Tags to ignore content of when KEEP_CONTENT is true */\n  let FORBID_CONTENTS = null;\n  const DEFAULT_FORBID_CONTENTS = addToSet({}, ['annotation-xml', 'audio', 'colgroup', 'desc', 'foreignobject', 'head', 'iframe', 'math', 'mi', 'mn', 'mo', 'ms', 'mtext', 'noembed', 'noframes', 'noscript', 'plaintext', 'script', 'style', 'svg', 'template', 'thead', 'title', 'video', 'xmp']);\n  /* Tags that are safe for data: URIs */\n  let DATA_URI_TAGS = null;\n  const DEFAULT_DATA_URI_TAGS = addToSet({}, ['audio', 'video', 'img', 'source', 'image', 'track']);\n  /* Attributes safe for values like \"javascript:\" */\n  let URI_SAFE_ATTRIBUTES = null;\n  const DEFAULT_URI_SAFE_ATTRIBUTES = addToSet({}, ['alt', 'class', 'for', 'id', 'label', 'name', 'pattern', 'placeholder', 'role', 'summary', 'title', 'value', 'style', 'xmlns']);\n  const MATHML_NAMESPACE = 'http://www.w3.org/1998/Math/MathML';\n  const SVG_NAMESPACE = 'http://www.w3.org/2000/svg';\n  const HTML_NAMESPACE = 'http://www.w3.org/1999/xhtml';\n  /* Document namespace */\n  let NAMESPACE = HTML_NAMESPACE;\n  let IS_EMPTY_INPUT = false;\n  /* Allowed XHTML+XML namespaces */\n  let ALLOWED_NAMESPACES = null;\n  const DEFAULT_ALLOWED_NAMESPACES = addToSet({}, [MATHML_NAMESPACE, SVG_NAMESPACE, HTML_NAMESPACE], stringToString);\n  let MATHML_TEXT_INTEGRATION_POINTS = addToSet({}, ['mi', 'mo', 'mn', 'ms', 'mtext']);\n  let HTML_INTEGRATION_POINTS = addToSet({}, ['annotation-xml']);\n  // Certain elements are allowed in both SVG and HTML\n  // namespace. We need to specify them explicitly\n  // so that they don't get erroneously deleted from\n  // HTML namespace.\n  const COMMON_SVG_AND_HTML_ELEMENTS = addToSet({}, ['title', 'style', 'font', 'a', 'script']);\n  /* Parsing of strict XHTML documents */\n  let PARSER_MEDIA_TYPE = null;\n  const SUPPORTED_PARSER_MEDIA_TYPES = ['application/xhtml+xml', 'text/html'];\n  const DEFAULT_PARSER_MEDIA_TYPE = 'text/html';\n  let transformCaseFunc = null;\n  /* Keep a reference to config to pass to hooks */\n  let CONFIG = null;\n  /* Ideally, do not touch anything below this line */\n  /* ______________________________________________ */\n  const formElement = document.createElement('form');\n  const isRegexOrFunction = function isRegexOrFunction(testValue) {\n    return testValue instanceof RegExp || testValue instanceof Function;\n  };\n  /**\n   * _parseConfig\n   *\n   * @param cfg optional config literal\n   */\n  // eslint-disable-next-line complexity\n  const _parseConfig = function _parseConfig() {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    if (CONFIG && CONFIG === cfg) {\n      return;\n    }\n    /* Shield configuration object from tampering */\n    if (!cfg || typeof cfg !== 'object') {\n      cfg = {};\n    }\n    /* Shield configuration object from prototype pollution */\n    cfg = clone(cfg);\n    PARSER_MEDIA_TYPE =\n    // eslint-disable-next-line unicorn/prefer-includes\n    SUPPORTED_PARSER_MEDIA_TYPES.indexOf(cfg.PARSER_MEDIA_TYPE) === -1 ? DEFAULT_PARSER_MEDIA_TYPE : cfg.PARSER_MEDIA_TYPE;\n    // HTML tags and attributes are not case-sensitive, converting to lowercase. Keeping XHTML as is.\n    transformCaseFunc = PARSER_MEDIA_TYPE === 'application/xhtml+xml' ? stringToString : stringToLowerCase;\n    /* Set configuration parameters */\n    ALLOWED_TAGS = objectHasOwnProperty(cfg, 'ALLOWED_TAGS') ? addToSet({}, cfg.ALLOWED_TAGS, transformCaseFunc) : DEFAULT_ALLOWED_TAGS;\n    ALLOWED_ATTR = objectHasOwnProperty(cfg, 'ALLOWED_ATTR') ? addToSet({}, cfg.ALLOWED_ATTR, transformCaseFunc) : DEFAULT_ALLOWED_ATTR;\n    ALLOWED_NAMESPACES = objectHasOwnProperty(cfg, 'ALLOWED_NAMESPACES') ? addToSet({}, cfg.ALLOWED_NAMESPACES, stringToString) : DEFAULT_ALLOWED_NAMESPACES;\n    URI_SAFE_ATTRIBUTES = objectHasOwnProperty(cfg, 'ADD_URI_SAFE_ATTR') ? addToSet(clone(DEFAULT_URI_SAFE_ATTRIBUTES), cfg.ADD_URI_SAFE_ATTR, transformCaseFunc) : DEFAULT_URI_SAFE_ATTRIBUTES;\n    DATA_URI_TAGS = objectHasOwnProperty(cfg, 'ADD_DATA_URI_TAGS') ? addToSet(clone(DEFAULT_DATA_URI_TAGS), cfg.ADD_DATA_URI_TAGS, transformCaseFunc) : DEFAULT_DATA_URI_TAGS;\n    FORBID_CONTENTS = objectHasOwnProperty(cfg, 'FORBID_CONTENTS') ? addToSet({}, cfg.FORBID_CONTENTS, transformCaseFunc) : DEFAULT_FORBID_CONTENTS;\n    FORBID_TAGS = objectHasOwnProperty(cfg, 'FORBID_TAGS') ? addToSet({}, cfg.FORBID_TAGS, transformCaseFunc) : clone({});\n    FORBID_ATTR = objectHasOwnProperty(cfg, 'FORBID_ATTR') ? addToSet({}, cfg.FORBID_ATTR, transformCaseFunc) : clone({});\n    USE_PROFILES = objectHasOwnProperty(cfg, 'USE_PROFILES') ? cfg.USE_PROFILES : false;\n    ALLOW_ARIA_ATTR = cfg.ALLOW_ARIA_ATTR !== false; // Default true\n    ALLOW_DATA_ATTR = cfg.ALLOW_DATA_ATTR !== false; // Default true\n    ALLOW_UNKNOWN_PROTOCOLS = cfg.ALLOW_UNKNOWN_PROTOCOLS || false; // Default false\n    ALLOW_SELF_CLOSE_IN_ATTR = cfg.ALLOW_SELF_CLOSE_IN_ATTR !== false; // Default true\n    SAFE_FOR_TEMPLATES = cfg.SAFE_FOR_TEMPLATES || false; // Default false\n    SAFE_FOR_XML = cfg.SAFE_FOR_XML !== false; // Default true\n    WHOLE_DOCUMENT = cfg.WHOLE_DOCUMENT || false; // Default false\n    RETURN_DOM = cfg.RETURN_DOM || false; // Default false\n    RETURN_DOM_FRAGMENT = cfg.RETURN_DOM_FRAGMENT || false; // Default false\n    RETURN_TRUSTED_TYPE = cfg.RETURN_TRUSTED_TYPE || false; // Default false\n    FORCE_BODY = cfg.FORCE_BODY || false; // Default false\n    SANITIZE_DOM = cfg.SANITIZE_DOM !== false; // Default true\n    SANITIZE_NAMED_PROPS = cfg.SANITIZE_NAMED_PROPS || false; // Default false\n    KEEP_CONTENT = cfg.KEEP_CONTENT !== false; // Default true\n    IN_PLACE = cfg.IN_PLACE || false; // Default false\n    IS_ALLOWED_URI$1 = cfg.ALLOWED_URI_REGEXP || IS_ALLOWED_URI;\n    NAMESPACE = cfg.NAMESPACE || HTML_NAMESPACE;\n    MATHML_TEXT_INTEGRATION_POINTS = cfg.MATHML_TEXT_INTEGRATION_POINTS || MATHML_TEXT_INTEGRATION_POINTS;\n    HTML_INTEGRATION_POINTS = cfg.HTML_INTEGRATION_POINTS || HTML_INTEGRATION_POINTS;\n    CUSTOM_ELEMENT_HANDLING = cfg.CUSTOM_ELEMENT_HANDLING || {};\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.tagNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.tagNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && isRegexOrFunction(cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)) {\n      CUSTOM_ELEMENT_HANDLING.attributeNameCheck = cfg.CUSTOM_ELEMENT_HANDLING.attributeNameCheck;\n    }\n    if (cfg.CUSTOM_ELEMENT_HANDLING && typeof cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements === 'boolean') {\n      CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements = cfg.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements;\n    }\n    if (SAFE_FOR_TEMPLATES) {\n      ALLOW_DATA_ATTR = false;\n    }\n    if (RETURN_DOM_FRAGMENT) {\n      RETURN_DOM = true;\n    }\n    /* Parse profile info */\n    if (USE_PROFILES) {\n      ALLOWED_TAGS = addToSet({}, text);\n      ALLOWED_ATTR = [];\n      if (USE_PROFILES.html === true) {\n        addToSet(ALLOWED_TAGS, html$1);\n        addToSet(ALLOWED_ATTR, html);\n      }\n      if (USE_PROFILES.svg === true) {\n        addToSet(ALLOWED_TAGS, svg$1);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.svgFilters === true) {\n        addToSet(ALLOWED_TAGS, svgFilters);\n        addToSet(ALLOWED_ATTR, svg);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n      if (USE_PROFILES.mathMl === true) {\n        addToSet(ALLOWED_TAGS, mathMl$1);\n        addToSet(ALLOWED_ATTR, mathMl);\n        addToSet(ALLOWED_ATTR, xml);\n      }\n    }\n    /* Merge configuration parameters */\n    if (cfg.ADD_TAGS) {\n      if (typeof cfg.ADD_TAGS === 'function') {\n        EXTRA_ELEMENT_HANDLING.tagCheck = cfg.ADD_TAGS;\n      } else {\n        if (ALLOWED_TAGS === DEFAULT_ALLOWED_TAGS) {\n          ALLOWED_TAGS = clone(ALLOWED_TAGS);\n        }\n        addToSet(ALLOWED_TAGS, cfg.ADD_TAGS, transformCaseFunc);\n      }\n    }\n    if (cfg.ADD_ATTR) {\n      if (typeof cfg.ADD_ATTR === 'function') {\n        EXTRA_ELEMENT_HANDLING.attributeCheck = cfg.ADD_ATTR;\n      } else {\n        if (ALLOWED_ATTR === DEFAULT_ALLOWED_ATTR) {\n          ALLOWED_ATTR = clone(ALLOWED_ATTR);\n        }\n        addToSet(ALLOWED_ATTR, cfg.ADD_ATTR, transformCaseFunc);\n      }\n    }\n    if (cfg.ADD_URI_SAFE_ATTR) {\n      addToSet(URI_SAFE_ATTRIBUTES, cfg.ADD_URI_SAFE_ATTR, transformCaseFunc);\n    }\n    if (cfg.FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n      addToSet(FORBID_CONTENTS, cfg.FORBID_CONTENTS, transformCaseFunc);\n    }\n    if (cfg.ADD_FORBID_CONTENTS) {\n      if (FORBID_CONTENTS === DEFAULT_FORBID_CONTENTS) {\n        FORBID_CONTENTS = clone(FORBID_CONTENTS);\n      }\n      addToSet(FORBID_CONTENTS, cfg.ADD_FORBID_CONTENTS, transformCaseFunc);\n    }\n    /* Add #text in case KEEP_CONTENT is set to true */\n    if (KEEP_CONTENT) {\n      ALLOWED_TAGS['#text'] = true;\n    }\n    /* Add html, head and body to ALLOWED_TAGS in case WHOLE_DOCUMENT is true */\n    if (WHOLE_DOCUMENT) {\n      addToSet(ALLOWED_TAGS, ['html', 'head', 'body']);\n    }\n    /* Add tbody to ALLOWED_TAGS in case tables are permitted, see #286, #365 */\n    if (ALLOWED_TAGS.table) {\n      addToSet(ALLOWED_TAGS, ['tbody']);\n      delete FORBID_TAGS.tbody;\n    }\n    if (cfg.TRUSTED_TYPES_POLICY) {\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createHTML !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createHTML\" hook.');\n      }\n      if (typeof cfg.TRUSTED_TYPES_POLICY.createScriptURL !== 'function') {\n        throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a \"createScriptURL\" hook.');\n      }\n      // Overwrite existing TrustedTypes policy.\n      trustedTypesPolicy = cfg.TRUSTED_TYPES_POLICY;\n      // Sign local variables required by `sanitize`.\n      emptyHTML = trustedTypesPolicy.createHTML('');\n    } else {\n      // Uninitialized policy, attempt to initialize the internal dompurify policy.\n      if (trustedTypesPolicy === undefined) {\n        trustedTypesPolicy = _createTrustedTypesPolicy(trustedTypes, currentScript);\n      }\n      // If creating the internal policy succeeded sign internal variables.\n      if (trustedTypesPolicy !== null && typeof emptyHTML === 'string') {\n        emptyHTML = trustedTypesPolicy.createHTML('');\n      }\n    }\n    // Prevent further manipulation of configuration.\n    // Not available in IE8, Safari 5, etc.\n    if (freeze) {\n      freeze(cfg);\n    }\n    CONFIG = cfg;\n  };\n  /* Keep track of all possible SVG and MathML tags\n   * so that we can perform the namespace checks\n   * correctly. */\n  const ALL_SVG_TAGS = addToSet({}, [...svg$1, ...svgFilters, ...svgDisallowed]);\n  const ALL_MATHML_TAGS = addToSet({}, [...mathMl$1, ...mathMlDisallowed]);\n  /**\n   * @param element a DOM element whose namespace is being checked\n   * @returns Return false if the element has a\n   *  namespace that a spec-compliant parser would never\n   *  return. Return true otherwise.\n   */\n  const _checkValidNamespace = function _checkValidNamespace(element) {\n    let parent = getParentNode(element);\n    // In JSDOM, if we're inside shadow DOM, then parentNode\n    // can be null. We just simulate parent in this case.\n    if (!parent || !parent.tagName) {\n      parent = {\n        namespaceURI: NAMESPACE,\n        tagName: 'template'\n      };\n    }\n    const tagName = stringToLowerCase(element.tagName);\n    const parentTagName = stringToLowerCase(parent.tagName);\n    if (!ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return false;\n    }\n    if (element.namespaceURI === SVG_NAMESPACE) {\n      // The only way to switch from HTML namespace to SVG\n      // is via <svg>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'svg';\n      }\n      // The only way to switch from MathML to SVG is via`\n      // svg if parent is either <annotation-xml> or MathML\n      // text integration points.\n      if (parent.namespaceURI === MATHML_NAMESPACE) {\n        return tagName === 'svg' && (parentTagName === 'annotation-xml' || MATHML_TEXT_INTEGRATION_POINTS[parentTagName]);\n      }\n      // We only allow elements that are defined in SVG\n      // spec. All others are disallowed in SVG namespace.\n      return Boolean(ALL_SVG_TAGS[tagName]);\n    }\n    if (element.namespaceURI === MATHML_NAMESPACE) {\n      // The only way to switch from HTML namespace to MathML\n      // is via <math>. If it happens via any other tag, then\n      // it should be killed.\n      if (parent.namespaceURI === HTML_NAMESPACE) {\n        return tagName === 'math';\n      }\n      // The only way to switch from SVG to MathML is via\n      // <math> and HTML integration points\n      if (parent.namespaceURI === SVG_NAMESPACE) {\n        return tagName === 'math' && HTML_INTEGRATION_POINTS[parentTagName];\n      }\n      // We only allow elements that are defined in MathML\n      // spec. All others are disallowed in MathML namespace.\n      return Boolean(ALL_MATHML_TAGS[tagName]);\n    }\n    if (element.namespaceURI === HTML_NAMESPACE) {\n      // The only way to switch from SVG to HTML is via\n      // HTML integration points, and from MathML to HTML\n      // is via MathML text integration points\n      if (parent.namespaceURI === SVG_NAMESPACE && !HTML_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      if (parent.namespaceURI === MATHML_NAMESPACE && !MATHML_TEXT_INTEGRATION_POINTS[parentTagName]) {\n        return false;\n      }\n      // We disallow tags that are specific for MathML\n      // or SVG and should never appear in HTML namespace\n      return !ALL_MATHML_TAGS[tagName] && (COMMON_SVG_AND_HTML_ELEMENTS[tagName] || !ALL_SVG_TAGS[tagName]);\n    }\n    // For XHTML and XML documents that support custom namespaces\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && ALLOWED_NAMESPACES[element.namespaceURI]) {\n      return true;\n    }\n    // The code should never reach this place (this means\n    // that the element somehow got namespace that is not\n    // HTML, SVG, MathML or allowed via ALLOWED_NAMESPACES).\n    // Return false just in case.\n    return false;\n  };\n  /**\n   * _forceRemove\n   *\n   * @param node a DOM node\n   */\n  const _forceRemove = function _forceRemove(node) {\n    arrayPush(DOMPurify.removed, {\n      element: node\n    });\n    try {\n      // eslint-disable-next-line unicorn/prefer-dom-node-remove\n      getParentNode(node).removeChild(node);\n    } catch (_) {\n      remove(node);\n    }\n  };\n  /**\n   * _removeAttribute\n   *\n   * @param name an Attribute name\n   * @param element a DOM node\n   */\n  const _removeAttribute = function _removeAttribute(name, element) {\n    try {\n      arrayPush(DOMPurify.removed, {\n        attribute: element.getAttributeNode(name),\n        from: element\n      });\n    } catch (_) {\n      arrayPush(DOMPurify.removed, {\n        attribute: null,\n        from: element\n      });\n    }\n    element.removeAttribute(name);\n    // We void attribute values for unremovable \"is\" attributes\n    if (name === 'is') {\n      if (RETURN_DOM || RETURN_DOM_FRAGMENT) {\n        try {\n          _forceRemove(element);\n        } catch (_) {}\n      } else {\n        try {\n          element.setAttribute(name, '');\n        } catch (_) {}\n      }\n    }\n  };\n  /**\n   * _initDocument\n   *\n   * @param dirty - a string of dirty markup\n   * @return a DOM, filled with the dirty markup\n   */\n  const _initDocument = function _initDocument(dirty) {\n    /* Create a HTML document */\n    let doc = null;\n    let leadingWhitespace = null;\n    if (FORCE_BODY) {\n      dirty = '<remove></remove>' + dirty;\n    } else {\n      /* If FORCE_BODY isn't used, leading whitespace needs to be preserved manually */\n      const matches = stringMatch(dirty, /^[\\r\\n\\t ]+/);\n      leadingWhitespace = matches && matches[0];\n    }\n    if (PARSER_MEDIA_TYPE === 'application/xhtml+xml' && NAMESPACE === HTML_NAMESPACE) {\n      // Root of XHTML doc must contain xmlns declaration (see https://www.w3.org/TR/xhtml1/normative.html#strict)\n      dirty = '<html xmlns=\"http://www.w3.org/1999/xhtml\"><head></head><body>' + dirty + '</body></html>';\n    }\n    const dirtyPayload = trustedTypesPolicy ? trustedTypesPolicy.createHTML(dirty) : dirty;\n    /*\n     * Use the DOMParser API by default, fallback later if needs be\n     * DOMParser not work for svg when has multiple root element.\n     */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      try {\n        doc = new DOMParser().parseFromString(dirtyPayload, PARSER_MEDIA_TYPE);\n      } catch (_) {}\n    }\n    /* Use createHTMLDocument in case DOMParser is not available */\n    if (!doc || !doc.documentElement) {\n      doc = implementation.createDocument(NAMESPACE, 'template', null);\n      try {\n        doc.documentElement.innerHTML = IS_EMPTY_INPUT ? emptyHTML : dirtyPayload;\n      } catch (_) {\n        // Syntax error if dirtyPayload is invalid xml\n      }\n    }\n    const body = doc.body || doc.documentElement;\n    if (dirty && leadingWhitespace) {\n      body.insertBefore(document.createTextNode(leadingWhitespace), body.childNodes[0] || null);\n    }\n    /* Work on whole document or just its body */\n    if (NAMESPACE === HTML_NAMESPACE) {\n      return getElementsByTagName.call(doc, WHOLE_DOCUMENT ? 'html' : 'body')[0];\n    }\n    return WHOLE_DOCUMENT ? doc.documentElement : body;\n  };\n  /**\n   * Creates a NodeIterator object that you can use to traverse filtered lists of nodes or elements in a document.\n   *\n   * @param root The root element or node to start traversing on.\n   * @return The created NodeIterator\n   */\n  const _createNodeIterator = function _createNodeIterator(root) {\n    return createNodeIterator.call(root.ownerDocument || root, root,\n    // eslint-disable-next-line no-bitwise\n    NodeFilter.SHOW_ELEMENT | NodeFilter.SHOW_COMMENT | NodeFilter.SHOW_TEXT | NodeFilter.SHOW_PROCESSING_INSTRUCTION | NodeFilter.SHOW_CDATA_SECTION, null);\n  };\n  /**\n   * _isClobbered\n   *\n   * @param element element to check for clobbering attacks\n   * @return true if clobbered, false if safe\n   */\n  const _isClobbered = function _isClobbered(element) {\n    return element instanceof HTMLFormElement && (typeof element.nodeName !== 'string' || typeof element.textContent !== 'string' || typeof element.removeChild !== 'function' || !(element.attributes instanceof NamedNodeMap) || typeof element.removeAttribute !== 'function' || typeof element.setAttribute !== 'function' || typeof element.namespaceURI !== 'string' || typeof element.insertBefore !== 'function' || typeof element.hasChildNodes !== 'function');\n  };\n  /**\n   * Checks whether the given object is a DOM node.\n   *\n   * @param value object to check whether it's a DOM node\n   * @return true is object is a DOM node\n   */\n  const _isNode = function _isNode(value) {\n    return typeof Node === 'function' && value instanceof Node;\n  };\n  function _executeHooks(hooks, currentNode, data) {\n    arrayForEach(hooks, hook => {\n      hook.call(DOMPurify, currentNode, data, CONFIG);\n    });\n  }\n  /**\n   * _sanitizeElements\n   *\n   * @protect nodeName\n   * @protect textContent\n   * @protect removeChild\n   * @param currentNode to check for permission to exist\n   * @return true if node was killed, false if left alive\n   */\n  const _sanitizeElements = function _sanitizeElements(currentNode) {\n    let content = null;\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeElements, currentNode, null);\n    /* Check if element is clobbered or can clobber */\n    if (_isClobbered(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Now let's check the element's type and name */\n    const tagName = transformCaseFunc(currentNode.nodeName);\n    /* Execute a hook if present */\n    _executeHooks(hooks.uponSanitizeElement, currentNode, {\n      tagName,\n      allowedTags: ALLOWED_TAGS\n    });\n    /* Detect mXSS attempts abusing namespace confusion */\n    if (SAFE_FOR_XML && currentNode.hasChildNodes() && !_isNode(currentNode.firstElementChild) && regExpTest(/<[/\\w!]/g, currentNode.innerHTML) && regExpTest(/<[/\\w!]/g, currentNode.textContent)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any occurrence of processing instructions */\n    if (currentNode.nodeType === NODE_TYPE.progressingInstruction) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove any kind of possibly harmful comments */\n    if (SAFE_FOR_XML && currentNode.nodeType === NODE_TYPE.comment && regExpTest(/<[/\\w]/g, currentNode.data)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Remove element if anything forbids its presence */\n    if (!(EXTRA_ELEMENT_HANDLING.tagCheck instanceof Function && EXTRA_ELEMENT_HANDLING.tagCheck(tagName)) && (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName])) {\n      /* Check if we have a custom element to handle */\n      if (!FORBID_TAGS[tagName] && _isBasicCustomElement(tagName)) {\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, tagName)) {\n          return false;\n        }\n        if (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(tagName)) {\n          return false;\n        }\n      }\n      /* Keep content except for bad-listed elements */\n      if (KEEP_CONTENT && !FORBID_CONTENTS[tagName]) {\n        const parentNode = getParentNode(currentNode) || currentNode.parentNode;\n        const childNodes = getChildNodes(currentNode) || currentNode.childNodes;\n        if (childNodes && parentNode) {\n          const childCount = childNodes.length;\n          for (let i = childCount - 1; i >= 0; --i) {\n            const childClone = cloneNode(childNodes[i], true);\n            childClone.__removalCount = (currentNode.__removalCount || 0) + 1;\n            parentNode.insertBefore(childClone, getNextSibling(currentNode));\n          }\n        }\n      }\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Check whether element has a valid namespace */\n    if (currentNode instanceof Element && !_checkValidNamespace(currentNode)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Make sure that older browsers don't get fallback-tag mXSS */\n    if ((tagName === 'noscript' || tagName === 'noembed' || tagName === 'noframes') && regExpTest(/<\\/no(script|embed|frames)/i, currentNode.innerHTML)) {\n      _forceRemove(currentNode);\n      return true;\n    }\n    /* Sanitize element content to be template-safe */\n    if (SAFE_FOR_TEMPLATES && currentNode.nodeType === NODE_TYPE.text) {\n      /* Get the element's text content */\n      content = currentNode.textContent;\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        content = stringReplace(content, expr, ' ');\n      });\n      if (currentNode.textContent !== content) {\n        arrayPush(DOMPurify.removed, {\n          element: currentNode.cloneNode()\n        });\n        currentNode.textContent = content;\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeElements, currentNode, null);\n    return false;\n  };\n  /**\n   * _isValidAttribute\n   *\n   * @param lcTag Lowercase tag name of containing element.\n   * @param lcName Lowercase attribute name.\n   * @param value Attribute value.\n   * @return Returns true if `value` is valid, otherwise false.\n   */\n  // eslint-disable-next-line complexity\n  const _isValidAttribute = function _isValidAttribute(lcTag, lcName, value) {\n    /* Make sure attribute cannot clobber */\n    if (SANITIZE_DOM && (lcName === 'id' || lcName === 'name') && (value in document || value in formElement)) {\n      return false;\n    }\n    /* Allow valid data-* attributes: At least one character after \"-\"\n        (https://html.spec.whatwg.org/multipage/dom.html#embedding-custom-non-visible-data-with-the-data-*-attributes)\n        XML-compatible (https://html.spec.whatwg.org/multipage/infrastructure.html#xml-compatible and http://www.w3.org/TR/xml/#d0e804)\n        We don't need to check the value; it's always URI safe. */\n    if (ALLOW_DATA_ATTR && !FORBID_ATTR[lcName] && regExpTest(DATA_ATTR, lcName)) ; else if (ALLOW_ARIA_ATTR && regExpTest(ARIA_ATTR, lcName)) ; else if (EXTRA_ELEMENT_HANDLING.attributeCheck instanceof Function && EXTRA_ELEMENT_HANDLING.attributeCheck(lcName, lcTag)) ; else if (!ALLOWED_ATTR[lcName] || FORBID_ATTR[lcName]) {\n      if (\n      // First condition does a very basic check if a) it's basically a valid custom element tagname AND\n      // b) if the tagName passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      // and c) if the attribute name passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.attributeNameCheck\n      _isBasicCustomElement(lcTag) && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, lcTag) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(lcTag)) && (CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.attributeNameCheck, lcName) || CUSTOM_ELEMENT_HANDLING.attributeNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.attributeNameCheck(lcName, lcTag)) ||\n      // Alternative, second condition checks if it's an `is`-attribute, AND\n      // the value passes whatever the user has configured for CUSTOM_ELEMENT_HANDLING.tagNameCheck\n      lcName === 'is' && CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements && (CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof RegExp && regExpTest(CUSTOM_ELEMENT_HANDLING.tagNameCheck, value) || CUSTOM_ELEMENT_HANDLING.tagNameCheck instanceof Function && CUSTOM_ELEMENT_HANDLING.tagNameCheck(value))) ; else {\n        return false;\n      }\n      /* Check value is safe. First, is attr inert? If so, is safe */\n    } else if (URI_SAFE_ATTRIBUTES[lcName]) ; else if (regExpTest(IS_ALLOWED_URI$1, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if ((lcName === 'src' || lcName === 'xlink:href' || lcName === 'href') && lcTag !== 'script' && stringIndexOf(value, 'data:') === 0 && DATA_URI_TAGS[lcTag]) ; else if (ALLOW_UNKNOWN_PROTOCOLS && !regExpTest(IS_SCRIPT_OR_DATA, stringReplace(value, ATTR_WHITESPACE, ''))) ; else if (value) {\n      return false;\n    } else ;\n    return true;\n  };\n  /**\n   * _isBasicCustomElement\n   * checks if at least one dash is included in tagName, and it's not the first char\n   * for more sophisticated checking see https://github.com/sindresorhus/validate-element-name\n   *\n   * @param tagName name of the tag of the node to sanitize\n   * @returns Returns true if the tag name meets the basic criteria for a custom element, otherwise false.\n   */\n  const _isBasicCustomElement = function _isBasicCustomElement(tagName) {\n    return tagName !== 'annotation-xml' && stringMatch(tagName, CUSTOM_ELEMENT);\n  };\n  /**\n   * _sanitizeAttributes\n   *\n   * @protect attributes\n   * @protect nodeName\n   * @protect removeAttribute\n   * @protect setAttribute\n   *\n   * @param currentNode to sanitize\n   */\n  const _sanitizeAttributes = function _sanitizeAttributes(currentNode) {\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeAttributes, currentNode, null);\n    const {\n      attributes\n    } = currentNode;\n    /* Check if we have attributes; if not we might have a text node */\n    if (!attributes || _isClobbered(currentNode)) {\n      return;\n    }\n    const hookEvent = {\n      attrName: '',\n      attrValue: '',\n      keepAttr: true,\n      allowedAttributes: ALLOWED_ATTR,\n      forceKeepAttr: undefined\n    };\n    let l = attributes.length;\n    /* Go backwards over all attributes; safely remove bad ones */\n    while (l--) {\n      const attr = attributes[l];\n      const {\n        name,\n        namespaceURI,\n        value: attrValue\n      } = attr;\n      const lcName = transformCaseFunc(name);\n      const initValue = attrValue;\n      let value = name === 'value' ? initValue : stringTrim(initValue);\n      /* Execute a hook if present */\n      hookEvent.attrName = lcName;\n      hookEvent.attrValue = value;\n      hookEvent.keepAttr = true;\n      hookEvent.forceKeepAttr = undefined; // Allows developers to see this is a property they can set\n      _executeHooks(hooks.uponSanitizeAttribute, currentNode, hookEvent);\n      value = hookEvent.attrValue;\n      /* Full DOM Clobbering protection via namespace isolation,\n       * Prefix id and name attributes with `user-content-`\n       */\n      if (SANITIZE_NAMED_PROPS && (lcName === 'id' || lcName === 'name')) {\n        // Remove the attribute with this value\n        _removeAttribute(name, currentNode);\n        // Prefix the value and later re-create the attribute with the sanitized value\n        value = SANITIZE_NAMED_PROPS_PREFIX + value;\n      }\n      /* Work around a security issue with comments inside attributes */\n      if (SAFE_FOR_XML && regExpTest(/((--!?|])>)|<\\/(style|title|textarea)/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Make sure we cannot easily use animated hrefs, even if animations are allowed */\n      if (lcName === 'attributename' && stringMatch(value, 'href')) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (hookEvent.forceKeepAttr) {\n        continue;\n      }\n      /* Did the hooks approve of the attribute? */\n      if (!hookEvent.keepAttr) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Work around a security issue in jQuery 3.0 */\n      if (!ALLOW_SELF_CLOSE_IN_ATTR && regExpTest(/\\/>/i, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Sanitize attribute content to be template-safe */\n      if (SAFE_FOR_TEMPLATES) {\n        arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n          value = stringReplace(value, expr, ' ');\n        });\n      }\n      /* Is `value` valid for this attribute? */\n      const lcTag = transformCaseFunc(currentNode.nodeName);\n      if (!_isValidAttribute(lcTag, lcName, value)) {\n        _removeAttribute(name, currentNode);\n        continue;\n      }\n      /* Handle attributes that require Trusted Types */\n      if (trustedTypesPolicy && typeof trustedTypes === 'object' && typeof trustedTypes.getAttributeType === 'function') {\n        if (namespaceURI) ; else {\n          switch (trustedTypes.getAttributeType(lcTag, lcName)) {\n            case 'TrustedHTML':\n              {\n                value = trustedTypesPolicy.createHTML(value);\n                break;\n              }\n            case 'TrustedScriptURL':\n              {\n                value = trustedTypesPolicy.createScriptURL(value);\n                break;\n              }\n          }\n        }\n      }\n      /* Handle invalid data-* attribute set by try-catching it */\n      if (value !== initValue) {\n        try {\n          if (namespaceURI) {\n            currentNode.setAttributeNS(namespaceURI, name, value);\n          } else {\n            /* Fallback to setAttribute() for browser-unrecognized namespaces e.g. \"x-schema\". */\n            currentNode.setAttribute(name, value);\n          }\n          if (_isClobbered(currentNode)) {\n            _forceRemove(currentNode);\n          } else {\n            arrayPop(DOMPurify.removed);\n          }\n        } catch (_) {\n          _removeAttribute(name, currentNode);\n        }\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeAttributes, currentNode, null);\n  };\n  /**\n   * _sanitizeShadowDOM\n   *\n   * @param fragment to iterate over recursively\n   */\n  const _sanitizeShadowDOM = function _sanitizeShadowDOM(fragment) {\n    let shadowNode = null;\n    const shadowIterator = _createNodeIterator(fragment);\n    /* Execute a hook if present */\n    _executeHooks(hooks.beforeSanitizeShadowDOM, fragment, null);\n    while (shadowNode = shadowIterator.nextNode()) {\n      /* Execute a hook if present */\n      _executeHooks(hooks.uponSanitizeShadowNode, shadowNode, null);\n      /* Sanitize tags and elements */\n      _sanitizeElements(shadowNode);\n      /* Check attributes next */\n      _sanitizeAttributes(shadowNode);\n      /* Deep shadow DOM detected */\n      if (shadowNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(shadowNode.content);\n      }\n    }\n    /* Execute a hook if present */\n    _executeHooks(hooks.afterSanitizeShadowDOM, fragment, null);\n  };\n  // eslint-disable-next-line complexity\n  DOMPurify.sanitize = function (dirty) {\n    let cfg = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    let body = null;\n    let importedNode = null;\n    let currentNode = null;\n    let returnNode = null;\n    /* Make sure we have a string to sanitize.\n      DO NOT return early, as this will return the wrong type if\n      the user has requested a DOM object rather than a string */\n    IS_EMPTY_INPUT = !dirty;\n    if (IS_EMPTY_INPUT) {\n      dirty = '<!-->';\n    }\n    /* Stringify, in case dirty is an object */\n    if (typeof dirty !== 'string' && !_isNode(dirty)) {\n      if (typeof dirty.toString === 'function') {\n        dirty = dirty.toString();\n        if (typeof dirty !== 'string') {\n          throw typeErrorCreate('dirty is not a string, aborting');\n        }\n      } else {\n        throw typeErrorCreate('toString is not a function');\n      }\n    }\n    /* Return dirty HTML if DOMPurify cannot run */\n    if (!DOMPurify.isSupported) {\n      return dirty;\n    }\n    /* Assign config vars */\n    if (!SET_CONFIG) {\n      _parseConfig(cfg);\n    }\n    /* Clean up removed elements */\n    DOMPurify.removed = [];\n    /* Check if dirty is correctly typed for IN_PLACE */\n    if (typeof dirty === 'string') {\n      IN_PLACE = false;\n    }\n    if (IN_PLACE) {\n      /* Do some early pre-sanitization to avoid unsafe root nodes */\n      if (dirty.nodeName) {\n        const tagName = transformCaseFunc(dirty.nodeName);\n        if (!ALLOWED_TAGS[tagName] || FORBID_TAGS[tagName]) {\n          throw typeErrorCreate('root node is forbidden and cannot be sanitized in-place');\n        }\n      }\n    } else if (dirty instanceof Node) {\n      /* If dirty is a DOM element, append to an empty document to avoid\n         elements being stripped by the parser */\n      body = _initDocument('<!---->');\n      importedNode = body.ownerDocument.importNode(dirty, true);\n      if (importedNode.nodeType === NODE_TYPE.element && importedNode.nodeName === 'BODY') {\n        /* Node is already a body, use as is */\n        body = importedNode;\n      } else if (importedNode.nodeName === 'HTML') {\n        body = importedNode;\n      } else {\n        // eslint-disable-next-line unicorn/prefer-dom-node-append\n        body.appendChild(importedNode);\n      }\n    } else {\n      /* Exit directly if we have nothing to do */\n      if (!RETURN_DOM && !SAFE_FOR_TEMPLATES && !WHOLE_DOCUMENT &&\n      // eslint-disable-next-line unicorn/prefer-includes\n      dirty.indexOf('<') === -1) {\n        return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(dirty) : dirty;\n      }\n      /* Initialize the document to work on */\n      body = _initDocument(dirty);\n      /* Check we have a DOM node from the data */\n      if (!body) {\n        return RETURN_DOM ? null : RETURN_TRUSTED_TYPE ? emptyHTML : '';\n      }\n    }\n    /* Remove first element node (ours) if FORCE_BODY is set */\n    if (body && FORCE_BODY) {\n      _forceRemove(body.firstChild);\n    }\n    /* Get node iterator */\n    const nodeIterator = _createNodeIterator(IN_PLACE ? dirty : body);\n    /* Now start iterating over the created document */\n    while (currentNode = nodeIterator.nextNode()) {\n      /* Sanitize tags and elements */\n      _sanitizeElements(currentNode);\n      /* Check attributes next */\n      _sanitizeAttributes(currentNode);\n      /* Shadow DOM detected, sanitize it */\n      if (currentNode.content instanceof DocumentFragment) {\n        _sanitizeShadowDOM(currentNode.content);\n      }\n    }\n    /* If we sanitized `dirty` in-place, return it. */\n    if (IN_PLACE) {\n      return dirty;\n    }\n    /* Return sanitized string or DOM */\n    if (RETURN_DOM) {\n      if (RETURN_DOM_FRAGMENT) {\n        returnNode = createDocumentFragment.call(body.ownerDocument);\n        while (body.firstChild) {\n          // eslint-disable-next-line unicorn/prefer-dom-node-append\n          returnNode.appendChild(body.firstChild);\n        }\n      } else {\n        returnNode = body;\n      }\n      if (ALLOWED_ATTR.shadowroot || ALLOWED_ATTR.shadowrootmode) {\n        /*\n          AdoptNode() is not used because internal state is not reset\n          (e.g. the past names map of a HTMLFormElement), this is safe\n          in theory but we would rather not risk another attack vector.\n          The state that is cloned by importNode() is explicitly defined\n          by the specs.\n        */\n        returnNode = importNode.call(originalDocument, returnNode, true);\n      }\n      return returnNode;\n    }\n    let serializedHTML = WHOLE_DOCUMENT ? body.outerHTML : body.innerHTML;\n    /* Serialize doctype if allowed */\n    if (WHOLE_DOCUMENT && ALLOWED_TAGS['!doctype'] && body.ownerDocument && body.ownerDocument.doctype && body.ownerDocument.doctype.name && regExpTest(DOCTYPE_NAME, body.ownerDocument.doctype.name)) {\n      serializedHTML = '<!DOCTYPE ' + body.ownerDocument.doctype.name + '>\\n' + serializedHTML;\n    }\n    /* Sanitize final string template-safe */\n    if (SAFE_FOR_TEMPLATES) {\n      arrayForEach([MUSTACHE_EXPR, ERB_EXPR, TMPLIT_EXPR], expr => {\n        serializedHTML = stringReplace(serializedHTML, expr, ' ');\n      });\n    }\n    return trustedTypesPolicy && RETURN_TRUSTED_TYPE ? trustedTypesPolicy.createHTML(serializedHTML) : serializedHTML;\n  };\n  DOMPurify.setConfig = function () {\n    let cfg = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    _parseConfig(cfg);\n    SET_CONFIG = true;\n  };\n  DOMPurify.clearConfig = function () {\n    CONFIG = null;\n    SET_CONFIG = false;\n  };\n  DOMPurify.isValidAttribute = function (tag, attr, value) {\n    /* Initialize shared config vars if necessary. */\n    if (!CONFIG) {\n      _parseConfig({});\n    }\n    const lcTag = transformCaseFunc(tag);\n    const lcName = transformCaseFunc(attr);\n    return _isValidAttribute(lcTag, lcName, value);\n  };\n  DOMPurify.addHook = function (entryPoint, hookFunction) {\n    if (typeof hookFunction !== 'function') {\n      return;\n    }\n    arrayPush(hooks[entryPoint], hookFunction);\n  };\n  DOMPurify.removeHook = function (entryPoint, hookFunction) {\n    if (hookFunction !== undefined) {\n      const index = arrayLastIndexOf(hooks[entryPoint], hookFunction);\n      return index === -1 ? undefined : arraySplice(hooks[entryPoint], index, 1)[0];\n    }\n    return arrayPop(hooks[entryPoint]);\n  };\n  DOMPurify.removeHooks = function (entryPoint) {\n    hooks[entryPoint] = [];\n  };\n  DOMPurify.removeAllHooks = function () {\n    hooks = _createHooksMap();\n  };\n  return DOMPurify;\n}\nvar purify = createDOMPurify();\n\nexport { purify as default };\n//# sourceMappingURL=purify.es.mjs.map\n","/**\n * marked v17.0.1 - a markdown parser\n * Copyright (c) 2018-2025, MarkedJS. (MIT License)\n * Copyright (c) 2011-2018, Christopher Jeffrey. (MIT License)\n * https://github.com/markedjs/marked\n */\n\n/**\n * DO NOT EDIT THIS FILE\n * The code in this file is generated from files in ./src/\n */\n\nfunction L(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var T=L();function Z(u){T=u}var C={exec:()=>null};function k(u,e=\"\"){let t=typeof u==\"string\"?u:u.source,n={replace:(r,i)=>{let s=typeof i==\"string\"?i:i.source;return s=s.replace(m.caret,\"$1\"),t=t.replace(r,s),n},getRegex:()=>new RegExp(t,e)};return n}var me=(()=>{try{return!!new RegExp(\"(?<=1)(?<!1)\")}catch{return!1}})(),m={codeRemoveIndent:/^(?: {1,4}| {0,3}\\t)/gm,outputLinkReplace:/\\\\([\\[\\]])/g,indentCodeCompensation:/^(\\s+)(?:```)/,beginningSpace:/^\\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\\n/g,tabCharGlobal:/\\t/g,multipleSpaceGlobal:/\\s+/g,blankLine:/^[ \\t]*$/,doubleBlankLine:/\\n[ \\t]*\\n[ \\t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\\n {0,3}((?:=+|-+) *)(?=\\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \\t]?/gm,listReplaceTabs:/^\\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\\[[ xX]\\] +\\S/,listReplaceTask:/^\\[[ xX]\\] +/,listTaskCheckbox:/\\[[ xX]\\]/,anyLine:/\\n.*\\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\\||\\| *$/g,tableRowBlankLine:/\\n[ \\t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\\s|>)/i,endPreScriptTag:/^<\\/(pre|code|kbd|script)(\\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'\"]*[^\\s])\\s+(['\"])(.*)\\2/,unicodeAlphaNumeric:/[\\p{L}\\p{N}]/u,escapeTest:/[&<>\"']/,escapeReplace:/[&<>\"']/g,escapeTestNoEncode:/[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/,escapeReplaceNoEncode:/[<>\"']|&(?!(#\\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\\w+);)/g,unescapeTest:/&(#(?:\\d+)|(?:#x[0-9A-Fa-f]+)|(?:\\w+));?/ig,caret:/(^|[^\\[])\\^/g,percentDecode:/%25/g,findPipe:/\\|/g,splitPipe:/ \\|/,slashPipe:/\\\\\\|/g,carriageReturn:/\\r\\n|\\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\\S*/,endingNewline:/\\n$/,listItemRegex:u=>new RegExp(`^( {0,3}${u})((?:[\t ][^\\\\n]*)?(?:\\\\n|$))`),nextBulletRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}(?:[*+-]|\\\\d{1,9}[.)])((?:[ \t][^\\\\n]*)?(?:\\\\n|$))`),hrRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\\\* *){3,})(?:\\\\n+|$)`),fencesBeginRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}(?:\\`\\`\\`|~~~)`),headingBeginRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}#`),htmlBeginRegex:u=>new RegExp(`^ {0,${Math.min(3,u-1)}}<(?:[a-z].*>|!--)`,\"i\")},xe=/^(?:[ \\t]*(?:\\n|$))+/,be=/^((?: {4}| {0,3}\\t)[^\\n]+(?:\\n(?:[ \\t]*(?:\\n|$))*)?)+/,Re=/^ {0,3}(`{3,}(?=[^`\\n]*(?:\\n|$))|~{3,})([^\\n]*)(?:\\n|$)(?:|([\\s\\S]*?)(?:\\n|$))(?: {0,3}\\1[~`]* *(?=\\n|$)|$)/,I=/^ {0,3}((?:-[\\t ]*){3,}|(?:_[ \\t]*){3,}|(?:\\*[ \\t]*){3,})(?:\\n+|$)/,Te=/^ {0,3}(#{1,6})(?=\\s|$)(.*)(?:\\n+|$)/,N=/(?:[*+-]|\\d{1,9}[.)])/,re=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\\n(?!\\s*?\\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,se=k(re).replace(/bull/g,N).replace(/blockCode/g,/(?: {4}| {0,3}\\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\\n>]+>\\n/).replace(/\\|table/g,\"\").getRegex(),Oe=k(re).replace(/bull/g,N).replace(/blockCode/g,/(?: {4}| {0,3}\\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\\n>]+>\\n/).replace(/table/g,/ {0,3}\\|?(?:[:\\- ]*\\|)+[\\:\\- ]*\\n/).getRegex(),Q=/^([^\\n]+(?:\\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\\n)[^\\n]+)*)/,we=/^[^\\n]+/,F=/(?!\\s*\\])(?:\\\\[\\s\\S]|[^\\[\\]\\\\])+/,ye=k(/^ {0,3}\\[(label)\\]: *(?:\\n[ \\t]*)?([^<\\s][^\\s]*|<.*?>)(?:(?: +(?:\\n[ \\t]*)?| *\\n[ \\t]*)(title))? *(?:\\n+|$)/).replace(\"label\",F).replace(\"title\",/(?:\"(?:\\\\\"?|[^\"\\\\])*\"|'[^'\\n]*(?:\\n[^'\\n]+)*\\n?'|\\([^()]*\\))/).getRegex(),Pe=k(/^( {0,3}bull)([ \\t][^\\n]+?)?(?:\\n|$)/).replace(/bull/g,N).getRegex(),v=\"address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul\",j=/<!--(?:-?>|[\\s\\S]*?(?:-->|$))/,Se=k(\"^ {0,3}(?:<(script|pre|style|textarea)[\\\\s>][\\\\s\\\\S]*?(?:</\\\\1>[^\\\\n]*\\\\n+|$)|comment[^\\\\n]*(\\\\n+|$)|<\\\\?[\\\\s\\\\S]*?(?:\\\\?>\\\\n*|$)|<![A-Z][\\\\s\\\\S]*?(?:>\\\\n*|$)|<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?(?:\\\\]\\\\]>\\\\n*|$)|</?(tag)(?: +|\\\\n|/?>)[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$)|<(?!script|pre|style|textarea)([a-z][\\\\w-]*)(?:attribute)*? */?>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$)|</(?!script|pre|style|textarea)[a-z][\\\\w-]*\\\\s*>(?=[ \\\\t]*(?:\\\\n|$))[\\\\s\\\\S]*?(?:(?:\\\\n[ \t]*)+\\\\n|$))\",\"i\").replace(\"comment\",j).replace(\"tag\",v).replace(\"attribute\",/ +[a-zA-Z:_][\\w.:-]*(?: *= *\"[^\"\\n]*\"| *= *'[^'\\n]*'| *= *[^\\s\"'=<>`]+)?/).getRegex(),ie=k(Q).replace(\"hr\",I).replace(\"heading\",\" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"|lheading\",\"\").replace(\"|table\",\"\").replace(\"blockquote\",\" {0,3}>\").replace(\"fences\",\" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\",\" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\",\"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\",v).getRegex(),$e=k(/^( {0,3}> ?(paragraph|[^\\n]*)(?:\\n|$))+/).replace(\"paragraph\",ie).getRegex(),U={blockquote:$e,code:be,def:ye,fences:Re,heading:Te,hr:I,html:Se,lheading:se,list:Pe,newline:xe,paragraph:ie,table:C,text:we},te=k(\"^ *([^\\\\n ].*)\\\\n {0,3}((?:\\\\| *)?:?-+:? *(?:\\\\| *:?-+:? *)*(?:\\\\| *)?)(?:\\\\n((?:(?! *\\\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\\\n|$))*)\\\\n*|$)\").replace(\"hr\",I).replace(\"heading\",\" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"blockquote\",\" {0,3}>\").replace(\"code\",\"(?: {4}| {0,3}\t)[^\\\\n]\").replace(\"fences\",\" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\",\" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\",\"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\",v).getRegex(),_e={...U,lheading:Oe,table:te,paragraph:k(Q).replace(\"hr\",I).replace(\"heading\",\" {0,3}#{1,6}(?:\\\\s|$)\").replace(\"|lheading\",\"\").replace(\"table\",te).replace(\"blockquote\",\" {0,3}>\").replace(\"fences\",\" {0,3}(?:`{3,}(?=[^`\\\\n]*\\\\n)|~{3,})[^\\\\n]*\\\\n\").replace(\"list\",\" {0,3}(?:[*+-]|1[.)]) \").replace(\"html\",\"</?(?:tag)(?: +|\\\\n|/?>)|<(?:script|pre|style|textarea|!--)\").replace(\"tag\",v).getRegex()},Le={...U,html:k(`^ *(?:comment *(?:\\\\n|\\\\s*$)|<(tag)[\\\\s\\\\S]+?</\\\\1> *(?:\\\\n{2,}|\\\\s*$)|<tag(?:\"[^\"]*\"|'[^']*'|\\\\s[^'\"/>\\\\s]*)*?/?> *(?:\\\\n{2,}|\\\\s*$))`).replace(\"comment\",j).replace(/tag/g,\"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\\\b)\\\\w+(?!:|[^\\\\w\\\\s@]*@)\\\\b\").getRegex(),def:/^ *\\[([^\\]]+)\\]: *<?([^\\s>]+)>?(?: +([\"(][^\\n]+[\")]))? *(?:\\n+|$)/,heading:/^(#{1,6})(.*)(?:\\n+|$)/,fences:C,lheading:/^(.+?)\\n {0,3}(=+|-+) *(?:\\n+|$)/,paragraph:k(Q).replace(\"hr\",I).replace(\"heading\",` *#{1,6} *[^\n]`).replace(\"lheading\",se).replace(\"|table\",\"\").replace(\"blockquote\",\" {0,3}>\").replace(\"|fences\",\"\").replace(\"|list\",\"\").replace(\"|html\",\"\").replace(\"|tag\",\"\").getRegex()},Me=/^\\\\([!\"#$%&'()*+,\\-./:;<=>?@\\[\\]\\\\^_`{|}~])/,ze=/^(`+)([^`]|[^`][\\s\\S]*?[^`])\\1(?!`)/,oe=/^( {2,}|\\\\)\\n(?!\\s*$)/,Ae=/^(`+|[^`])(?:(?= {2,}\\n)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*_]|\\b_|$)|[^ ](?= {2,}\\n)))/,D=/[\\p{P}\\p{S}]/u,K=/[\\s\\p{P}\\p{S}]/u,ae=/[^\\s\\p{P}\\p{S}]/u,Ce=k(/^((?![*_])punctSpace)/,\"u\").replace(/punctSpace/g,K).getRegex(),le=/(?!~)[\\p{P}\\p{S}]/u,Ie=/(?!~)[\\s\\p{P}\\p{S}]/u,Ee=/(?:[^\\s\\p{P}\\p{S}]|~)/u,Be=k(/link|precode-code|html/,\"g\").replace(\"link\",/\\[(?:[^\\[\\]`]|(?<a>`+)[^`]+\\k<a>(?!`))*?\\]\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)]|\\((?:\\\\[\\s\\S]|[^\\\\\\(\\)])*\\))*\\)/).replace(\"precode-\",me?\"(?<!`)()\":\"(^^|[^`])\").replace(\"code\",/(?<b>`+)[^`]+\\k<b>(?!`)/).replace(\"html\",/<(?! )[^<>]*?>/).getRegex(),ue=/^(?:\\*+(?:((?!\\*)punct)|[^\\s*]))|^_+(?:((?!_)punct)|([^\\s_]))/,qe=k(ue,\"u\").replace(/punct/g,D).getRegex(),ve=k(ue,\"u\").replace(/punct/g,le).getRegex(),pe=\"^[^_*]*?__[^_*]*?\\\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\\\*)punct(\\\\*+)(?=[\\\\s]|$)|notPunctSpace(\\\\*+)(?!\\\\*)(?=punctSpace|$)|(?!\\\\*)punctSpace(\\\\*+)(?=notPunctSpace)|[\\\\s](\\\\*+)(?!\\\\*)(?=punct)|(?!\\\\*)punct(\\\\*+)(?!\\\\*)(?=punct)|notPunctSpace(\\\\*+)(?=notPunctSpace)\",De=k(pe,\"gu\").replace(/notPunctSpace/g,ae).replace(/punctSpace/g,K).replace(/punct/g,D).getRegex(),He=k(pe,\"gu\").replace(/notPunctSpace/g,Ee).replace(/punctSpace/g,Ie).replace(/punct/g,le).getRegex(),Ze=k(\"^[^_*]*?\\\\*\\\\*[^_*]*?_[^_*]*?(?=\\\\*\\\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)\",\"gu\").replace(/notPunctSpace/g,ae).replace(/punctSpace/g,K).replace(/punct/g,D).getRegex(),Ge=k(/\\\\(punct)/,\"gu\").replace(/punct/g,D).getRegex(),Ne=k(/^<(scheme:[^\\s\\x00-\\x1f<>]*|email)>/).replace(\"scheme\",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace(\"email\",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Qe=k(j).replace(\"(?:-->|$)\",\"-->\").getRegex(),Fe=k(\"^comment|^</[a-zA-Z][\\\\w:-]*\\\\s*>|^<[a-zA-Z][\\\\w-]*(?:attribute)*?\\\\s*/?>|^<\\\\?[\\\\s\\\\S]*?\\\\?>|^<![a-zA-Z]+\\\\s[\\\\s\\\\S]*?>|^<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>\").replace(\"comment\",Qe).replace(\"attribute\",/\\s+[a-zA-Z:_][\\w.:-]*(?:\\s*=\\s*\"[^\"]*\"|\\s*=\\s*'[^']*'|\\s*=\\s*[^\\s\"'=<>`]+)?/).getRegex(),q=/(?:\\[(?:\\\\[\\s\\S]|[^\\[\\]\\\\])*\\]|\\\\[\\s\\S]|`+[^`]*?`+(?!`)|[^\\[\\]\\\\`])*?/,je=k(/^!?\\[(label)\\]\\(\\s*(href)(?:(?:[ \\t]*(?:\\n[ \\t]*)?)(title))?\\s*\\)/).replace(\"label\",q).replace(\"href\",/<(?:\\\\.|[^\\n<>\\\\])+>|[^ \\t\\n\\x00-\\x1f]*/).replace(\"title\",/\"(?:\\\\\"?|[^\"\\\\])*\"|'(?:\\\\'?|[^'\\\\])*'|\\((?:\\\\\\)?|[^)\\\\])*\\)/).getRegex(),ce=k(/^!?\\[(label)\\]\\[(ref)\\]/).replace(\"label\",q).replace(\"ref\",F).getRegex(),he=k(/^!?\\[(ref)\\](?:\\[\\])?/).replace(\"ref\",F).getRegex(),Ue=k(\"reflink|nolink(?!\\\\()\",\"g\").replace(\"reflink\",ce).replace(\"nolink\",he).getRegex(),ne=/[hH][tT][tT][pP][sS]?|[fF][tT][pP]/,W={_backpedal:C,anyPunctuation:Ge,autolink:Ne,blockSkip:Be,br:oe,code:ze,del:C,emStrongLDelim:qe,emStrongRDelimAst:De,emStrongRDelimUnd:Ze,escape:Me,link:je,nolink:he,punctuation:Ce,reflink:ce,reflinkSearch:Ue,tag:Fe,text:Ae,url:C},Ke={...W,link:k(/^!?\\[(label)\\]\\((.*?)\\)/).replace(\"label\",q).getRegex(),reflink:k(/^!?\\[(label)\\]\\s*\\[([^\\]]*)\\]/).replace(\"label\",q).getRegex()},G={...W,emStrongRDelimAst:He,emStrongLDelim:ve,url:k(/^((?:protocol):\\/\\/|www\\.)(?:[a-zA-Z0-9\\-]+\\.?)+[^\\s<]*|^email/).replace(\"protocol\",ne).replace(\"email\",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'\"~()&]+|\\([^)]*\\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'\"~)]+(?!$))+/,del:/^(~~?)(?=[^\\s~])((?:\\\\[\\s\\S]|[^\\\\])*?(?:\\\\[\\s\\S]|[^\\s~\\\\]))\\1(?=[^~]|$)/,text:k(/^([`~]+|[^`~])(?:(?= {2,}\\n)|(?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)|[\\s\\S]*?(?:(?=[\\\\<!\\[`*~_]|\\b_|protocol:\\/\\/|www\\.|$)|[^ ](?= {2,}\\n)|[^a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-](?=[a-zA-Z0-9.!#$%&'*+\\/=?_`{\\|}~-]+@)))/).replace(\"protocol\",ne).getRegex()},We={...G,br:k(oe).replace(\"{2,}\",\"*\").getRegex(),text:k(G.text).replace(\"\\\\b_\",\"\\\\b_| {2,}\\\\n\").replace(/\\{2,\\}/g,\"*\").getRegex()},E={normal:U,gfm:_e,pedantic:Le},M={normal:W,gfm:G,breaks:We,pedantic:Ke};var Xe={\"&\":\"&amp;\",\"<\":\"&lt;\",\">\":\"&gt;\",'\"':\"&quot;\",\"'\":\"&#39;\"},ke=u=>Xe[u];function w(u,e){if(e){if(m.escapeTest.test(u))return u.replace(m.escapeReplace,ke)}else if(m.escapeTestNoEncode.test(u))return u.replace(m.escapeReplaceNoEncode,ke);return u}function X(u){try{u=encodeURI(u).replace(m.percentDecode,\"%\")}catch{return null}return u}function J(u,e){let t=u.replace(m.findPipe,(i,s,a)=>{let o=!1,l=s;for(;--l>=0&&a[l]===\"\\\\\";)o=!o;return o?\"|\":\" |\"}),n=t.split(m.splitPipe),r=0;if(n[0].trim()||n.shift(),n.length>0&&!n.at(-1)?.trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push(\"\");for(;r<n.length;r++)n[r]=n[r].trim().replace(m.slashPipe,\"|\");return n}function z(u,e,t){let n=u.length;if(n===0)return\"\";let r=0;for(;r<n;){let i=u.charAt(n-r-1);if(i===e&&!t)r++;else if(i!==e&&t)r++;else break}return u.slice(0,n-r)}function de(u,e){if(u.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<u.length;n++)if(u[n]===\"\\\\\")n++;else if(u[n]===e[0])t++;else if(u[n]===e[1]&&(t--,t<0))return n;return t>0?-2:-1}function ge(u,e,t,n,r){let i=e.href,s=e.title||null,a=u[1].replace(r.other.outputLinkReplace,\"$1\");n.state.inLink=!0;let o={type:u[0].charAt(0)===\"!\"?\"image\":\"link\",raw:t,href:i,title:s,text:a,tokens:n.inlineTokens(a)};return n.state.inLink=!1,o}function Je(u,e,t){let n=u.match(t.other.indentCodeCompensation);if(n===null)return e;let r=n[1];return e.split(`\n`).map(i=>{let s=i.match(t.other.beginningSpace);if(s===null)return i;let[a]=s;return a.length>=r.length?i.slice(r.length):i}).join(`\n`)}var y=class{options;rules;lexer;constructor(e){this.options=e||T}space(e){let t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:\"space\",raw:t[0]}}code(e){let t=this.rules.block.code.exec(e);if(t){let n=t[0].replace(this.rules.other.codeRemoveIndent,\"\");return{type:\"code\",raw:t[0],codeBlockStyle:\"indented\",text:this.options.pedantic?n:z(n,`\n`)}}}fences(e){let t=this.rules.block.fences.exec(e);if(t){let n=t[0],r=Je(n,t[3]||\"\",this.rules);return{type:\"code\",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,\"$1\"):t[2],text:r}}}heading(e){let t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){let r=z(n,\"#\");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:\"heading\",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){let t=this.rules.block.hr.exec(e);if(t)return{type:\"hr\",raw:z(t[0],`\n`)}}blockquote(e){let t=this.rules.block.blockquote.exec(e);if(t){let n=z(t[0],`\n`).split(`\n`),r=\"\",i=\"\",s=[];for(;n.length>0;){let a=!1,o=[],l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);let p=o.join(`\n`),c=p.replace(this.rules.other.blockquoteSetextReplace,`\n    $1`).replace(this.rules.other.blockquoteSetextReplace2,\"\");r=r?`${r}\n${p}`:p,i=i?`${i}\n${c}`:c;let g=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(c,s,!0),this.lexer.state.top=g,n.length===0)break;let h=s.at(-1);if(h?.type===\"code\")break;if(h?.type===\"blockquote\"){let R=h,f=R.raw+`\n`+n.join(`\n`),O=this.blockquote(f);s[s.length-1]=O,r=r.substring(0,r.length-R.raw.length)+O.raw,i=i.substring(0,i.length-R.text.length)+O.text;break}else if(h?.type===\"list\"){let R=h,f=R.raw+`\n`+n.join(`\n`),O=this.list(f);s[s.length-1]=O,r=r.substring(0,r.length-h.raw.length)+O.raw,i=i.substring(0,i.length-R.raw.length)+O.raw,n=f.substring(s.at(-1).raw.length).split(`\n`);continue}}return{type:\"blockquote\",raw:r,tokens:s,text:i}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim(),r=n.length>1,i={type:\"list\",raw:\"\",ordered:r,start:r?+n.slice(0,-1):\"\",loose:!1,items:[]};n=r?`\\\\d{1,9}\\\\${n.slice(-1)}`:`\\\\${n}`,this.options.pedantic&&(n=r?n:\"[*+-]\");let s=this.rules.other.listItemRegex(n),a=!1;for(;e;){let l=!1,p=\"\",c=\"\";if(!(t=s.exec(e))||this.rules.block.hr.test(e))break;p=t[0],e=e.substring(p.length);let g=t[2].split(`\n`,1)[0].replace(this.rules.other.listReplaceTabs,O=>\" \".repeat(3*O.length)),h=e.split(`\n`,1)[0],R=!g.trim(),f=0;if(this.options.pedantic?(f=2,c=g.trimStart()):R?f=t[1].length+1:(f=t[2].search(this.rules.other.nonSpaceChar),f=f>4?1:f,c=g.slice(f),f+=t[1].length),R&&this.rules.other.blankLine.test(h)&&(p+=h+`\n`,e=e.substring(h.length+1),l=!0),!l){let O=this.rules.other.nextBulletRegex(f),V=this.rules.other.hrRegex(f),Y=this.rules.other.fencesBeginRegex(f),ee=this.rules.other.headingBeginRegex(f),fe=this.rules.other.htmlBeginRegex(f);for(;e;){let H=e.split(`\n`,1)[0],A;if(h=H,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,\"  \"),A=h):A=h.replace(this.rules.other.tabCharGlobal,\"    \"),Y.test(h)||ee.test(h)||fe.test(h)||O.test(h)||V.test(h))break;if(A.search(this.rules.other.nonSpaceChar)>=f||!h.trim())c+=`\n`+A.slice(f);else{if(R||g.replace(this.rules.other.tabCharGlobal,\"    \").search(this.rules.other.nonSpaceChar)>=4||Y.test(g)||ee.test(g)||V.test(g))break;c+=`\n`+h}!R&&!h.trim()&&(R=!0),p+=H+`\n`,e=e.substring(H.length+1),g=A.slice(f)}}i.loose||(a?i.loose=!0:this.rules.other.doubleBlankLine.test(p)&&(a=!0)),i.items.push({type:\"list_item\",raw:p,task:!!this.options.gfm&&this.rules.other.listIsTask.test(c),loose:!1,text:c,tokens:[]}),i.raw+=p}let o=i.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;i.raw=i.raw.trimEnd();for(let l of i.items){if(this.lexer.state.top=!1,l.tokens=this.lexer.blockTokens(l.text,[]),l.task){if(l.text=l.text.replace(this.rules.other.listReplaceTask,\"\"),l.tokens[0]?.type===\"text\"||l.tokens[0]?.type===\"paragraph\"){l.tokens[0].raw=l.tokens[0].raw.replace(this.rules.other.listReplaceTask,\"\"),l.tokens[0].text=l.tokens[0].text.replace(this.rules.other.listReplaceTask,\"\");for(let c=this.lexer.inlineQueue.length-1;c>=0;c--)if(this.rules.other.listIsTask.test(this.lexer.inlineQueue[c].src)){this.lexer.inlineQueue[c].src=this.lexer.inlineQueue[c].src.replace(this.rules.other.listReplaceTask,\"\");break}}let p=this.rules.other.listTaskCheckbox.exec(l.raw);if(p){let c={type:\"checkbox\",raw:p[0]+\" \",checked:p[0]!==\"[ ]\"};l.checked=c.checked,i.loose?l.tokens[0]&&[\"paragraph\",\"text\"].includes(l.tokens[0].type)&&\"tokens\"in l.tokens[0]&&l.tokens[0].tokens?(l.tokens[0].raw=c.raw+l.tokens[0].raw,l.tokens[0].text=c.raw+l.tokens[0].text,l.tokens[0].tokens.unshift(c)):l.tokens.unshift({type:\"paragraph\",raw:c.raw,text:c.raw,tokens:[c]}):l.tokens.unshift(c)}}if(!i.loose){let p=l.tokens.filter(g=>g.type===\"space\"),c=p.length>0&&p.some(g=>this.rules.other.anyLine.test(g.raw));i.loose=c}}if(i.loose)for(let l of i.items){l.loose=!0;for(let p of l.tokens)p.type===\"text\"&&(p.type=\"paragraph\")}return i}}html(e){let t=this.rules.block.html.exec(e);if(t)return{type:\"html\",block:!0,raw:t[0],pre:t[1]===\"pre\"||t[1]===\"script\"||t[1]===\"style\",text:t[0]}}def(e){let t=this.rules.block.def.exec(e);if(t){let n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal,\" \"),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,\"$1\").replace(this.rules.inline.anyPunctuation,\"$1\"):\"\",i=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,\"$1\"):t[3];return{type:\"def\",tag:n,raw:t[0],href:r,title:i}}}table(e){let t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;let n=J(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,\"\").split(\"|\"),i=t[3]?.trim()?t[3].replace(this.rules.other.tableRowBlankLine,\"\").split(`\n`):[],s={type:\"table\",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(let a of r)this.rules.other.tableAlignRight.test(a)?s.align.push(\"right\"):this.rules.other.tableAlignCenter.test(a)?s.align.push(\"center\"):this.rules.other.tableAlignLeft.test(a)?s.align.push(\"left\"):s.align.push(null);for(let a=0;a<n.length;a++)s.header.push({text:n[a],tokens:this.lexer.inline(n[a]),header:!0,align:s.align[a]});for(let a of i)s.rows.push(J(a,s.header.length).map((o,l)=>({text:o,tokens:this.lexer.inline(o),header:!1,align:s.align[l]})));return s}}lheading(e){let t=this.rules.block.lheading.exec(e);if(t)return{type:\"heading\",raw:t[0],depth:t[2].charAt(0)===\"=\"?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){let t=this.rules.block.paragraph.exec(e);if(t){let n=t[1].charAt(t[1].length-1)===`\n`?t[1].slice(0,-1):t[1];return{type:\"paragraph\",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){let t=this.rules.block.text.exec(e);if(t)return{type:\"text\",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){let t=this.rules.inline.escape.exec(e);if(t)return{type:\"escape\",raw:t[0],text:t[1]}}tag(e){let t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:\"html\",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){let t=this.rules.inline.link.exec(e);if(t){let n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;let s=z(n.slice(0,-1),\"\\\\\");if((n.length-s.length)%2===0)return}else{let s=de(t[2],\"()\");if(s===-2)return;if(s>-1){let o=(t[0].indexOf(\"!\")===0?5:4)+t[1].length+s;t[2]=t[2].substring(0,s),t[0]=t[0].substring(0,o).trim(),t[3]=\"\"}}let r=t[2],i=\"\";if(this.options.pedantic){let s=this.rules.other.pedanticHrefTitle.exec(r);s&&(r=s[1],i=s[3])}else i=t[3]?t[3].slice(1,-1):\"\";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),ge(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,\"$1\"),title:i&&i.replace(this.rules.inline.anyPunctuation,\"$1\")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){let r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal,\" \"),i=t[r.toLowerCase()];if(!i){let s=n[0].charAt(0);return{type:\"text\",raw:s,text:s}}return ge(n,i,n[0],this.lexer,this.rules)}}emStrong(e,t,n=\"\"){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||\"\")||!n||this.rules.inline.punctuation.exec(n)){let s=[...r[0]].length-1,a,o,l=s,p=0,c=r[0][0]===\"*\"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(c.lastIndex=0,t=t.slice(-1*e.length+s);(r=c.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&s%3&&!((s+o)%3)){p+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+p);let g=[...r[0]][0].length,h=e.slice(0,s+r.index+g+o);if(Math.min(s,o)%2){let f=h.slice(1,-1);return{type:\"em\",raw:h,text:f,tokens:this.lexer.inlineTokens(f)}}let R=h.slice(2,-2);return{type:\"strong\",raw:h,text:R,tokens:this.lexer.inlineTokens(R)}}}}codespan(e){let t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal,\" \"),r=this.rules.other.nonSpaceChar.test(n),i=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&i&&(n=n.substring(1,n.length-1)),{type:\"codespan\",raw:t[0],text:n}}}br(e){let t=this.rules.inline.br.exec(e);if(t)return{type:\"br\",raw:t[0]}}del(e){let t=this.rules.inline.del.exec(e);if(t)return{type:\"del\",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){let t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]===\"@\"?(n=t[1],r=\"mailto:\"+n):(n=t[1],r=n),{type:\"link\",raw:t[0],text:n,href:r,tokens:[{type:\"text\",raw:n,text:n}]}}}url(e){let t;if(t=this.rules.inline.url.exec(e)){let n,r;if(t[2]===\"@\")n=t[0],r=\"mailto:\"+n;else{let i;do i=t[0],t[0]=this.rules.inline._backpedal.exec(t[0])?.[0]??\"\";while(i!==t[0]);n=t[0],t[1]===\"www.\"?r=\"http://\"+t[0]:r=t[0]}return{type:\"link\",raw:t[0],text:n,href:r,tokens:[{type:\"text\",raw:n,text:n}]}}}inlineText(e){let t=this.rules.inline.text.exec(e);if(t){let n=this.lexer.state.inRawBlock;return{type:\"text\",raw:t[0],text:t[0],escaped:n}}}};var x=class u{tokens;options;state;inlineQueue;tokenizer;constructor(e){this.tokens=[],this.tokens.links=Object.create(null),this.options=e||T,this.options.tokenizer=this.options.tokenizer||new y,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};let t={other:m,block:E.normal,inline:M.normal};this.options.pedantic?(t.block=E.pedantic,t.inline=M.pedantic):this.options.gfm&&(t.block=E.gfm,this.options.breaks?t.inline=M.breaks:t.inline=M.gfm),this.tokenizer.rules=t}static get rules(){return{block:E,inline:M}}static lex(e,t){return new u(t).lex(e)}static lexInline(e,t){return new u(t).inlineTokens(e)}lex(e){e=e.replace(m.carriageReturn,`\n`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){let n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[],n=!1){for(this.options.pedantic&&(e=e.replace(m.tabCharGlobal,\"    \").replace(m.spaceLine,\"\"));e;){let r;if(this.options.extensions?.block?.some(s=>(r=s.call({lexer:this},e,t))?(e=e.substring(r.raw.length),t.push(r),!0):!1))continue;if(r=this.tokenizer.space(e)){e=e.substring(r.raw.length);let s=t.at(-1);r.raw.length===1&&s!==void 0?s.raw+=`\n`:t.push(r);continue}if(r=this.tokenizer.code(e)){e=e.substring(r.raw.length);let s=t.at(-1);s?.type===\"paragraph\"||s?.type===\"text\"?(s.raw+=(s.raw.endsWith(`\n`)?\"\":`\n`)+r.raw,s.text+=`\n`+r.text,this.inlineQueue.at(-1).src=s.text):t.push(r);continue}if(r=this.tokenizer.fences(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.heading(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.hr(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.blockquote(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.list(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.html(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.def(e)){e=e.substring(r.raw.length);let s=t.at(-1);s?.type===\"paragraph\"||s?.type===\"text\"?(s.raw+=(s.raw.endsWith(`\n`)?\"\":`\n`)+r.raw,s.text+=`\n`+r.raw,this.inlineQueue.at(-1).src=s.text):this.tokens.links[r.tag]||(this.tokens.links[r.tag]={href:r.href,title:r.title},t.push(r));continue}if(r=this.tokenizer.table(e)){e=e.substring(r.raw.length),t.push(r);continue}if(r=this.tokenizer.lheading(e)){e=e.substring(r.raw.length),t.push(r);continue}let i=e;if(this.options.extensions?.startBlock){let s=1/0,a=e.slice(1),o;this.options.extensions.startBlock.forEach(l=>{o=l.call({lexer:this},a),typeof o==\"number\"&&o>=0&&(s=Math.min(s,o))}),s<1/0&&s>=0&&(i=e.substring(0,s+1))}if(this.state.top&&(r=this.tokenizer.paragraph(i))){let s=t.at(-1);n&&s?.type===\"paragraph\"?(s.raw+=(s.raw.endsWith(`\n`)?\"\":`\n`)+r.raw,s.text+=`\n`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(r),n=i.length!==e.length,e=e.substring(r.raw.length);continue}if(r=this.tokenizer.text(e)){e=e.substring(r.raw.length);let s=t.at(-1);s?.type===\"text\"?(s.raw+=(s.raw.endsWith(`\n`)?\"\":`\n`)+r.raw,s.text+=`\n`+r.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=s.text):t.push(r);continue}if(e){let s=\"Infinite loop on byte: \"+e.charCodeAt(0);if(this.options.silent){console.error(s);break}else throw new Error(s)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n=e,r=null;if(this.tokens.links){let o=Object.keys(this.tokens.links);if(o.length>0)for(;(r=this.tokenizer.rules.inline.reflinkSearch.exec(n))!=null;)o.includes(r[0].slice(r[0].lastIndexOf(\"[\")+1,-1))&&(n=n.slice(0,r.index)+\"[\"+\"a\".repeat(r[0].length-2)+\"]\"+n.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(r=this.tokenizer.rules.inline.anyPunctuation.exec(n))!=null;)n=n.slice(0,r.index)+\"++\"+n.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);let i;for(;(r=this.tokenizer.rules.inline.blockSkip.exec(n))!=null;)i=r[2]?r[2].length:0,n=n.slice(0,r.index+i)+\"[\"+\"a\".repeat(r[0].length-i-2)+\"]\"+n.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);n=this.options.hooks?.emStrongMask?.call({lexer:this},n)??n;let s=!1,a=\"\";for(;e;){s||(a=\"\"),s=!1;let o;if(this.options.extensions?.inline?.some(p=>(o=p.call({lexer:this},e,t))?(e=e.substring(o.raw.length),t.push(o),!0):!1))continue;if(o=this.tokenizer.escape(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.tag(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.link(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(o.raw.length);let p=t.at(-1);o.type===\"text\"&&p?.type===\"text\"?(p.raw+=o.raw,p.text+=o.text):t.push(o);continue}if(o=this.tokenizer.emStrong(e,n,a)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.codespan(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.br(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.del(e)){e=e.substring(o.raw.length),t.push(o);continue}if(o=this.tokenizer.autolink(e)){e=e.substring(o.raw.length),t.push(o);continue}if(!this.state.inLink&&(o=this.tokenizer.url(e))){e=e.substring(o.raw.length),t.push(o);continue}let l=e;if(this.options.extensions?.startInline){let p=1/0,c=e.slice(1),g;this.options.extensions.startInline.forEach(h=>{g=h.call({lexer:this},c),typeof g==\"number\"&&g>=0&&(p=Math.min(p,g))}),p<1/0&&p>=0&&(l=e.substring(0,p+1))}if(o=this.tokenizer.inlineText(l)){e=e.substring(o.raw.length),o.raw.slice(-1)!==\"_\"&&(a=o.raw.slice(-1)),s=!0;let p=t.at(-1);p?.type===\"text\"?(p.raw+=o.raw,p.text+=o.text):t.push(o);continue}if(e){let p=\"Infinite loop on byte: \"+e.charCodeAt(0);if(this.options.silent){console.error(p);break}else throw new Error(p)}}return t}};var P=class{options;parser;constructor(e){this.options=e||T}space(e){return\"\"}code({text:e,lang:t,escaped:n}){let r=(t||\"\").match(m.notSpaceStart)?.[0],i=e.replace(m.endingNewline,\"\")+`\n`;return r?'<pre><code class=\"language-'+w(r)+'\">'+(n?i:w(i,!0))+`</code></pre>\n`:\"<pre><code>\"+(n?i:w(i,!0))+`</code></pre>\n`}blockquote({tokens:e}){return`<blockquote>\n${this.parser.parse(e)}</blockquote>\n`}html({text:e}){return e}def(e){return\"\"}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>\n`}hr(e){return`<hr>\n`}list(e){let t=e.ordered,n=e.start,r=\"\";for(let a=0;a<e.items.length;a++){let o=e.items[a];r+=this.listitem(o)}let i=t?\"ol\":\"ul\",s=t&&n!==1?' start=\"'+n+'\"':\"\";return\"<\"+i+s+`>\n`+r+\"</\"+i+`>\n`}listitem(e){return`<li>${this.parser.parse(e.tokens)}</li>\n`}checkbox({checked:e}){return\"<input \"+(e?'checked=\"\" ':\"\")+'disabled=\"\" type=\"checkbox\"> '}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>\n`}table(e){let t=\"\",n=\"\";for(let i=0;i<e.header.length;i++)n+=this.tablecell(e.header[i]);t+=this.tablerow({text:n});let r=\"\";for(let i=0;i<e.rows.length;i++){let s=e.rows[i];n=\"\";for(let a=0;a<s.length;a++)n+=this.tablecell(s[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>\n<thead>\n`+t+`</thead>\n`+r+`</table>\n`}tablerow({text:e}){return`<tr>\n${e}</tr>\n`}tablecell(e){let t=this.parser.parseInline(e.tokens),n=e.header?\"th\":\"td\";return(e.align?`<${n} align=\"${e.align}\">`:`<${n}>`)+t+`</${n}>\n`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${w(e,!0)}</code>`}br(e){return\"<br>\"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){let r=this.parser.parseInline(n),i=X(e);if(i===null)return r;e=i;let s='<a href=\"'+e+'\"';return t&&(s+=' title=\"'+w(t)+'\"'),s+=\">\"+r+\"</a>\",s}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));let i=X(e);if(i===null)return w(n);e=i;let s=`<img src=\"${e}\" alt=\"${n}\"`;return t&&(s+=` title=\"${w(t)}\"`),s+=\">\",s}text(e){return\"tokens\"in e&&e.tokens?this.parser.parseInline(e.tokens):\"escaped\"in e&&e.escaped?e.text:w(e.text)}};var $=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return\"\"+e}image({text:e}){return\"\"+e}br(){return\"\"}checkbox({raw:e}){return e}};var b=class u{options;renderer;textRenderer;constructor(e){this.options=e||T,this.options.renderer=this.options.renderer||new P,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new $}static parse(e,t){return new u(t).parse(e)}static parseInline(e,t){return new u(t).parseInline(e)}parse(e){let t=\"\";for(let n=0;n<e.length;n++){let r=e[n];if(this.options.extensions?.renderers?.[r.type]){let s=r,a=this.options.extensions.renderers[s.type].call({parser:this},s);if(a!==!1||![\"space\",\"hr\",\"heading\",\"code\",\"table\",\"blockquote\",\"list\",\"html\",\"def\",\"paragraph\",\"text\"].includes(s.type)){t+=a||\"\";continue}}let i=r;switch(i.type){case\"space\":{t+=this.renderer.space(i);break}case\"hr\":{t+=this.renderer.hr(i);break}case\"heading\":{t+=this.renderer.heading(i);break}case\"code\":{t+=this.renderer.code(i);break}case\"table\":{t+=this.renderer.table(i);break}case\"blockquote\":{t+=this.renderer.blockquote(i);break}case\"list\":{t+=this.renderer.list(i);break}case\"checkbox\":{t+=this.renderer.checkbox(i);break}case\"html\":{t+=this.renderer.html(i);break}case\"def\":{t+=this.renderer.def(i);break}case\"paragraph\":{t+=this.renderer.paragraph(i);break}case\"text\":{t+=this.renderer.text(i);break}default:{let s='Token with \"'+i.type+'\" type was not found.';if(this.options.silent)return console.error(s),\"\";throw new Error(s)}}}return t}parseInline(e,t=this.renderer){let n=\"\";for(let r=0;r<e.length;r++){let i=e[r];if(this.options.extensions?.renderers?.[i.type]){let a=this.options.extensions.renderers[i.type].call({parser:this},i);if(a!==!1||![\"escape\",\"html\",\"link\",\"image\",\"strong\",\"em\",\"codespan\",\"br\",\"del\",\"text\"].includes(i.type)){n+=a||\"\";continue}}let s=i;switch(s.type){case\"escape\":{n+=t.text(s);break}case\"html\":{n+=t.html(s);break}case\"link\":{n+=t.link(s);break}case\"image\":{n+=t.image(s);break}case\"checkbox\":{n+=t.checkbox(s);break}case\"strong\":{n+=t.strong(s);break}case\"em\":{n+=t.em(s);break}case\"codespan\":{n+=t.codespan(s);break}case\"br\":{n+=t.br(s);break}case\"del\":{n+=t.del(s);break}case\"text\":{n+=t.text(s);break}default:{let a='Token with \"'+s.type+'\" type was not found.';if(this.options.silent)return console.error(a),\"\";throw new Error(a)}}}return n}};var S=class{options;block;constructor(e){this.options=e||T}static passThroughHooks=new Set([\"preprocess\",\"postprocess\",\"processAllTokens\",\"emStrongMask\"]);static passThroughHooksRespectAsync=new Set([\"preprocess\",\"postprocess\",\"processAllTokens\"]);preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}emStrongMask(e){return e}provideLexer(){return this.block?x.lex:x.lexInline}provideParser(){return this.block?b.parse:b.parseInline}};var B=class{defaults=L();options=this.setOptions;parse=this.parseMarkdown(!0);parseInline=this.parseMarkdown(!1);Parser=b;Renderer=P;TextRenderer=$;Lexer=x;Tokenizer=y;Hooks=S;constructor(...e){this.use(...e)}walkTokens(e,t){let n=[];for(let r of e)switch(n=n.concat(t.call(this,r)),r.type){case\"table\":{let i=r;for(let s of i.header)n=n.concat(this.walkTokens(s.tokens,t));for(let s of i.rows)for(let a of s)n=n.concat(this.walkTokens(a.tokens,t));break}case\"list\":{let i=r;n=n.concat(this.walkTokens(i.items,t));break}default:{let i=r;this.defaults.extensions?.childTokens?.[i.type]?this.defaults.extensions.childTokens[i.type].forEach(s=>{let a=i[s].flat(1/0);n=n.concat(this.walkTokens(a,t))}):i.tokens&&(n=n.concat(this.walkTokens(i.tokens,t)))}}return n}use(...e){let t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{let r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(i=>{if(!i.name)throw new Error(\"extension name required\");if(\"renderer\"in i){let s=t.renderers[i.name];s?t.renderers[i.name]=function(...a){let o=i.renderer.apply(this,a);return o===!1&&(o=s.apply(this,a)),o}:t.renderers[i.name]=i.renderer}if(\"tokenizer\"in i){if(!i.level||i.level!==\"block\"&&i.level!==\"inline\")throw new Error(\"extension level must be 'block' or 'inline'\");let s=t[i.level];s?s.unshift(i.tokenizer):t[i.level]=[i.tokenizer],i.start&&(i.level===\"block\"?t.startBlock?t.startBlock.push(i.start):t.startBlock=[i.start]:i.level===\"inline\"&&(t.startInline?t.startInline.push(i.start):t.startInline=[i.start]))}\"childTokens\"in i&&i.childTokens&&(t.childTokens[i.name]=i.childTokens)}),r.extensions=t),n.renderer){let i=this.defaults.renderer||new P(this.defaults);for(let s in n.renderer){if(!(s in i))throw new Error(`renderer '${s}' does not exist`);if([\"options\",\"parser\"].includes(s))continue;let a=s,o=n.renderer[a],l=i[a];i[a]=(...p)=>{let c=o.apply(i,p);return c===!1&&(c=l.apply(i,p)),c||\"\"}}r.renderer=i}if(n.tokenizer){let i=this.defaults.tokenizer||new y(this.defaults);for(let s in n.tokenizer){if(!(s in i))throw new Error(`tokenizer '${s}' does not exist`);if([\"options\",\"rules\",\"lexer\"].includes(s))continue;let a=s,o=n.tokenizer[a],l=i[a];i[a]=(...p)=>{let c=o.apply(i,p);return c===!1&&(c=l.apply(i,p)),c}}r.tokenizer=i}if(n.hooks){let i=this.defaults.hooks||new S;for(let s in n.hooks){if(!(s in i))throw new Error(`hook '${s}' does not exist`);if([\"options\",\"block\"].includes(s))continue;let a=s,o=n.hooks[a],l=i[a];S.passThroughHooks.has(s)?i[a]=p=>{if(this.defaults.async&&S.passThroughHooksRespectAsync.has(s))return(async()=>{let g=await o.call(i,p);return l.call(i,g)})();let c=o.call(i,p);return l.call(i,c)}:i[a]=(...p)=>{if(this.defaults.async)return(async()=>{let g=await o.apply(i,p);return g===!1&&(g=await l.apply(i,p)),g})();let c=o.apply(i,p);return c===!1&&(c=l.apply(i,p)),c}}r.hooks=i}if(n.walkTokens){let i=this.defaults.walkTokens,s=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(s.call(this,a)),i&&(o=o.concat(i.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return x.lex(e,t??this.defaults)}parser(e,t){return b.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{let i={...r},s={...this.defaults,...i},a=this.onError(!!s.silent,!!s.async);if(this.defaults.async===!0&&i.async===!1)return a(new Error(\"marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise.\"));if(typeof n>\"u\"||n===null)return a(new Error(\"marked(): input parameter is undefined or null\"));if(typeof n!=\"string\")return a(new Error(\"marked(): input parameter is of type \"+Object.prototype.toString.call(n)+\", string expected\"));if(s.hooks&&(s.hooks.options=s,s.hooks.block=e),s.async)return(async()=>{let o=s.hooks?await s.hooks.preprocess(n):n,p=await(s.hooks?await s.hooks.provideLexer():e?x.lex:x.lexInline)(o,s),c=s.hooks?await s.hooks.processAllTokens(p):p;s.walkTokens&&await Promise.all(this.walkTokens(c,s.walkTokens));let h=await(s.hooks?await s.hooks.provideParser():e?b.parse:b.parseInline)(c,s);return s.hooks?await s.hooks.postprocess(h):h})().catch(a);try{s.hooks&&(n=s.hooks.preprocess(n));let l=(s.hooks?s.hooks.provideLexer():e?x.lex:x.lexInline)(n,s);s.hooks&&(l=s.hooks.processAllTokens(l)),s.walkTokens&&this.walkTokens(l,s.walkTokens);let c=(s.hooks?s.hooks.provideParser():e?b.parse:b.parseInline)(l,s);return s.hooks&&(c=s.hooks.postprocess(c)),c}catch(o){return a(o)}}}onError(e,t){return n=>{if(n.message+=`\nPlease report this to https://github.com/markedjs/marked.`,e){let r=\"<p>An error occurred:</p><pre>\"+w(n.message+\"\",!0)+\"</pre>\";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}};var _=new B;function d(u,e){return _.parse(u,e)}d.options=d.setOptions=function(u){return _.setOptions(u),d.defaults=_.defaults,Z(d.defaults),d};d.getDefaults=L;d.defaults=T;d.use=function(...u){return _.use(...u),d.defaults=_.defaults,Z(d.defaults),d};d.walkTokens=function(u,e){return _.walkTokens(u,e)};d.parseInline=_.parseInline;d.Parser=b;d.parser=b.parse;d.Renderer=P;d.TextRenderer=$;d.Lexer=x;d.lexer=x.lex;d.Tokenizer=y;d.Hooks=S;d.parse=d;var Dt=d.options,Ht=d.setOptions,Zt=d.use,Gt=d.walkTokens,Nt=d.parseInline,Qt=d,Ft=b.parse,jt=x.lex;export{S as Hooks,x as Lexer,B as Marked,b as Parser,P as Renderer,$ as TextRenderer,y as Tokenizer,T as defaults,L as getDefaults,jt as lexer,d as marked,Dt as options,Qt as parse,Nt as parseInline,Ft as parser,Ht as setOptions,Zt as use,Gt as walkTokens};\n//# sourceMappingURL=marked.esm.js.map\n","import DOMPurify from \"dompurify\";\nimport { marked } from \"marked\";\nimport { truncateText } from \"./format.ts\";\n\nmarked.setOptions({\n  gfm: true,\n  breaks: true,\n});\n\nconst allowedTags = [\n  \"a\",\n  \"b\",\n  \"blockquote\",\n  \"br\",\n  \"code\",\n  \"del\",\n  \"em\",\n  \"h1\",\n  \"h2\",\n  \"h3\",\n  \"h4\",\n  \"hr\",\n  \"i\",\n  \"li\",\n  \"ol\",\n  \"p\",\n  \"pre\",\n  \"strong\",\n  \"table\",\n  \"tbody\",\n  \"td\",\n  \"th\",\n  \"thead\",\n  \"tr\",\n  \"ul\",\n  \"img\",\n];\n\nconst allowedAttrs = [\"class\", \"href\", \"rel\", \"target\", \"title\", \"start\", \"src\", \"alt\"];\nconst sanitizeOptions = {\n  ALLOWED_TAGS: allowedTags,\n  ALLOWED_ATTR: allowedAttrs,\n  ADD_DATA_URI_TAGS: [\"img\"],\n};\n\nlet hooksInstalled = false;\nconst MARKDOWN_CHAR_LIMIT = 140_000;\nconst MARKDOWN_PARSE_LIMIT = 40_000;\nconst MARKDOWN_CACHE_LIMIT = 200;\nconst MARKDOWN_CACHE_MAX_CHARS = 50_000;\nconst markdownCache = new Map<string, string>();\n\nfunction getCachedMarkdown(key: string): string | null {\n  const cached = markdownCache.get(key);\n  if (cached === undefined) {\n    return null;\n  }\n  markdownCache.delete(key);\n  markdownCache.set(key, cached);\n  return cached;\n}\n\nfunction setCachedMarkdown(key: string, value: string) {\n  markdownCache.set(key, value);\n  if (markdownCache.size <= MARKDOWN_CACHE_LIMIT) {\n    return;\n  }\n  const oldest = markdownCache.keys().next().value;\n  if (oldest) {\n    markdownCache.delete(oldest);\n  }\n}\n\nfunction installHooks() {\n  if (hooksInstalled) {\n    return;\n  }\n  hooksInstalled = true;\n\n  DOMPurify.addHook(\"afterSanitizeAttributes\", (node) => {\n    if (!(node instanceof HTMLAnchorElement)) {\n      return;\n    }\n    const href = node.getAttribute(\"href\");\n    if (!href) {\n      return;\n    }\n    node.setAttribute(\"rel\", \"noreferrer noopener\");\n    node.setAttribute(\"target\", \"_blank\");\n  });\n}\n\nexport function toSanitizedMarkdownHtml(markdown: string): string {\n  const input = markdown.trim();\n  if (!input) {\n    return \"\";\n  }\n  installHooks();\n  if (input.length <= MARKDOWN_CACHE_MAX_CHARS) {\n    const cached = getCachedMarkdown(input);\n    if (cached !== null) {\n      return cached;\n    }\n  }\n  const truncated = truncateText(input, MARKDOWN_CHAR_LIMIT);\n  const suffix = truncated.truncated\n    ? `\\n\\n… truncated (${truncated.total} chars, showing first ${truncated.text.length}).`\n    : \"\";\n  if (truncated.text.length > MARKDOWN_PARSE_LIMIT) {\n    const escaped = escapeHtml(`${truncated.text}${suffix}`);\n    const html = `<pre class=\"code-block\">${escaped}</pre>`;\n    const sanitized = DOMPurify.sanitize(html, sanitizeOptions);\n    if (input.length <= MARKDOWN_CACHE_MAX_CHARS) {\n      setCachedMarkdown(input, sanitized);\n    }\n    return sanitized;\n  }\n  const rendered = marked.parse(`${truncated.text}${suffix}`, {\n    renderer: htmlEscapeRenderer,\n  }) as string;\n  const sanitized = DOMPurify.sanitize(rendered, sanitizeOptions);\n  if (input.length <= MARKDOWN_CACHE_MAX_CHARS) {\n    setCachedMarkdown(input, sanitized);\n  }\n  return sanitized;\n}\n\n// Prevent raw HTML in chat messages from being rendered as formatted HTML.\n// Display it as escaped text so users see the literal markup.\n// Security is handled by DOMPurify, but rendering pasted HTML (e.g. error\n// pages) as formatted output is confusing UX (#13937).\nconst htmlEscapeRenderer = new marked.Renderer();\nhtmlEscapeRenderer.html = ({ text }: { text: string }) => escapeHtml(text);\n\nfunction escapeHtml(value: string): string {\n  return value\n    .replace(/&/g, \"&amp;\")\n    .replace(/</g, \"&lt;\")\n    .replace(/>/g, \"&gt;\")\n    .replace(/\"/g, \"&quot;\")\n    .replace(/'/g, \"&#39;\");\n}\n","import { html, type TemplateResult } from \"lit\";\nimport { icons } from \"../icons\";\n\nconst COPIED_FOR_MS = 1500;\nconst ERROR_FOR_MS = 2000;\nconst COPY_LABEL = \"Copy as markdown\";\nconst COPIED_LABEL = \"Copied\";\nconst ERROR_LABEL = \"Copy failed\";\n\ntype CopyButtonOptions = {\n  text: () => string;\n  label?: string;\n};\n\nasync function copyTextToClipboard(text: string): Promise<boolean> {\n  if (!text) return false;\n\n  try {\n    await navigator.clipboard.writeText(text);\n    return true;\n  } catch {\n    return false;\n  }\n}\n\nfunction setButtonLabel(button: HTMLButtonElement, label: string) {\n  button.title = label;\n  button.setAttribute(\"aria-label\", label);\n}\n\nfunction createCopyButton(options: CopyButtonOptions): TemplateResult {\n  const idleLabel = options.label ?? COPY_LABEL;\n  return html`\n    <button\n      class=\"chat-copy-btn\"\n      type=\"button\"\n      title=${idleLabel}\n      aria-label=${idleLabel}\n      @click=${async (e: Event) => {\n        const btn = e.currentTarget as HTMLButtonElement | null;\n        const iconContainer = btn?.querySelector(\n          \".chat-copy-btn__icon\",\n        ) as HTMLElement | null;\n\n        if (!btn || btn.dataset.copying === \"1\") return;\n\n        btn.dataset.copying = \"1\";\n        btn.setAttribute(\"aria-busy\", \"true\");\n        btn.disabled = true;\n\n        const copied = await copyTextToClipboard(options.text());\n        if (!btn.isConnected) return;\n\n        delete btn.dataset.copying;\n        btn.removeAttribute(\"aria-busy\");\n        btn.disabled = false;\n\n        if (!copied) {\n          btn.dataset.error = \"1\";\n          setButtonLabel(btn, ERROR_LABEL);\n\n          window.setTimeout(() => {\n            if (!btn.isConnected) return;\n            delete btn.dataset.error;\n            setButtonLabel(btn, idleLabel);\n          }, ERROR_FOR_MS);\n          return;\n        }\n\n        btn.dataset.copied = \"1\";\n        setButtonLabel(btn, COPIED_LABEL);\n\n        window.setTimeout(() => {\n          if (!btn.isConnected) return;\n          delete btn.dataset.copied;\n          setButtonLabel(btn, idleLabel);\n        }, COPIED_FOR_MS);\n      }}\n    >\n      <span class=\"chat-copy-btn__icon\" aria-hidden=\"true\">\n        <span class=\"chat-copy-btn__icon-copy\">${icons.copy}</span>\n        <span class=\"chat-copy-btn__icon-check\">${icons.check}</span>\n      </span>\n    </button>\n  `;\n}\n\nexport function renderCopyAsMarkdownButton(markdown: string): TemplateResult {\n  return createCopyButton({ text: () => markdown, label: COPY_LABEL });\n}\n","/**\n * Message normalization utilities for chat rendering.\n */\n\nimport type {\n  NormalizedMessage,\n  MessageContentItem,\n} from \"../types/chat-types\";\n\n/**\n * Normalize a raw message object into a consistent structure.\n */\nexport function normalizeMessage(message: unknown): NormalizedMessage {\n  const m = message as Record<string, unknown>;\n  let role = typeof m.role === \"string\" ? m.role : \"unknown\";\n\n  // Detect tool messages by common gateway shapes.\n  // Some tool events come through as assistant role with tool_* items in the content array.\n  const hasToolId =\n    typeof m.toolCallId === \"string\" || typeof m.tool_call_id === \"string\";\n\n  const contentRaw = m.content;\n  const contentItems = Array.isArray(contentRaw) ? contentRaw : null;\n  const hasToolContent =\n    Array.isArray(contentItems) &&\n    contentItems.some((item) => {\n      const x = item as Record<string, unknown>;\n      const t = String(x.type ?? \"\").toLowerCase();\n      return t === \"toolresult\" || t === \"tool_result\";\n    });\n\n  const hasToolName =\n    typeof (m as Record<string, unknown>).toolName === \"string\" ||\n    typeof (m as Record<string, unknown>).tool_name === \"string\";\n\n  if (hasToolId || hasToolContent || hasToolName) {\n    role = \"toolResult\";\n  }\n\n  // Extract content\n  let content: MessageContentItem[] = [];\n\n  if (typeof m.content === \"string\") {\n    content = [{ type: \"text\", text: m.content }];\n  } else if (Array.isArray(m.content)) {\n    content = m.content.map((item: Record<string, unknown>) => ({\n      type: (item.type as MessageContentItem[\"type\"]) || \"text\",\n      text: item.text as string | undefined,\n      name: item.name as string | undefined,\n      args: item.args || item.arguments,\n    }));\n  } else if (typeof m.text === \"string\") {\n    content = [{ type: \"text\", text: m.text }];\n  }\n\n  const timestamp = typeof m.timestamp === \"number\" ? m.timestamp : Date.now();\n  const id = typeof m.id === \"string\" ? m.id : undefined;\n\n  return { role, content, timestamp, id };\n}\n\n/**\n * Normalize role for grouping purposes.\n */\nexport function normalizeRoleForGrouping(role: string): string {\n  const lower = role.toLowerCase();\n  // Preserve original casing when it's already a core role.\n  if (role === \"user\" || role === \"User\") return role;\n  if (role === \"assistant\") return \"assistant\";\n  if (role === \"system\") return \"system\";\n  // Keep tool-related roles distinct so the UI can style/toggle them.\n  if (\n    lower === \"toolresult\" ||\n    lower === \"tool_result\" ||\n    lower === \"tool\" ||\n    lower === \"function\"\n  ) {\n    return \"tool\";\n  }\n  return role;\n}\n\n/**\n * Check if a message is a tool result message based on its role.\n */\nexport function isToolResultMessage(message: unknown): boolean {\n  const m = message as Record<string, unknown>;\n  const role = typeof m.role === \"string\" ? m.role.toLowerCase() : \"\";\n  return role === \"toolresult\" || role === \"tool_result\";\n}\n","import rawConfig from \"./tool-display.json\";\nimport type { IconName } from \"./icons\";\n\ntype ToolDisplayActionSpec = {\n  label?: string;\n  detailKeys?: string[];\n};\n\ntype ToolDisplaySpec = {\n  icon?: string;\n  title?: string;\n  label?: string;\n  detailKeys?: string[];\n  actions?: Record<string, ToolDisplayActionSpec>;\n};\n\ntype ToolDisplayConfig = {\n  version?: number;\n  fallback?: ToolDisplaySpec;\n  tools?: Record<string, ToolDisplaySpec>;\n};\n\nexport type ToolDisplay = {\n  name: string;\n  icon: IconName;\n  title: string;\n  label: string;\n  verb?: string;\n  detail?: string;\n};\n\nconst TOOL_DISPLAY_CONFIG = rawConfig as ToolDisplayConfig;\nconst FALLBACK = TOOL_DISPLAY_CONFIG.fallback ?? { icon: \"puzzle\" };\nconst TOOL_MAP = TOOL_DISPLAY_CONFIG.tools ?? {};\n\nfunction normalizeToolName(name?: string): string {\n  return (name ?? \"tool\").trim();\n}\n\nfunction defaultTitle(name: string): string {\n  const cleaned = name.replace(/_/g, \" \").trim();\n  if (!cleaned) return \"Tool\";\n  return cleaned\n    .split(/\\s+/)\n    .map((part) =>\n      part.length <= 2 && part.toUpperCase() === part\n        ? part\n        : `${part.at(0)?.toUpperCase() ?? \"\"}${part.slice(1)}`,\n    )\n    .join(\" \");\n}\n\nfunction normalizeVerb(value?: string): string | undefined {\n  const trimmed = value?.trim();\n  if (!trimmed) return undefined;\n  return trimmed.replace(/_/g, \" \");\n}\n\nfunction coerceDisplayValue(value: unknown): string | undefined {\n  if (value === null || value === undefined) return undefined;\n  if (typeof value === \"string\") {\n    const trimmed = value.trim();\n    if (!trimmed) return undefined;\n    const firstLine = trimmed.split(/\\r?\\n/)[0]?.trim() ?? \"\";\n    if (!firstLine) return undefined;\n    return firstLine.length > 160 ? `${firstLine.slice(0, 157)}…` : firstLine;\n  }\n  if (typeof value === \"number\" || typeof value === \"boolean\") {\n    return String(value);\n  }\n  if (Array.isArray(value)) {\n    const values = value\n      .map((item) => coerceDisplayValue(item))\n      .filter((item): item is string => Boolean(item));\n    if (values.length === 0) return undefined;\n    const preview = values.slice(0, 3).join(\", \");\n    return values.length > 3 ? `${preview}…` : preview;\n  }\n  return undefined;\n}\n\nfunction lookupValueByPath(args: unknown, path: string): unknown {\n  if (!args || typeof args !== \"object\") return undefined;\n  let current: unknown = args;\n  for (const segment of path.split(\".\")) {\n    if (!segment) return undefined;\n    if (!current || typeof current !== \"object\") return undefined;\n    const record = current as Record<string, unknown>;\n    current = record[segment];\n  }\n  return current;\n}\n\nfunction resolveDetailFromKeys(args: unknown, keys: string[]): string | undefined {\n  for (const key of keys) {\n    const value = lookupValueByPath(args, key);\n    const display = coerceDisplayValue(value);\n    if (display) return display;\n  }\n  return undefined;\n}\n\nfunction resolveReadDetail(args: unknown): string | undefined {\n  if (!args || typeof args !== \"object\") return undefined;\n  const record = args as Record<string, unknown>;\n  const path = typeof record.path === \"string\" ? record.path : undefined;\n  if (!path) return undefined;\n  const offset = typeof record.offset === \"number\" ? record.offset : undefined;\n  const limit = typeof record.limit === \"number\" ? record.limit : undefined;\n  if (offset !== undefined && limit !== undefined) {\n    return `${path}:${offset}-${offset + limit}`;\n  }\n  return path;\n}\n\nfunction resolveWriteDetail(args: unknown): string | undefined {\n  if (!args || typeof args !== \"object\") return undefined;\n  const record = args as Record<string, unknown>;\n  const path = typeof record.path === \"string\" ? record.path : undefined;\n  return path;\n}\n\nfunction resolveActionSpec(\n  spec: ToolDisplaySpec | undefined,\n  action: string | undefined,\n): ToolDisplayActionSpec | undefined {\n  if (!spec || !action) return undefined;\n  return spec.actions?.[action] ?? undefined;\n}\n\nexport function resolveToolDisplay(params: {\n  name?: string;\n  args?: unknown;\n  meta?: string;\n}): ToolDisplay {\n  const name = normalizeToolName(params.name);\n  const key = name.toLowerCase();\n  const spec = TOOL_MAP[key];\n  const icon = (spec?.icon ?? FALLBACK.icon ?? \"puzzle\") as IconName;\n  const title = spec?.title ?? defaultTitle(name);\n  const label = spec?.label ?? name;\n  const actionRaw =\n    params.args && typeof params.args === \"object\"\n      ? ((params.args as Record<string, unknown>).action as string | undefined)\n      : undefined;\n  const action = typeof actionRaw === \"string\" ? actionRaw.trim() : undefined;\n  const actionSpec = resolveActionSpec(spec, action);\n  const verb = normalizeVerb(actionSpec?.label ?? action);\n\n  let detail: string | undefined;\n  if (key === \"read\") detail = resolveReadDetail(params.args);\n  if (!detail && (key === \"write\" || key === \"edit\" || key === \"attach\")) {\n    detail = resolveWriteDetail(params.args);\n  }\n\n  const detailKeys =\n    actionSpec?.detailKeys ?? spec?.detailKeys ?? FALLBACK.detailKeys ?? [];\n  if (!detail && detailKeys.length > 0) {\n    detail = resolveDetailFromKeys(params.args, detailKeys);\n  }\n\n  if (!detail && params.meta) {\n    detail = params.meta;\n  }\n\n  if (detail) {\n    detail = shortenHomeInString(detail);\n  }\n\n  return {\n    name,\n    icon,\n    title,\n    label,\n    verb,\n    detail,\n  };\n}\n\nexport function formatToolDetail(display: ToolDisplay): string | undefined {\n  const parts: string[] = [];\n  if (display.verb) parts.push(display.verb);\n  if (display.detail) parts.push(display.detail);\n  if (parts.length === 0) return undefined;\n  return parts.join(\" · \");\n}\n\nexport function formatToolSummary(display: ToolDisplay): string {\n  const detail = formatToolDetail(display);\n  return detail ? `${display.label}: ${detail}` : display.label;\n}\n\nfunction shortenHomeInString(input: string): string {\n  if (!input) return input;\n  return input\n    .replace(/\\/Users\\/[^/]+/g, \"~\")\n    .replace(/\\/home\\/[^/]+/g, \"~\");\n}\n","/**\n * Chat-related constants for the UI layer.\n */\n\n/** Character threshold for showing tool output inline vs collapsed */\nexport const TOOL_INLINE_THRESHOLD = 80;\n\n/** Maximum lines to show in collapsed preview */\nexport const PREVIEW_MAX_LINES = 2;\n\n/** Maximum characters to show in collapsed preview */\nexport const PREVIEW_MAX_CHARS = 100;\n","/**\n * Helper functions for tool card rendering.\n */\n\nimport { PREVIEW_MAX_CHARS, PREVIEW_MAX_LINES } from \"./constants\";\n\n/**\n * Format tool output content for display in the sidebar.\n * Detects JSON and wraps it in a code block with formatting.\n */\nexport function formatToolOutputForSidebar(text: string): string {\n  const trimmed = text.trim();\n  // Try to detect and format JSON\n  if (trimmed.startsWith(\"{\") || trimmed.startsWith(\"[\")) {\n    try {\n      const parsed = JSON.parse(trimmed);\n      return \"```json\\n\" + JSON.stringify(parsed, null, 2) + \"\\n```\";\n    } catch {\n      // Not valid JSON, return as-is\n    }\n  }\n  return text;\n}\n\n/**\n * Get a truncated preview of tool output text.\n * Truncates to first N lines or first N characters, whichever is shorter.\n */\nexport function getTruncatedPreview(text: string): string {\n  const allLines = text.split(\"\\n\");\n  const lines = allLines.slice(0, PREVIEW_MAX_LINES);\n  const preview = lines.join(\"\\n\");\n  if (preview.length > PREVIEW_MAX_CHARS) {\n    return preview.slice(0, PREVIEW_MAX_CHARS) + \"…\";\n  }\n  return lines.length < allLines.length ? preview + \"…\" : preview;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatToolDetail, resolveToolDisplay } from \"../tool-display\";\nimport { icons } from \"../icons\";\nimport type { ToolCard } from \"../types/chat-types\";\nimport { TOOL_INLINE_THRESHOLD } from \"./constants\";\nimport {\n  formatToolOutputForSidebar,\n  getTruncatedPreview,\n} from \"./tool-helpers\";\nimport { isToolResultMessage } from \"./message-normalizer\";\nimport { extractTextCached } from \"./message-extract\";\n\nexport function extractToolCards(message: unknown): ToolCard[] {\n  const m = message as Record<string, unknown>;\n  const content = normalizeContent(m.content);\n  const cards: ToolCard[] = [];\n\n  for (const item of content) {\n    const kind = String(item.type ?? \"\").toLowerCase();\n    const isToolCall =\n      [\"toolcall\", \"tool_call\", \"tooluse\", \"tool_use\"].includes(kind) ||\n      (typeof item.name === \"string\" && item.arguments != null);\n    if (isToolCall) {\n      cards.push({\n        kind: \"call\",\n        name: (item.name as string) ?? \"tool\",\n        args: coerceArgs(item.arguments ?? item.args),\n      });\n    }\n  }\n\n  for (const item of content) {\n    const kind = String(item.type ?? \"\").toLowerCase();\n    if (kind !== \"toolresult\" && kind !== \"tool_result\") continue;\n    const text = extractToolText(item);\n    const name = typeof item.name === \"string\" ? item.name : \"tool\";\n    cards.push({ kind: \"result\", name, text });\n  }\n\n  if (\n    isToolResultMessage(message) &&\n    !cards.some((card) => card.kind === \"result\")\n  ) {\n    const name =\n      (typeof m.toolName === \"string\" && m.toolName) ||\n      (typeof m.tool_name === \"string\" && m.tool_name) ||\n      \"tool\";\n    const text = extractTextCached(message) ?? undefined;\n    cards.push({ kind: \"result\", name, text });\n  }\n\n  return cards;\n}\n\nexport function renderToolCardSidebar(\n  card: ToolCard,\n  onOpenSidebar?: (content: string) => void,\n) {\n  const display = resolveToolDisplay({ name: card.name, args: card.args });\n  const detail = formatToolDetail(display);\n  const hasText = Boolean(card.text?.trim());\n\n  const canClick = Boolean(onOpenSidebar);\n  const handleClick = canClick\n    ? () => {\n        if (hasText) {\n          onOpenSidebar!(formatToolOutputForSidebar(card.text!));\n          return;\n        }\n        const info = `## ${display.label}\\n\\n${\n          detail ? `**Command:** \\`${detail}\\`\\n\\n` : \"\"\n        }*No output — tool completed successfully.*`;\n        onOpenSidebar!(info);\n      }\n    : undefined;\n\n  const isShort = hasText && (card.text?.length ?? 0) <= TOOL_INLINE_THRESHOLD;\n  const showCollapsed = hasText && !isShort;\n  const showInline = hasText && isShort;\n  const isEmpty = !hasText;\n\n  return html`\n    <div\n      class=\"chat-tool-card ${canClick ? \"chat-tool-card--clickable\" : \"\"}\"\n      @click=${handleClick}\n      role=${canClick ? \"button\" : nothing}\n      tabindex=${canClick ? \"0\" : nothing}\n      @keydown=${canClick\n        ? (e: KeyboardEvent) => {\n            if (e.key !== \"Enter\" && e.key !== \" \") return;\n            e.preventDefault();\n            handleClick?.();\n          }\n        : nothing}\n    >\n      <div class=\"chat-tool-card__header\">\n        <div class=\"chat-tool-card__title\">\n          <span class=\"chat-tool-card__icon\">${icons[display.icon]}</span>\n          <span>${display.label}</span>\n        </div>\n        ${canClick\n          ? html`<span class=\"chat-tool-card__action\">${hasText ? \"View\" : \"\"} ${icons.check}</span>`\n          : nothing}\n        ${isEmpty && !canClick ? html`<span class=\"chat-tool-card__status\">${icons.check}</span>` : nothing}\n      </div>\n      ${detail\n        ? html`<div class=\"chat-tool-card__detail\">${detail}</div>`\n        : nothing}\n      ${isEmpty\n        ? html`<div class=\"chat-tool-card__status-text muted\">Completed</div>`\n        : nothing}\n      ${showCollapsed\n        ? html`<div class=\"chat-tool-card__preview mono\">${getTruncatedPreview(card.text!)}</div>`\n        : nothing}\n      ${showInline\n        ? html`<div class=\"chat-tool-card__inline mono\">${card.text}</div>`\n        : nothing}\n    </div>\n  `;\n}\n\nfunction normalizeContent(content: unknown): Array<Record<string, unknown>> {\n  if (!Array.isArray(content)) return [];\n  return content.filter(Boolean) as Array<Record<string, unknown>>;\n}\n\nfunction coerceArgs(value: unknown): unknown {\n  if (typeof value !== \"string\") return value;\n  const trimmed = value.trim();\n  if (!trimmed) return value;\n  if (!trimmed.startsWith(\"{\") && !trimmed.startsWith(\"[\")) return value;\n  try {\n    return JSON.parse(trimmed);\n  } catch {\n    return value;\n  }\n}\n\nfunction extractToolText(item: Record<string, unknown>): string | undefined {\n  if (typeof item.text === \"string\") return item.text;\n  if (typeof item.content === \"string\") return item.content;\n  return undefined;\n}\n","import { html, nothing } from \"lit\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nimport type { AssistantIdentity } from \"../assistant-identity\";\nimport { toSanitizedMarkdownHtml } from \"../markdown\";\nimport type { MessageGroup } from \"../types/chat-types\";\nimport { renderCopyAsMarkdownButton } from \"./copy-as-markdown\";\nimport { isToolResultMessage, normalizeRoleForGrouping } from \"./message-normalizer\";\nimport {\n  extractTextCached,\n  extractThinkingCached,\n  formatReasoningMarkdown,\n} from \"./message-extract\";\nimport { extractToolCards, renderToolCardSidebar } from \"./tool-cards\";\n\ntype ImageBlock = {\n  url: string;\n  alt?: string;\n};\n\nfunction extractImages(message: unknown): ImageBlock[] {\n  const m = message as Record<string, unknown>;\n  const content = m.content;\n  const images: ImageBlock[] = [];\n\n  if (Array.isArray(content)) {\n    for (const block of content) {\n      if (typeof block !== \"object\" || block === null) continue;\n      const b = block as Record<string, unknown>;\n\n      if (b.type === \"image\") {\n        // Handle source object format (from sendChatMessage)\n        const source = b.source as Record<string, unknown> | undefined;\n        if (source?.type === \"base64\" && typeof source.data === \"string\") {\n          const data = source.data as string;\n          const mediaType = (source.media_type as string) || \"image/png\";\n          // If data is already a data URL, use it directly\n          const url = data.startsWith(\"data:\")\n            ? data\n            : `data:${mediaType};base64,${data}`;\n          images.push({ url });\n        } else if (typeof b.url === \"string\") {\n          images.push({ url: b.url });\n        }\n      } else if (b.type === \"image_url\") {\n        // OpenAI format\n        const imageUrl = b.image_url as Record<string, unknown> | undefined;\n        if (typeof imageUrl?.url === \"string\") {\n          images.push({ url: imageUrl.url });\n        }\n      }\n    }\n  }\n\n  return images;\n}\n\nexport function renderReadingIndicatorGroup(assistant?: AssistantIdentity) {\n  return html`\n    <div class=\"chat-group assistant\">\n      ${renderAvatar(\"assistant\", assistant)}\n      <div class=\"chat-group-messages\">\n        <div class=\"chat-bubble chat-reading-indicator\" aria-hidden=\"true\">\n          <span class=\"chat-reading-indicator__dots\">\n            <span></span><span></span><span></span>\n          </span>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nexport function renderStreamingGroup(\n  text: string,\n  startedAt: number,\n  onOpenSidebar?: (content: string) => void,\n  assistant?: AssistantIdentity,\n) {\n  const timestamp = new Date(startedAt).toLocaleTimeString([], {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n  });\n  const name = assistant?.name ?? \"助手\";\n\n  return html`\n    <div class=\"chat-group assistant\">\n      ${renderAvatar(\"assistant\", assistant)}\n      <div class=\"chat-group-messages\">\n        ${renderGroupedMessage(\n          {\n            role: \"assistant\",\n            content: [{ type: \"text\", text }],\n            timestamp: startedAt,\n          },\n          { isStreaming: true, showReasoning: false },\n          onOpenSidebar,\n        )}\n        <div class=\"chat-group-footer\">\n          <span class=\"chat-sender-name\">${name}</span>\n          <span class=\"chat-group-timestamp\">${timestamp}</span>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nexport function renderMessageGroup(\n  group: MessageGroup,\n  opts: {\n    onOpenSidebar?: (content: string) => void;\n    showReasoning: boolean;\n    assistantName?: string;\n    assistantAvatar?: string | null;\n  },\n) {\n  const normalizedRole = normalizeRoleForGrouping(group.role);\n  const assistantName = opts.assistantName ?? \"助手\";\n  const who =\n    normalizedRole === \"user\"\n      ? \"你\"\n      : normalizedRole === \"assistant\"\n        ? assistantName\n        : normalizedRole;\n  const roleClass =\n    normalizedRole === \"user\"\n      ? \"user\"\n      : normalizedRole === \"assistant\"\n        ? \"assistant\"\n        : \"other\";\n  const timestamp = new Date(group.timestamp).toLocaleTimeString([], {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n  });\n\n  return html`\n    <div class=\"chat-group ${roleClass}\">\n      ${renderAvatar(group.role, {\n        name: assistantName,\n        avatar: opts.assistantAvatar ?? null,\n      })}\n      <div class=\"chat-group-messages\">\n        ${group.messages.map((item, index) =>\n          renderGroupedMessage(\n            item.message,\n            {\n              isStreaming:\n                group.isStreaming && index === group.messages.length - 1,\n              showReasoning: opts.showReasoning,\n            },\n            opts.onOpenSidebar,\n          ),\n        )}\n        <div class=\"chat-group-footer\">\n          <span class=\"chat-sender-name\">${who}</span>\n          <span class=\"chat-group-timestamp\">${timestamp}</span>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderAvatar(\n  role: string,\n  assistant?: Pick<AssistantIdentity, \"name\" | \"avatar\">,\n) {\n  const normalized = normalizeRoleForGrouping(role);\n  const assistantName = assistant?.name?.trim() || \"助手\";\n  const assistantAvatar = assistant?.avatar?.trim() || \"\";\n  const initial =\n    normalized === \"user\"\n      ? \"U\"\n      : normalized === \"assistant\"\n        ? assistantName.charAt(0).toUpperCase() || \"A\"\n        : normalized === \"tool\"\n          ? \"⚙\"\n          : \"?\";\n  const className =\n    normalized === \"user\"\n      ? \"user\"\n      : normalized === \"assistant\"\n        ? \"assistant\"\n      : normalized === \"tool\"\n          ? \"tool\"\n          : \"other\";\n\n  if (assistantAvatar && normalized === \"assistant\") {\n    if (isAvatarUrl(assistantAvatar)) {\n      return html`<img\n        class=\"chat-avatar ${className}\"\n        src=\"${assistantAvatar}\"\n        alt=\"${assistantName}\"\n      />`;\n    }\n    return html`<div class=\"chat-avatar ${className}\">${assistantAvatar}</div>`;\n  }\n\n  return html`<div class=\"chat-avatar ${className}\">${initial}</div>`;\n}\n\nfunction isAvatarUrl(value: string): boolean {\n  return (\n    /^https?:\\/\\//i.test(value) ||\n    /^data:image\\//i.test(value) ||\n    /^\\//.test(value) // Relative paths from avatar endpoint\n  );\n}\n\nfunction renderMessageImages(images: ImageBlock[]) {\n  if (images.length === 0) return nothing;\n\n  return html`\n    <div class=\"chat-message-images\">\n      ${images.map(\n        (img) => html`\n          <img\n            src=${img.url}\n            alt=${img.alt ?? \"附件图片\"}\n            class=\"chat-message-image\"\n            @click=${() => window.open(img.url, \"_blank\")}\n          />\n        `,\n      )}\n    </div>\n  `;\n}\n\nfunction renderGroupedMessage(\n  message: unknown,\n  opts: { isStreaming: boolean; showReasoning: boolean },\n  onOpenSidebar?: (content: string) => void,\n) {\n  const m = message as Record<string, unknown>;\n  const role = typeof m.role === \"string\" ? m.role : \"unknown\";\n  const isToolResult =\n    isToolResultMessage(message) ||\n    role.toLowerCase() === \"toolresult\" ||\n    role.toLowerCase() === \"tool_result\" ||\n    typeof m.toolCallId === \"string\" ||\n    typeof m.tool_call_id === \"string\";\n\n  const toolCards = extractToolCards(message);\n  const hasToolCards = toolCards.length > 0;\n  const images = extractImages(message);\n  const hasImages = images.length > 0;\n\n  const extractedText = extractTextCached(message);\n  const extractedThinking =\n    opts.showReasoning && role === \"assistant\"\n      ? extractThinkingCached(message)\n      : null;\n  const markdownBase = extractedText?.trim() ? extractedText : null;\n  const reasoningMarkdown = extractedThinking\n    ? formatReasoningMarkdown(extractedThinking)\n    : null;\n  const markdown = markdownBase;\n  const canCopyMarkdown = role === \"assistant\" && Boolean(markdown?.trim());\n\n  const bubbleClasses = [\n    \"chat-bubble\",\n    canCopyMarkdown ? \"has-copy\" : \"\",\n    opts.isStreaming ? \"streaming\" : \"\",\n    \"fade-in\",\n  ]\n    .filter(Boolean)\n    .join(\" \");\n\n  if (!markdown && hasToolCards && isToolResult) {\n    return html`${toolCards.map((card) =>\n      renderToolCardSidebar(card, onOpenSidebar),\n    )}`;\n  }\n\n  if (!markdown && !hasToolCards && !hasImages) return nothing;\n\n  return html`\n    <div class=\"${bubbleClasses}\">\n      ${canCopyMarkdown ? renderCopyAsMarkdownButton(markdown!) : nothing}\n      ${renderMessageImages(images)}\n      ${reasoningMarkdown\n        ? html`<div class=\"chat-thinking\">${unsafeHTML(\n            toSanitizedMarkdownHtml(reasoningMarkdown),\n          )}</div>`\n        : nothing}\n      ${markdown\n        ? html`<div class=\"chat-text\">${unsafeHTML(toSanitizedMarkdownHtml(markdown))}</div>`\n        : nothing}\n      ${toolCards.map((card) => renderToolCardSidebar(card, onOpenSidebar))}\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\nimport { unsafeHTML } from \"lit/directives/unsafe-html.js\";\n\nimport { icons } from \"../icons\";\nimport { toSanitizedMarkdownHtml } from \"../markdown\";\n\nexport type MarkdownSidebarProps = {\n  content: string | null;\n  error: string | null;\n  onClose: () => void;\n  onViewRawText: () => void;\n};\n\nexport function renderMarkdownSidebar(props: MarkdownSidebarProps) {\n  return html`\n    <div class=\"sidebar-panel\">\n      <div class=\"sidebar-header\">\n        <div class=\"sidebar-title\">Tool Output</div>\n        <button @click=${props.onClose} class=\"btn\" title=\"Close sidebar\">\n          ${icons.x}\n        </button>\n      </div>\n      <div class=\"sidebar-content\">\n        ${props.error\n          ? html`\n              <div class=\"callout danger\">${props.error}</div>\n              <button @click=${props.onViewRawText} class=\"btn\" style=\"margin-top: 12px;\">\n                View Raw Text\n              </button>\n            `\n          : props.content\n            ? html`<div class=\"sidebar-markdown\">${unsafeHTML(toSanitizedMarkdownHtml(props.content))}</div>`\n            : html`<div class=\"muted\">No content available</div>`}\n      </div>\n    </div>\n  `;\n}\n","import { LitElement, css, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators.js\";\n\n/**\n * A draggable divider for resizable split views.\n * Dispatches 'resize' events with { splitRatio: number } detail.\n */\n@customElement(\"resizable-divider\")\nexport class ResizableDivider extends LitElement {\n  @property({ type: Number }) splitRatio = 0.6;\n  @property({ type: Number }) minRatio = 0.4;\n  @property({ type: Number }) maxRatio = 0.7;\n\n  private isDragging = false;\n  private startX = 0;\n  private startRatio = 0;\n\n  static styles = css`\n    :host {\n      width: 4px;\n      cursor: col-resize;\n      background: var(--border, #333);\n      transition: background 150ms ease-out;\n      flex-shrink: 0;\n      position: relative;\n    }\n    \n    :host::before {\n      content: \"\";\n      position: absolute;\n      top: 0;\n      left: -4px;\n      right: -4px;\n      bottom: 0;\n    }\n    \n    :host(:hover) {\n      background: var(--accent, #007bff);\n    }\n    \n    :host(.dragging) {\n      background: var(--accent, #007bff);\n    }\n  `;\n\n  render() {\n    return nothing;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    this.addEventListener(\"mousedown\", this.handleMouseDown);\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    this.removeEventListener(\"mousedown\", this.handleMouseDown);\n    document.removeEventListener(\"mousemove\", this.handleMouseMove);\n    document.removeEventListener(\"mouseup\", this.handleMouseUp);\n  }\n\n  private handleMouseDown = (e: MouseEvent) => {\n    this.isDragging = true;\n    this.startX = e.clientX;\n    this.startRatio = this.splitRatio;\n    this.classList.add(\"dragging\");\n\n    document.addEventListener(\"mousemove\", this.handleMouseMove);\n    document.addEventListener(\"mouseup\", this.handleMouseUp);\n\n    e.preventDefault();\n  };\n\n  private handleMouseMove = (e: MouseEvent) => {\n    if (!this.isDragging) return;\n\n    const container = this.parentElement;\n    if (!container) return;\n\n    const containerWidth = container.getBoundingClientRect().width;\n    const deltaX = e.clientX - this.startX;\n    const deltaRatio = deltaX / containerWidth;\n\n    let newRatio = this.startRatio + deltaRatio;\n    newRatio = Math.max(this.minRatio, Math.min(this.maxRatio, newRatio));\n\n    this.dispatchEvent(\n      new CustomEvent(\"resize\", {\n        detail: { splitRatio: newRatio },\n        bubbles: true,\n        composed: true,\n      })\n    );\n  };\n\n  private handleMouseUp = () => {\n    this.isDragging = false;\n    this.classList.remove(\"dragging\");\n\n    document.removeEventListener(\"mousemove\", this.handleMouseMove);\n    document.removeEventListener(\"mouseup\", this.handleMouseUp);\n  };\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"resizable-divider\": ResizableDivider;\n  }\n}\n","import { html, nothing } from \"lit\";\nimport { ref } from \"lit/directives/ref.js\";\nimport { repeat } from \"lit/directives/repeat.js\";\nimport type { SessionsListResult } from \"../types\";\nimport type { ChatItem, MessageGroup } from \"../types/chat-types\";\nimport type { ChatAttachment, ChatQueueItem } from \"../ui-types\";\nimport {\n  renderMessageGroup,\n  renderReadingIndicatorGroup,\n  renderStreamingGroup,\n} from \"../chat/grouped-render\";\nimport { normalizeMessage, normalizeRoleForGrouping } from \"../chat/message-normalizer\";\nimport { icons } from \"../icons\";\nimport { renderMarkdownSidebar } from \"./markdown-sidebar\";\nimport \"../components/resizable-divider\";\n\nexport type CompactionIndicatorStatus = {\n  active: boolean;\n  startedAt: number | null;\n  completedAt: number | null;\n};\n\nexport type ChatProps = {\n  sessionKey: string;\n  onSessionKeyChange: (next: string) => void;\n  thinkingLevel: string | null;\n  showThinking: boolean;\n  loading: boolean;\n  sending: boolean;\n  canAbort?: boolean;\n  compactionStatus?: CompactionIndicatorStatus | null;\n  messages: unknown[];\n  toolMessages: unknown[];\n  stream: string | null;\n  streamStartedAt: number | null;\n  assistantAvatarUrl?: string | null;\n  draft: string;\n  queue: ChatQueueItem[];\n  connected: boolean;\n  canSend: boolean;\n  disabledReason: string | null;\n  error: string | null;\n  sessions: SessionsListResult | null;\n  // Focus mode\n  focusMode: boolean;\n  // Sidebar state\n  sidebarOpen?: boolean;\n  sidebarContent?: string | null;\n  sidebarError?: string | null;\n  splitRatio?: number;\n  assistantName: string;\n  assistantAvatar: string | null;\n  // Image attachments\n  attachments?: ChatAttachment[];\n  onAttachmentsChange?: (attachments: ChatAttachment[]) => void;\n  // Scroll control\n  showNewMessages?: boolean;\n  onScrollToBottom?: () => void;\n  // Event handlers\n  onRefresh: () => void;\n  onToggleFocusMode: () => void;\n  onDraftChange: (next: string) => void;\n  onSend: () => void;\n  onAbort?: () => void;\n  onQueueRemove: (id: string) => void;\n  onNewSession: () => void;\n  onOpenSidebar?: (content: string) => void;\n  onCloseSidebar?: () => void;\n  onSplitRatioChange?: (ratio: number) => void;\n  onChatScroll?: (event: Event) => void;\n};\n\nconst COMPACTION_TOAST_DURATION_MS = 5000;\n\nfunction adjustTextareaHeight(el: HTMLTextAreaElement) {\n  el.style.height = \"auto\";\n  el.style.height = `${el.scrollHeight}px`;\n}\n\nfunction renderCompactionIndicator(status: CompactionIndicatorStatus | null | undefined) {\n  if (!status) {\n    return nothing;\n  }\n\n  // Show \"compacting...\" while active\n  if (status.active) {\n    return html`\n      <div class=\"callout info compaction-indicator compaction-indicator--active\">\n        ${icons.loader} 正在压缩上下文...\n      </div>\n    `;\n  }\n\n  // Show \"compaction complete\" briefly after completion\n  if (status.completedAt) {\n    const elapsed = Date.now() - status.completedAt;\n    if (elapsed < COMPACTION_TOAST_DURATION_MS) {\n      return html`\n        <div class=\"callout success compaction-indicator compaction-indicator--complete\">\n          ${icons.check} 上下文已压缩\n        </div>\n      `;\n    }\n  }\n\n  return nothing;\n}\n\nfunction generateAttachmentId(): string {\n  return `att-${Date.now()}-${Math.random().toString(36).slice(2, 9)}`;\n}\n\nfunction handlePaste(e: ClipboardEvent, props: ChatProps) {\n  const items = e.clipboardData?.items;\n  if (!items || !props.onAttachmentsChange) {\n    return;\n  }\n\n  const imageItems: DataTransferItem[] = [];\n  for (let i = 0; i < items.length; i++) {\n    const item = items[i];\n    if (item.type.startsWith(\"image/\")) {\n      imageItems.push(item);\n    }\n  }\n\n  if (imageItems.length === 0) {\n    return;\n  }\n\n  e.preventDefault();\n\n  for (const item of imageItems) {\n    const file = item.getAsFile();\n    if (!file) {\n      continue;\n    }\n\n    const reader = new FileReader();\n    reader.addEventListener(\"load\", () => {\n      const dataUrl = reader.result as string;\n      const newAttachment: ChatAttachment = {\n        id: generateAttachmentId(),\n        dataUrl,\n        mimeType: file.type,\n      };\n      const current = props.attachments ?? [];\n      props.onAttachmentsChange?.([...current, newAttachment]);\n    });\n    reader.readAsDataURL(file);\n  }\n}\n\nfunction renderAttachmentPreview(props: ChatProps) {\n  const attachments = props.attachments ?? [];\n  if (attachments.length === 0) {\n    return nothing;\n  }\n\n  return html`\n    <div class=\"chat-attachments\">\n      ${attachments.map(\n        (att) => html`\n          <div class=\"chat-attachment\">\n            <img\n              src=${att.dataUrl}\n              alt=\"附件预览\"\n              class=\"chat-attachment__img\"\n            />\n            <button\n              class=\"chat-attachment__remove\"\n              type=\"button\"\n              aria-label=\"移除附件\"\n              @click=${() => {\n                const next = (props.attachments ?? []).filter((a) => a.id !== att.id);\n                props.onAttachmentsChange?.(next);\n              }}\n            >\n              ${icons.x}\n            </button>\n          </div>\n        `,\n      )}\n    </div>\n  `;\n}\n\nexport function renderChat(props: ChatProps) {\n  const canCompose = props.connected;\n  const isBusy = props.sending || props.stream !== null;\n  const canAbort = Boolean(props.canAbort && props.onAbort);\n  const activeSession = props.sessions?.sessions?.find((row) => row.key === props.sessionKey);\n  const reasoningLevel = activeSession?.reasoningLevel ?? \"off\";\n  const showReasoning = props.showThinking && reasoningLevel !== \"off\";\n  const assistantIdentity = {\n    name: props.assistantName,\n    avatar: props.assistantAvatar ?? props.assistantAvatarUrl ?? null,\n  };\n\n  const hasAttachments = (props.attachments?.length ?? 0) > 0;\n  const composePlaceholder = props.connected\n    ? hasAttachments\n      ? \"添加消息或粘贴更多图片...\"\n      : \"消息（↩ 发送，Shift+↩ 换行，可粘贴图片）\"\n    : \"连接网关以开始对话…\";\n\n  const splitRatio = props.splitRatio ?? 0.6;\n  const sidebarOpen = Boolean(props.sidebarOpen && props.onCloseSidebar);\n  const thread = html`\n    <div\n      class=\"chat-thread\"\n      role=\"log\"\n      aria-live=\"polite\"\n      @scroll=${props.onChatScroll}\n    >\n      ${\n        props.loading\n          ? html`\n              <div class=\"muted\">正在加载对话…</div>\n            `\n          : nothing\n      }\n      ${repeat(\n        buildChatItems(props),\n        (item) => item.key,\n        (item) => {\n          if (item.kind === \"reading-indicator\") {\n            return renderReadingIndicatorGroup(assistantIdentity);\n          }\n\n          if (item.kind === \"stream\") {\n            return renderStreamingGroup(\n              item.text,\n              item.startedAt,\n              props.onOpenSidebar,\n              assistantIdentity,\n            );\n          }\n\n          if (item.kind === \"group\") {\n            return renderMessageGroup(item, {\n              onOpenSidebar: props.onOpenSidebar,\n              showReasoning,\n              assistantName: props.assistantName,\n              assistantAvatar: assistantIdentity.avatar,\n            });\n          }\n\n          return nothing;\n        },\n      )}\n    </div>\n  `;\n\n  return html`\n    <section class=\"card chat\">\n      ${props.disabledReason ? html`<div class=\"callout\">${props.disabledReason}</div>` : nothing}\n\n      ${props.error ? html`<div class=\"callout danger\">${props.error}</div>` : nothing}\n\n      ${renderCompactionIndicator(props.compactionStatus)}\n\n      ${\n        props.focusMode\n          ? html`\n            <button\n              class=\"chat-focus-exit\"\n              type=\"button\"\n              @click=${props.onToggleFocusMode}\n              aria-label=\"退出专注模式\"\n              title=\"退出专注模式\"\n            >\n              ${icons.x}\n            </button>\n          `\n          : nothing\n      }\n\n      <div\n        class=\"chat-split-container ${sidebarOpen ? \"chat-split-container--open\" : \"\"}\"\n      >\n        <div\n          class=\"chat-main\"\n          style=\"flex: ${sidebarOpen ? `0 0 ${splitRatio * 100}%` : \"1 1 100%\"}\"\n        >\n          ${thread}\n        </div>\n\n        ${\n          sidebarOpen\n            ? html`\n              <resizable-divider\n                .splitRatio=${splitRatio}\n                @resize=${(e: CustomEvent) => props.onSplitRatioChange?.(e.detail.splitRatio)}\n              ></resizable-divider>\n              <div class=\"chat-sidebar\">\n                ${renderMarkdownSidebar({\n                  content: props.sidebarContent ?? null,\n                  error: props.sidebarError ?? null,\n                  onClose: props.onCloseSidebar!,\n                  onViewRawText: () => {\n                    if (!props.sidebarContent || !props.onOpenSidebar) {\n                      return;\n                    }\n                    props.onOpenSidebar(`\\`\\`\\`\\n${props.sidebarContent}\\n\\`\\`\\``);\n                  },\n                })}\n              </div>\n            `\n            : nothing\n        }\n      </div>\n\n      ${\n        props.queue.length\n          ? html`\n            <div class=\"chat-queue\" role=\"status\" aria-live=\"polite\">\n              <div class=\"chat-queue__title\">队列 (${props.queue.length})</div>\n              <div class=\"chat-queue__list\">\n                ${props.queue.map(\n                  (item) => html`\n                    <div class=\"chat-queue__item\">\n                      <div class=\"chat-queue__text\">\n                        ${\n                          item.text ||\n                          (item.attachments?.length ? `图片 (${item.attachments.length})` : \"\")\n                        }\n                      </div>\n                      <button\n                        class=\"btn chat-queue__remove\"\n                        type=\"button\"\n                        aria-label=\"移除队列消息\"\n                        @click=${() => props.onQueueRemove(item.id)}\n                      >\n                        ${icons.x}\n                      </button>\n                    </div>\n                  `,\n                )}\n              </div>\n            </div>\n          `\n          : nothing\n      }\n\n      ${\n        props.showNewMessages\n          ? html`\n            <button\n              class=\"chat-new-messages\"\n              type=\"button\"\n              @click=${props.onScrollToBottom}\n            >\n              新消息 ${icons.arrowDown}\n            </button>\n          `\n          : nothing\n      }\n\n      <div class=\"chat-compose\">\n        ${renderAttachmentPreview(props)}\n        <div class=\"chat-compose__row\">\n          <label class=\"field chat-compose__field\">\n            <span>消息</span>\n            <textarea\n              ${ref((el) => el && adjustTextareaHeight(el as HTMLTextAreaElement))}\n              .value=${props.draft}\n              ?disabled=${!props.connected}\n              @keydown=${(e: KeyboardEvent) => {\n                if (e.key !== \"Enter\") {\n                  return;\n                }\n                if (e.isComposing || e.keyCode === 229) {\n                  return;\n                }\n                if (e.shiftKey) {\n                  return;\n                } // Allow Shift+Enter for line breaks\n                if (!props.connected) {\n                  return;\n                }\n                e.preventDefault();\n                if (canCompose) {\n                  props.onSend();\n                }\n              }}\n              @input=${(e: Event) => {\n                const target = e.target as HTMLTextAreaElement;\n                adjustTextareaHeight(target);\n                props.onDraftChange(target.value);\n              }}\n              @paste=${(e: ClipboardEvent) => handlePaste(e, props)}\n              placeholder=${composePlaceholder}\n            ></textarea>\n          </label>\n          <div class=\"chat-compose__actions\">\n            <button\n              class=\"btn\"\n              ?disabled=${!props.connected || (!canAbort && props.sending)}\n              @click=${canAbort ? props.onAbort : props.onNewSession}\n            >\n              ${canAbort ? \"停止\" : \"新会话\"}\n            </button>\n            <button\n              class=\"btn primary\"\n              ?disabled=${!props.connected}\n              @click=${props.onSend}\n            >\n              ${isBusy ? \"队列\" : \"发送\"}<kbd class=\"btn-kbd\">↵</kbd>\n            </button>\n          </div>\n        </div>\n      </div>\n    </section>\n  `;\n}\n\nconst CHAT_HISTORY_RENDER_LIMIT = 200;\n\nfunction groupMessages(items: ChatItem[]): Array<ChatItem | MessageGroup> {\n  const result: Array<ChatItem | MessageGroup> = [];\n  let currentGroup: MessageGroup | null = null;\n\n  for (const item of items) {\n    if (item.kind !== \"message\") {\n      if (currentGroup) {\n        result.push(currentGroup);\n        currentGroup = null;\n      }\n      result.push(item);\n      continue;\n    }\n\n    const normalized = normalizeMessage(item.message);\n    const role = normalizeRoleForGrouping(normalized.role);\n    const timestamp = normalized.timestamp || Date.now();\n\n    if (!currentGroup || currentGroup.role !== role) {\n      if (currentGroup) {\n        result.push(currentGroup);\n      }\n      currentGroup = {\n        kind: \"group\",\n        key: `group:${role}:${item.key}`,\n        role,\n        messages: [{ message: item.message, key: item.key }],\n        timestamp,\n        isStreaming: false,\n      };\n    } else {\n      currentGroup.messages.push({ message: item.message, key: item.key });\n    }\n  }\n\n  if (currentGroup) {\n    result.push(currentGroup);\n  }\n  return result;\n}\n\nfunction buildChatItems(props: ChatProps): Array<ChatItem | MessageGroup> {\n  const items: ChatItem[] = [];\n  const history = Array.isArray(props.messages) ? props.messages : [];\n  const tools = Array.isArray(props.toolMessages) ? props.toolMessages : [];\n  const historyStart = Math.max(0, history.length - CHAT_HISTORY_RENDER_LIMIT);\n  if (historyStart > 0) {\n    items.push({\n      kind: \"message\",\n      key: \"chat:history:notice\",\n      message: {\n        role: \"system\",\n        content: `Showing last ${CHAT_HISTORY_RENDER_LIMIT} messages (${historyStart} hidden).`,\n        timestamp: Date.now(),\n      },\n    });\n  }\n  for (let i = historyStart; i < history.length; i++) {\n    const msg = history[i];\n    const normalized = normalizeMessage(msg);\n\n    if (!props.showThinking && normalized.role.toLowerCase() === \"toolresult\") {\n      continue;\n    }\n\n    items.push({\n      kind: \"message\",\n      key: messageKey(msg, i),\n      message: msg,\n    });\n  }\n  if (props.showThinking) {\n    for (let i = 0; i < tools.length; i++) {\n      items.push({\n        kind: \"message\",\n        key: messageKey(tools[i], i + history.length),\n        message: tools[i],\n      });\n    }\n  }\n\n  if (props.stream !== null) {\n    const key = `stream:${props.sessionKey}:${props.streamStartedAt ?? \"live\"}`;\n    if (props.stream.trim().length > 0) {\n      items.push({\n        kind: \"stream\",\n        key,\n        text: props.stream,\n        startedAt: props.streamStartedAt ?? Date.now(),\n      });\n    } else {\n      items.push({ kind: \"reading-indicator\", key });\n    }\n  }\n\n  return groupMessages(items);\n}\n\nfunction messageKey(message: unknown, index: number): string {\n  const m = message as Record<string, unknown>;\n  const toolCallId = typeof m.toolCallId === \"string\" ? m.toolCallId : \"\";\n  if (toolCallId) {\n    return `tool:${toolCallId}`;\n  }\n  const id = typeof m.id === \"string\" ? m.id : \"\";\n  if (id) {\n    return `msg:${id}`;\n  }\n  const messageId = typeof m.messageId === \"string\" ? m.messageId : \"\";\n  if (messageId) {\n    return `msg:${messageId}`;\n  }\n  const timestamp = typeof m.timestamp === \"number\" ? m.timestamp : null;\n  const role = typeof m.role === \"string\" ? m.role : \"unknown\";\n  if (timestamp != null) {\n    return `msg:${role}:${timestamp}:${index}`;\n  }\n  return `msg:${role}:${index}`;\n}\n","import { html, nothing } from \"lit\";\nimport type { ConfigUiHints } from \"../types\";\nimport { analyzeConfigSchema, renderConfigForm, SECTION_META } from \"./config-form\";\nimport {\n  hintForPath,\n  humanize,\n  schemaType,\n  type JsonSchema,\n} from \"./config-form.shared\";\n\nexport type ConfigProps = {\n  raw: string;\n  originalRaw: string;\n  valid: boolean | null;\n  issues: unknown[];\n  loading: boolean;\n  saving: boolean;\n  applying: boolean;\n  updating: boolean;\n  connected: boolean;\n  schema: unknown | null;\n  schemaLoading: boolean;\n  uiHints: ConfigUiHints;\n  formMode: \"form\" | \"raw\";\n  formValue: Record<string, unknown> | null;\n  originalValue: Record<string, unknown> | null;\n  searchQuery: string;\n  activeSection: string | null;\n  activeSubsection: string | null;\n  onRawChange: (next: string) => void;\n  onFormModeChange: (mode: \"form\" | \"raw\") => void;\n  onFormPatch: (path: Array<string | number>, value: unknown) => void;\n  onSearchChange: (query: string) => void;\n  onSectionChange: (section: string | null) => void;\n  onSubsectionChange: (section: string | null) => void;\n  onReload: () => void;\n  onSave: () => void;\n  onApply: () => void;\n  onUpdate: () => void;\n};\n\n// SVG Icons for sidebar (Lucide-style)\nconst sidebarIcons = {\n  all: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"7\" height=\"7\"></rect><rect x=\"14\" y=\"3\" width=\"7\" height=\"7\"></rect><rect x=\"14\" y=\"14\" width=\"7\" height=\"7\"></rect><rect x=\"3\" y=\"14\" width=\"7\" height=\"7\"></rect></svg>`,\n  env: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"3\"></circle><path d=\"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z\"></path></svg>`,\n  update: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"></path><polyline points=\"7 10 12 15 17 10\"></polyline><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"></line></svg>`,\n  agents: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2z\"></path><circle cx=\"8\" cy=\"14\" r=\"1\"></circle><circle cx=\"16\" cy=\"14\" r=\"1\"></circle></svg>`,\n  auth: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\"></rect><path d=\"M7 11V7a5 5 0 0 1 10 0v4\"></path></svg>`,\n  channels: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"></path></svg>`,\n  messages: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z\"></path><polyline points=\"22,6 12,13 2,6\"></polyline></svg>`,\n  commands: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"4 17 10 11 4 5\"></polyline><line x1=\"12\" y1=\"19\" x2=\"20\" y2=\"19\"></line></svg>`,\n  hooks: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"></path><path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"></path></svg>`,\n  skills: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polygon points=\"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2\"></polygon></svg>`,\n  tools: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z\"></path></svg>`,\n  gateway: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"2\" y1=\"12\" x2=\"22\" y2=\"12\"></line><path d=\"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z\"></path></svg>`,\n  wizard: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M15 4V2\"></path><path d=\"M15 16v-2\"></path><path d=\"M8 9h2\"></path><path d=\"M20 9h2\"></path><path d=\"M17.8 11.8 19 13\"></path><path d=\"M15 9h0\"></path><path d=\"M17.8 6.2 19 5\"></path><path d=\"m3 21 9-9\"></path><path d=\"M12.2 6.2 11 5\"></path></svg>`,\n  // Additional sections\n  meta: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 20h9\"></path><path d=\"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z\"></path></svg>`,\n  logging: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"></path><polyline points=\"14 2 14 8 20 8\"></polyline><line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"></line><line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"></line><polyline points=\"10 9 9 9 8 9\"></polyline></svg>`,\n  browser: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><circle cx=\"12\" cy=\"12\" r=\"4\"></circle><line x1=\"21.17\" y1=\"8\" x2=\"12\" y2=\"8\"></line><line x1=\"3.95\" y1=\"6.06\" x2=\"8.54\" y2=\"14\"></line><line x1=\"10.88\" y1=\"21.94\" x2=\"15.46\" y2=\"14\"></line></svg>`,\n  ui: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><line x1=\"3\" y1=\"9\" x2=\"21\" y2=\"9\"></line><line x1=\"9\" y1=\"21\" x2=\"9\" y2=\"9\"></line></svg>`,\n  models: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z\"></path><polyline points=\"3.27 6.96 12 12.01 20.73 6.96\"></polyline><line x1=\"12\" y1=\"22.08\" x2=\"12\" y2=\"12\"></line></svg>`,\n  bindings: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"2\" y=\"2\" width=\"20\" height=\"8\" rx=\"2\" ry=\"2\"></rect><rect x=\"2\" y=\"14\" width=\"20\" height=\"8\" rx=\"2\" ry=\"2\"></rect><line x1=\"6\" y1=\"6\" x2=\"6.01\" y2=\"6\"></line><line x1=\"6\" y1=\"18\" x2=\"6.01\" y2=\"18\"></line></svg>`,\n  broadcast: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M4.9 19.1C1 15.2 1 8.8 4.9 4.9\"></path><path d=\"M7.8 16.2c-2.3-2.3-2.3-6.1 0-8.5\"></path><circle cx=\"12\" cy=\"12\" r=\"2\"></circle><path d=\"M16.2 7.8c2.3 2.3 2.3 6.1 0 8.5\"></path><path d=\"M19.1 4.9C23 8.8 23 15.1 19.1 19\"></path></svg>`,\n  audio: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M9 18V5l12-2v13\"></path><circle cx=\"6\" cy=\"18\" r=\"3\"></circle><circle cx=\"18\" cy=\"16\" r=\"3\"></circle></svg>`,\n  session: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2\"></path><circle cx=\"9\" cy=\"7\" r=\"4\"></circle><path d=\"M23 21v-2a4 4 0 0 0-3-3.87\"></path><path d=\"M16 3.13a4 4 0 0 1 0 7.75\"></path></svg>`,\n  cron: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><polyline points=\"12 6 12 12 16 14\"></polyline></svg>`,\n  web: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"></circle><line x1=\"2\" y1=\"12\" x2=\"22\" y2=\"12\"></line><path d=\"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z\"></path></svg>`,\n  discovery: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"11\" cy=\"11\" r=\"8\"></circle><line x1=\"21\" y1=\"21\" x2=\"16.65\" y2=\"16.65\"></line></svg>`,\n  canvasHost: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect><circle cx=\"8.5\" cy=\"8.5\" r=\"1.5\"></circle><polyline points=\"21 15 16 10 5 21\"></polyline></svg>`,\n  talk: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z\"></path><path d=\"M19 10v2a7 7 0 0 1-14 0v-2\"></path><line x1=\"12\" y1=\"19\" x2=\"12\" y2=\"23\"></line><line x1=\"8\" y1=\"23\" x2=\"16\" y2=\"23\"></line></svg>`,\n  plugins: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 2v6\"></path><path d=\"m4.93 10.93 4.24 4.24\"></path><path d=\"M2 12h6\"></path><path d=\"m4.93 13.07 4.24-4.24\"></path><path d=\"M12 22v-6\"></path><path d=\"m19.07 13.07-4.24-4.24\"></path><path d=\"M22 12h-6\"></path><path d=\"m19.07 10.93-4.24 4.24\"></path></svg>`,\n  default: html`<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"></path><polyline points=\"14 2 14 8 20 8\"></polyline></svg>`,\n};\n\n// Section definitions\nconst SECTIONS: Array<{ key: string; label: string }> = [\n  { key: \"env\", label: \"环境\" },\n  { key: \"update\", label: \"更新\" },\n  { key: \"agents\", label: \"代理\" },\n  { key: \"auth\", label: \"身份验证\" },\n  { key: \"channels\", label: \"通道\" },\n  { key: \"messages\", label: \"消息\" },\n  { key: \"commands\", label: \"命令\" },\n  { key: \"hooks\", label: \"钩子\" },\n  { key: \"skills\", label: \"技能\" },\n  { key: \"tools\", label: \"工具\" },\n  { key: \"gateway\", label: \"网关\" },\n  { key: \"wizard\", label: \"设置向导\" },\n];\n\ntype SubsectionEntry = {\n  key: string;\n  label: string;\n  description?: string;\n  order: number;\n};\n\nconst ALL_SUBSECTION = \"__all__\";\n\nfunction getSectionIcon(key: string) {\n  return sidebarIcons[key as keyof typeof sidebarIcons] ?? sidebarIcons.default;\n}\n\nfunction resolveSectionMeta(key: string, schema?: JsonSchema): {\n  label: string;\n  description?: string;\n} {\n  const meta = SECTION_META[key];\n  if (meta) return meta;\n  return {\n    label: schema?.title ?? humanize(key),\n    description: schema?.description ?? \"\",\n  };\n}\n\nfunction resolveSubsections(params: {\n  key: string;\n  schema: JsonSchema | undefined;\n  uiHints: ConfigUiHints;\n}): SubsectionEntry[] {\n  const { key, schema, uiHints } = params;\n  if (!schema || schemaType(schema) !== \"object\" || !schema.properties) return [];\n  const entries = Object.entries(schema.properties).map(([subKey, node]) => {\n    const hint = hintForPath([key, subKey], uiHints);\n    const label = hint?.label ?? node.title ?? humanize(subKey);\n    const description = hint?.help ?? node.description ?? \"\";\n    const order = hint?.order ?? 50;\n    return { key: subKey, label, description, order };\n  });\n  entries.sort((a, b) => (a.order !== b.order ? a.order - b.order : a.key.localeCompare(b.key)));\n  return entries;\n}\n\nfunction computeDiff(\n  original: Record<string, unknown> | null,\n  current: Record<string, unknown> | null\n): Array<{ path: string; from: unknown; to: unknown }> {\n  if (!original || !current) return [];\n  const changes: Array<{ path: string; from: unknown; to: unknown }> = [];\n\n  function compare(orig: unknown, curr: unknown, path: string) {\n    if (orig === curr) return;\n    if (typeof orig !== typeof curr) {\n      changes.push({ path, from: orig, to: curr });\n      return;\n    }\n    if (typeof orig !== \"object\" || orig === null || curr === null) {\n      if (orig !== curr) {\n        changes.push({ path, from: orig, to: curr });\n      }\n      return;\n    }\n    if (Array.isArray(orig) && Array.isArray(curr)) {\n      if (JSON.stringify(orig) !== JSON.stringify(curr)) {\n        changes.push({ path, from: orig, to: curr });\n      }\n      return;\n    }\n    const origObj = orig as Record<string, unknown>;\n    const currObj = curr as Record<string, unknown>;\n    const allKeys = new Set([...Object.keys(origObj), ...Object.keys(currObj)]);\n    for (const key of allKeys) {\n      compare(origObj[key], currObj[key], path ? `${path}.${key}` : key);\n    }\n  }\n\n  compare(original, current, \"\");\n  return changes;\n}\n\nfunction truncateValue(value: unknown, maxLen = 40): string {\n  let str: string;\n  try {\n    const json = JSON.stringify(value);\n    str = json ?? String(value);\n  } catch {\n    str = String(value);\n  }\n  if (str.length <= maxLen) return str;\n  return str.slice(0, maxLen - 3) + \"...\";\n}\n\nexport function renderConfig(props: ConfigProps) {\n  const validity =\n    props.valid == null ? \"unknown\" : props.valid ? \"valid\" : \"invalid\";\n  const analysis = analyzeConfigSchema(props.schema);\n  const formUnsafe = analysis.schema\n    ? analysis.unsupportedPaths.length > 0\n    : false;\n\n  // Get available sections from schema\n  const schemaProps = analysis.schema?.properties ?? {};\n  const availableSections = SECTIONS.filter(s => s.key in schemaProps);\n\n  // Add any sections in schema but not in our list\n  const knownKeys = new Set(SECTIONS.map(s => s.key));\n  const extraSections = Object.keys(schemaProps)\n    .filter(k => !knownKeys.has(k))\n    .map(k => ({ key: k, label: k.charAt(0).toUpperCase() + k.slice(1) }));\n\n  const allSections = [...availableSections, ...extraSections];\n\n  const activeSectionSchema =\n    props.activeSection && analysis.schema && schemaType(analysis.schema) === \"object\"\n      ? (analysis.schema.properties?.[props.activeSection] as JsonSchema | undefined)\n      : undefined;\n  const activeSectionMeta = props.activeSection\n    ? resolveSectionMeta(props.activeSection, activeSectionSchema)\n    : null;\n  const subsections = props.activeSection\n    ? resolveSubsections({\n        key: props.activeSection,\n        schema: activeSectionSchema,\n        uiHints: props.uiHints,\n      })\n    : [];\n  const allowSubnav =\n    props.formMode === \"form\" &&\n    Boolean(props.activeSection) &&\n    subsections.length > 0;\n  const isAllSubsection = props.activeSubsection === ALL_SUBSECTION;\n  const effectiveSubsection = props.searchQuery\n    ? null\n    : isAllSubsection\n      ? null\n      : props.activeSubsection ?? (subsections[0]?.key ?? null);\n\n  // Compute diff for showing changes (works for both form and raw modes)\n  const diff = props.formMode === \"form\"\n    ? computeDiff(props.originalValue, props.formValue)\n    : [];\n  const hasRawChanges = props.formMode === \"raw\" && props.raw !== props.originalRaw;\n  const hasChanges = props.formMode === \"form\" ? diff.length > 0 : hasRawChanges;\n\n  // Save/apply buttons require actual changes to be enabled.\n  // Note: formUnsafe warns about unsupported schema paths but shouldn't block saving.\n  const canSaveForm =\n    Boolean(props.formValue) && !props.loading && Boolean(analysis.schema);\n  const canSave =\n    props.connected &&\n    !props.saving &&\n    hasChanges &&\n    (props.formMode === \"raw\" ? true : canSaveForm);\n  const canApply =\n    props.connected &&\n    !props.applying &&\n    !props.updating &&\n    hasChanges &&\n    (props.formMode === \"raw\" ? true : canSaveForm);\n  const canUpdate = props.connected && !props.applying && !props.updating;\n\n  return html`\n    <div class=\"config-layout\">\n      <!-- Sidebar -->\n      <aside class=\"config-sidebar\">\n        <div class=\"config-sidebar__header\">\n          <div class=\"config-sidebar__title\">设置</div>\n          <span class=\"pill pill--sm ${validity === \"valid\" ? \"pill--ok\" : validity === \"invalid\" ? \"pill--danger\" : \"\"}\">${validity}</span>\n        </div>\n\n        <!-- Search -->\n        <div class=\"config-search\">\n          <svg class=\"config-search__icon\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <circle cx=\"11\" cy=\"11\" r=\"8\"></circle>\n            <path d=\"M21 21l-4.35-4.35\"></path>\n          </svg>\n          <input\n            type=\"text\"\n            class=\"config-search__input\"\n            placeholder=\"搜索设置...\"\n            .value=${props.searchQuery}\n            @input=${(e: Event) => props.onSearchChange((e.target as HTMLInputElement).value)}\n          />\n          ${props.searchQuery ? html`\n            <button\n              class=\"config-search__clear\"\n              @click=${() => props.onSearchChange(\"\")}\n            >×</button>\n          ` : nothing}\n        </div>\n\n        <!-- Section nav -->\n        <nav class=\"config-nav\">\n          <button\n            class=\"config-nav__item ${props.activeSection === null ? \"active\" : \"\"}\"\n            @click=${() => props.onSectionChange(null)}\n          >\n            <span class=\"config-nav__icon\">${sidebarIcons.all}</span>\n            <span class=\"config-nav__label\">所有设置</span>\n          </button>\n          ${allSections.map(section => html`\n            <button\n              class=\"config-nav__item ${props.activeSection === section.key ? \"active\" : \"\"}\"\n              @click=${() => props.onSectionChange(section.key)}\n            >\n              <span class=\"config-nav__icon\">${getSectionIcon(section.key)}</span>\n              <span class=\"config-nav__label\">${section.label}</span>\n            </button>\n          `)}\n        </nav>\n\n        <!-- Mode toggle at bottom -->\n        <div class=\"config-sidebar__footer\">\n          <div class=\"config-mode-toggle\">\n            <button\n              class=\"config-mode-toggle__btn ${props.formMode === \"form\" ? \"active\" : \"\"}\"\n              ?disabled=${props.schemaLoading || !props.schema}\n              @click=${() => props.onFormModeChange(\"form\")}\n            >\n              表单\n            </button>\n            <button\n              class=\"config-mode-toggle__btn ${props.formMode === \"raw\" ? \"active\" : \"\"}\"\n              @click=${() => props.onFormModeChange(\"raw\")}\n            >\n              原始\n            </button>\n          </div>\n        </div>\n      </aside>\n\n      <!-- Main content -->\n      <main class=\"config-main\">\n        <!-- Action bar -->\n        <div class=\"config-actions\">\n          <div class=\"config-actions__left\">\n            ${hasChanges ? html`\n              <span class=\"config-changes-badge\">${props.formMode === \"raw\" ? \"未保存的更改\" : `${diff.length} 个未保存的更改`}</span>\n            ` : html`\n              <span class=\"config-status muted\">无更改</span>\n            `}\n          </div>\n          <div class=\"config-actions__right\">\n            <button class=\"btn btn--sm\" ?disabled=${props.loading} @click=${props.onReload}>\n              ${props.loading ? \"加载中…\" : \"重新加载\"}\n            </button>\n            <button\n              class=\"btn btn--sm primary\"\n              ?disabled=${!canSave}\n              @click=${props.onSave}\n            >\n              ${props.saving ? \"保存中…\" : \"保存\"}\n            </button>\n            <button\n              class=\"btn btn--sm\"\n              ?disabled=${!canApply}\n              @click=${props.onApply}\n            >\n              ${props.applying ? \"应用中…\" : \"应用\"}\n            </button>\n            <button\n              class=\"btn btn--sm\"\n              ?disabled=${!canUpdate}\n              @click=${props.onUpdate}\n            >\n              ${props.updating ? \"更新中…\" : \"更新\"}\n            </button>\n          </div>\n        </div>\n\n        <!-- Diff panel (form mode only - raw mode doesn't have granular diff) -->\n        ${hasChanges && props.formMode === \"form\" ? html`\n          <details class=\"config-diff\">\n            <summary class=\"config-diff__summary\">\n              <span>查看 ${diff.length} 个待处理的更改</span>\n              <svg class=\"config-diff__chevron\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                <polyline points=\"6 9 12 15 18 9\"></polyline>\n              </svg>\n            </summary>\n            <div class=\"config-diff__content\">\n              ${diff.map(change => html`\n                <div class=\"config-diff__item\">\n                  <div class=\"config-diff__path\">${change.path}</div>\n                  <div class=\"config-diff__values\">\n                    <span class=\"config-diff__from\">${truncateValue(change.from)}</span>\n                    <span class=\"config-diff__arrow\">→</span>\n                    <span class=\"config-diff__to\">${truncateValue(change.to)}</span>\n                  </div>\n                </div>\n              `)}\n            </div>\n          </details>\n        ` : nothing}\n\n        ${activeSectionMeta && props.formMode === \"form\"\n          ? html`\n              <div class=\"config-section-hero\">\n                <div class=\"config-section-hero__icon\">${getSectionIcon(props.activeSection ?? \"\")}</div>\n                <div class=\"config-section-hero__text\">\n                  <div class=\"config-section-hero__title\">${activeSectionMeta.label}</div>\n                  ${activeSectionMeta.description\n                    ? html`<div class=\"config-section-hero__desc\">${activeSectionMeta.description}</div>`\n                    : nothing}\n                </div>\n              </div>\n            `\n          : nothing}\n\n        ${allowSubnav\n          ? html`\n              <div class=\"config-subnav\">\n                <button\n                  class=\"config-subnav__item ${effectiveSubsection === null ? \"active\" : \"\"}\"\n                  @click=${() => props.onSubsectionChange(ALL_SUBSECTION)}\n                >\n                  全部\n                </button>\n                ${subsections.map(\n                  (entry) => html`\n                    <button\n                      class=\"config-subnav__item ${\n                        effectiveSubsection === entry.key ? \"active\" : \"\"\n                      }\"\n                      title=${entry.description || entry.label}\n                      @click=${() => props.onSubsectionChange(entry.key)}\n                    >\n                      ${entry.label}\n                    </button>\n                  `,\n                )}\n              </div>\n            `\n          : nothing}\n\n        <!-- Form content -->\n        <div class=\"config-content\">\n          ${props.formMode === \"form\"\n            ? html`\n                ${props.schemaLoading\n                  ? html`<div class=\"config-loading\">\n                      <div class=\"config-loading__spinner\"></div>\n                      <span>正在加载模式…</span>\n                    </div>`\n                  : renderConfigForm({\n                      schema: analysis.schema,\n                      uiHints: props.uiHints,\n                      value: props.formValue,\n                      disabled: props.loading || !props.formValue,\n                      unsupportedPaths: analysis.unsupportedPaths,\n                      onPatch: props.onFormPatch,\n                      searchQuery: props.searchQuery,\n                      activeSection: props.activeSection,\n                      activeSubsection: effectiveSubsection,\n                    })}\n                ${formUnsafe\n                  ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n                      表单视图无法安全编辑某些字段。\n                      使用原始模式以避免丢失配置项。\n                    </div>`\n                  : nothing}\n              `\n            : html`\n                <label class=\"field config-raw-field\">\n                  <span>原始JSON5</span>\n                  <textarea\n                    .value=${props.raw}\n                    @input=${(e: Event) =>\n                      props.onRawChange((e.target as HTMLTextAreaElement).value)}\n                  ></textarea>\n                </label>\n              `}\n        </div>\n\n        ${props.issues.length > 0\n          ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n              <pre class=\"code-block\">${JSON.stringify(props.issues, null, 2)}</pre>\n            </div>`\n          : nothing}\n      </main>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\nimport type { ChannelUiMetaEntry, CronJob, CronRunLogEntry, CronStatus } from \"../types.ts\";\nimport type { CronFormState } from \"../ui-types.ts\";\nimport { formatMs } from \"../format.ts\";\nimport {\n  formatCronPayload,\n  formatCronSchedule,\n  formatCronState,\n  formatNextRun,\n} from \"../presenter.ts\";\n\nexport type CronProps = {\n  loading: boolean;\n  status: CronStatus | null;\n  jobs: CronJob[];\n  error: string | null;\n  busy: boolean;\n  form: CronFormState;\n  channels: string[];\n  channelLabels?: Record<string, string>;\n  channelMeta?: ChannelUiMetaEntry[];\n  runsJobId: string | null;\n  runs: CronRunLogEntry[];\n  onFormChange: (patch: Partial<CronFormState>) => void;\n  onRefresh: () => void;\n  onAdd: () => void;\n  onToggle: (job: CronJob, enabled: boolean) => void;\n  onRun: (job: CronJob) => void;\n  onRemove: (job: CronJob) => void;\n  onLoadRuns: (jobId: string) => void;\n};\n\nfunction buildChannelOptions(props: CronProps): string[] {\n  const options = [\"last\", ...props.channels.filter(Boolean)];\n  const current = props.form.deliveryChannel?.trim();\n  if (current && !options.includes(current)) {\n    options.push(current);\n  }\n  const seen = new Set<string>();\n  return options.filter((value) => {\n    if (seen.has(value)) {\n      return false;\n    }\n    seen.add(value);\n    return true;\n  });\n}\n\nfunction resolveChannelLabel(props: CronProps, channel: string): string {\n  if (channel === \"last\") {\n    return \"last\";\n  }\n  const meta = props.channelMeta?.find((entry) => entry.id === channel);\n  if (meta?.label) {\n    return meta.label;\n  }\n  return props.channelLabels?.[channel] ?? channel;\n}\n\nexport function renderCron(props: CronProps) {\n  const channelOptions = buildChannelOptions(props);\n  return html`\n    <section class=\"grid grid-cols-2\">\n      <div class=\"card\">\n        <div class=\"card-title\">调度器</div>\n        <div class=\"card-sub\">网关内置定时调度器状态。</div>\n        <div class=\"stat-grid\" style=\"margin-top: 16px;\">\n          <div class=\"stat\">\n            <div class=\"stat-label\">已启用</div>\n            <div class=\"stat-value\">\n              ${props.status ? (props.status.enabled ? \"是\" : \"否\") : \"无\"}\n            </div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">任务数</div>\n            <div class=\"stat-value\">${props.status?.jobs ?? \"n/a\"}</div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">下次唤醒</div>\n            <div class=\"stat-value\">${formatNextRun(props.status?.nextWakeAtMs ?? null)}</div>\n          </div>\n        </div>\n        <div class=\"row\" style=\"margin-top: 12px;\">\n          <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n            ${props.loading ? \"刷新中…\" : \"刷新\"}\n          </button>\n          ${props.error ? html`<span class=\"muted\">${props.error}</span>` : nothing}\n        </div>\n      </div>\n\n      <div class=\"card\">\n        <div class=\"card-title\">新建任务</div>\n        <div class=\"card-sub\">创建定时唤醒或代理运行。</div>\n        <div class=\"form-grid\" style=\"margin-top: 16px;\">\n          <label class=\"field\">\n            <span>名称</span>\n            <input\n              .value=${props.form.name}\n              @input=${(e: Event) =>\n                props.onFormChange({ name: (e.target as HTMLInputElement).value })}\n            />\n          </label>\n          <label class=\"field\">\n            <span>描述</span>\n            <input\n              .value=${props.form.description}\n              @input=${(e: Event) =>\n                props.onFormChange({ description: (e.target as HTMLInputElement).value })}\n            />\n          </label>\n          <label class=\"field\">\n            <span>代理 ID</span>\n            <input\n              .value=${props.form.agentId}\n              @input=${(e: Event) =>\n                props.onFormChange({ agentId: (e.target as HTMLInputElement).value })}\n              placeholder=\"默认\"\n            />\n          </label>\n          <label class=\"field checkbox\">\n            <span>启用</span>\n            <input\n              type=\"checkbox\"\n              .checked=${props.form.enabled}\n              @change=${(e: Event) =>\n                props.onFormChange({ enabled: (e.target as HTMLInputElement).checked })}\n            />\n          </label>\n          <label class=\"field\">\n            <span>调度</span>\n            <select\n              .value=${props.form.scheduleKind}\n              @change=${(e: Event) =>\n                props.onFormChange({\n                  scheduleKind: (e.target as HTMLSelectElement)\n                    .value as CronFormState[\"scheduleKind\"],\n                })}\n            >\n              <option value=\"every\">每隔</option>\n              <option value=\"at\">定时</option>\n              <option value=\"cron\">Cron 表达式</option>\n            </select>\n          </label>\n        </div>\n        ${renderScheduleFields(props)}\n        <div class=\"form-grid\" style=\"margin-top: 12px;\">\n          <label class=\"field\">\n            <span>会话</span>\n            <select\n              .value=${props.form.sessionTarget}\n              @change=${(e: Event) =>\n                props.onFormChange({\n                  sessionTarget: (e.target as HTMLSelectElement)\n                    .value as CronFormState[\"sessionTarget\"],\n                })}\n            >\n              <option value=\"main\">主会话</option>\n              <option value=\"isolated\">独立会话</option>\n            </select>\n          </label>\n          <label class=\"field\">\n            <span>唤醒模式</span>\n            <select\n              .value=${props.form.wakeMode}\n              @change=${(e: Event) =>\n                props.onFormChange({\n                  wakeMode: (e.target as HTMLSelectElement).value as CronFormState[\"wakeMode\"],\n                })}\n            >\n              <option value=\"next-heartbeat\">下次心跳</option>\n              <option value=\"now\">立即</option>\n            </select>\n          </label>\n          <label class=\"field\">\n            <span>负载</span>\n            <select\n              .value=${props.form.payloadKind}\n              @change=${(e: Event) =>\n                props.onFormChange({\n                  payloadKind: (e.target as HTMLSelectElement)\n                    .value as CronFormState[\"payloadKind\"],\n                })}\n            >\n              <option value=\"systemEvent\">系统事件</option>\n              <option value=\"agentTurn\">代理轮次</option>\n            </select>\n          </label>\n        </div>\n        <label class=\"field\" style=\"margin-top: 12px;\">\n          <span>${props.form.payloadKind === \"systemEvent\" ? \"系统文本\" : \"代理消息\"}</span>\n          <textarea\n            .value=${props.form.payloadText}\n            @input=${(e: Event) =>\n              props.onFormChange({\n                payloadText: (e.target as HTMLTextAreaElement).value,\n              })}\n            rows=\"4\"\n          ></textarea>\n        </label>\n        ${\n          props.form.payloadKind === \"agentTurn\"\n            ? html`\n                <div class=\"form-grid\" style=\"margin-top: 12px;\">\n                  <label class=\"field\">\n                    <span>分发方式</span>\n                    <select\n                      .value=${props.form.deliveryMode}\n                      @change=${(e: Event) =>\n                        props.onFormChange({\n                          deliveryMode: (e.target as HTMLSelectElement)\n                            .value as CronFormState[\"deliveryMode\"],\n                        })}\n                    >\n                      <option value=\"legacy\">主会话摘要（旧版）</option>\n                      <option value=\"announce\">通告摘要（默认）</option>\n                      <option value=\"deliver\">分发完整输出</option>\n                      <option value=\"none\">无（内部）</option>\n                    </select>\n                  </label>\n                  <label class=\"field\">\n                    <span>超时（秒）</span>\n                    <input\n                      .value=${props.form.timeoutSeconds}\n                      @input=${(e: Event) =>\n                        props.onFormChange({\n                          timeoutSeconds: (e.target as HTMLInputElement).value,\n                        })}\n                    />\n                  </label>\n                  ${\n                    props.form.deliveryMode === \"announce\" || props.form.deliveryMode === \"deliver\"\n                      ? html`\n                          <label class=\"field\">\n                            <span>通道</span>\n                            <select\n                              .value=${props.form.deliveryChannel || \"last\"}\n                              @change=${(e: Event) =>\n                                props.onFormChange({\n                                  deliveryChannel: (e.target as HTMLSelectElement).value,\n                                })}\n                            >\n                              ${channelOptions.map(\n                                (channel) =>\n                                  html`<option value=${channel}>\n                                    ${resolveChannelLabel(props, channel)}\n                                  </option>`,\n                              )}\n                            </select>\n                          </label>\n                          <label class=\"field\">\n                            <span>发送至</span>\n                            <input\n                              .value=${props.form.deliveryTo}\n                              @input=${(e: Event) =>\n                                props.onFormChange({\n                                  deliveryTo: (e.target as HTMLInputElement).value,\n                                })}\n                              placeholder=\"+1555… 或聊天 ID\"\n                            />\n                          </label>\n                        `\n                      : nothing\n                  }\n                  ${\n                    props.form.sessionTarget === \"isolated\" && props.form.deliveryMode === \"legacy\"\n                      ? html`\n                          <label class=\"field\">\n                            <span>发布到主会话前缀</span>\n                            <input\n                              .value=${props.form.postToMainPrefix}\n                              @input=${(e: Event) =>\n                                props.onFormChange({\n                                  postToMainPrefix: (e.target as HTMLInputElement).value,\n                                })}\n                            />\n                          </label>\n                        `\n                      : nothing\n                  }\n                </div>\n              `\n            : nothing\n        }\n        <div class=\"row\" style=\"margin-top: 14px;\">\n          <button class=\"btn primary\" ?disabled=${props.busy} @click=${props.onAdd}>\n            ${props.busy ? \"保存中…\" : \"添加任务\"}\n          </button>\n        </div>\n      </div>\n    </section>\n\n    <section class=\"card\" style=\"margin-top: 18px;\">\n      <div class=\"card-title\">任务列表</div>\n      <div class=\"card-sub\">网关中存储的所有定时任务。</div>\n      ${\n        props.jobs.length === 0\n          ? html`\n              <div class=\"muted\" style=\"margin-top: 12px\">暂无任务。</div>\n            `\n          : html`\n            <div class=\"list\" style=\"margin-top: 12px;\">\n              ${props.jobs.map((job) => renderJob(job, props))}\n            </div>\n          `\n      }\n    </section>\n\n    <section class=\"card\" style=\"margin-top: 18px;\">\n      <div class=\"card-title\">运行历史</div>\n      <div class=\"card-sub\">${props.runsJobId ?? \"（选择一个任务）\"}的最近运行记录。</div>\n      ${\n        props.runsJobId == null\n          ? html`\n              <div class=\"muted\" style=\"margin-top: 12px\">选择一个任务以查看运行历史。</div>\n            `\n          : props.runs.length === 0\n            ? html`\n                <div class=\"muted\" style=\"margin-top: 12px\">暂无运行记录。</div>\n              `\n            : html`\n              <div class=\"list\" style=\"margin-top: 12px;\">\n                ${props.runs.map((entry) => renderRun(entry))}\n              </div>\n            `\n      }\n    </section>\n  `;\n}\n\nfunction renderScheduleFields(props: CronProps) {\n  const form = props.form;\n  if (form.scheduleKind === \"at\") {\n    return html`\n      <label class=\"field\" style=\"margin-top: 12px;\">\n        <span>运行时间</span>\n        <input\n          type=\"datetime-local\"\n          .value=${form.scheduleAt}\n          @input=${(e: Event) =>\n            props.onFormChange({\n              scheduleAt: (e.target as HTMLInputElement).value,\n            })}\n        />\n      </label>\n    `;\n  }\n  if (form.scheduleKind === \"every\") {\n    return html`\n      <div class=\"form-grid\" style=\"margin-top: 12px;\">\n        <label class=\"field\">\n          <span>每隔</span>\n          <input\n            .value=${form.everyAmount}\n            @input=${(e: Event) =>\n              props.onFormChange({\n                everyAmount: (e.target as HTMLInputElement).value,\n              })}\n          />\n        </label>\n        <label class=\"field\">\n          <span>单位</span>\n          <select\n            .value=${form.everyUnit}\n            @change=${(e: Event) =>\n              props.onFormChange({\n                everyUnit: (e.target as HTMLSelectElement).value as CronFormState[\"everyUnit\"],\n              })}\n          >\n            <option value=\"minutes\">分钟</option>\n            <option value=\"hours\">小时</option>\n            <option value=\"days\">天</option>\n          </select>\n        </label>\n      </div>\n    `;\n  }\n  return html`\n    <div class=\"form-grid\" style=\"margin-top: 12px;\">\n      <label class=\"field\">\n        <span>表达式</span>\n        <input\n          .value=${form.cronExpr}\n          @input=${(e: Event) =>\n            props.onFormChange({ cronExpr: (e.target as HTMLInputElement).value })}\n        />\n      </label>\n      <label class=\"field\">\n        <span>时区（可选）</span>\n        <input\n          .value=${form.cronTz}\n          @input=${(e: Event) =>\n            props.onFormChange({ cronTz: (e.target as HTMLInputElement).value })}\n        />\n      </label>\n    </div>\n  `;\n}\n\nfunction renderJob(job: CronJob, props: CronProps) {\n  const isSelected = props.runsJobId === job.id;\n  const itemClass = `list-item list-item-clickable${isSelected ? \" list-item-selected\" : \"\"}`;\n  return html`\n    <div class=${itemClass} @click=${() => props.onLoadRuns(job.id)}>\n      <div class=\"list-main\">\n        <div class=\"list-title\">${job.name}</div>\n        <div class=\"list-sub\">${formatCronSchedule(job)}</div>\n        <div class=\"muted\">${formatCronPayload(job)}</div>\n        ${job.agentId ? html`<div class=\"muted\">代理: ${job.agentId}</div>` : nothing}\n        <div class=\"chip-row\" style=\"margin-top: 6px;\">\n          <span class=\"chip\">${job.enabled ? \"已启用\" : \"已禁用\"}</span>\n          <span class=\"chip\">${job.sessionTarget}</span>\n          <span class=\"chip\">${job.wakeMode}</span>\n        </div>\n      </div>\n      <div class=\"list-meta\">\n        <div>${formatCronState(job)}</div>\n        <div class=\"row\" style=\"justify-content: flex-end; margin-top: 8px;\">\n          <button\n            class=\"btn\"\n            ?disabled=${props.busy}\n            @click=${(event: Event) => {\n              event.stopPropagation();\n              props.onToggle(job, !job.enabled);\n            }}\n          >\n            ${job.enabled ? \"禁用\" : \"启用\"}\n          </button>\n          <button\n            class=\"btn\"\n            ?disabled=${props.busy}\n            @click=${(event: Event) => {\n              event.stopPropagation();\n              props.onRun(job);\n            }}\n          >\n            运行\n          </button>\n          <button\n            class=\"btn\"\n            ?disabled=${props.busy}\n            @click=${(event: Event) => {\n              event.stopPropagation();\n              props.onLoadRuns(job.id);\n            }}\n          >\n            历史\n          </button>\n          <button\n            class=\"btn danger\"\n            ?disabled=${props.busy}\n            @click=${(event: Event) => {\n              event.stopPropagation();\n              props.onRemove(job);\n            }}\n          >\n            删除\n          </button>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderRun(entry: CronRunLogEntry) {\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${entry.status}</div>\n        <div class=\"list-sub\">${entry.summary ?? \"\"}</div>\n      </div>\n      <div class=\"list-meta\">\n        <div>${formatMs(entry.ts)}</div>\n        <div class=\"muted\">${entry.durationMs ?? 0}ms</div>\n        ${entry.error ? html`<div class=\"muted\">${entry.error}</div>` : nothing}\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatEventPayload } from \"../presenter\";\nimport type { EventLogEntry } from \"../app-events\";\n\nexport type DebugProps = {\n  loading: boolean;\n  status: Record<string, unknown> | null;\n  health: Record<string, unknown> | null;\n  models: unknown[];\n  heartbeat: unknown;\n  eventLog: EventLogEntry[];\n  callMethod: string;\n  callParams: string;\n  callResult: string | null;\n  callError: string | null;\n  onCallMethodChange: (next: string) => void;\n  onCallParamsChange: (next: string) => void;\n  onRefresh: () => void;\n  onCall: () => void;\n};\n\nexport function renderDebug(props: DebugProps) {\n  return html`\n    <section class=\"grid grid-cols-2\">\n      <div class=\"card\">\n        <div class=\"row\" style=\"justify-content: space-between;\">\n          <div>\n            <div class=\"card-title\">快照</div>\n            <div class=\"card-sub\">状态、健康状况和心跳数据。</div>\n          </div>\n          <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n            ${props.loading ? \"刷新中…\" : \"刷新\"}\n          </button>\n        </div>\n        <div class=\"stack\" style=\"margin-top: 12px;\">\n          <div>\n            <div class=\"muted\">状态</div>\n            <pre class=\"code-block\">${JSON.stringify(props.status ?? {}, null, 2)}</pre>\n          </div>\n          <div>\n            <div class=\"muted\">健康状况</div>\n            <pre class=\"code-block\">${JSON.stringify(props.health ?? {}, null, 2)}</pre>\n          </div>\n          <div>\n            <div class=\"muted\">最后心跳</div>\n            <pre class=\"code-block\">${JSON.stringify(props.heartbeat ?? {}, null, 2)}</pre>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"card\">\n        <div class=\"card-title\">手动RPC</div>\n        <div class=\"card-sub\">使用JSON参数发送原始网关方法。</div>\n        <div class=\"form-grid\" style=\"margin-top: 16px;\">\n          <label class=\"field\">\n            <span>方法</span>\n            <input\n              .value=${props.callMethod}\n              @input=${(e: Event) =>\n                props.onCallMethodChange((e.target as HTMLInputElement).value)}\n              placeholder=\"系统状态\"\n            />\n          </label>\n          <label class=\"field\">\n            <span>参数（JSON）</span>\n            <textarea\n              .value=${props.callParams}\n              @input=${(e: Event) =>\n                props.onCallParamsChange((e.target as HTMLTextAreaElement).value)}\n              rows=\"6\"\n            ></textarea>\n          </label>\n        </div>\n        <div class=\"row\" style=\"margin-top: 12px;\">\n          <button class=\"btn primary\" @click=${props.onCall}>调用</button>\n        </div>\n        ${props.callError\n          ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n              ${props.callError}\n            </div>`\n          : nothing}\n        ${props.callResult\n          ? html`<pre class=\"code-block\" style=\"margin-top: 12px;\">${props.callResult}</pre>`\n          : nothing}\n      </div>\n    </section>\n\n    <section class=\"card\" style=\"margin-top: 18px;\">\n      <div class=\"card-title\">模型</div>\n      <div class=\"card-sub\">来自models.list的目录。</div>\n      <pre class=\"code-block\" style=\"margin-top: 12px;\">${JSON.stringify(\n        props.models ?? [],\n        null,\n        2,\n      )}</pre>\n    </section>\n\n    <section class=\"card\" style=\"margin-top: 18px;\">\n      <div class=\"card-title\">事件日志</div>\n      <div class=\"card-sub\">最新的网关事件。</div>\n      ${props.eventLog.length === 0\n        ? html`<div class=\"muted\" style=\"margin-top: 12px;\">暂无事件。</div>`\n        : html`\n            <div class=\"list\" style=\"margin-top: 12px;\">\n              ${props.eventLog.map(\n                (evt) => html`\n                  <div class=\"list-item\">\n                    <div class=\"list-main\">\n                      <div class=\"list-title\">${evt.event}</div>\n                      <div class=\"list-sub\">${new Date(evt.ts).toLocaleTimeString()}</div>\n                    </div>\n                    <div class=\"list-meta\">\n                      <pre class=\"code-block\">${formatEventPayload(evt.payload)}</pre>\n                    </div>\n                  </div>\n                `,\n              )}\n            </div>\n          `}\n    </section>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport type { AppViewState } from \"../app-view-state\";\n\nfunction formatRemaining(ms: number): string {\n  const remaining = Math.max(0, ms);\n  const totalSeconds = Math.floor(remaining / 1000);\n  if (totalSeconds < 60) return `${totalSeconds}s`;\n  const minutes = Math.floor(totalSeconds / 60);\n  if (minutes < 60) return `${minutes}m`;\n  const hours = Math.floor(minutes / 60);\n  return `${hours}h`;\n}\n\nfunction renderMetaRow(label: string, value?: string | null) {\n  if (!value) return nothing;\n  return html`<div class=\"exec-approval-meta-row\"><span>${label}</span><span>${value}</span></div>`;\n}\n\nexport function renderExecApprovalPrompt(state: AppViewState) {\n  const active = state.execApprovalQueue[0];\n  if (!active) return nothing;\n  const request = active.request;\n  const remainingMs = active.expiresAtMs - Date.now();\n  const remaining = remainingMs > 0 ? `${formatRemaining(remainingMs)} 后过期` : \"已过期\";\n  const queueCount = state.execApprovalQueue.length;\n  return html`\n    <div class=\"exec-approval-overlay\" role=\"dialog\" aria-live=\"polite\">\n      <div class=\"exec-approval-card\">\n        <div class=\"exec-approval-header\">\n          <div>\n            <div class=\"exec-approval-title\">执行审批</div>\n            <div class=\"exec-approval-sub\">${remaining}</div>\n          </div>\n          ${queueCount > 1\n            ? html`<div class=\"exec-approval-queue\">${queueCount} 个待处理</div>`\n            : nothing}\n        </div>\n        <div class=\"exec-approval-command mono\">${request.command}</div>\n        <div class=\"exec-approval-meta\">\n          ${renderMetaRow(\"主机\", request.host)}\n          ${renderMetaRow(\"代理\", request.agentId)}\n          ${renderMetaRow(\"会话\", request.sessionKey)}\n          ${renderMetaRow(\"工作目录\", request.cwd)}\n          ${renderMetaRow(\"解析路径\", request.resolvedPath)}\n          ${renderMetaRow(\"安全策略\", request.security)}\n          ${renderMetaRow(\"询问模式\", request.ask)}\n        </div>\n        ${state.execApprovalError\n          ? html`<div class=\"exec-approval-error\">${state.execApprovalError}</div>`\n          : nothing}\n        <div class=\"exec-approval-actions\">\n          <button\n            class=\"btn primary\"\n            ?disabled=${state.execApprovalBusy}\n            @click=${() => state.handleExecApprovalDecision(\"allow-once\")}\n          >\n            允许一次\n          </button>\n          <button\n            class=\"btn\"\n            ?disabled=${state.execApprovalBusy}\n            @click=${() => state.handleExecApprovalDecision(\"allow-always\")}\n          >\n            始终允许\n          </button>\n          <button\n            class=\"btn danger\"\n            ?disabled=${state.execApprovalBusy}\n            @click=${() => state.handleExecApprovalDecision(\"deny\")}\n          >\n            拒绝\n          </button>\n        </div>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport type { AppViewState } from \"../app-view-state\";\n\n/**\n * Security confirmation modal for gateway URL changes from URL parameters.\n * This prevents 1-click RCE attacks where a malicious link could redirect\n * the user to an attacker-controlled gateway and steal auth tokens.\n * See CVE: GHSA-g8p2-7wf7-98mq\n */\nexport function renderGatewayUrlConfirmPrompt(state: AppViewState) {\n  const pendingUrl = state.pendingGatewayUrl;\n  if (!pendingUrl) return nothing;\n\n  const currentUrl = state.settings.gatewayUrl || window.location.origin;\n\n  return html`\n    <div class=\"exec-approval-overlay\" role=\"dialog\" aria-live=\"polite\" aria-modal=\"true\">\n      <div class=\"exec-approval-card\">\n        <div class=\"exec-approval-header\">\n          <div>\n            <div class=\"exec-approval-title\">⚠️ 网关地址变更请求</div>\n            <div class=\"exec-approval-sub\">请仔细核实此请求</div>\n          </div>\n        </div>\n        <div class=\"exec-approval-meta\">\n          <div class=\"exec-approval-meta-row\">\n            <span>当前地址</span>\n            <span class=\"mono\">${currentUrl}</span>\n          </div>\n          <div class=\"exec-approval-meta-row\">\n            <span>请求地址</span>\n            <span class=\"mono\" style=\"color: var(--warning)\">${pendingUrl}</span>\n          </div>\n        </div>\n        <div style=\"margin: 1rem 0; padding: 0.75rem; background: var(--danger-bg, rgba(239, 68, 68, 0.1)); border-radius: 0.5rem; font-size: 0.875rem;\">\n          <strong>安全警告：</strong>此请求来自 URL 参数。如果您不确定来源，请拒绝此请求。\n          连接到恶意网关可能导致您的认证信息泄露。\n        </div>\n        <div class=\"exec-approval-actions\">\n          <button\n            class=\"btn danger\"\n            @click=${() => state.rejectPendingGatewayUrl()}\n          >\n            拒绝\n          </button>\n          <button\n            class=\"btn primary\"\n            @click=${() => state.acceptPendingGatewayUrl()}\n          >\n            确认连接\n          </button>\n        </div>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatPresenceAge, formatPresenceSummary } from \"../presenter\";\nimport type { PresenceEntry } from \"../types\";\n\nexport type InstancesProps = {\n  loading: boolean;\n  entries: PresenceEntry[];\n  lastError: string | null;\n  statusMessage: string | null;\n  onRefresh: () => void;\n};\n\nexport function renderInstances(props: InstancesProps) {\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">已连接实例</div>\n          <div class=\"card-sub\">来自网关和客户端的存在信标。</div>\n        </div>\n        <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n          ${props.loading ? \"加载中…\" : \"刷新\"}\n        </button>\n      </div>\n      ${props.lastError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">\n            ${props.lastError}\n          </div>`\n        : nothing}\n      ${props.statusMessage\n        ? html`<div class=\"callout\" style=\"margin-top: 12px;\">\n            ${props.statusMessage}\n          </div>`\n        : nothing}\n      <div class=\"list\" style=\"margin-top: 16px;\">\n        ${props.entries.length === 0\n          ? html`<div class=\"muted\">暂未报告任何实例。</div>`\n          : props.entries.map((entry) => renderEntry(entry))}\n      </div>\n    </section>\n  `;\n}\n\nfunction renderEntry(entry: PresenceEntry) {\n  const lastInput =\n    entry.lastInputSeconds != null\n      ? `${entry.lastInputSeconds}秒前`\n      : \"无\";\n  const mode = entry.mode ?? \"未知\";\n  const roles = Array.isArray(entry.roles) ? entry.roles.filter(Boolean) : [];\n  const scopes = Array.isArray(entry.scopes) ? entry.scopes.filter(Boolean) : [];\n  const scopesLabel =\n    scopes.length > 0\n      ? scopes.length > 3\n        ? `${scopes.length} 作用域`\n        : `作用域: ${scopes.join(\", \")}`\n      : null;\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${entry.host ?? \"未知主机\"}</div>\n        <div class=\"list-sub\">${formatPresenceSummary(entry)}</div>\n        <div class=\"chip-row\">\n          <span class=\"chip\">${mode}</span>\n          ${roles.map((role) => html`<span class=\"chip\">${role}</span>`)}\n          ${scopesLabel ? html`<span class=\"chip\">${scopesLabel}</span>` : nothing}\n          ${entry.platform ? html`<span class=\"chip\">${entry.platform}</span>` : nothing}\n          ${entry.deviceFamily\n            ? html`<span class=\"chip\">${entry.deviceFamily}</span>`\n            : nothing}\n          ${entry.modelIdentifier\n            ? html`<span class=\"chip\">${entry.modelIdentifier}</span>`\n            : nothing}\n          ${entry.version ? html`<span class=\"chip\">${entry.version}</span>` : nothing}\n        </div>\n      </div>\n      <div class=\"list-meta\">\n        <div>${formatPresenceAge(entry)}</div>\n        <div class=\"muted\">上次输入 ${lastInput}</div>\n        <div class=\"muted\">原因 ${entry.reason ?? \"\"}</div>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport type { LogEntry, LogLevel } from \"../types\";\n\nconst LEVELS: LogLevel[] = [\"trace\", \"debug\", \"info\", \"warn\", \"error\", \"fatal\"];\n\nexport type LogsProps = {\n  loading: boolean;\n  error: string | null;\n  file: string | null;\n  entries: LogEntry[];\n  filterText: string;\n  levelFilters: Record<LogLevel, boolean>;\n  autoFollow: boolean;\n  truncated: boolean;\n  onFilterTextChange: (next: string) => void;\n  onLevelToggle: (level: LogLevel, enabled: boolean) => void;\n  onToggleAutoFollow: (next: boolean) => void;\n  onRefresh: () => void;\n  onExport: (lines: string[], label: string) => void;\n  onScroll: (event: Event) => void;\n};\n\nfunction formatTime(value?: string | null) {\n  if (!value) return \"\";\n  const date = new Date(value);\n  if (Number.isNaN(date.getTime())) return value;\n  return date.toLocaleTimeString();\n}\n\nfunction matchesFilter(entry: LogEntry, needle: string) {\n  if (!needle) return true;\n  const haystack = [entry.message, entry.subsystem, entry.raw]\n    .filter(Boolean)\n    .join(\" \")\n    .toLowerCase();\n  return haystack.includes(needle);\n}\n\nexport function renderLogs(props: LogsProps) {\n  const needle = props.filterText.trim().toLowerCase();\n  const levelFiltered = LEVELS.some((level) => !props.levelFilters[level]);\n  const filtered = props.entries.filter((entry) => {\n    if (entry.level && !props.levelFilters[entry.level]) return false;\n    return matchesFilter(entry, needle);\n  });\n  const exportLabel = needle || levelFiltered ? \"filtered\" : \"visible\";\n\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">日志</div>\n          <div class=\"card-sub\">网关文件日志（JSONL）。</div>\n        </div>\n        <div class=\"row\" style=\"gap: 8px;\">\n          <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n            ${props.loading ? \"加载中…\" : \"刷新\"}\n          </button>\n          <button\n            class=\"btn\"\n            ?disabled=${filtered.length === 0}\n            @click=${() => props.onExport(filtered.map((entry) => entry.raw), exportLabel)}\n          >\n            导出 ${exportLabel}\n          </button>\n        </div>\n      </div>\n\n      <div class=\"filters\" style=\"margin-top: 14px;\">\n        <label class=\"field\" style=\"min-width: 220px;\">\n          <span>过滤器</span>\n          <input\n            .value=${props.filterText}\n            @input=${(e: Event) =>\n              props.onFilterTextChange((e.target as HTMLInputElement).value)}\n            placeholder=\"搜索日志\"\n          />\n        </label>\n        <label class=\"field checkbox\">\n          <span>自动跟随</span>\n          <input\n            type=\"checkbox\"\n            .checked=${props.autoFollow}\n            @change=${(e: Event) =>\n              props.onToggleAutoFollow((e.target as HTMLInputElement).checked)}\n          />\n        </label>\n      </div>\n\n      <div class=\"chip-row\" style=\"margin-top: 12px;\">\n        ${LEVELS.map(\n          (level) => html`\n            <label class=\"chip log-chip ${level}\">\n              <input\n                type=\"checkbox\"\n                .checked=${props.levelFilters[level]}\n                @change=${(e: Event) =>\n                  props.onLevelToggle(level, (e.target as HTMLInputElement).checked)}\n              />\n              <span>${level}</span>\n            </label>\n          `,\n        )}\n      </div>\n\n      ${props.file\n        ? html`<div class=\"muted\" style=\"margin-top: 10px;\">文件: ${props.file}</div>`\n        : nothing}\n      ${props.truncated\n        ? html`<div class=\"callout\" style=\"margin-top: 10px;\">\n            日志输出已截断；显示最新部分。\n          </div>`\n        : nothing}\n      ${props.error\n        ? html`<div class=\"callout danger\" style=\"margin-top: 10px;\">${props.error}</div>`\n        : nothing}\n\n      <div class=\"log-stream\" style=\"margin-top: 12px;\" @scroll=${props.onScroll}>\n        ${filtered.length === 0\n          ? html`<div class=\"muted\" style=\"padding: 12px;\">无日志条目。</div>`\n          : filtered.map(\n              (entry) => html`\n                <div class=\"log-row\">\n                  <div class=\"log-time mono\">${formatTime(entry.time)}</div>\n                  <div class=\"log-level ${entry.level ?? \"\"}\">${entry.level ?? \"\"}</div>\n                  <div class=\"log-subsystem mono\">${entry.subsystem ?? \"\"}</div>\n                  <div class=\"log-message mono\">${entry.message ?? entry.raw}</div>\n                </div>\n              `,\n            )}\n      </div>\n    </section>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { clampText, formatAgo, formatList } from \"../format\";\nimport type {\n  ExecApprovalsAllowlistEntry,\n  ExecApprovalsFile,\n  ExecApprovalsSnapshot,\n} from \"../controllers/exec-approvals\";\nimport type {\n  DevicePairingList,\n  DeviceTokenSummary,\n  PairedDevice,\n  PendingDevice,\n} from \"../controllers/devices\";\n\nexport type NodesProps = {\n  loading: boolean;\n  nodes: Array<Record<string, unknown>>;\n  devicesLoading: boolean;\n  devicesError: string | null;\n  devicesList: DevicePairingList | null;\n  configForm: Record<string, unknown> | null;\n  configLoading: boolean;\n  configSaving: boolean;\n  configDirty: boolean;\n  configFormMode: \"form\" | \"raw\";\n  execApprovalsLoading: boolean;\n  execApprovalsSaving: boolean;\n  execApprovalsDirty: boolean;\n  execApprovalsSnapshot: ExecApprovalsSnapshot | null;\n  execApprovalsForm: ExecApprovalsFile | null;\n  execApprovalsSelectedAgent: string | null;\n  execApprovalsTarget: \"gateway\" | \"node\";\n  execApprovalsTargetNodeId: string | null;\n  onRefresh: () => void;\n  onDevicesRefresh: () => void;\n  onDeviceApprove: (requestId: string) => void;\n  onDeviceReject: (requestId: string) => void;\n  onDeviceRotate: (deviceId: string, role: string, scopes?: string[]) => void;\n  onDeviceRevoke: (deviceId: string, role: string) => void;\n  onLoadConfig: () => void;\n  onLoadExecApprovals: () => void;\n  onBindDefault: (nodeId: string | null) => void;\n  onBindAgent: (agentIndex: number, nodeId: string | null) => void;\n  onSaveBindings: () => void;\n  onExecApprovalsTargetChange: (kind: \"gateway\" | \"node\", nodeId: string | null) => void;\n  onExecApprovalsSelectAgent: (agentId: string) => void;\n  onExecApprovalsPatch: (path: Array<string | number>, value: unknown) => void;\n  onExecApprovalsRemove: (path: Array<string | number>) => void;\n  onSaveExecApprovals: () => void;\n};\n\nexport function renderNodes(props: NodesProps) {\n  const bindingState = resolveBindingsState(props);\n  const approvalsState = resolveExecApprovalsState(props);\n  return html`\n    ${renderExecApprovals(approvalsState)}\n    ${renderBindings(bindingState)}\n    ${renderDevices(props)}\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">节点</div>\n          <div class=\"card-sub\">配对设备和实时链接。</div>\n        </div>\n        <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n          ${props.loading ? \"加载中…\" : \"刷新\"}\n        </button>\n      </div>\n      <div class=\"list\" style=\"margin-top: 16px;\">\n        ${props.nodes.length === 0\n          ? html`<div class=\"muted\">未找到节点。</div>`\n          : props.nodes.map((n) => renderNode(n))}\n      </div>\n    </section>\n  `;\n}\n\nfunction renderDevices(props: NodesProps) {\n  const list = props.devicesList ?? { pending: [], paired: [] };\n  const pending = Array.isArray(list.pending) ? list.pending : [];\n  const paired = Array.isArray(list.paired) ? list.paired : [];\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">设备</div>\n          <div class=\"card-sub\">配对请求 + 角色令牌。</div>\n        </div>\n        <button class=\"btn\" ?disabled=${props.devicesLoading} @click=${props.onDevicesRefresh}>\n          ${props.devicesLoading ? \"加载中…\" : \"刷新\"}\n        </button>\n      </div>\n      ${props.devicesError\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${props.devicesError}</div>`\n        : nothing}\n      <div class=\"list\" style=\"margin-top: 16px;\">\n        ${pending.length > 0\n          ? html`\n              <div class=\"muted\" style=\"margin-bottom: 8px;\">待处理</div>\n              ${pending.map((req) => renderPendingDevice(req, props))}\n            `\n          : nothing}\n        ${paired.length > 0\n          ? html`\n              <div class=\"muted\" style=\"margin-top: 12px; margin-bottom: 8px;\">已配对</div>\n              ${paired.map((device) => renderPairedDevice(device, props))}\n            `\n          : nothing}\n        ${pending.length === 0 && paired.length === 0\n          ? html`<div class=\"muted\">无配对设备。</div>`\n          : nothing}\n      </div>\n    </section>\n  `;\n}\n\nfunction renderPendingDevice(req: PendingDevice, props: NodesProps) {\n  const name = req.displayName?.trim() || req.deviceId;\n  const age = typeof req.ts === \"number\" ? formatAgo(req.ts) : \"无\";\n  const role = req.role?.trim() ? `role: ${req.role}` : \"角色: -\";\n  const repair = req.isRepair ? \" · repair\" : \"\";\n  const ip = req.remoteIp ? ` · ${req.remoteIp}` : \"\";\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${name}</div>\n        <div class=\"list-sub\">${req.deviceId}${ip}</div>\n        <div class=\"muted\" style=\"margin-top: 6px;\">\n          ${role} · requested ${age}${repair}\n        </div>\n      </div>\n      <div class=\"list-meta\">\n        <div class=\"row\" style=\"justify-content: flex-end; gap: 8px; flex-wrap: wrap;\">\n          <button class=\"btn btn--sm primary\" @click=${() => props.onDeviceApprove(req.requestId)}>\n            批准\n          </button>\n          <button class=\"btn btn--sm\" @click=${() => props.onDeviceReject(req.requestId)}>\n            拒绝\n          </button>\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderPairedDevice(device: PairedDevice, props: NodesProps) {\n  const name = device.displayName?.trim() || device.deviceId;\n  const ip = device.remoteIp ? ` · ${device.remoteIp}` : \"\";\n  const roles = `角色: ${formatList(device.roles)}`;\n  const scopes = `范围: ${formatList(device.scopes)}`;\n  const tokens = Array.isArray(device.tokens) ? device.tokens : [];\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${name}</div>\n        <div class=\"list-sub\">${device.deviceId}${ip}</div>\n        <div class=\"muted\" style=\"margin-top: 6px;\">${roles} · ${scopes}</div>\n        ${tokens.length === 0\n          ? html`<div class=\"muted\" style=\"margin-top: 6px;\">令牌: 无</div>`\n          : html`\n              <div class=\"muted\" style=\"margin-top: 10px;\">令牌</div>\n              <div style=\"display: flex; flex-direction: column; gap: 8px; margin-top: 6px;\">\n                ${tokens.map((token) => renderTokenRow(device.deviceId, token, props))}\n              </div>\n            `}\n      </div>\n    </div>\n  `;\n}\n\nfunction renderTokenRow(deviceId: string, token: DeviceTokenSummary, props: NodesProps) {\n  const status = token.revokedAtMs ? \"revoked\" : \"active\";\n  const scopes = `范围: ${formatList(token.scopes)}`;\n  const when = formatAgo(token.rotatedAtMs ?? token.createdAtMs ?? token.lastUsedAtMs ?? null);\n  return html`\n    <div class=\"row\" style=\"justify-content: space-between; gap: 8px;\">\n      <div class=\"list-sub\">${token.role} · ${status} · ${scopes} · ${when}</div>\n      <div class=\"row\" style=\"justify-content: flex-end; gap: 6px; flex-wrap: wrap;\">\n        <button\n          class=\"btn btn--sm\"\n          @click=${() => props.onDeviceRotate(deviceId, token.role, token.scopes)}\n        >\n          更新\n        </button>\n        ${token.revokedAtMs\n          ? nothing\n          : html`\n              <button\n                class=\"btn btn--sm danger\"\n                @click=${() => props.onDeviceRevoke(deviceId, token.role)}>\n              >\n                撤销\n              </button>\n            `}\n      </div>\n    </div>\n  `;\n}\n\ntype BindingAgent = {\n  id: string;\n  name?: string;\n  index: number;\n  isDefault: boolean;\n  binding?: string | null;\n};\n\ntype BindingNode = {\n  id: string;\n  label: string;\n};\n\ntype BindingState = {\n  ready: boolean;\n  disabled: boolean;\n  configDirty: boolean;\n  configLoading: boolean;\n  configSaving: boolean;\n  defaultBinding?: string | null;\n  agents: BindingAgent[];\n  nodes: BindingNode[];\n  onBindDefault: (nodeId: string | null) => void;\n  onBindAgent: (agentIndex: number, nodeId: string | null) => void;\n  onSave: () => void;\n  onLoadConfig: () => void;\n  formMode: \"form\" | \"raw\";\n};\n\ntype ExecSecurity = \"deny\" | \"allowlist\" | \"full\";\ntype ExecAsk = \"off\" | \"on-miss\" | \"always\";\n\ntype ExecApprovalsResolvedDefaults = {\n  security: ExecSecurity;\n  ask: ExecAsk;\n  askFallback: ExecSecurity;\n  autoAllowSkills: boolean;\n};\n\ntype ExecApprovalsAgentOption = {\n  id: string;\n  name?: string;\n  isDefault?: boolean;\n};\n\ntype ExecApprovalsTargetNode = {\n  id: string;\n  label: string;\n};\n\ntype ExecApprovalsState = {\n  ready: boolean;\n  disabled: boolean;\n  dirty: boolean;\n  loading: boolean;\n  saving: boolean;\n  form: ExecApprovalsFile | null;\n  defaults: ExecApprovalsResolvedDefaults;\n  selectedScope: string;\n  selectedAgent: Record<string, unknown> | null;\n  agents: ExecApprovalsAgentOption[];\n  allowlist: ExecApprovalsAllowlistEntry[];\n  target: \"gateway\" | \"node\";\n  targetNodeId: string | null;\n  targetNodes: ExecApprovalsTargetNode[];\n  onSelectScope: (agentId: string) => void;\n  onSelectTarget: (kind: \"gateway\" | \"node\", nodeId: string | null) => void;\n  onPatch: (path: Array<string | number>, value: unknown) => void;\n  onRemove: (path: Array<string | number>) => void;\n  onLoad: () => void;\n  onSave: () => void;\n};\n\nconst EXEC_APPROVALS_DEFAULT_SCOPE = \"__defaults__\";\n\nconst SECURITY_OPTIONS: Array<{ value: ExecSecurity; label: string }> = [\n  { value: \"deny\", label: \"拒绝\" },\n  { value: \"allowlist\", label: \"白名单\" },\n  { value: \"full\", label: \"全部\" },\n];\n\nconst ASK_OPTIONS: Array<{ value: ExecAsk; label: string }> = [\n  { value: \"off\", label: \"关闭\" },\n  { value: \"on-miss\", label: \"未命中时\" },\n  { value: \"always\", label: \"始终\" },\n];\n\nfunction resolveBindingsState(props: NodesProps): BindingState {\n  const config = props.configForm;\n  const nodes = resolveExecNodes(props.nodes);\n  const { defaultBinding, agents } = resolveAgentBindings(config);\n  const ready = Boolean(config);\n  const disabled = props.configSaving || props.configFormMode === \"raw\";\n  return {\n    ready,\n    disabled,\n    configDirty: props.configDirty,\n    configLoading: props.configLoading,\n    configSaving: props.configSaving,\n    defaultBinding,\n    agents,\n    nodes,\n    onBindDefault: props.onBindDefault,\n    onBindAgent: props.onBindAgent,\n    onSave: props.onSaveBindings,\n    onLoadConfig: props.onLoadConfig,\n    formMode: props.configFormMode,\n  };\n}\n\nfunction normalizeSecurity(value?: string): ExecSecurity {\n  if (value === \"allowlist\" || value === \"full\" || value === \"deny\") return value;\n  return \"deny\";\n}\n\nfunction normalizeAsk(value?: string): ExecAsk {\n  if (value === \"always\" || value === \"off\" || value === \"on-miss\") return value;\n  return \"on-miss\";\n}\n\nfunction resolveExecApprovalsDefaults(\n  form: ExecApprovalsFile | null,\n): ExecApprovalsResolvedDefaults {\n  const defaults = form?.defaults ?? {};\n  return {\n    security: normalizeSecurity(defaults.security),\n    ask: normalizeAsk(defaults.ask),\n    askFallback: normalizeSecurity(defaults.askFallback ?? \"deny\"),\n    autoAllowSkills: Boolean(defaults.autoAllowSkills ?? false),\n  };\n}\n\nfunction resolveConfigAgents(config: Record<string, unknown> | null): ExecApprovalsAgentOption[] {\n  const agentsNode = (config?.agents ?? {}) as Record<string, unknown>;\n  const list = Array.isArray(agentsNode.list) ? agentsNode.list : [];\n  const agents: ExecApprovalsAgentOption[] = [];\n  list.forEach((entry) => {\n    if (!entry || typeof entry !== \"object\") return;\n    const record = entry as Record<string, unknown>;\n    const id = typeof record.id === \"string\" ? record.id.trim() : \"\";\n    if (!id) return;\n    const name = typeof record.name === \"string\" ? record.name.trim() : undefined;\n    const isDefault = record.default === true;\n    agents.push({ id, name: name || undefined, isDefault });\n  });\n  return agents;\n}\n\nfunction resolveExecApprovalsAgents(\n  config: Record<string, unknown> | null,\n  form: ExecApprovalsFile | null,\n): ExecApprovalsAgentOption[] {\n  const configAgents = resolveConfigAgents(config);\n  const approvalsAgents = Object.keys(form?.agents ?? {});\n  const merged = new Map<string, ExecApprovalsAgentOption>();\n  configAgents.forEach((agent) => merged.set(agent.id, agent));\n  approvalsAgents.forEach((id) => {\n    if (merged.has(id)) return;\n    merged.set(id, { id });\n  });\n  const agents = Array.from(merged.values());\n  if (agents.length === 0) {\n    agents.push({ id: \"main\", isDefault: true });\n  }\n  agents.sort((a, b) => {\n    if (a.isDefault && !b.isDefault) return -1;\n    if (!a.isDefault && b.isDefault) return 1;\n    const aLabel = a.name?.trim() ? a.name : a.id;\n    const bLabel = b.name?.trim() ? b.name : b.id;\n    return aLabel.localeCompare(bLabel);\n  });\n  return agents;\n}\n\nfunction resolveExecApprovalsScope(\n  selected: string | null,\n  agents: ExecApprovalsAgentOption[],\n): string {\n  if (selected === EXEC_APPROVALS_DEFAULT_SCOPE) return EXEC_APPROVALS_DEFAULT_SCOPE;\n  if (selected && agents.some((agent) => agent.id === selected)) return selected;\n  return EXEC_APPROVALS_DEFAULT_SCOPE;\n}\n\nfunction resolveExecApprovalsState(props: NodesProps): ExecApprovalsState {\n  const form = props.execApprovalsForm ?? props.execApprovalsSnapshot?.file ?? null;\n  const ready = Boolean(form);\n  const defaults = resolveExecApprovalsDefaults(form);\n  const agents = resolveExecApprovalsAgents(props.configForm, form);\n  const targetNodes = resolveExecApprovalsNodes(props.nodes);\n  const target = props.execApprovalsTarget;\n  let targetNodeId =\n    target === \"node\" && props.execApprovalsTargetNodeId\n      ? props.execApprovalsTargetNodeId\n      : null;\n  if (target === \"node\" && targetNodeId && !targetNodes.some((node) => node.id === targetNodeId)) {\n    targetNodeId = null;\n  }\n  const selectedScope = resolveExecApprovalsScope(props.execApprovalsSelectedAgent, agents);\n  const selectedAgent =\n    selectedScope !== EXEC_APPROVALS_DEFAULT_SCOPE\n      ? ((form?.agents ?? {})[selectedScope] as Record<string, unknown> | undefined) ??\n        null\n      : null;\n  const allowlist = Array.isArray((selectedAgent as { allowlist?: unknown })?.allowlist)\n    ? ((selectedAgent as { allowlist?: ExecApprovalsAllowlistEntry[] }).allowlist ??\n        [])\n    : [];\n  return {\n    ready,\n    disabled: props.execApprovalsSaving || props.execApprovalsLoading,\n    dirty: props.execApprovalsDirty,\n    loading: props.execApprovalsLoading,\n    saving: props.execApprovalsSaving,\n    form,\n    defaults,\n    selectedScope,\n    selectedAgent,\n    agents,\n    allowlist,\n    target,\n    targetNodeId,\n    targetNodes,\n    onSelectScope: props.onExecApprovalsSelectAgent,\n    onSelectTarget: props.onExecApprovalsTargetChange,\n    onPatch: props.onExecApprovalsPatch,\n    onRemove: props.onExecApprovalsRemove,\n    onLoad: props.onLoadExecApprovals,\n    onSave: props.onSaveExecApprovals,\n  };\n}\n\nfunction renderBindings(state: BindingState) {\n  const supportsBinding = state.nodes.length > 0;\n  const defaultValue = state.defaultBinding ?? \"\";\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between; align-items: center;\">\n        <div>\n          <div class=\"card-title\">执行节点绑定</div>\n          <div class=\"card-sub\">\n            使用<span class=\"mono\">exec host=node</span>时将代理固定到特定节点。\n          </div>\n        </div>\n        <button\n          class=\"btn\"\n          ?disabled=${state.disabled || !state.configDirty}\n          @click=${state.onSave}\n        >\n          ${state.configSaving ? \"保存中…\" : \"保存\"}\n        </button>\n      </div>\n\n      ${state.formMode === \"raw\"\n        ? html`<div class=\"callout warn\" style=\"margin-top: 12px;\">\n            将配置选项卡切换到<strong>表单</strong>模式以在此处编辑绑定。\n          </div>`\n        : nothing}\n\n      ${!state.ready\n        ? html`<div class=\"row\" style=\"margin-top: 12px; gap: 12px;\">\n            <div class=\"muted\">加载配置以编辑绑定。</div>\n            <button class=\"btn\" ?disabled=${state.configLoading} @click=${state.onLoadConfig}>\n              ${state.configLoading ? \"加载中…\" : \"加载配置\"}\n            </button>\n          </div>`\n        : html`\n            <div class=\"list\" style=\"margin-top: 16px;\">\n              <div class=\"list-item\">\n                <div class=\"list-main\">\n                  <div class=\"list-title\">默认绑定</div>\n                  <div class=\"list-sub\">当代理不覆盖节点绑定时使用。</div>\n                </div>\n                <div class=\"list-meta\">\n                  <label class=\"field\">\n                    <span>节点</span>\n                    <select\n                      ?disabled=${state.disabled || !supportsBinding}\n                      @change=${(event: Event) => {\n                        const target = event.target as HTMLSelectElement;\n                        const value = target.value.trim();\n                        state.onBindDefault(value ? value : null);\n                      }}\n                    >\n                      <option value=\"\" ?selected=${defaultValue === \"\"}>任何节点</option>\n                      ${state.nodes.map(\n                        (node) =>\n                          html`<option\n                            value=${node.id}\n                            ?selected=${defaultValue === node.id}\n                          >\n                            ${node.label}\n                          </option>`,\n                      )}\n                    </select>\n                  </label>\n                  ${!supportsBinding\n                    ? html`<div class=\"muted\">没有可用system.run的节点。</div>`\n                    : nothing}\n                </div>\n              </div>\n\n              ${state.agents.length === 0\n                ? html`<div class=\"muted\">未找到代理。</div>`\n                : state.agents.map((agent) =>\n                    renderAgentBinding(agent, state),\n                  )}\n            </div>\n          `}\n    </section>\n  `;\n}\n\nfunction renderExecApprovals(state: ExecApprovalsState) {\n  const ready = state.ready;\n  const targetReady = state.target !== \"node\" || Boolean(state.targetNodeId);\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between; align-items: center;\">\n        <div>\n          <div class=\"card-title\">执行审批</div>\n          <div class=\"card-sub\">\n            <span class=\"mono\">exec host=gateway/node</span>的白名单和审批策略。\n          </div>\n        </div>\n        <button\n          class=\"btn\"\n          ?disabled=${state.disabled || !state.dirty || !targetReady}\n          @click=${state.onSave}\n        >\n          ${state.saving ? \"保存中…\" : \"保存\"}\n        </button>\n      </div>\n\n      ${renderExecApprovalsTarget(state)}\n\n      ${!ready\n        ? html`<div class=\"row\" style=\"margin-top: 12px; gap: 12px;\">\n            <div class=\"muted\">加载执行审批以编辑白名单。</div>\n            <button class=\"btn\" ?disabled=${state.loading || !targetReady} @click=${state.onLoad}>\n              ${state.loading ? \"加载中…\" : \"加载审批\"}\n            </button>\n          </div>`\n        : html`\n            ${renderExecApprovalsTabs(state)}\n            ${renderExecApprovalsPolicy(state)}\n            ${state.selectedScope === EXEC_APPROVALS_DEFAULT_SCOPE\n              ? nothing\n              : renderExecApprovalsAllowlist(state)}\n          `}\n    </section>\n  `;\n}\n\nfunction renderExecApprovalsTarget(state: ExecApprovalsState) {\n  const hasNodes = state.targetNodes.length > 0;\n  const nodeValue = state.targetNodeId ?? \"\";\n  return html`\n    <div class=\"list\" style=\"margin-top: 12px;\">\n      <div class=\"list-item\">\n        <div class=\"list-main\">\n          <div class=\"list-title\">目标</div>\n          <div class=\"list-sub\">\n            网关编辑本地审批；节点编辑选定的节点。\n          </div>\n        </div>\n        <div class=\"list-meta\">\n          <label class=\"field\">\n            <span>主机</span>\n            <select\n              ?disabled=${state.disabled}\n              @change=${(event: Event) => {\n                const target = event.target as HTMLSelectElement;\n                const value = target.value;\n                if (value === \"node\") {\n                  const first = state.targetNodes[0]?.id ?? null;\n                  state.onSelectTarget(\"node\", nodeValue || first);\n                } else {\n                  state.onSelectTarget(\"gateway\", null);\n                }\n              }}\n            >\n              <option value=\"gateway\" ?selected=${state.target === \"gateway\"}>网关</option>\n              <option value=\"node\" ?selected=${state.target === \"node\"}>节点</option>\n            </select>\n          </label>\n          ${state.target === \"node\"\n            ? html`\n                <label class=\"field\">\n                  <span>节点</span>\n                  <select\n                    ?disabled=${state.disabled || !hasNodes}\n                    @change=${(event: Event) => {\n                      const target = event.target as HTMLSelectElement;\n                      const value = target.value.trim();\n                      state.onSelectTarget(\"node\", value ? value : null);\n                    }}\n                  >\n                    <option value=\"\" ?selected=${nodeValue === \"\"}>选择节点</option>\n                    ${state.targetNodes.map(\n                      (node) =>\n                        html`<option\n                          value=${node.id}\n                          ?selected=${nodeValue === node.id}\n                        >\n                          ${node.label}\n                        </option>`,\n                    )}\n                  </select>\n                </label>\n              `\n            : nothing}\n        </div>\n      </div>\n      ${state.target === \"node\" && !hasNodes\n        ? html`<div class=\"muted\">尚无节点发布执行审批广告。</div>`\n        : nothing}\n    </div>\n  `;\n}\n\nfunction renderExecApprovalsTabs(state: ExecApprovalsState) {\n  return html`\n    <div class=\"row\" style=\"margin-top: 12px; gap: 8px; flex-wrap: wrap;\">\n      <span class=\"label\">范围</span>\n      <div class=\"row\" style=\"gap: 8px; flex-wrap: wrap;\">\n        <button\n          class=\"btn btn--sm ${state.selectedScope === EXEC_APPROVALS_DEFAULT_SCOPE ? \"active\" : \"\"}\"\n          @click=${() => state.onSelectScope(EXEC_APPROVALS_DEFAULT_SCOPE)}\n        >\n          默认值\n        </button>\n        ${state.agents.map((agent) => {\n          const label = agent.name?.trim() ? `${agent.name} (${agent.id})` : agent.id;\n          return html`\n            <button\n              class=\"btn btn--sm ${state.selectedScope === agent.id ? \"active\" : \"\"}\"\n              @click=${() => state.onSelectScope(agent.id)}\n            >\n              ${label}\n            </button>\n          `;\n        })}\n      </div>\n    </div>\n  `;\n}\n\nfunction renderExecApprovalsPolicy(state: ExecApprovalsState) {\n  const isDefaults = state.selectedScope === EXEC_APPROVALS_DEFAULT_SCOPE;\n  const defaults = state.defaults;\n  const agent = state.selectedAgent ?? {};\n  const basePath = isDefaults ? [\"defaults\"] : [\"agents\", state.selectedScope];\n  const agentSecurity = typeof agent.security === \"string\" ? agent.security : undefined;\n  const agentAsk = typeof agent.ask === \"string\" ? agent.ask : undefined;\n  const agentAskFallback =\n    typeof agent.askFallback === \"string\" ? agent.askFallback : undefined;\n  const securityValue = isDefaults ? defaults.security : agentSecurity ?? \"__default__\";\n  const askValue = isDefaults ? defaults.ask : agentAsk ?? \"__default__\";\n  const askFallbackValue = isDefaults\n    ? defaults.askFallback\n    : agentAskFallback ?? \"__default__\";\n  const autoOverride =\n    typeof agent.autoAllowSkills === \"boolean\" ? agent.autoAllowSkills : undefined;\n  const autoEffective = autoOverride ?? defaults.autoAllowSkills;\n  const autoIsDefault = autoOverride == null;\n\n  return html`\n    <div class=\"list\" style=\"margin-top: 16px;\">\n      <div class=\"list-item\">\n        <div class=\"list-main\">\n          <div class=\"list-title\">安全</div>\n          <div class=\"list-sub\">\n            ${isDefaults\n              ? \"默认安全模式。\"\n              : `默认值: ${defaults.security}.`}\n          </div>\n        </div>\n        <div class=\"list-meta\">\n          <label class=\"field\">\n            <span>模式</span>\n            <select\n              ?disabled=${state.disabled}\n              @change=${(event: Event) => {\n                const target = event.target as HTMLSelectElement;\n                const value = target.value;\n                if (!isDefaults && value === \"__default__\") {\n                  state.onRemove([...basePath, \"security\"]);\n                } else {\n                  state.onPatch([...basePath, \"security\"], value);\n                }\n              }}\n            >\n              ${!isDefaults\n                ? html`<option value=\"__default__\" ?selected=${securityValue === \"__default__\"}>\n                    使用默认值 (${defaults.security})\n                  </option>`\n                : nothing}\n              ${SECURITY_OPTIONS.map(\n                (option) =>\n                  html`<option\n                    value=${option.value}\n                    ?selected=${securityValue === option.value}\n                  >\n                    ${option.label}\n                  </option>`,\n              )}\n            </select>\n          </label>\n        </div>\n      </div>\n\n      <div class=\"list-item\">\n        <div class=\"list-main\">\n          <div class=\"list-title\">询问</div>\n          <div class=\"list-sub\">\n            ${isDefaults ? \"默认提示策略。\" : `默认值: ${defaults.ask}.`}\n          </div>\n        </div>\n        <div class=\"list-meta\">\n          <label class=\"field\">\n            <span>模式</span>\n            <select\n              ?disabled=${state.disabled}\n              @change=${(event: Event) => {\n                const target = event.target as HTMLSelectElement;\n                const value = target.value;\n                if (!isDefaults && value === \"__default__\") {\n                  state.onRemove([...basePath, \"ask\"]);\n                } else {\n                  state.onPatch([...basePath, \"ask\"], value);\n                }\n              }}\n            >\n              ${!isDefaults\n                ? html`<option value=\"__default__\" ?selected=${askValue === \"__default__\"}>\n                    使用默认值 (${defaults.ask})\n                  </option>`\n                : nothing}\n              ${ASK_OPTIONS.map(\n                (option) =>\n                  html`<option\n                    value=${option.value}\n                    ?selected=${askValue === option.value}\n                  >\n                    ${option.label}\n                  </option>`,\n              )}\n            </select>\n          </label>\n        </div>\n      </div>\n\n      <div class=\"list-item\">\n        <div class=\"list-main\">\n          <div class=\"list-title\">询问回退</div>\n          <div class=\"list-sub\">\n            ${isDefaults\n              ? \"当UI提示不可用时应用。\"\n              : `默认值: ${defaults.askFallback}.`}\n          </div>\n        </div>\n        <div class=\"list-meta\">\n          <label class=\"field\">\n            <span>回退</span>\n            <select\n              ?disabled=${state.disabled}\n              @change=${(event: Event) => {\n                const target = event.target as HTMLSelectElement;\n                const value = target.value;\n                if (!isDefaults && value === \"__default__\") {\n                  state.onRemove([...basePath, \"askFallback\"]);\n                } else {\n                  state.onPatch([...basePath, \"askFallback\"], value);\n                }\n              }}\n            >\n              ${!isDefaults\n                ? html`<option value=\"__default__\" ?selected=${askFallbackValue === \"__default__\"}>\n                    使用默认值 (${defaults.askFallback})\n                  </option>`\n                : nothing}\n              ${SECURITY_OPTIONS.map(\n                (option) =>\n                  html`<option\n                    value=${option.value}\n                    ?selected=${askFallbackValue === option.value}\n                  >\n                    ${option.label}\n                  </option>`,\n              )}\n            </select>\n          </label>\n        </div>\n      </div>\n\n      <div class=\"list-item\">\n        <div class=\"list-main\">\n          <div class=\"list-title\">自动允许技能CLI</div>\n          <div class=\"list-sub\">\n            ${isDefaults\n              ? \"允许网关列出的技能可执行文件。\"\n              : autoIsDefault\n                ? `使用默认值 (${defaults.autoAllowSkills ? \"开\" : \"关\"}).`\n                : `覆盖 (${autoEffective ? \"开\" : \"关\"}).`}\n          </div>\n        </div>\n        <div class=\"list-meta\">\n          <label class=\"field\">\n            <span>启用</span>\n            <input\n              type=\"checkbox\"\n              ?disabled=${state.disabled}\n              .checked=${autoEffective}\n              @change=${(event: Event) => {\n                const target = event.target as HTMLInputElement;\n                state.onPatch([...basePath, \"autoAllowSkills\"], target.checked);\n              }}\n            />\n          </label>\n          ${!isDefaults && !autoIsDefault\n            ? html`<button\n                class=\"btn btn--sm\"\n                ?disabled=${state.disabled}\n                @click=${() => state.onRemove([...basePath, \"autoAllowSkills\"])}\n              >\n                使用默认值\n              </button>`\n            : nothing}\n        </div>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderExecApprovalsAllowlist(state: ExecApprovalsState) {\n  const allowlistPath = [\"agents\", state.selectedScope, \"allowlist\"];\n  const entries = state.allowlist;\n  return html`\n    <div class=\"row\" style=\"margin-top: 18px; justify-content: space-between;\">\n      <div>\n        <div class=\"card-title\">白名单</div>\n        <div class=\"card-sub\">不区分大小写的通配符模式。</div>\n      </div>\n      <button\n        class=\"btn btn--sm\"\n        ?disabled=${state.disabled}\n        @click=${() => {\n          const next = [...entries, { pattern: \"\" }];\n          state.onPatch(allowlistPath, next);\n        }}\n      >\n        添加模式\n      </button>\n    </div>\n    <div class=\"list\" style=\"margin-top: 12px;\">\n      ${entries.length === 0\n        ? html`<div class=\"muted\">尚无白名单条目。</div>`\n        : entries.map((entry, index) =>\n            renderAllowlistEntry(state, entry, index),\n          )}\n    </div>\n  `;\n}\n\nfunction renderAllowlistEntry(\n  state: ExecApprovalsState,\n  entry: ExecApprovalsAllowlistEntry,\n  index: number,\n) {\n  const lastUsed = entry.lastUsedAt ? formatAgo(entry.lastUsedAt) : \"从未\";\n  const lastCommand = entry.lastUsedCommand\n    ? clampText(entry.lastUsedCommand, 120)\n    : null;\n  const lastPath = entry.lastResolvedPath\n    ? clampText(entry.lastResolvedPath, 120)\n    : null;\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${entry.pattern?.trim() ? entry.pattern : \"新模式\"}</div>\n        <div class=\"list-sub\">最后使用: ${lastUsed}</div>\n        ${lastCommand ? html`<div class=\"list-sub mono\">${lastCommand}</div>` : nothing}\n        ${lastPath ? html`<div class=\"list-sub mono\">${lastPath}</div>` : nothing}\n      </div>\n      <div class=\"list-meta\">\n        <label class=\"field\">\n          <span>模式</span>\n          <input\n            type=\"text\"\n            .value=${entry.pattern ?? \"\"}\n            ?disabled=${state.disabled}\n            @input=${(event: Event) => {\n              const target = event.target as HTMLInputElement;\n              state.onPatch(\n                [\"agents\", state.selectedScope, \"allowlist\", index, \"pattern\"],\n                target.value,\n              );\n            }}\n          />\n        </label>\n        <button\n          class=\"btn btn--sm danger\"\n          ?disabled=${state.disabled}\n          @click=${() => {\n            if (state.allowlist.length <= 1) {\n              state.onRemove([\"agents\", state.selectedScope, \"allowlist\"]);\n              return;\n            }\n            state.onRemove([\"agents\", state.selectedScope, \"allowlist\", index]);\n          }}\n        >\n          移除\n        </button>\n      </div>\n    </div>\n  `;\n}\n\nfunction renderAgentBinding(agent: BindingAgent, state: BindingState) {\n  const bindingValue = agent.binding ?? \"__default__\";\n  const label = agent.name?.trim() ? `${agent.name} (${agent.id})` : agent.id;\n  const supportsBinding = state.nodes.length > 0;\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${label}</div>\n        <div class=\"list-sub\">\n          ${agent.isDefault ? \"默认代理\" : \"代理\"} ·\n          ${bindingValue === \"__default__\"\n            ? `使用默认值 (${state.defaultBinding ?? \"任意\"})`\n            : `覆盖: ${agent.binding}`}\n        </div>\n      </div>\n      <div class=\"list-meta\">\n        <label class=\"field\">\n          <span>绑定</span>\n          <select\n            ?disabled=${state.disabled || !supportsBinding}\n            @change=${(event: Event) => {\n              const target = event.target as HTMLSelectElement;\n              const value = target.value.trim();\n              state.onBindAgent(agent.index, value === \"__default__\" ? null : value);\n            }}\n          >\n            <option value=\"__default__\" ?selected=${bindingValue === \"__default__\"}>\n              使用默认值\n            </option>\n            ${state.nodes.map(\n              (node) =>\n                html`<option\n                  value=${node.id}\n                  ?selected=${bindingValue === node.id}\n                >\n                  ${node.label}\n                </option>`,\n            )}\n          </select>\n        </label>\n      </div>\n    </div>\n  `;\n}\n\nfunction resolveExecNodes(nodes: Array<Record<string, unknown>>): BindingNode[] {\n  const list: BindingNode[] = [];\n  for (const node of nodes) {\n    const commands = Array.isArray(node.commands) ? node.commands : [];\n    const supports = commands.some((cmd) => String(cmd) === \"system.run\");\n    if (!supports) continue;\n    const nodeId = typeof node.nodeId === \"string\" ? node.nodeId.trim() : \"\";\n    if (!nodeId) continue;\n    const displayName =\n      typeof node.displayName === \"string\" && node.displayName.trim()\n        ? node.displayName.trim()\n        : nodeId;\n    list.push({ id: nodeId, label: displayName === nodeId ? nodeId : `${displayName} · ${nodeId}` });\n  }\n  list.sort((a, b) => a.label.localeCompare(b.label));\n  return list;\n}\n\nfunction resolveExecApprovalsNodes(nodes: Array<Record<string, unknown>>): ExecApprovalsTargetNode[] {\n  const list: ExecApprovalsTargetNode[] = [];\n  for (const node of nodes) {\n    const commands = Array.isArray(node.commands) ? node.commands : [];\n    const supports = commands.some(\n      (cmd) => String(cmd) === \"system.execApprovals.get\" || String(cmd) === \"system.execApprovals.set\",\n    );\n    if (!supports) continue;\n    const nodeId = typeof node.nodeId === \"string\" ? node.nodeId.trim() : \"\";\n    if (!nodeId) continue;\n    const displayName =\n      typeof node.displayName === \"string\" && node.displayName.trim()\n        ? node.displayName.trim()\n        : nodeId;\n    list.push({ id: nodeId, label: displayName === nodeId ? nodeId : `${displayName} · ${nodeId}` });\n  }\n  list.sort((a, b) => a.label.localeCompare(b.label));\n  return list;\n}\n\nfunction resolveAgentBindings(config: Record<string, unknown> | null): {\n  defaultBinding?: string | null;\n  agents: BindingAgent[];\n} {\n  const fallbackAgent: BindingAgent = {\n    id: \"main\",\n    name: undefined,\n    index: 0,\n    isDefault: true,\n    binding: null,\n  };\n  if (!config || typeof config !== \"object\") {\n    return { defaultBinding: null, agents: [fallbackAgent] };\n  }\n  const tools = (config.tools ?? {}) as Record<string, unknown>;\n  const exec = (tools.exec ?? {}) as Record<string, unknown>;\n  const defaultBinding =\n    typeof exec.node === \"string\" && exec.node.trim() ? exec.node.trim() : null;\n\n  const agentsNode = (config.agents ?? {}) as Record<string, unknown>;\n  const list = Array.isArray(agentsNode.list) ? agentsNode.list : [];\n  if (list.length === 0) {\n    return { defaultBinding, agents: [fallbackAgent] };\n  }\n\n  const agents: BindingAgent[] = [];\n  list.forEach((entry, index) => {\n    if (!entry || typeof entry !== \"object\") return;\n    const record = entry as Record<string, unknown>;\n    const id = typeof record.id === \"string\" ? record.id.trim() : \"\";\n    if (!id) return;\n    const name = typeof record.name === \"string\" ? record.name.trim() : undefined;\n    const isDefault = record.default === true;\n    const toolsEntry = (record.tools ?? {}) as Record<string, unknown>;\n    const execEntry = (toolsEntry.exec ?? {}) as Record<string, unknown>;\n    const binding =\n      typeof execEntry.node === \"string\" && execEntry.node.trim()\n        ? execEntry.node.trim()\n        : null;\n    agents.push({\n      id,\n      name: name || undefined,\n      index,\n      isDefault,\n      binding,\n    });\n  });\n\n  if (agents.length === 0) {\n    agents.push(fallbackAgent);\n  }\n\n  return { defaultBinding, agents };\n}\n\nfunction renderNode(node: Record<string, unknown>) {\n  const connected = Boolean(node.connected);\n  const paired = Boolean(node.paired);\n  const title =\n    (typeof node.displayName === \"string\" && node.displayName.trim()) ||\n    (typeof node.nodeId === \"string\" ? node.nodeId : \"未知\");\n  const caps = Array.isArray(node.caps) ? (node.caps as unknown[]) : [];\n  const commands = Array.isArray(node.commands) ? (node.commands as unknown[]) : [];\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">${title}</div>\n        <div class=\"list-sub\">\n          ${typeof node.nodeId === \"string\" ? node.nodeId : \"\"}\n          ${typeof node.remoteIp === \"string\" ? ` · ${node.remoteIp}` : \"\"}\n          ${typeof node.version === \"string\" ? ` · ${node.version}` : \"\"}\n        </div>\n        <div class=\"chip-row\" style=\"margin-top: 6px;\">\n          <span class=\"chip\">${paired ? \"已配对\" : \"未配对\"}</span>\n          <span class=\"chip ${connected ? \"chip-ok\" : \"chip-warn\"}\">\n            ${connected ? \"已连接\" : \"离线\"}\n          </span>\n          ${caps.slice(0, 12).map((c) => html`<span class=\"chip\">${String(c)}</span>`)}\n          ${commands\n            .slice(0, 8)\n            .map((c) => html`<span class=\"chip\">${String(c)}</span>`)}\n        </div>\n      </div>\n    </div>\n  `;\n}\n","import { html } from \"lit\";\n\nimport type { GatewayHelloOk } from \"../gateway\";\nimport { formatAgo, formatDurationMs } from \"../format\";\nimport { formatNextRun } from \"../presenter\";\nimport type { UiSettings } from \"../storage\";\n\nexport type OverviewProps = {\n  connected: boolean;\n  hello: GatewayHelloOk | null;\n  settings: UiSettings;\n  password: string;\n  lastError: string | null;\n  presenceCount: number;\n  sessionsCount: number | null;\n  cronEnabled: boolean | null;\n  cronNext: number | null;\n  lastChannelsRefresh: number | null;\n  onSettingsChange: (next: UiSettings) => void;\n  onPasswordChange: (next: string) => void;\n  onSessionKeyChange: (next: string) => void;\n  onConnect: () => void;\n  onRefresh: () => void;\n};\n\nexport function renderOverview(props: OverviewProps) {\n  const snapshot = props.hello?.snapshot as\n    | { uptimeMs?: number; policy?: { tickIntervalMs?: number } }\n    | undefined;\n  const uptime = snapshot?.uptimeMs ? formatDurationMs(snapshot.uptimeMs) : \"n/a\";\n  const tick = snapshot?.policy?.tickIntervalMs\n    ? `${snapshot.policy.tickIntervalMs}ms`\n    : \"n/a\";\n  const authHint = (() => {\n    if (props.connected || !props.lastError) return null;\n    const lower = props.lastError.toLowerCase();\n    const authFailed = lower.includes(\"unauthorized\") || lower.includes(\"connect failed\");\n    if (!authFailed) return null;\n    const hasToken = Boolean(props.settings.token.trim());\n    const hasPassword = Boolean(props.password.trim());\n    if (!hasToken && !hasPassword) {\n      return html`\n        <div class=\"muted\" style=\"margin-top: 8px;\">\n          此网关需要身份验证。添加令牌或密码，然后点击连接。\n          <div style=\"margin-top: 6px;\">\n            <span class=\"mono\">clawdbot dashboard --no-open</span> → 生成带令牌的URL<br />\n            <span class=\"mono\">clawdbot doctor --generate-gateway-token</span> → 设置令牌\n          </div>\n          <div style=\"margin-top: 6px;\">\n            <a\n              class=\"session-link\"\n              href=\"https://docs.clawd.bot/web/dashboard\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n              title=\"控制界面身份验证文档（在新标签页中打开）\"\n              >文档：控制界面身份验证</a\n            >\n          </div>\n        </div>\n      `;\n    }\n    return html`\n      <div class=\"muted\" style=\"margin-top: 8px;\">\n        身份验证失败。重新复制带令牌的URL，使用\n        <span class=\"mono\">clawdbot dashboard --no-open</span>，或更新令牌，\n        然后点击连接。\n        <div style=\"margin-top: 6px;\">\n          <a\n            class=\"session-link\"\n            href=\"https://docs.clawd.bot/web/dashboard\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            title=\"控制界面身份验证文档（在新标签页中打开）\"\n            >文档：控制界面身份验证</a\n          >\n        </div>\n      </div>\n    `;\n  })();\n  const insecureContextHint = (() => {\n    if (props.connected || !props.lastError) return null;\n    const isSecureContext = typeof window !== \"undefined\" ? window.isSecureContext : true;\n    if (isSecureContext !== false) return null;\n    const lower = props.lastError.toLowerCase();\n    if (!lower.includes(\"secure context\") && !lower.includes(\"device identity required\")) {\n      return null;\n    }\n    return html`\n      <div class=\"muted\" style=\"margin-top: 8px;\">\n        此页面使用HTTP协议，因此浏览器会阻止设备身份验证。请使用HTTPS（Tailscale Serve）或\n        在网关主机上打开 <span class=\"mono\">http://127.0.0.1:18789</span>。\n        <div style=\"margin-top: 6px;\">\n          如果必须使用HTTP，请设置\n          <span class=\"mono\">gateway.controlUi.allowInsecureAuth: true</span>（仅限令牌）。\n        </div>\n        <div style=\"margin-top: 6px;\">\n          <a\n            class=\"session-link\"\n            href=\"https://docs.clawd.bot/gateway/tailscale\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            title=\"Tailscale Serve 文档（在新标签页中打开）\"\n            >文档：Tailscale Serve</a\n          >\n          <span class=\"muted\"> · </span>\n          <a\n            class=\"session-link\"\n            href=\"https://docs.clawd.bot/web/control-ui#insecure-http\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n            title=\"非安全HTTP文档（在新标签页中打开）\"\n            >文档：非安全HTTP</a\n          >\n        </div>\n      </div>\n    `;\n  })();\n\n  return html`\n    <section class=\"grid grid-cols-2\">\n      <div class=\"card\">\n        <div class=\"card-title\">网关访问</div>\n        <div class=\"card-sub\">仪表板连接位置以及身份验证方式。</div>\n        <div class=\"form-grid\" style=\"margin-top: 16px;\">\n          <label class=\"field\">\n            <span>WebSocket URL</span>\n            <input\n              .value=${props.settings.gatewayUrl}\n              @input=${(e: Event) => {\n                const v = (e.target as HTMLInputElement).value;\n                props.onSettingsChange({ ...props.settings, gatewayUrl: v });\n              }}\n              placeholder=\"ws://100.x.y.z:18789\"\n            />\n          </label>\n          <label class=\"field\">\n            <span>网关令牌</span>\n            <input\n              .value=${props.settings.token}\n              @input=${(e: Event) => {\n                const v = (e.target as HTMLInputElement).value;\n                props.onSettingsChange({ ...props.settings, token: v });\n              }}\n              placeholder=\"CLAWDBOT_GATEWAY_TOKEN\"\n            />\n          </label>\n          <label class=\"field\">\n            <span>密码（不存储）</span>\n            <input\n              type=\"password\"\n              .value=${props.password}\n              @input=${(e: Event) => {\n                const v = (e.target as HTMLInputElement).value;\n                props.onPasswordChange(v);\n              }}\n              placeholder=\"系统或共享密码\"\n            />\n          </label>\n          <label class=\"field\">\n            <span>默认会话密钥</span>\n            <input\n              .value=${props.settings.sessionKey}\n              @input=${(e: Event) => {\n                const v = (e.target as HTMLInputElement).value;\n                props.onSessionKeyChange(v);\n              }}\n            />\n          </label>\n        </div>\n        <div class=\"row\" style=\"margin-top: 14px;\">\n          <button class=\"btn\" @click=${() => props.onConnect()}>连接</button>\n          <button class=\"btn\" @click=${() => props.onRefresh()}>刷新</button>\n          <span class=\"muted\">点击连接以应用连接更改。</span>\n        </div>\n      </div>\n\n      <div class=\"card\">\n        <div class=\"card-title\">快照</div>\n        <div class=\"card-sub\">最新网关握手信息。</div>\n        <div class=\"stat-grid\" style=\"margin-top: 16px;\">\n          <div class=\"stat\">\n            <div class=\"stat-label\">状态</div>\n            <div class=\"stat-value ${props.connected ? \"ok\" : \"warn\"}\">\n              ${props.connected ? \"已连接\" : \"已断开\"}\n            </div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">运行时间</div>\n            <div class=\"stat-value\">${uptime}</div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">心跳间隔</div>\n            <div class=\"stat-value\">${tick}</div>\n          </div>\n          <div class=\"stat\">\n            <div class=\"stat-label\">上次通道刷新</div>\n            <div class=\"stat-value\">\n              ${props.lastChannelsRefresh\n                ? formatAgo(props.lastChannelsRefresh)\n                : \"无\"}\n            </div>\n          </div>\n        </div>\n        ${props.lastError\n          ? html`<div class=\"callout danger\" style=\"margin-top: 14px;\">\n              <div>${props.lastError}</div>\n              ${authHint ?? \"\"}\n              ${insecureContextHint ?? \"\"}\n            </div>`\n          : html`<div class=\"callout\" style=\"margin-top: 14px;\">\n              使用通道链接 WhatsApp、Telegram、Discord、Signal 或 iMessage。\n            </div>`}\n      </div>\n    </section>\n\n    <section class=\"grid grid-cols-3\" style=\"margin-top: 18px;\">\n      <div class=\"card stat-card\">\n        <div class=\"stat-label\">实例</div>\n        <div class=\"stat-value\">${props.presenceCount}</div>\n        <div class=\"muted\">过去5分钟内的存在信标。</div>\n      </div>\n      <div class=\"card stat-card\">\n        <div class=\"stat-label\">会话</div>\n        <div class=\"stat-value\">${props.sessionsCount ?? \"n/a\"}</div>\n        <div class=\"muted\">网关跟踪的最近会话密钥。</div>\n      </div>\n      <div class=\"card stat-card\">\n        <div class=\"stat-label\">定时任务</div>\n        <div class=\"stat-value\">\n          ${props.cronEnabled == null\n            ? \"无\"\n            : props.cronEnabled\n              ? \"启用\"\n              : \"禁用\"}\n        </div>\n        <div class=\"muted\">下次唤醒 ${formatNextRun(props.cronNext)}</div>\n      </div>\n    </section>\n\n    <section class=\"card\" style=\"margin-top: 18px;\">\n      <div class=\"card-title\">注意事项</div>\n      <div class=\"card-sub\">远程控制设置的快速提醒。</div>\n      <div class=\"note-grid\" style=\"margin-top: 14px;\">\n        <div>\n          <div class=\"note-title\">Tailscale服务</div>\n          <div class=\"muted\">\n            优先使用服务模式，在回环接口上保持网关并使用尾网认证。\n          </div>\n        </div>\n        <div>\n          <div class=\"note-title\">会话管理</div>\n          <div class=\"muted\">使用 /new 或 sessions.patch 来重置上下文。</div>\n        </div>\n        <div>\n          <div class=\"note-title\">定时任务提醒</div>\n          <div class=\"muted\">对重复运行使用隔离会话。</div>\n        </div>\n      </div>\n    </section>\n  `;\n}\n","import { html, nothing } from \"lit\";\n\nimport { formatAgo } from \"../format\";\nimport { formatSessionTokens } from \"../presenter\";\nimport { pathForTab } from \"../navigation\";\nimport type { GatewaySessionRow, SessionsListResult } from \"../types\";\n\nexport type SessionsProps = {\n  loading: boolean;\n  result: SessionsListResult | null;\n  error: string | null;\n  activeMinutes: string;\n  limit: string;\n  includeGlobal: boolean;\n  includeUnknown: boolean;\n  basePath: string;\n  onFiltersChange: (next: {\n    activeMinutes: string;\n    limit: string;\n    includeGlobal: boolean;\n    includeUnknown: boolean;\n  }) => void;\n  onRefresh: () => void;\n  onPatch: (\n    key: string,\n    patch: {\n      label?: string | null;\n      thinkingLevel?: string | null;\n      verboseLevel?: string | null;\n      reasoningLevel?: string | null;\n    },\n  ) => void;\n  onDelete: (key: string) => void;\n};\n\nconst THINK_LEVELS = [\"\", \"off\", \"minimal\", \"low\", \"medium\", \"high\"] as const;\nconst BINARY_THINK_LEVELS = [\"\", \"off\", \"on\"] as const;\nconst VERBOSE_LEVELS = [\n  { value: \"\", label: \"inherit\" },\n  { value: \"off\", label: \"off (explicit)\" },\n  { value: \"on\", label: \"on\" },\n] as const;\nconst REASONING_LEVELS = [\"\", \"off\", \"on\", \"stream\"] as const;\n\nfunction normalizeProviderId(provider?: string | null): string {\n  if (!provider) return \"\";\n  const normalized = provider.trim().toLowerCase();\n  if (normalized === \"z.ai\" || normalized === \"z-ai\") return \"zai\";\n  return normalized;\n}\n\nfunction isBinaryThinkingProvider(provider?: string | null): boolean {\n  return normalizeProviderId(provider) === \"zai\";\n}\n\nfunction resolveThinkLevelOptions(provider?: string | null): readonly string[] {\n  return isBinaryThinkingProvider(provider) ? BINARY_THINK_LEVELS : THINK_LEVELS;\n}\n\nfunction resolveThinkLevelDisplay(value: string, isBinary: boolean): string {\n  if (!isBinary) return value;\n  if (!value || value === \"off\") return value;\n  return \"on\";\n}\n\nfunction resolveThinkLevelPatchValue(value: string, isBinary: boolean): string | null {\n  if (!value) return null;\n  if (!isBinary) return value;\n  if (value === \"on\") return \"low\";\n  return value;\n}\n\nexport function renderSessions(props: SessionsProps) {\n  const rows = props.result?.sessions ?? [];\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">会话</div>\n          <div class=\"card-sub\">活跃会话密钥和每会话覆盖设置。</div>\n        </div>\n        <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n          ${props.loading ? \"加载中…\" : \"刷新\"}\n        </button>\n      </div>\n\n      <div class=\"filters\" style=\"margin-top: 14px;\">\n        <label class=\"field\">\n          <span>活跃于（分钟内）</span>\n          <input\n            .value=${props.activeMinutes}\n            @input=${(e: Event) =>\n              props.onFiltersChange({\n                activeMinutes: (e.target as HTMLInputElement).value,\n                limit: props.limit,\n                includeGlobal: props.includeGlobal,\n                includeUnknown: props.includeUnknown,\n              })}\n          />\n        </label>\n        <label class=\"field\">\n          <span>限制</span>\n          <input\n            .value=${props.limit}\n            @input=${(e: Event) =>\n              props.onFiltersChange({\n                activeMinutes: props.activeMinutes,\n                limit: (e.target as HTMLInputElement).value,\n                includeGlobal: props.includeGlobal,\n                includeUnknown: props.includeUnknown,\n              })}\n          />\n        </label>\n        <label class=\"field checkbox\">\n          <span>包含全局</span>\n          <input\n            type=\"checkbox\"\n            .checked=${props.includeGlobal}\n            @change=${(e: Event) =>\n              props.onFiltersChange({\n                activeMinutes: props.activeMinutes,\n                limit: props.limit,\n                includeGlobal: (e.target as HTMLInputElement).checked,\n                includeUnknown: props.includeUnknown,\n              })}\n          />\n        </label>\n        <label class=\"field checkbox\">\n          <span>包含未知</span>\n          <input\n            type=\"checkbox\"\n            .checked=${props.includeUnknown}\n            @change=${(e: Event) =>\n              props.onFiltersChange({\n                activeMinutes: props.activeMinutes,\n                limit: props.limit,\n                includeGlobal: props.includeGlobal,\n                includeUnknown: (e.target as HTMLInputElement).checked,\n              })}\n          />\n        </label>\n      </div>\n\n      ${props.error\n        ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${props.error}</div>`\n        : nothing}\n\n      <div class=\"muted\" style=\"margin-top: 12px;\">\n        ${props.result ? `存储: ${props.result.path}` : \"\"}\n      </div>\n\n      <div class=\"table\" style=\"margin-top: 16px;\">\n        <div class=\"table-head\">\n          <div>密钥</div>\n          <div>标签</div>\n          <div>类型</div>\n          <div>更新时间</div>\n          <div>令牌</div>\n          <div>思考</div>\n          <div>详细</div>\n          <div>推理</div>\n          <div>操作</div>\n        </div>\n        ${rows.length === 0\n          ? html`<div class=\"muted\">未找到会话。</div>`\n          : rows.map((row) =>\n              renderRow(row, props.basePath, props.onPatch, props.onDelete, props.loading),\n            )}\n      </div>\n    </section>\n  `;\n}\n\nfunction renderRow(\n  row: GatewaySessionRow,\n  basePath: string,\n  onPatch: SessionsProps[\"onPatch\"],\n  onDelete: SessionsProps[\"onDelete\"],\n  disabled: boolean,\n) {\n  const updated = row.updatedAt ? formatAgo(row.updatedAt) : \"无\";\n  const rawThinking = row.thinkingLevel ?? \"\";\n  const isBinaryThinking = isBinaryThinkingProvider(row.modelProvider);\n  const thinking = resolveThinkLevelDisplay(rawThinking, isBinaryThinking);\n  const thinkLevels = resolveThinkLevelOptions(row.modelProvider);\n  const verbose = row.verboseLevel ?? \"\";\n  const reasoning = row.reasoningLevel ?? \"\";\n  const displayName = row.displayName ?? row.key;\n  const canLink = row.kind !== \"global\";\n  const chatUrl = canLink\n    ? `${pathForTab(\"chat\", basePath)}?session=${encodeURIComponent(row.key)}`\n    : null;\n\n  return html`\n    <div class=\"table-row\">\n      <div class=\"mono\">${canLink\n        ? html`<a href=${chatUrl} class=\"session-link\">${displayName}</a>`\n        : displayName}</div>\n      <div>\n        <input\n          .value=${row.label ?? \"\"}\n          ?disabled=${disabled}\n          placeholder=\"（可选）\"\n          @change=${(e: Event) => {\n            const value = (e.target as HTMLInputElement).value.trim();\n            onPatch(row.key, { label: value || null });\n          }}\n        />\n      </div>\n      <div>${row.kind}</div>\n      <div>${updated}</div>\n      <div>${formatSessionTokens(row)}</div>\n      <div>\n        <select\n          .value=${thinking}\n          ?disabled=${disabled}\n          @change=${(e: Event) => {\n            const value = (e.target as HTMLSelectElement).value;\n            onPatch(row.key, {\n              thinkingLevel: resolveThinkLevelPatchValue(value, isBinaryThinking),\n            });\n          }}\n        >\n          ${thinkLevels.map((level) =>\n            html`<option value=${level}>${level || \"继承\"}</option>`\n          )}\n        </select>\n      </div>\n      <div>\n        <select\n          .value=${verbose}\n          ?disabled=${disabled}\n          @change=${(e: Event) => {\n            const value = (e.target as HTMLSelectElement).value;\n            onPatch(row.key, { verboseLevel: value || null });\n          }}\n        >\n          ${VERBOSE_LEVELS.map(\n            (level) => html`<option value=${level.value}>${level.label}</option>`,\n          )}\n        </select>\n      </div>\n      <div>\n        <select\n          .value=${reasoning}\n          ?disabled=${disabled}\n          @change=${(e: Event) => {\n            const value = (e.target as HTMLSelectElement).value;\n            onPatch(row.key, { reasoningLevel: value || null });\n          }}\n        >\n          ${REASONING_LEVELS.map((level) =>\n            html`<option value=${level}>${level || \"继承\"}</option>`\n          )}\n        </select>\n      </div>\n      <div>\n        <button class=\"btn danger\" ?disabled=${disabled} @click=${() => onDelete(row.key)}>\n          删除\n        </button>\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\nimport type { SkillMessageMap } from \"../controllers/skills\";\nimport type { SkillStatusEntry, SkillStatusReport } from \"../types\";\nimport { clampText } from \"../format\";\n\ntype SkillGroup = {\n  id: string;\n  label: string;\n  skills: SkillStatusEntry[];\n};\n\nconst SKILL_SOURCE_GROUPS: Array<{ id: string; label: string; sources: string[] }> = [\n  { id: \"workspace\", label: \"工作区技能\", sources: [\"openclaw-workspace\"] },\n  { id: \"built-in\", label: \"内置技能\", sources: [\"openclaw-bundled\"] },\n  { id: \"installed\", label: \"已安装技能\", sources: [\"openclaw-managed\"] },\n  { id: \"extra\", label: \"额外技能\", sources: [\"openclaw-extra\"] },\n];\n\nfunction groupSkills(skills: SkillStatusEntry[]): SkillGroup[] {\n  const groups = new Map<string, SkillGroup>();\n  for (const def of SKILL_SOURCE_GROUPS) {\n    groups.set(def.id, { id: def.id, label: def.label, skills: [] });\n  }\n  const other: SkillGroup = { id: \"other\", label: \"其他技能\", skills: [] };\n  for (const skill of skills) {\n    const match = SKILL_SOURCE_GROUPS.find((group) => group.sources.includes(skill.source));\n    if (match) {\n      groups.get(match.id)?.skills.push(skill);\n    } else {\n      other.skills.push(skill);\n    }\n  }\n  const ordered = SKILL_SOURCE_GROUPS.map((group) => groups.get(group.id)).filter(\n    (group): group is SkillGroup => Boolean(group && group.skills.length > 0),\n  );\n  if (other.skills.length > 0) {\n    ordered.push(other);\n  }\n  return ordered;\n}\n\nexport type SkillsProps = {\n  loading: boolean;\n  report: SkillStatusReport | null;\n  error: string | null;\n  filter: string;\n  edits: Record<string, string>;\n  busyKey: string | null;\n  messages: SkillMessageMap;\n  onFilterChange: (next: string) => void;\n  onRefresh: () => void;\n  onToggle: (skillKey: string, enabled: boolean) => void;\n  onEdit: (skillKey: string, value: string) => void;\n  onSaveKey: (skillKey: string) => void;\n  onInstall: (skillKey: string, name: string, installId: string) => void;\n};\n\nexport function renderSkills(props: SkillsProps) {\n  const skills = props.report?.skills ?? [];\n  const filter = props.filter.trim().toLowerCase();\n  const filtered = filter\n    ? skills.filter((skill) =>\n        [skill.name, skill.description, skill.source].join(\" \").toLowerCase().includes(filter),\n      )\n    : skills;\n  const groups = groupSkills(filtered);\n\n  return html`\n    <section class=\"card\">\n      <div class=\"row\" style=\"justify-content: space-between;\">\n        <div>\n          <div class=\"card-title\">技能</div>\n          <div class=\"card-sub\">内置、管理和工作区技能。</div>\n        </div>\n        <button class=\"btn\" ?disabled=${props.loading} @click=${props.onRefresh}>\n          ${props.loading ? \"加载中…\" : \"刷新\"}\n        </button>\n      </div>\n\n      <div class=\"filters\" style=\"margin-top: 14px;\">\n        <label class=\"field\" style=\"flex: 1;\">\n          <span>过滤</span>\n          <input\n            .value=${props.filter}\n            @input=${(e: Event) => props.onFilterChange((e.target as HTMLInputElement).value)}\n            placeholder=\"搜索技能\"\n          />\n        </label>\n        <div class=\"muted\">显示 ${filtered.length} 个</div>\n      </div>\n\n      ${\n        props.error\n          ? html`<div class=\"callout danger\" style=\"margin-top: 12px;\">${props.error}</div>`\n          : nothing\n      }\n\n      ${\n        filtered.length === 0\n          ? html`\n              <div class=\"muted\" style=\"margin-top: 16px\">未找到技能。</div>\n            `\n          : html`\n            <div class=\"agent-skills-groups\" style=\"margin-top: 16px;\">\n              ${groups.map((group) => {\n                const collapsedByDefault = group.id === \"workspace\" || group.id === \"built-in\";\n                return html`\n                  <details class=\"agent-skills-group\" ?open=${!collapsedByDefault}>\n                    <summary class=\"agent-skills-header\">\n                      <span>${group.label}</span>\n                      <span class=\"muted\">${group.skills.length}</span>\n                    </summary>\n                    <div class=\"list skills-grid\">\n                      ${group.skills.map((skill) => renderSkill(skill, props))}\n                    </div>\n                  </details>\n                `;\n              })}\n            </div>\n          `\n      }\n    </section>\n  `;\n}\n\nfunction renderSkill(skill: SkillStatusEntry, props: SkillsProps) {\n  const busy = props.busyKey === skill.skillKey;\n  const apiKey = props.edits[skill.skillKey] ?? \"\";\n  const message = props.messages[skill.skillKey] ?? null;\n  const canInstall = skill.install.length > 0 && skill.missing.bins.length > 0;\n  const missing = [\n    ...skill.missing.bins.map((b) => `bin:${b}`),\n    ...skill.missing.env.map((e) => `env:${e}`),\n    ...skill.missing.config.map((c) => `config:${c}`),\n    ...skill.missing.os.map((o) => `os:${o}`),\n  ];\n  const reasons: string[] = [];\n  if (skill.disabled) {\n    reasons.push(\"已禁用\");\n  }\n  if (skill.blockedByAllowlist) {\n    reasons.push(\"被白名单阻止\");\n  }\n  return html`\n    <div class=\"list-item\">\n      <div class=\"list-main\">\n        <div class=\"list-title\">\n          ${skill.emoji ? `${skill.emoji} ` : \"\"}${skill.name}\n        </div>\n        <div class=\"list-sub\">${clampText(skill.description, 140)}</div>\n        <div class=\"chip-row\" style=\"margin-top: 6px;\">\n          <span class=\"chip\">${skill.source}</span>\n          <span class=\"chip ${skill.eligible ? \"chip-ok\" : \"chip-warn\"}\">\n            ${skill.eligible ? \"可用\" : \"已阻止\"}\n          </span>\n          ${\n            skill.disabled\n              ? html`\n                  <span class=\"chip chip-warn\">已禁用</span>\n                `\n              : nothing\n          }\n        </div>\n        ${\n          missing.length > 0\n            ? html`\n              <div class=\"muted\" style=\"margin-top: 6px;\">\n                缺失: ${missing.join(\", \")}\n              </div>\n            `\n            : nothing\n        }\n        ${\n          reasons.length > 0\n            ? html`\n              <div class=\"muted\" style=\"margin-top: 6px;\">\n                原因: ${reasons.join(\", \")}\n              </div>\n            `\n            : nothing\n        }\n      </div>\n      <div class=\"list-meta\">\n        <div class=\"row\" style=\"justify-content: flex-end; flex-wrap: wrap;\">\n          <button\n            class=\"btn\"\n            ?disabled=${busy}\n            @click=${() => props.onToggle(skill.skillKey, skill.disabled)}\n          >\n            ${skill.disabled ? \"启用\" : \"禁用\"}\n          </button>\n          ${\n            canInstall\n              ? html`<button\n                class=\"btn\"\n                ?disabled=${busy}\n                @click=${() => props.onInstall(skill.skillKey, skill.name, skill.install[0].id)}\n              >\n                ${busy ? \"安装中…\" : skill.install[0].label}\n              </button>`\n              : nothing\n          }\n        </div>\n        ${\n          message\n            ? html`<div\n              class=\"muted\"\n              style=\"margin-top: 8px; color: ${\n                message.kind === \"error\"\n                  ? \"var(--danger-color, #d14343)\"\n                  : \"var(--success-color, #0a7f5a)\"\n              };\"\n            >\n              ${message.message}\n            </div>`\n            : nothing\n        }\n        ${\n          skill.primaryEnv\n            ? html`\n              <div class=\"field\" style=\"margin-top: 10px;\">\n                <span>API 密钥</span>\n                <input\n                  type=\"password\"\n                  .value=${apiKey}\n                  @input=${(e: Event) =>\n                    props.onEdit(skill.skillKey, (e.target as HTMLInputElement).value)}\n                />\n              </div>\n              <button\n                class=\"btn primary\"\n                style=\"margin-top: 8px;\"\n                ?disabled=${busy}\n                @click=${() => props.onSaveKey(skill.skillKey)}\n              >\n                保存密钥\n              </button>\n            `\n            : nothing\n        }\n      </div>\n    </div>\n  `;\n}\n","import { html, nothing } from \"lit\";\nimport type { AppViewState } from \"./app-view-state.ts\";\nimport { parseAgentSessionKey } from \"../../../src/routing/session-key.js\";\nimport { ChatHost, refreshChatAvatar } from \"./app-chat.ts\";\nimport { renderChatControls, renderTab, renderThemeToggle } from \"./app-render.helpers.ts\";\nimport { OpenClawApp } from \"./app.ts\";\nimport { loadAgentFileContent, loadAgentFiles, saveAgentFile } from \"./controllers/agent-files.ts\";\nimport { loadAgentIdentities, loadAgentIdentity } from \"./controllers/agent-identity.ts\";\nimport { loadAgentSkills } from \"./controllers/agent-skills.ts\";\nimport { loadAgents } from \"./controllers/agents.ts\";\nimport { loadChannels } from \"./controllers/channels.ts\";\nimport { ChatState, loadChatHistory } from \"./controllers/chat.ts\";\nimport {\n  applyConfig,\n  ConfigState,\n  loadConfig,\n  runUpdate,\n  saveConfig,\n  updateConfigFormValue,\n  removeConfigFormValue,\n} from \"./controllers/config.ts\";\nimport {\n  loadCronRuns,\n  toggleCronJob,\n  runCronJob,\n  removeCronJob,\n  addCronJob,\n} from \"./controllers/cron.ts\";\nimport { loadDebug, callDebugMethod } from \"./controllers/debug.ts\";\nimport {\n  approveDevicePairing,\n  loadDevices,\n  rejectDevicePairing,\n  revokeDeviceToken,\n  rotateDeviceToken,\n} from \"./controllers/devices.ts\";\nimport {\n  loadExecApprovals,\n  removeExecApprovalsFormValue,\n  saveExecApprovals,\n  updateExecApprovalsFormValue,\n} from \"./controllers/exec-approvals.ts\";\nimport { loadLogs, LogsState } from \"./controllers/logs.ts\";\nimport { loadNodes } from \"./controllers/nodes.ts\";\nimport { loadPresence } from \"./controllers/presence.ts\";\nimport { deleteSession, loadSessions, patchSession } from \"./controllers/sessions.ts\";\nimport {\n  installSkill,\n  loadSkills,\n  saveSkillApiKey,\n  updateSkillEdit,\n  updateSkillEnabled,\n} from \"./controllers/skills.ts\";\nimport { icons } from \"./icons.ts\";\nimport { normalizeBasePath, TAB_GROUPS, subtitleForTab, titleForTab } from \"./navigation.ts\";\nimport { ConfigUiHints } from \"./types.ts\";\nimport { renderAgents } from \"./views/agents.ts\";\nimport { renderChannels } from \"./views/channels.ts\";\nimport { renderChat } from \"./views/chat.ts\";\nimport { renderConfig } from \"./views/config.ts\";\nimport { renderCron } from \"./views/cron.ts\";\nimport { renderDebug } from \"./views/debug.ts\";\nimport { renderExecApprovalPrompt } from \"./views/exec-approval.ts\";\nimport { renderGatewayUrlConfirmPrompt } from \"./views/gateway-url-confirm.ts\";\nimport { renderInstances } from \"./views/instances.ts\";\nimport { renderLogs } from \"./views/logs.ts\";\nimport { renderNodes } from \"./views/nodes.ts\";\nimport { renderOverview } from \"./views/overview.ts\";\nimport { renderSessions } from \"./views/sessions.ts\";\nimport { renderSkills } from \"./views/skills.ts\";\n\nconst AVATAR_DATA_RE = /^data:/i;\nconst AVATAR_HTTP_RE = /^https?:\\/\\//i;\n\nfunction resolveAssistantAvatarUrl(state: AppViewState): string | undefined {\n  const list = state.agentsList?.agents ?? [];\n  const parsed = parseAgentSessionKey(state.sessionKey);\n  const agentId = parsed?.agentId ?? state.agentsList?.defaultId ?? \"main\";\n  const agent = list.find((entry) => entry.id === agentId);\n  const identity = agent?.identity;\n  const candidate = identity?.avatarUrl ?? identity?.avatar;\n  if (!candidate) {\n    return undefined;\n  }\n  if (AVATAR_DATA_RE.test(candidate) || AVATAR_HTTP_RE.test(candidate)) {\n    return candidate;\n  }\n  return identity?.avatarUrl;\n}\n\nexport function renderApp(state: AppViewState) {\n  const presenceCount = state.presenceEntries.length;\n  const sessionsCount = state.sessionsResult?.count ?? null;\n  const cronNext = state.cronStatus?.nextWakeAtMs ?? null;\n  const chatDisabledReason = state.connected ? null : \"已断开与网关的连接。\";\n  const isChat = state.tab === \"chat\";\n  const chatFocus = isChat && (state.settings.chatFocusMode || state.onboarding);\n  const showThinking = state.onboarding ? false : state.settings.chatShowThinking;\n  const assistantAvatarUrl = resolveAssistantAvatarUrl(state);\n  const chatAvatarUrl = state.chatAvatarUrl ?? assistantAvatarUrl ?? null;\n  const logoBase = normalizeBasePath(state.basePath);\n  const logoHref = logoBase ? `${logoBase}/favicon.svg` : \"/favicon.svg\";\n  const configValue =\n    state.configForm ?? (state.configSnapshot?.config as Record<string, unknown> | null);\n  const resolvedAgentId =\n    state.agentsSelectedId ??\n    state.agentsList?.defaultId ??\n    state.agentsList?.agents?.[0]?.id ??\n    null;\n\n  return html`\n    <div class=\"shell ${isChat ? \"shell--chat\" : \"\"} ${chatFocus ? \"shell--chat-focus\" : \"\"} ${state.settings.navCollapsed ? \"shell--nav-collapsed\" : \"\"} ${state.onboarding ? \"shell--onboarding\" : \"\"}\">\n      <header class=\"topbar\">\n        <div class=\"topbar-left\">\n          <button\n            class=\"nav-collapse-toggle\"\n            @click=${() =>\n              state.applySettings({\n                ...state.settings,\n                navCollapsed: !state.settings.navCollapsed,\n              })}\n            title=\"${state.settings.navCollapsed ? \"展开侧边栏\" : \"折叠侧边栏\"}\"\n            aria-label=\"${state.settings.navCollapsed ? \"展开侧边栏\" : \"折叠侧边栏\"}\"\n          >\n            <span class=\"nav-collapse-toggle__icon\">${icons.menu}</span>\n          </button>\n          <div class=\"brand\">\n            <div class=\"brand-logo\">\n              <img src=\"${logoHref}\" alt=\"OpenClaw\" />\n            </div>\n            <div class=\"brand-text\">\n              <div class=\"brand-title\">OPENCLAW</div>\n              <div class=\"brand-sub\">网关仪表盘</div>\n            </div>\n          </div>\n        </div>\n        <div class=\"topbar-status\">\n          <div class=\"pill\">\n            <span class=\"statusDot ${state.connected ? \"ok\" : \"\"}\"></span>\n            <span>健康状态</span>\n            <span class=\"mono\">${state.connected ? \"正常\" : \"离线\"}</span>\n          </div>\n          ${renderThemeToggle(state)}\n        </div>\n      </header>\n      <aside class=\"nav ${state.settings.navCollapsed ? \"nav--collapsed\" : \"\"}\">\n        ${TAB_GROUPS.map((group) => {\n          const isGroupCollapsed = state.settings.navGroupsCollapsed[group.label] ?? false;\n          const hasActiveTab = group.tabs.some((tab) => tab === state.tab);\n          return html`\n            <div class=\"nav-group ${isGroupCollapsed && !hasActiveTab ? \"nav-group--collapsed\" : \"\"}\">\n              <button\n                class=\"nav-label\"\n                @click=${() => {\n                  const next = { ...state.settings.navGroupsCollapsed };\n                  next[group.label] = !isGroupCollapsed;\n                  state.applySettings({\n                    ...state.settings,\n                    navGroupsCollapsed: next,\n                  });\n                }}\n                aria-expanded=${!isGroupCollapsed}\n              >\n                <span class=\"nav-label__text\">${group.label}</span>\n                <span class=\"nav-label__chevron\">${isGroupCollapsed ? \"+\" : \"−\"}</span>\n              </button>\n              <div class=\"nav-group__items\">\n                ${group.tabs.map((tab) => renderTab(state, tab))}\n              </div>\n            </div>\n          `;\n        })}\n        <div class=\"nav-group nav-group--links\">\n          <div class=\"nav-label nav-label--static\">\n            <span class=\"nav-label__text\">资源</span>\n          </div>\n          <div class=\"nav-group__items\">\n            <a\n              class=\"nav-item nav-item--external\"\n              href=\"https://docs.openclaw.ai\"\n              target=\"_blank\"\n              rel=\"noreferrer\"\n              title=\"文档（在新标签页中打开）\"\n            >\n              <span class=\"nav-item__icon\" aria-hidden=\"true\">${icons.book}</span>\n              <span class=\"nav-item__text\">文档</span>\n            </a>\n          </div>\n        </div>\n      </aside>\n      <main class=\"content ${isChat ? \"content--chat\" : \"\"}\">\n        <section class=\"content-header\">\n          <div>\n            <div class=\"page-title\">${titleForTab(state.tab)}</div>\n            <div class=\"page-sub\">${subtitleForTab(state.tab)}</div>\n          </div>\n          <div class=\"page-meta\">\n            ${state.lastError ? html`<div class=\"pill danger\">${state.lastError}</div>` : nothing}\n            ${isChat ? renderChatControls(state) : nothing}\n          </div>\n        </section>\n\n        ${\n          state.tab === \"overview\"\n            ? renderOverview({\n                connected: state.connected,\n                hello: state.hello,\n                settings: state.settings,\n                password: state.password,\n                lastError: state.lastError,\n                presenceCount,\n                sessionsCount,\n                cronEnabled: state.cronStatus?.enabled ?? null,\n                cronNext,\n                lastChannelsRefresh: state.channelsLastSuccess,\n                onSettingsChange: (next) => state.applySettings(next),\n                onPasswordChange: (next) => (state.password = next),\n                onSessionKeyChange: (next) => {\n                  state.sessionKey = next;\n                  state.chatMessage = \"\";\n                  (state as unknown as OpenClawApp).resetToolStream();\n                  state.applySettings({\n                    ...state.settings,\n                    sessionKey: next,\n                    lastActiveSessionKey: next,\n                  });\n                  void state.loadAssistantIdentity();\n                },\n                onConnect: () => state.connect(),\n                onRefresh: () => state.loadOverview(),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"channels\"\n            ? renderChannels({\n                connected: state.connected,\n                loading: state.channelsLoading,\n                snapshot: state.channelsSnapshot,\n                lastError: state.channelsError,\n                lastSuccessAt: state.channelsLastSuccess,\n                whatsappMessage: state.whatsappLoginMessage,\n                whatsappQrDataUrl: state.whatsappLoginQrDataUrl,\n                whatsappConnected: state.whatsappLoginConnected,\n                whatsappBusy: state.whatsappBusy,\n                configSchema: state.configSchema,\n                configSchemaLoading: state.configSchemaLoading,\n                configForm: state.configForm,\n                configUiHints: state.configUiHints as ConfigUiHints,\n                configSaving: state.configSaving,\n                configFormDirty: state.configFormDirty,\n                nostrProfileFormState: state.nostrProfileFormState,\n                nostrProfileAccountId: state.nostrProfileAccountId,\n                onRefresh: (probe) => loadChannels(state, probe),\n                onWhatsAppStart: (force) => state.handleWhatsAppStart(force),\n                onWhatsAppWait: () => state.handleWhatsAppWait(),\n                onWhatsAppLogout: () => state.handleWhatsAppLogout(),\n                onConfigPatch: (path, value) =>\n                  updateConfigFormValue(state as unknown as ConfigState, path, value),\n                onConfigSave: () => state.handleChannelConfigSave(),\n                onConfigReload: () => state.handleChannelConfigReload(),\n                onNostrProfileEdit: (accountId, profile) =>\n                  state.handleNostrProfileEdit(accountId, profile),\n                onNostrProfileCancel: () => state.handleNostrProfileCancel(),\n                onNostrProfileFieldChange: (field, value) =>\n                  state.handleNostrProfileFieldChange(field, value),\n                onNostrProfileSave: () => state.handleNostrProfileSave(),\n                onNostrProfileImport: () => state.handleNostrProfileImport(),\n                onNostrProfileToggleAdvanced: () => state.handleNostrProfileToggleAdvanced(),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"instances\"\n            ? renderInstances({\n                loading: state.presenceLoading,\n                entries: state.presenceEntries,\n                lastError: state.presenceError,\n                statusMessage: state.presenceStatus,\n                onRefresh: () => loadPresence(state),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"sessions\"\n            ? renderSessions({\n                loading: state.sessionsLoading,\n                result: state.sessionsResult,\n                error: state.sessionsError,\n                activeMinutes: state.sessionsFilterActive,\n                limit: state.sessionsFilterLimit,\n                includeGlobal: state.sessionsIncludeGlobal,\n                includeUnknown: state.sessionsIncludeUnknown,\n                basePath: state.basePath,\n                onFiltersChange: (next) => {\n                  state.sessionsFilterActive = next.activeMinutes;\n                  state.sessionsFilterLimit = next.limit;\n                  state.sessionsIncludeGlobal = next.includeGlobal;\n                  state.sessionsIncludeUnknown = next.includeUnknown;\n                },\n                onRefresh: () => loadSessions(state),\n                onPatch: (key, patch) => patchSession(state, key, patch),\n                onDelete: (key) => deleteSession(state, key),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"cron\"\n            ? renderCron({\n                loading: state.cronLoading,\n                status: state.cronStatus,\n                jobs: state.cronJobs,\n                error: state.cronError,\n                busy: state.cronBusy,\n                form: state.cronForm,\n                channels: state.channelsSnapshot?.channelMeta?.length\n                  ? state.channelsSnapshot.channelMeta.map((entry) => entry.id)\n                  : (state.channelsSnapshot?.channelOrder ?? []),\n                channelLabels: state.channelsSnapshot?.channelLabels ?? {},\n                channelMeta: state.channelsSnapshot?.channelMeta ?? [],\n                runsJobId: state.cronRunsJobId,\n                runs: state.cronRuns,\n                onFormChange: (patch) => (state.cronForm = { ...state.cronForm, ...patch }),\n                onRefresh: () => state.loadCron(),\n                onAdd: () => addCronJob(state),\n                onToggle: (job, enabled) => toggleCronJob(state, job, enabled),\n                onRun: (job) => runCronJob(state, job),\n                onRemove: (job) => removeCronJob(state, job),\n                onLoadRuns: (jobId) => loadCronRuns(state, jobId),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"agents\"\n            ? renderAgents({\n                loading: state.agentsLoading,\n                error: state.agentsError,\n                agentsList: state.agentsList,\n                selectedAgentId: resolvedAgentId,\n                activePanel: state.agentsPanel,\n                configForm: configValue,\n                configLoading: state.configLoading,\n                configSaving: state.configSaving,\n                configDirty: state.configFormDirty,\n                channelsLoading: state.channelsLoading,\n                channelsError: state.channelsError,\n                channelsSnapshot: state.channelsSnapshot,\n                channelsLastSuccess: state.channelsLastSuccess,\n                cronLoading: state.cronLoading,\n                cronStatus: state.cronStatus,\n                cronJobs: state.cronJobs,\n                cronError: state.cronError,\n                agentFilesLoading: state.agentFilesLoading,\n                agentFilesError: state.agentFilesError,\n                agentFilesList: state.agentFilesList,\n                agentFileActive: state.agentFileActive,\n                agentFileContents: state.agentFileContents,\n                agentFileDrafts: state.agentFileDrafts,\n                agentFileSaving: state.agentFileSaving,\n                agentIdentityLoading: state.agentIdentityLoading,\n                agentIdentityError: state.agentIdentityError,\n                agentIdentityById: state.agentIdentityById,\n                agentSkillsLoading: state.agentSkillsLoading,\n                agentSkillsReport: state.agentSkillsReport,\n                agentSkillsError: state.agentSkillsError,\n                agentSkillsAgentId: state.agentSkillsAgentId,\n                skillsFilter: state.skillsFilter,\n                onRefresh: async () => {\n                  await loadAgents(state);\n                  const agentIds = state.agentsList?.agents?.map((entry) => entry.id) ?? [];\n                  if (agentIds.length > 0) {\n                    void loadAgentIdentities(state, agentIds);\n                  }\n                },\n                onSelectAgent: (agentId) => {\n                  if (state.agentsSelectedId === agentId) {\n                    return;\n                  }\n                  state.agentsSelectedId = agentId;\n                  state.agentFilesList = null;\n                  state.agentFilesError = null;\n                  state.agentFilesLoading = false;\n                  state.agentFileActive = null;\n                  state.agentFileContents = {};\n                  state.agentFileDrafts = {};\n                  state.agentSkillsReport = null;\n                  state.agentSkillsError = null;\n                  state.agentSkillsAgentId = null;\n                  void loadAgentIdentity(state, agentId);\n                  if (state.agentsPanel === \"files\") {\n                    void loadAgentFiles(state, agentId);\n                  }\n                  if (state.agentsPanel === \"skills\") {\n                    void loadAgentSkills(state, agentId);\n                  }\n                },\n                onSelectPanel: (panel) => {\n                  state.agentsPanel = panel;\n                  if (panel === \"files\" && resolvedAgentId) {\n                    if (state.agentFilesList?.agentId !== resolvedAgentId) {\n                      state.agentFilesList = null;\n                      state.agentFilesError = null;\n                      state.agentFileActive = null;\n                      state.agentFileContents = {};\n                      state.agentFileDrafts = {};\n                      void loadAgentFiles(state, resolvedAgentId);\n                    }\n                  }\n                  if (panel === \"skills\") {\n                    if (resolvedAgentId) {\n                      void loadAgentSkills(state, resolvedAgentId);\n                    }\n                  }\n                  if (panel === \"channels\") {\n                    void loadChannels(state, false);\n                  }\n                  if (panel === \"cron\") {\n                    void state.loadCron();\n                  }\n                },\n                onLoadFiles: (agentId) => {\n                  void (async () => {\n                    await loadAgentFiles(state, agentId);\n                    if (state.agentFileActive) {\n                      await loadAgentFileContent(state, agentId, state.agentFileActive, {\n                        force: true,\n                        preserveDraft: true,\n                      });\n                    }\n                  })();\n                },\n                onSelectFile: (name) => {\n                  state.agentFileActive = name;\n                  if (!resolvedAgentId) {\n                    return;\n                  }\n                  void loadAgentFileContent(state, resolvedAgentId, name);\n                },\n                onFileDraftChange: (name, content) => {\n                  state.agentFileDrafts = { ...state.agentFileDrafts, [name]: content };\n                },\n                onFileReset: (name) => {\n                  const base = state.agentFileContents[name] ?? \"\";\n                  state.agentFileDrafts = { ...state.agentFileDrafts, [name]: base };\n                },\n                onFileSave: (name) => {\n                  if (!resolvedAgentId) {\n                    return;\n                  }\n                  const content =\n                    state.agentFileDrafts[name] ?? state.agentFileContents[name] ?? \"\";\n                  void saveAgentFile(state, resolvedAgentId, name, content);\n                },\n                onToolsProfileChange: (agentId, profile, clearAllow) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  const basePath = [\"agents\", \"list\", index, \"tools\"];\n                  if (profile) {\n                    updateConfigFormValue(\n                      state as unknown as ConfigState,\n                      [...basePath, \"profile\"],\n                      profile,\n                    );\n                  } else {\n                    removeConfigFormValue(state as unknown as ConfigState, [\n                      ...basePath,\n                      \"profile\",\n                    ]);\n                  }\n                  if (clearAllow) {\n                    removeConfigFormValue(state as unknown as ConfigState, [...basePath, \"allow\"]);\n                  }\n                },\n                onToolsOverridesChange: (agentId, alsoAllow, deny) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  const basePath = [\"agents\", \"list\", index, \"tools\"];\n                  if (alsoAllow.length > 0) {\n                    updateConfigFormValue(\n                      state as unknown as ConfigState,\n                      [...basePath, \"alsoAllow\"],\n                      alsoAllow,\n                    );\n                  } else {\n                    removeConfigFormValue(state as unknown as ConfigState, [\n                      ...basePath,\n                      \"alsoAllow\",\n                    ]);\n                  }\n                  if (deny.length > 0) {\n                    updateConfigFormValue(\n                      state as unknown as ConfigState,\n                      [...basePath, \"deny\"],\n                      deny,\n                    );\n                  } else {\n                    removeConfigFormValue(state as unknown as ConfigState, [...basePath, \"deny\"]);\n                  }\n                },\n                onConfigReload: () => loadConfig(state as unknown as ConfigState),\n                onConfigSave: () => saveConfig(state as unknown as ConfigState),\n                onChannelsRefresh: () => loadChannels(state, false),\n                onCronRefresh: () => state.loadCron(),\n                onSkillsFilterChange: (next) => (state.skillsFilter = next),\n                onSkillsRefresh: () => {\n                  if (resolvedAgentId) {\n                    void loadAgentSkills(state, resolvedAgentId);\n                  }\n                },\n                onAgentSkillToggle: (agentId, skillName, enabled) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  const entry = list[index] as { skills?: unknown };\n                  const normalizedSkill = skillName.trim();\n                  if (!normalizedSkill) {\n                    return;\n                  }\n                  const allSkills =\n                    state.agentSkillsReport?.skills?.map((skill) => skill.name).filter(Boolean) ??\n                    [];\n                  const existing = Array.isArray(entry.skills)\n                    ? entry.skills.map((name) => String(name).trim()).filter(Boolean)\n                    : undefined;\n                  const base = existing ?? allSkills;\n                  const next = new Set(base);\n                  if (enabled) {\n                    next.add(normalizedSkill);\n                  } else {\n                    next.delete(normalizedSkill);\n                  }\n                  updateConfigFormValue(\n                    state as unknown as ConfigState,\n                    [\"agents\", \"list\", index, \"skills\"],\n                    [...next],\n                  );\n                },\n                onAgentSkillsClear: (agentId) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  removeConfigFormValue(state as unknown as ConfigState, [\n                    \"agents\",\n                    \"list\",\n                    index,\n                    \"skills\",\n                  ]);\n                },\n                onAgentSkillsDisableAll: (agentId) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  updateConfigFormValue(\n                    state as unknown as ConfigState,\n                    [\"agents\", \"list\", index, \"skills\"],\n                    [],\n                  );\n                },\n                onModelChange: (agentId, modelId) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  const basePath = [\"agents\", \"list\", index, \"model\"];\n                  if (!modelId) {\n                    removeConfigFormValue(state as unknown as ConfigState, basePath);\n                    return;\n                  }\n                  const entry = list[index] as { model?: unknown };\n                  const existing = entry?.model;\n                  if (existing && typeof existing === \"object\" && !Array.isArray(existing)) {\n                    const fallbacks = (existing as { fallbacks?: unknown }).fallbacks;\n                    const next = {\n                      primary: modelId,\n                      ...(Array.isArray(fallbacks) ? { fallbacks } : {}),\n                    };\n                    updateConfigFormValue(state as unknown as ConfigState, basePath, next);\n                  } else {\n                    updateConfigFormValue(state as unknown as ConfigState, basePath, modelId);\n                  }\n                },\n                onModelFallbacksChange: (agentId, fallbacks) => {\n                  if (!configValue) {\n                    return;\n                  }\n                  const list = (configValue as { agents?: { list?: unknown[] } }).agents?.list;\n                  if (!Array.isArray(list)) {\n                    return;\n                  }\n                  const index = list.findIndex(\n                    (entry) =>\n                      entry &&\n                      typeof entry === \"object\" &&\n                      \"id\" in entry &&\n                      (entry as { id?: string }).id === agentId,\n                  );\n                  if (index < 0) {\n                    return;\n                  }\n                  const basePath = [\"agents\", \"list\", index, \"model\"];\n                  const entry = list[index] as { model?: unknown };\n                  const normalized = fallbacks.map((name) => name.trim()).filter(Boolean);\n                  const existing = entry.model;\n                  const resolvePrimary = () => {\n                    if (typeof existing === \"string\") {\n                      return existing.trim() || null;\n                    }\n                    if (existing && typeof existing === \"object\" && !Array.isArray(existing)) {\n                      const primary = (existing as { primary?: unknown }).primary;\n                      if (typeof primary === \"string\") {\n                        const trimmed = primary.trim();\n                        return trimmed || null;\n                      }\n                    }\n                    return null;\n                  };\n                  const primary = resolvePrimary();\n                  if (normalized.length === 0) {\n                    if (primary) {\n                      updateConfigFormValue(state as unknown as ConfigState, basePath, primary);\n                    } else {\n                      removeConfigFormValue(state as unknown as ConfigState, basePath);\n                    }\n                    return;\n                  }\n                  const next = primary\n                    ? { primary, fallbacks: normalized }\n                    : { fallbacks: normalized };\n                  updateConfigFormValue(state as unknown as ConfigState, basePath, next);\n                },\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"skills\"\n            ? renderSkills({\n                loading: state.skillsLoading,\n                report: state.skillsReport,\n                error: state.skillsError,\n                filter: state.skillsFilter,\n                edits: state.skillEdits,\n                messages: state.skillMessages,\n                busyKey: state.skillsBusyKey,\n                onFilterChange: (next) => (state.skillsFilter = next),\n                onRefresh: () => loadSkills(state, { clearMessages: true }),\n                onToggle: (key, enabled) => updateSkillEnabled(state, key, enabled),\n                onEdit: (key, value) => updateSkillEdit(state, key, value),\n                onSaveKey: (key) => saveSkillApiKey(state, key),\n                onInstall: (skillKey, name, installId) =>\n                  installSkill(state, skillKey, name, installId),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"nodes\"\n            ? renderNodes({\n                loading: state.nodesLoading,\n                nodes: state.nodes,\n                devicesLoading: state.devicesLoading,\n                devicesError: state.devicesError,\n                devicesList: state.devicesList,\n                configForm:\n                  state.configForm ??\n                  (state.configSnapshot?.config as Record<string, unknown> | null),\n                configLoading: state.configLoading,\n                configSaving: state.configSaving,\n                configDirty: state.configFormDirty,\n                configFormMode: state.configFormMode,\n                execApprovalsLoading: state.execApprovalsLoading,\n                execApprovalsSaving: state.execApprovalsSaving,\n                execApprovalsDirty: state.execApprovalsDirty,\n                execApprovalsSnapshot: state.execApprovalsSnapshot,\n                execApprovalsForm: state.execApprovalsForm,\n                execApprovalsSelectedAgent: state.execApprovalsSelectedAgent,\n                execApprovalsTarget: state.execApprovalsTarget,\n                execApprovalsTargetNodeId: state.execApprovalsTargetNodeId,\n                onRefresh: () => loadNodes(state),\n                onDevicesRefresh: () => loadDevices(state),\n                onDeviceApprove: (requestId) => approveDevicePairing(state, requestId),\n                onDeviceReject: (requestId) => rejectDevicePairing(state, requestId),\n                onDeviceRotate: (deviceId, role, scopes) =>\n                  rotateDeviceToken(state, { deviceId, role, scopes }),\n                onDeviceRevoke: (deviceId, role) => revokeDeviceToken(state, { deviceId, role }),\n                onLoadConfig: () => loadConfig(state as unknown as ConfigState),\n                onLoadExecApprovals: () => {\n                  const target =\n                    state.execApprovalsTarget === \"node\" && state.execApprovalsTargetNodeId\n                      ? { kind: \"node\" as const, nodeId: state.execApprovalsTargetNodeId }\n                      : { kind: \"gateway\" as const };\n                  return loadExecApprovals(state, target);\n                },\n                onBindDefault: (nodeId) => {\n                  if (nodeId) {\n                    updateConfigFormValue(\n                      state as unknown as ConfigState,\n                      [\"tools\", \"exec\", \"node\"],\n                      nodeId,\n                    );\n                  } else {\n                    removeConfigFormValue(state as unknown as ConfigState, [\n                      \"tools\",\n                      \"exec\",\n                      \"node\",\n                    ]);\n                  }\n                },\n                onBindAgent: (agentIndex, nodeId) => {\n                  const basePath = [\"agents\", \"list\", agentIndex, \"tools\", \"exec\", \"node\"];\n                  if (nodeId) {\n                    updateConfigFormValue(state as unknown as ConfigState, basePath, nodeId);\n                  } else {\n                    removeConfigFormValue(state as unknown as ConfigState, basePath);\n                  }\n                },\n                onSaveBindings: () => saveConfig(state as unknown as ConfigState),\n                onExecApprovalsTargetChange: (kind, nodeId) => {\n                  state.execApprovalsTarget = kind;\n                  state.execApprovalsTargetNodeId = nodeId;\n                  state.execApprovalsSnapshot = null;\n                  state.execApprovalsForm = null;\n                  state.execApprovalsDirty = false;\n                  state.execApprovalsSelectedAgent = null;\n                },\n                onExecApprovalsSelectAgent: (agentId) => {\n                  state.execApprovalsSelectedAgent = agentId;\n                },\n                onExecApprovalsPatch: (path, value) =>\n                  updateExecApprovalsFormValue(state, path, value),\n                onExecApprovalsRemove: (path) => removeExecApprovalsFormValue(state, path),\n                onSaveExecApprovals: () => {\n                  const target =\n                    state.execApprovalsTarget === \"node\" && state.execApprovalsTargetNodeId\n                      ? { kind: \"node\" as const, nodeId: state.execApprovalsTargetNodeId }\n                      : { kind: \"gateway\" as const };\n                  return saveExecApprovals(state, target);\n                },\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"chat\"\n            ? renderChat({\n                sessionKey: state.sessionKey,\n                onSessionKeyChange: (next) => {\n                  state.sessionKey = next;\n                  state.chatMessage = \"\";\n                  state.chatAttachments = [];\n                  state.chatStream = null;\n                  state.chatRunId = null;\n                  (state as unknown as OpenClawApp).chatStreamStartedAt = null;\n                  state.chatQueue = [];\n                  (state as unknown as OpenClawApp).resetToolStream();\n                  (state as unknown as OpenClawApp).resetChatScroll();\n                  state.applySettings({\n                    ...state.settings,\n                    sessionKey: next,\n                    lastActiveSessionKey: next,\n                  });\n                  void state.loadAssistantIdentity();\n                  void loadChatHistory(state as unknown as ChatState);\n                  void refreshChatAvatar(state as unknown as ChatHost);\n                },\n                thinkingLevel: state.chatThinkingLevel,\n                showThinking,\n                loading: state.chatLoading,\n                sending: state.chatSending,\n                assistantAvatarUrl: chatAvatarUrl,\n                messages: state.chatMessages,\n                toolMessages: state.chatToolMessages,\n                stream: state.chatStream,\n                streamStartedAt: null,\n                draft: state.chatMessage,\n                queue: state.chatQueue,\n                connected: state.connected,\n                canSend: state.connected,\n                disabledReason: chatDisabledReason,\n                error: state.lastError,\n                sessions: state.sessionsResult,\n                focusMode: chatFocus,\n                onRefresh: () => {\n                  return Promise.all([\n                    loadChatHistory(state as unknown as ChatState),\n                    refreshChatAvatar(state as unknown as ChatHost),\n                  ]);\n                },\n                onToggleFocusMode: () => {\n                  if (state.onboarding) {\n                    return;\n                  }\n                  state.applySettings({\n                    ...state.settings,\n                    chatFocusMode: !state.settings.chatFocusMode,\n                  });\n                },\n                onChatScroll: (event) => (state as unknown as OpenClawApp).handleChatScroll(event),\n                onDraftChange: (next) => (state.chatMessage = next),\n                attachments: state.chatAttachments,\n                onAttachmentsChange: (next) => (state.chatAttachments = next),\n                onSend: () => (state as unknown as OpenClawApp).handleSendChat(),\n                canAbort: Boolean(state.chatRunId),\n                onAbort: () => void (state as unknown as OpenClawApp).handleAbortChat(),\n                onQueueRemove: (id) => (state as unknown as OpenClawApp).removeQueuedMessage(id),\n                onNewSession: () =>\n                  (state as unknown as OpenClawApp).handleSendChat(\"/new\", { restoreDraft: true }),\n                showNewMessages: state.chatNewMessagesBelow,\n                onScrollToBottom: () => state.scrollToBottom(),\n                // Sidebar props for tool output viewing\n                sidebarOpen: (state as unknown as OpenClawApp).sidebarOpen,\n                sidebarContent: (state as unknown as OpenClawApp).sidebarContent,\n                sidebarError: (state as unknown as OpenClawApp).sidebarError,\n                splitRatio: (state as unknown as OpenClawApp).splitRatio,\n                onOpenSidebar: (content: string) =>\n                  (state as unknown as OpenClawApp).handleOpenSidebar(content),\n                onCloseSidebar: () => (state as unknown as OpenClawApp).handleCloseSidebar(),\n                onSplitRatioChange: (ratio: number) =>\n                  (state as unknown as OpenClawApp).handleSplitRatioChange(ratio),\n                assistantName: state.assistantName,\n                assistantAvatar: state.assistantAvatar,\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"config\"\n            ? renderConfig({\n                raw: state.configRaw,\n                originalRaw: state.configRawOriginal,\n                valid: state.configValid,\n                issues: state.configIssues,\n                loading: state.configLoading,\n                saving: state.configSaving,\n                applying: state.configApplying,\n                updating: state.updateRunning,\n                connected: state.connected,\n                schema: state.configSchema,\n                schemaLoading: state.configSchemaLoading,\n                uiHints: state.configUiHints as ConfigUiHints,\n                formMode: state.configFormMode,\n                formValue: state.configForm,\n                originalValue: state.configFormOriginal,\n                searchQuery: (state as unknown as OpenClawApp).configSearchQuery,\n                activeSection: (state as unknown as OpenClawApp).configActiveSection,\n                activeSubsection: (state as unknown as OpenClawApp).configActiveSubsection,\n                onRawChange: (next) => {\n                  state.configRaw = next;\n                },\n                onFormModeChange: (mode) => (state.configFormMode = mode),\n                onFormPatch: (path, value) =>\n                  updateConfigFormValue(state as unknown as OpenClawApp, path, value),\n                onSearchChange: (query) =>\n                  ((state as unknown as OpenClawApp).configSearchQuery = query),\n                onSectionChange: (section) => {\n                  (state as unknown as OpenClawApp).configActiveSection = section;\n                  (state as unknown as OpenClawApp).configActiveSubsection = null;\n                },\n                onSubsectionChange: (section) =>\n                  ((state as unknown as OpenClawApp).configActiveSubsection = section),\n                onReload: () => loadConfig(state as unknown as OpenClawApp),\n                onSave: () => saveConfig(state as unknown as OpenClawApp),\n                onApply: () => applyConfig(state as unknown as OpenClawApp),\n                onUpdate: () => runUpdate(state as unknown as OpenClawApp),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"debug\"\n            ? renderDebug({\n                loading: state.debugLoading,\n                status: state.debugStatus,\n                health: state.debugHealth,\n                models: state.debugModels,\n                heartbeat: state.debugHeartbeat,\n                eventLog: state.eventLog,\n                callMethod: state.debugCallMethod,\n                callParams: state.debugCallParams,\n                callResult: state.debugCallResult,\n                callError: state.debugCallError,\n                onCallMethodChange: (next) => (state.debugCallMethod = next),\n                onCallParamsChange: (next) => (state.debugCallParams = next),\n                onRefresh: () => loadDebug(state),\n                onCall: () => callDebugMethod(state),\n              })\n            : nothing\n        }\n\n        ${\n          state.tab === \"logs\"\n            ? renderLogs({\n                loading: state.logsLoading,\n                error: state.logsError,\n                file: state.logsFile,\n                entries: state.logsEntries,\n                filterText: state.logsFilterText,\n                levelFilters: state.logsLevelFilters,\n                autoFollow: state.logsAutoFollow,\n                truncated: state.logsTruncated,\n                onFilterTextChange: (next) => (state.logsFilterText = next),\n                onLevelToggle: (level, enabled) => {\n                  state.logsLevelFilters = { ...state.logsLevelFilters, [level]: enabled };\n                },\n                onToggleAutoFollow: (next) => (state.logsAutoFollow = next),\n                onRefresh: () => loadLogs(state as unknown as LogsState, { reset: true }),\n                onExport: (lines, label) =>\n                  (state as unknown as OpenClawApp).exportLogs(lines, label),\n                onScroll: (event) => (state as unknown as OpenClawApp).handleLogsScroll(event),\n              })\n            : nothing\n        }\n      </main>\n      ${renderExecApprovalPrompt(state)}\n      ${renderGatewayUrlConfirmPrompt(state)}\n    </div>\n  `;\n}\n","import { LitElement } from \"lit\";\nimport { customElement, state } from \"lit/decorators.js\";\nimport type { EventLogEntry } from \"./app-events\";\nimport type { AppViewState } from \"./app-view-state\";\nimport type { DevicePairingList } from \"./controllers/devices\";\nimport type { ExecApprovalRequest } from \"./controllers/exec-approval\";\nimport type { ExecApprovalsFile, ExecApprovalsSnapshot } from \"./controllers/exec-approvals\";\nimport type { GatewayBrowserClient, GatewayHelloOk } from \"./gateway\";\nimport type { Tab } from \"./navigation\";\nimport type { ResolvedTheme, ThemeMode } from \"./theme\";\nimport type {\n  AgentsListResult,\n  ConfigSnapshot,\n  ConfigUiHints,\n  CronJob,\n  CronRunLogEntry,\n  CronStatus,\n  HealthSnapshot,\n  LogEntry,\n  LogLevel,\n  PresenceEntry,\n  ChannelsStatusSnapshot,\n  SessionsListResult,\n  SkillStatusReport,\n  StatusSummary,\n  NostrProfile,\n} from \"./types\";\nimport type { NostrProfileFormState } from \"./views/channels.nostr-profile-form\";\nimport {\n  handleChannelConfigReload as handleChannelConfigReloadInternal,\n  handleChannelConfigSave as handleChannelConfigSaveInternal,\n  handleNostrProfileCancel as handleNostrProfileCancelInternal,\n  handleNostrProfileEdit as handleNostrProfileEditInternal,\n  handleNostrProfileFieldChange as handleNostrProfileFieldChangeInternal,\n  handleNostrProfileImport as handleNostrProfileImportInternal,\n  handleNostrProfileSave as handleNostrProfileSaveInternal,\n  handleNostrProfileToggleAdvanced as handleNostrProfileToggleAdvancedInternal,\n  handleWhatsAppLogout as handleWhatsAppLogoutInternal,\n  handleWhatsAppStart as handleWhatsAppStartInternal,\n  handleWhatsAppWait as handleWhatsAppWaitInternal,\n} from \"./app-channels\";\nimport {\n  handleAbortChat as handleAbortChatInternal,\n  handleSendChat as handleSendChatInternal,\n  removeQueuedMessage as removeQueuedMessageInternal,\n} from \"./app-chat\";\nimport { DEFAULT_CRON_FORM, DEFAULT_LOG_LEVEL_FILTERS } from \"./app-defaults\";\nimport { connectGateway as connectGatewayInternal } from \"./app-gateway\";\nimport {\n  handleConnected,\n  handleDisconnected,\n  handleFirstUpdated,\n  handleUpdated,\n} from \"./app-lifecycle\";\nimport { renderApp } from \"./app-render\";\nimport {\n  exportLogs as exportLogsInternal,\n  handleChatScroll as handleChatScrollInternal,\n  handleLogsScroll as handleLogsScrollInternal,\n  resetChatScroll as resetChatScrollInternal,\n  scheduleChatScroll as scheduleChatScrollInternal,\n} from \"./app-scroll\";\nimport {\n  applySettings as applySettingsInternal,\n  loadCron as loadCronInternal,\n  loadOverview as loadOverviewInternal,\n  setTab as setTabInternal,\n  setTheme as setThemeInternal,\n  onPopState as onPopStateInternal,\n} from \"./app-settings\";\nimport {\n  resetToolStream as resetToolStreamInternal,\n  type ToolStreamEntry,\n} from \"./app-tool-stream\";\nimport { resolveInjectedAssistantIdentity } from \"./assistant-identity\";\nimport { loadAssistantIdentity as loadAssistantIdentityInternal } from \"./controllers/assistant-identity\";\nimport { loadSettings, type UiSettings } from \"./storage\";\nimport { type ChatAttachment, type ChatQueueItem, type CronFormState } from \"./ui-types\";\n\ndeclare global {\n  interface Window {\n    __OPENCLAW_CONTROL_UI_BASE_PATH__?: string;\n  }\n}\n\nconst injectedAssistantIdentity = resolveInjectedAssistantIdentity();\n\nfunction resolveOnboardingMode(): boolean {\n  if (!window.location.search) {\n    return false;\n  }\n  const params = new URLSearchParams(window.location.search);\n  const raw = params.get(\"onboarding\");\n  if (!raw) {\n    return false;\n  }\n  const normalized = raw.trim().toLowerCase();\n  return normalized === \"1\" || normalized === \"true\" || normalized === \"yes\" || normalized === \"on\";\n}\n\n@customElement(\"openclaw-app\")\nexport class OpenClawApp extends LitElement {\n  @state() settings: UiSettings = loadSettings();\n  @state() password = \"\";\n  @state() tab: Tab = \"chat\";\n  @state() onboarding = resolveOnboardingMode();\n  @state() connected = false;\n  @state() theme: ThemeMode = this.settings.theme ?? \"system\";\n  @state() themeResolved: ResolvedTheme = \"dark\";\n  @state() hello: GatewayHelloOk | null = null;\n  @state() lastError: string | null = null;\n  @state() eventLog: EventLogEntry[] = [];\n  private eventLogBuffer: EventLogEntry[] = [];\n  private toolStreamSyncTimer: number | null = null;\n  private sidebarCloseTimer: number | null = null;\n\n  @state() assistantName = injectedAssistantIdentity.name;\n  @state() assistantAvatar = injectedAssistantIdentity.avatar;\n  @state() assistantAgentId = injectedAssistantIdentity.agentId ?? null;\n\n  @state() sessionKey = this.settings.sessionKey;\n  @state() chatLoading = false;\n  @state() chatSending = false;\n  @state() chatMessage = \"\";\n  @state() chatMessages: unknown[] = [];\n  @state() chatToolMessages: unknown[] = [];\n  @state() chatStream: string | null = null;\n  @state() chatStreamStartedAt: number | null = null;\n  @state() chatRunId: string | null = null;\n  @state() compactionStatus: import(\"./app-tool-stream\").CompactionStatus | null = null;\n  @state() chatAvatarUrl: string | null = null;\n  @state() chatThinkingLevel: string | null = null;\n  @state() chatQueue: ChatQueueItem[] = [];\n  @state() chatAttachments: ChatAttachment[] = [];\n  // Sidebar state for tool output viewing\n  @state() sidebarOpen = false;\n  @state() sidebarContent: string | null = null;\n  @state() sidebarError: string | null = null;\n  @state() splitRatio = this.settings.splitRatio;\n\n  @state() nodesLoading = false;\n  @state() nodes: Array<Record<string, unknown>> = [];\n  @state() devicesLoading = false;\n  @state() devicesError: string | null = null;\n  @state() devicesList: DevicePairingList | null = null;\n  @state() execApprovalsLoading = false;\n  @state() execApprovalsSaving = false;\n  @state() execApprovalsDirty = false;\n  @state() execApprovalsSnapshot: ExecApprovalsSnapshot | null = null;\n  @state() execApprovalsForm: ExecApprovalsFile | null = null;\n  @state() execApprovalsSelectedAgent: string | null = null;\n  @state() execApprovalsTarget: \"gateway\" | \"node\" = \"gateway\";\n  @state() execApprovalsTargetNodeId: string | null = null;\n  @state() execApprovalQueue: ExecApprovalRequest[] = [];\n  @state() execApprovalBusy = false;\n  @state() execApprovalError: string | null = null;\n  @state() pendingGatewayUrl: string | null = null;\n\n  @state() configLoading = false;\n  @state() configRaw = \"{\\n}\\n\";\n  @state() configRawOriginal = \"\";\n  @state() configValid: boolean | null = null;\n  @state() configIssues: unknown[] = [];\n  @state() configSaving = false;\n  @state() configApplying = false;\n  @state() updateRunning = false;\n  @state() applySessionKey = this.settings.lastActiveSessionKey;\n  @state() configSnapshot: ConfigSnapshot | null = null;\n  @state() configSchema: unknown = null;\n  @state() configSchemaVersion: string | null = null;\n  @state() configSchemaLoading = false;\n  @state() configUiHints: ConfigUiHints = {};\n  @state() configForm: Record<string, unknown> | null = null;\n  @state() configFormOriginal: Record<string, unknown> | null = null;\n  @state() configFormDirty = false;\n  @state() configFormMode: \"form\" | \"raw\" = \"form\";\n  @state() configSearchQuery = \"\";\n  @state() configActiveSection: string | null = null;\n  @state() configActiveSubsection: string | null = null;\n\n  @state() channelsLoading = false;\n  @state() channelsSnapshot: ChannelsStatusSnapshot | null = null;\n  @state() channelsError: string | null = null;\n  @state() channelsLastSuccess: number | null = null;\n  @state() whatsappLoginMessage: string | null = null;\n  @state() whatsappLoginQrDataUrl: string | null = null;\n  @state() whatsappLoginConnected: boolean | null = null;\n  @state() whatsappBusy = false;\n  @state() nostrProfileFormState: NostrProfileFormState | null = null;\n  @state() nostrProfileAccountId: string | null = null;\n\n  @state() presenceLoading = false;\n  @state() presenceEntries: PresenceEntry[] = [];\n  @state() presenceError: string | null = null;\n  @state() presenceStatus: string | null = null;\n\n  @state() agentsLoading = false;\n  @state() agentsList: AgentsListResult | null = null;\n  @state() agentsError: string | null = null;\n\n  @state() sessionsLoading = false;\n  @state() sessionsResult: SessionsListResult | null = null;\n  @state() sessionsError: string | null = null;\n  @state() sessionsFilterActive = \"\";\n  @state() sessionsFilterLimit = \"120\";\n  @state() sessionsIncludeGlobal = true;\n  @state() sessionsIncludeUnknown = false;\n\n  @state() cronLoading = false;\n  @state() cronJobs: CronJob[] = [];\n  @state() cronStatus: CronStatus | null = null;\n  @state() cronError: string | null = null;\n  @state() cronForm: CronFormState = { ...DEFAULT_CRON_FORM };\n  @state() cronRunsJobId: string | null = null;\n  @state() cronRuns: CronRunLogEntry[] = [];\n  @state() cronBusy = false;\n\n  @state() skillsLoading = false;\n  @state() skillsReport: SkillStatusReport | null = null;\n  @state() skillsError: string | null = null;\n  @state() skillsFilter = \"\";\n  @state() skillEdits: Record<string, string> = {};\n  @state() skillsBusyKey: string | null = null;\n  @state() skillMessages: Record<string, SkillMessage> = {};\n\n  @state() debugLoading = false;\n  @state() debugStatus: StatusSummary | null = null;\n  @state() debugHealth: HealthSnapshot | null = null;\n  @state() debugModels: unknown[] = [];\n  @state() debugHeartbeat: unknown = null;\n  @state() debugCallMethod = \"\";\n  @state() debugCallParams = \"{}\";\n  @state() debugCallResult: string | null = null;\n  @state() debugCallError: string | null = null;\n\n  @state() logsLoading = false;\n  @state() logsError: string | null = null;\n  @state() logsFile: string | null = null;\n  @state() logsEntries: LogEntry[] = [];\n  @state() logsFilterText = \"\";\n  @state() logsLevelFilters: Record<LogLevel, boolean> = {\n    ...DEFAULT_LOG_LEVEL_FILTERS,\n  };\n  @state() logsAutoFollow = true;\n  @state() logsTruncated = false;\n  @state() logsCursor: number | null = null;\n  @state() logsLastFetchAt: number | null = null;\n  @state() logsLimit = 500;\n  @state() logsMaxBytes = 250_000;\n  @state() logsAtBottom = true;\n\n  client: GatewayBrowserClient | null = null;\n  private chatScrollFrame: number | null = null;\n  private chatScrollTimeout: number | null = null;\n  private chatHasAutoScrolled = false;\n  private chatUserNearBottom = true;\n  @state() chatNewMessagesBelow = false;\n  private nodesPollInterval: number | null = null;\n  private logsPollInterval: number | null = null;\n  private debugPollInterval: number | null = null;\n  private logsScrollFrame: number | null = null;\n  private toolStreamById = new Map<string, ToolStreamEntry>();\n  private toolStreamOrder: string[] = [];\n  refreshSessionsAfterChat = new Set<string>();\n  basePath = \"\";\n  private popStateHandler = () =>\n    onPopStateInternal(this as unknown as Parameters<typeof onPopStateInternal>[0]);\n  private themeMedia: MediaQueryList | null = null;\n  private themeMediaHandler: ((event: MediaQueryListEvent) => void) | null = null;\n  private topbarObserver: ResizeObserver | null = null;\n\n  createRenderRoot() {\n    return this;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    handleConnected(this as unknown as Parameters<typeof handleConnected>[0]);\n  }\n\n  protected firstUpdated() {\n    handleFirstUpdated(this as unknown as Parameters<typeof handleFirstUpdated>[0]);\n  }\n\n  disconnectedCallback() {\n    handleDisconnected(this as unknown as Parameters<typeof handleDisconnected>[0]);\n    super.disconnectedCallback();\n  }\n\n  protected updated(changed: Map<PropertyKey, unknown>) {\n    handleUpdated(this as unknown as Parameters<typeof handleUpdated>[0], changed);\n  }\n\n  connect() {\n    connectGatewayInternal(this as unknown as Parameters<typeof connectGatewayInternal>[0]);\n  }\n\n  handleChatScroll(event: Event) {\n    handleChatScrollInternal(\n      this as unknown as Parameters<typeof handleChatScrollInternal>[0],\n      event,\n    );\n  }\n\n  handleLogsScroll(event: Event) {\n    handleLogsScrollInternal(\n      this as unknown as Parameters<typeof handleLogsScrollInternal>[0],\n      event,\n    );\n  }\n\n  exportLogs(lines: string[], label: string) {\n    exportLogsInternal(lines, label);\n  }\n\n  resetToolStream() {\n    resetToolStreamInternal(this as unknown as Parameters<typeof resetToolStreamInternal>[0]);\n  }\n\n  resetChatScroll() {\n    resetChatScrollInternal(this as unknown as Parameters<typeof resetChatScrollInternal>[0]);\n  }\n\n  scrollToBottom() {\n    resetChatScrollInternal(this as unknown as Parameters<typeof resetChatScrollInternal>[0]);\n    scheduleChatScrollInternal(this as unknown as Parameters<typeof scheduleChatScrollInternal>[0], true);\n  }\n\n  async loadAssistantIdentity() {\n    await loadAssistantIdentityInternal(this);\n  }\n\n  applySettings(next: UiSettings) {\n    applySettingsInternal(this as unknown as Parameters<typeof applySettingsInternal>[0], next);\n  }\n\n  setTab(next: Tab) {\n    setTabInternal(this as unknown as Parameters<typeof setTabInternal>[0], next);\n  }\n\n  setTheme(next: ThemeMode, context?: Parameters<typeof setThemeInternal>[2]) {\n    setThemeInternal(this as unknown as Parameters<typeof setThemeInternal>[0], next, context);\n  }\n\n  async loadOverview() {\n    await loadOverviewInternal(this as unknown as Parameters<typeof loadOverviewInternal>[0]);\n  }\n\n  async loadCron() {\n    await loadCronInternal(this as unknown as Parameters<typeof loadCronInternal>[0]);\n  }\n\n  async handleAbortChat() {\n    await handleAbortChatInternal(this as unknown as Parameters<typeof handleAbortChatInternal>[0]);\n  }\n\n  removeQueuedMessage(id: string) {\n    removeQueuedMessageInternal(\n      this as unknown as Parameters<typeof removeQueuedMessageInternal>[0],\n      id,\n    );\n  }\n\n  async handleSendChat(\n    messageOverride?: string,\n    opts?: Parameters<typeof handleSendChatInternal>[2],\n  ) {\n    await handleSendChatInternal(\n      this as unknown as Parameters<typeof handleSendChatInternal>[0],\n      messageOverride,\n      opts,\n    );\n  }\n\n  async handleWhatsAppStart(force: boolean) {\n    await handleWhatsAppStartInternal(this, force);\n  }\n\n  async handleWhatsAppWait() {\n    await handleWhatsAppWaitInternal(this);\n  }\n\n  async handleWhatsAppLogout() {\n    await handleWhatsAppLogoutInternal(this);\n  }\n\n  async handleChannelConfigSave() {\n    await handleChannelConfigSaveInternal(this);\n  }\n\n  async handleChannelConfigReload() {\n    await handleChannelConfigReloadInternal(this);\n  }\n\n  handleNostrProfileEdit(accountId: string, profile: NostrProfile | null) {\n    handleNostrProfileEditInternal(this, accountId, profile);\n  }\n\n  handleNostrProfileCancel() {\n    handleNostrProfileCancelInternal(this);\n  }\n\n  handleNostrProfileFieldChange(field: keyof NostrProfile, value: string) {\n    handleNostrProfileFieldChangeInternal(this, field, value);\n  }\n\n  async handleNostrProfileSave() {\n    await handleNostrProfileSaveInternal(this);\n  }\n\n  async handleNostrProfileImport() {\n    await handleNostrProfileImportInternal(this);\n  }\n\n  handleNostrProfileToggleAdvanced() {\n    handleNostrProfileToggleAdvancedInternal(this);\n  }\n\n  async handleExecApprovalDecision(decision: \"allow-once\" | \"allow-always\" | \"deny\") {\n    const active = this.execApprovalQueue[0];\n    if (!active || !this.client || this.execApprovalBusy) {\n      return;\n    }\n    this.execApprovalBusy = true;\n    this.execApprovalError = null;\n    try {\n      await this.client.request(\"exec.approval.resolve\", {\n        id: active.id,\n        decision,\n      });\n      this.execApprovalQueue = this.execApprovalQueue.filter((entry) => entry.id !== active.id);\n    } catch (err) {\n      this.execApprovalError = `Exec approval failed: ${String(err)}`;\n    } finally {\n      this.execApprovalBusy = false;\n    }\n  }\n\n  handleGatewayUrlConfirm() {\n    const nextGatewayUrl = this.pendingGatewayUrl;\n    if (!nextGatewayUrl) {\n      return;\n    }\n    this.pendingGatewayUrl = null;\n    applySettingsInternal(this as unknown as Parameters<typeof applySettingsInternal>[0], {\n      ...this.settings,\n      gatewayUrl: nextGatewayUrl,\n    });\n    this.connect();\n  }\n\n  handleGatewayUrlCancel() {\n    this.pendingGatewayUrl = null;\n  }\n\n  // Sidebar handlers for tool output viewing\n  handleOpenSidebar(content: string) {\n    if (this.sidebarCloseTimer != null) {\n      window.clearTimeout(this.sidebarCloseTimer);\n      this.sidebarCloseTimer = null;\n    }\n    this.sidebarContent = content;\n    this.sidebarError = null;\n    this.sidebarOpen = true;\n  }\n\n  handleCloseSidebar() {\n    this.sidebarOpen = false;\n    // Clear content after transition\n    if (this.sidebarCloseTimer != null) {\n      window.clearTimeout(this.sidebarCloseTimer);\n    }\n    this.sidebarCloseTimer = window.setTimeout(() => {\n      if (this.sidebarOpen) {\n        return;\n      }\n      this.sidebarContent = null;\n      this.sidebarError = null;\n      this.sidebarCloseTimer = null;\n    }, 200);\n  }\n\n  handleSplitRatioChange(ratio: number) {\n    const newRatio = Math.max(0.4, Math.min(0.7, ratio));\n    this.splitRatio = newRatio;\n    this.applySettings({ ...this.settings, splitRatio: newRatio });\n  }\n\n  render() {\n    return renderApp(this as unknown as AppViewState);\n  }\n}\n\n/** Backward-compat alias used by tests, app-gateway, app-chat, etc. */\nexport { OpenClawApp as ClawdbotApp };\n"],"names":["t","e","s","o","n$5","r","n","i","S","c","h","a","l","p","d","u","f","b","y$2","y","v","_","m","g","$","x","E","A","C","P","V","N","S$1","I","L","z","H","M","R","k","Z","I$2","Z$1","j","B","D","loadChannels","state","probe","res","err","startWhatsAppLogin","force","waitWhatsAppLogin","logoutWhatsApp","cloneConfigObject","value","serializeConfigForm","form","setPathValue","obj","path","current","key","nextKey","record","lastKey","removePathValue","loadConfig","applyConfigSnapshot","loadConfigSchema","applyConfigSchema","snapshot","rawFromSnapshot","saveConfig","raw","baseHash","applyConfig","runUpdate","updateConfigFormValue","base","removeConfigFormValue","isFormDirty","values","original","renderNostrProfileForm","params","callbacks","accountId","isDirty","renderField","field","label","opts","type","placeholder","maxLength","help","error","inputId","html","target","nothing","renderPicturePreview","picture","img","createNostrProfileFormState","profile","handleWhatsAppStart","host","handleWhatsAppWait","handleWhatsAppLogout","handleChannelConfigSave","handleChannelConfigReload","parseValidationErrors","details","errors","entry","rawField","rest","message","resolveNostrAccountId","buildNostrProfileUrl","suffix","resolveGatewayHttpAuthHeader","deviceToken","token","password","buildGatewayHttpHeaders","authorization","handleNostrProfileEdit","handleNostrProfileCancel","handleNostrProfileFieldChange","handleNostrProfileToggleAdvanced","handleNostrProfileSave","response","data","errorMessage","handleNostrProfileImport","merged","nextValues","showAdvanced","QUICK_TAG_RE","FINAL_TAG_RE","THINKING_TAG_RE","applyTrim","mode","stripReasoningTagsFromText","text","options","cleaned","result","lastIndex","inThinking","match","idx","isClose","formatMs","ms","formatAgo","diff","sec","min","hr","formatDurationMs","formatList","clampText","max","truncateText","toNumber","fallback","stripThinkingTags","ENVELOPE_PREFIX","ENVELOPE_CHANNELS","textCache","thinkingCache","looksLikeEnvelopeHeader","header","stripEnvelope","extractText","role","content","parts","item","joined","extractTextCached","extractThinking","rawText","extractRawText","extracted","extractThinkingCached","formatReasoningMarkdown","trimmed","lines","line","uuidFromBytes","bytes","hex","weakRandomBytes","now","generateUUID","cryptoLike","loadChatHistory","dataUrlToBase64","dataUrl","sendChatMessage","attachments","msg","hasAttachments","contentBlocks","att","runId","apiAttachments","parsed","abortChatRun","handleChatEvent","payload","next","loadSessions","activeMinutes","limit","patchSession","patch","deleteSession","TOOL_STREAM_LIMIT","TOOL_STREAM_THROTTLE_MS","TOOL_OUTPUT_CHAR_LIMIT","extractToolOutputText","part","formatToolOutput","contentText","truncated","buildToolStreamMessage","trimToolStream","overflow","removed","id","syncToolStreamMessages","flushToolStreamSync","scheduleToolStreamSync","resetToolStream","COMPACTION_TOAST_DURATION_MS","handleCompactionEvent","phase","handleAgentEvent","sessionKey","toolCallId","name","args","output","NEAR_BOTTOM_THRESHOLD","scheduleChatScroll","pickScrollTarget","container","overflowY","distanceFromBottom","effectiveForce","retryDelay","latest","latestDistanceFromBottom","scheduleLogsScroll","handleChatScroll","event","handleLogsScroll","resetChatScroll","exportLogs","blob","url","anchor","stamp","observeTopbar","topbar","update","height","LOG_BUFFER_LIMIT","LEVELS","parseMaybeJsonString","normalizeLevel","lowered","parseLogLine","meta","time","level","contextCandidate","contextObj","subsystem","loadLogs","entries","shouldReset","loadNodes","loadDebug","status","health","models","heartbeat","modelPayload","callDebugMethod","startNodesPolling","stopNodesPolling","startLogsPolling","stopLogsPolling","startDebugPolling","stopDebugPolling","loadAgentIdentity","agentId","loadAgentIdentities","agentIds","missing","loadAgentSkills","loadAgents","selected","known","loadCronStatus","loadCronJobs","buildCronSchedule","amount","unit","expr","buildCronPayload","timeoutSeconds","addCronJob","schedule","delivery","legacyPrefix","job","toggleCronJob","enabled","runCronJob","loadCronRuns","removeCronJob","jobId","ed25519_CURVE","Gx","Gy","_a","_d","L2","captureTrace","isBig","isStr","isBytes","abytes","length","title","len","needsLen","prefix","ofLen","got","u8n","u8fr","buf","padh","pad","bytesToHex","_ch","ch","hexToBytes","hl","al","array","ai","hi","n1","n2","cr","subtle","concatBytes","arrs","sum","randomBytes","big","assertRange","modN","invert","num","md","q","callHash","fn","hashes","apoint","Point","B256","X","Y","T","zip215","normed","lastByte","bytesToNumLE","y2","isValid","uvRatio","isXOdd","isLastByteOdd","X2","Y2","Z2","Z4","aX2","left","right","XY","ZT","other","X1","Y1","Z1","X1Z2","X2Z1","Y1Z2","Y2Z1","x1y1","G","F","X3","Y3","T3","Z3","T1","T2","safe","wNAF","scalar","iz","numTo32bLE","pow2","power","pow_2_252_3","b2","b4","b5","b10","b20","b40","b80","b160","b240","b250","RM1","v3","v7","pow","vx2","root1","root2","useRoot1","useRoot2","noRoot","modL_LE","hash","sha512a","sha512s","hash2extK","hashed","head","point","pointBytes","getExtendedPublicKeyAsync","secretKey","getExtendedPublicKey","getPublicKeyAsync","hashFinishA","_sign","rBytes","signAsync","randomSecretKey","seed","utils","W","scalarBits","pwindows","pwindowSize","precompute","points","w","Gpows","ctneg","cnd","comp","pow_2_w","maxNum","mask","shiftBy","wbits","off","offF","offP","isEven","isNeg","STORAGE_KEY","base64UrlEncode","binary","byte","base64UrlDecode","input","normalized","padded","out","fingerprintPublicKey","publicKey","generateIdentity","privateKey","loadOrCreateDeviceIdentity","derivedId","updated","identity","stored","signDevicePayload","privateKeyBase64Url","sig","normalizeRole","normalizeScopes","scopes","scope","readStore","writeStore","store","loadDeviceAuthToken","storeDeviceAuthToken","existing","clearDeviceAuthToken","loadDevices","approveDevicePairing","requestId","rejectDevicePairing","rotateDeviceToken","revokeDeviceToken","resolveExecApprovalsRpc","nodeId","resolveExecApprovalsSaveRpc","loadExecApprovals","rpc","applyExecApprovalsSnapshot","saveExecApprovals","file","updateExecApprovalsFormValue","removeExecApprovalsFormValue","loadPresence","setSkillMessage","getErrorMessage","loadSkills","updateSkillEdit","skillKey","updateSkillEnabled","saveSkillApiKey","apiKey","installSkill","installId","TAB_GROUPS","TAB_PATHS","PATH_TO_TAB","tab","normalizeBasePath","basePath","normalizePath","pathForTab","tabFromPath","pathname","inferBasePathFromPathname","segments","candidate","iconForTab","titleForTab","subtitleForTab","KEY","loadSettings","defaults","saveSettings","clamp01","hasReducedMotionPreference","cleanupThemeTransition","root","startThemeTransition","nextTheme","applyTheme","context","currentTheme","documentReference","document_","prefersReducedMotion","xPercent","yPercent","rect","transition","getSystemTheme","resolveTheme","applySettings","applyResolvedTheme","setLastActiveSessionKey","applySettingsFromUrl","tokenRaw","passwordRaw","sessionRaw","gatewayUrlRaw","shouldCleanUrl","session","gatewayUrl","setTab","refreshActiveTab","syncUrlWithTab","setTheme","loadOverview","loadChannelsTab","loadCron","refreshChat","inferBasePath","configured","syncThemeWithSettings","resolved","attachThemeListener","detachThemeListener","syncTabWithLocation","replace","setTabFromRoute","onPopState","targetPath","currentPath","syncUrlWithSessionKey","parseAgentSessionKey","isChatBusy","isChatStopCommand","handleAbortChat","enqueueChatMessage","sendChatMessageNow","ok","flushChatQueue","removeQueuedMessage","handleSendChat","messageOverride","previousDraft","attachmentsToSend","refreshChatAvatar","flushChatQueueForEvent","resolveAgentIdForSession","buildAvatarMetaUrl","encoded","avatarUrl","DEFAULT_LOG_LEVEL_FILTERS","DEFAULT_CRON_FORM","GATEWAY_CLIENT_IDS","GATEWAY_CLIENT_NAMES","GATEWAY_CLIENT_MODES","buildDeviceAuthPayload","version","CONNECT_FAILED_CLOSE_CODE","GatewayBrowserClient","ev","reason","delay","isSecureContext","deviceIdentity","canFallbackToShared","authToken","storedToken","auth","device","signedAtMs","nonce","signature","hello","frame","evt","seq","pending","method","resolve","reject","isRecord","parseExecApprovalRequested","request","command","createdAtMs","expiresAtMs","parseExecApprovalResolved","pruneExecApprovalQueue","queue","addExecApproval","removeExecApproval","MAX_ASSISTANT_NAME","MAX_ASSISTANT_AVATAR","DEFAULT_ASSISTANT_NAME","coerceIdentityValue","normalizeAssistantIdentity","avatar","resolveInjectedAssistantIdentity","loadAssistantIdentity","normalizeSessionKeyForDefaults","mainSessionKey","mainKey","defaultAgentId","applySessionDefaults","resolvedSessionKey","resolvedSettingsSessionKey","resolvedLastActiveSessionKey","nextSessionKey","nextSettings","shouldUpdateSettings","connectGateway","applySnapshot","code","handleGatewayEvent","expected","received","handleGatewayEventUnsafe","handleConnected","handleFirstUpdated","handleDisconnected","handleUpdated","changed","forcedByTab","forcedByLoad","i$1","icons","renderTab","href","renderChatControls","resolveMainSessionKey","sessionOptions","resolveSessionOptions","disableThinkingToggle","disableFocusToggle","showThinking","focusActive","refreshIcon","focusIcon","repeat","sessions","row","resolveSessionDisplayName","displayName","seen","resolvedMain","resolvedCurrent","THEME_ORDER","renderThemeToggle","index","renderMonitorIcon","renderSunIcon","renderMoonIcon","mergeFileEntry","list","nextFiles","loadAgentFiles","loadAgentFileContent","saveAgentFile","TOOL_NAME_ALIASES","TOOL_GROUPS","TOOL_PROFILES","normalizeToolName","normalizeToolList","expandToolGroups","expanded","group","resolveToolProfilePolicy","formatPresenceSummary","ip","formatPresenceAge","ts","formatNextRun","formatSessionTokens","total","ctx","formatEventPayload","formatCronState","last","formatCronSchedule","atMs","formatCronPayload","TOOL_SECTIONS","PROFILE_OPTIONS","normalizeAgentLabel","agent","isLikelyEmoji","hasNonAscii","resolveAgentEmoji","agentIdentity","identityEmoji","agentEmoji","identityAvatar","agentBadgeText","defaultId","formatBytes","units","size","unitIndex","resolveAgentConfig","config","cfg","buildAgentContext","configForm","agentFilesList","workspace","modelLabel","resolveModelLabel","identityName","skillFilter","skillCount","model","primary","fallbackCount","normalizeModelValue","resolveModelPrimary","resolveModelFallbacks","fallbacks","parseFallbackList","resolveConfiguredModels","modelId","modelRaw","alias","buildModelOptions","hasCurrent","option","compilePattern","pattern","escaped","compilePatterns","patterns","matchesAny","isAllowedByPolicy","policy","deny","allow","matchesList","renderAgents","props","agents","selectedId","selectedAgent","badge","emoji","renderAgentHeader","renderAgentTabs","panel","renderAgentOverview","renderAgentFiles","renderAgentTools","renderAgentSkills","renderAgentChannels","renderAgentCron","subtitle","active","onSelect","agentIdentityLoading","agentIdentityError","configLoading","configSaving","configDirty","onConfigReload","onConfigSave","onModelChange","onModelFallbacksChange","defaultModel","modelPrimary","defaultPrimary","effectivePrimary","modelFallbacks","fallbackText","identityStatus","isDefault","renderAgentContextCard","resolveChannelLabel","resolveChannelEntries","ids","ordered","CHANNEL_EXTRA_FIELDS","resolveChannelConfigValue","channelId","fromChannels","formatChannelExtraValue","resolveChannelExtras","summarizeChannelAccounts","accounts","connected","account","probeOk","lastSuccessLabel","summary","extras","extra","jobs","files","activeEntry","baseContent","draft","renderAgentFileRow","agentTools","globalTools","profileSource","hasAgentAllow","hasGlobalAllow","editable","alsoAllow","basePolicy","toolIds","section","tool","resolveAllowed","toolId","baseAllowed","extraAllowed","denied","enabledCount","updateTool","nextEnabled","nextAllow","nextDeny","updateAll","allowed","SKILL_SOURCE_GROUPS","groupSkills","skills","groups","def","skill","allowlist","allowSet","usingAllowlist","reportReady","rawSkills","filter","filtered","totalCount","renderAgentSkillGroup","collapsedByDefault","renderAgentSkillRow","reasons","formatDuration","channelEnabled","channels","channelStatus","running","accountActive","getChannelAccountCount","channelAccounts","renderChannelAccountCount","count","schemaType","schema","defaultValue","pathKey","segment","hintForPath","hints","direct","hintKey","hint","hintSegments","humanize","isSensitivePath","META_KEYS","isAnySchema","jsonValue","renderNode","unsupported","disabled","onPatch","showLabel","nonNull","extractLiteral","literals","allLiterals","resolvedValue","lit","renderSelect","primitiveTypes","variant","normalizedTypes","hasString","hasNumber","renderTextInput","opt","renderObject","renderArray","displayValue","renderNumberInput","inputType","isSensitive","numValue","currentIndex","unset","val","sorted","orderA","orderB","reserved","additional","allowExtra","propKey","node","renderMapField","itemsSchema","arr","reservedKeys","anySchema","entryValue","valuePath","sectionIcons","SECTION_META","getSectionIcon","matchesSearch","query","schemaMatches","propSchema","items","unions","renderConfigForm","properties","searchQuery","activeSection","activeSubsection","filteredEntries","subsectionContext","sectionSchema","sectionKey","subsectionKey","description","sectionValue","scopedValue","normalizeEnum","nullable","enumValues","analyzeConfigSchema","normalizeSchemaNode","pathLabel","union","normalizeUnion","enumNullable","normalizedProps","remaining","unique","resolveSchemaNode","resolveChannelValue","EXTRA_CHANNEL_FIELDS","formatExtraValue","renderExtraChannelFields","renderChannelConfigForm","analysis","configValue","renderChannelConfigSection","renderDiscordCard","discord","accountCountLabel","renderGoogleChatCard","googleChat","renderIMessageCard","imessage","truncatePubkey","pubkey","renderNostrCard","nostr","nostrAccounts","profileFormState","profileFormCallbacks","onEditProfile","primaryAccount","summaryConfigured","summaryRunning","summaryPublicKey","summaryLastStartAt","summaryLastError","hasMultipleAccounts","showingForm","renderAccountCard","renderProfileSection","about","nip05","hasAnyProfileData","renderSignalCard","signal","renderSlackCard","slack","renderTelegramCard","telegram","telegramAccounts","botUsername","renderWhatsAppCard","whatsapp","renderChannels","googlechat","orderedChannels","resolveChannelOrder","channel","renderChannel","showForm","renderGenericChannelCard","lastError","renderGenericAccount","resolveChannelMetaMap","RECENT_ACTIVITY_THRESHOLD_MS","hasRecentActivity","deriveRunningStatus","deriveConnectedStatus","runningStatus","connectedStatus","setPrototypeOf","isFrozen","getPrototypeOf","getOwnPropertyDescriptor","freeze","seal","create","apply","construct","func","thisArg","_len","_key","Func","_len2","_key2","arrayForEach","unapply","arrayLastIndexOf","arrayPop","arrayPush","arraySplice","stringToLowerCase","stringToString","stringMatch","stringReplace","stringIndexOf","stringTrim","objectHasOwnProperty","regExpTest","typeErrorCreate","unconstruct","_len3","_key3","_len4","_key4","addToSet","set","transformCaseFunc","element","lcElement","cleanArray","clone","object","newObject","property","lookupGetter","prop","desc","fallbackValue","html$1","svg$1","svgFilters","svgDisallowed","mathMl$1","mathMlDisallowed","svg","mathMl","xml","MUSTACHE_EXPR","ERB_EXPR","TMPLIT_EXPR","DATA_ATTR","ARIA_ATTR","IS_ALLOWED_URI","IS_SCRIPT_OR_DATA","ATTR_WHITESPACE","DOCTYPE_NAME","CUSTOM_ELEMENT","EXPRESSIONS","NODE_TYPE","getGlobal","_createTrustedTypesPolicy","trustedTypes","purifyHostElement","ATTR_NAME","policyName","scriptUrl","_createHooksMap","createDOMPurify","window","DOMPurify","document","originalDocument","currentScript","DocumentFragment","HTMLTemplateElement","Node","Element","NodeFilter","NamedNodeMap","HTMLFormElement","DOMParser","ElementPrototype","cloneNode","remove","getNextSibling","getChildNodes","getParentNode","template","trustedTypesPolicy","emptyHTML","implementation","createNodeIterator","createDocumentFragment","getElementsByTagName","importNode","hooks","IS_ALLOWED_URI$1","ALLOWED_TAGS","DEFAULT_ALLOWED_TAGS","ALLOWED_ATTR","DEFAULT_ALLOWED_ATTR","CUSTOM_ELEMENT_HANDLING","FORBID_TAGS","FORBID_ATTR","EXTRA_ELEMENT_HANDLING","ALLOW_ARIA_ATTR","ALLOW_DATA_ATTR","ALLOW_UNKNOWN_PROTOCOLS","ALLOW_SELF_CLOSE_IN_ATTR","SAFE_FOR_TEMPLATES","SAFE_FOR_XML","WHOLE_DOCUMENT","SET_CONFIG","FORCE_BODY","RETURN_DOM","RETURN_DOM_FRAGMENT","RETURN_TRUSTED_TYPE","SANITIZE_DOM","SANITIZE_NAMED_PROPS","SANITIZE_NAMED_PROPS_PREFIX","KEEP_CONTENT","IN_PLACE","USE_PROFILES","FORBID_CONTENTS","DEFAULT_FORBID_CONTENTS","DATA_URI_TAGS","DEFAULT_DATA_URI_TAGS","URI_SAFE_ATTRIBUTES","DEFAULT_URI_SAFE_ATTRIBUTES","MATHML_NAMESPACE","SVG_NAMESPACE","HTML_NAMESPACE","NAMESPACE","IS_EMPTY_INPUT","ALLOWED_NAMESPACES","DEFAULT_ALLOWED_NAMESPACES","MATHML_TEXT_INTEGRATION_POINTS","HTML_INTEGRATION_POINTS","COMMON_SVG_AND_HTML_ELEMENTS","PARSER_MEDIA_TYPE","SUPPORTED_PARSER_MEDIA_TYPES","DEFAULT_PARSER_MEDIA_TYPE","CONFIG","formElement","isRegexOrFunction","testValue","_parseConfig","ALL_SVG_TAGS","ALL_MATHML_TAGS","_checkValidNamespace","parent","tagName","parentTagName","_forceRemove","_removeAttribute","_initDocument","dirty","doc","leadingWhitespace","matches","dirtyPayload","body","_createNodeIterator","_isClobbered","_isNode","_executeHooks","currentNode","hook","_sanitizeElements","_isBasicCustomElement","parentNode","childNodes","childCount","childClone","_isValidAttribute","lcTag","lcName","_sanitizeAttributes","attributes","hookEvent","attr","namespaceURI","attrValue","initValue","_sanitizeShadowDOM","fragment","shadowNode","shadowIterator","importedNode","returnNode","nodeIterator","serializedHTML","tag","entryPoint","hookFunction","purify","me","xe","be","Re","Te","re","se","Oe","Q","we","ye","Pe","Se","ie","$e","U","te","_e","Le","Me","ze","oe","Ae","K","ae","Ce","le","Ie","Ee","Be","ue","qe","ve","pe","De","He","Ze","Ge","Ne","Qe","Fe","je","ce","he","Ue","ne","Ke","We","Xe","ke","J","de","ge","Je","O","ee","fe","marked","allowedTags","allowedAttrs","sanitizeOptions","hooksInstalled","MARKDOWN_CHAR_LIMIT","MARKDOWN_PARSE_LIMIT","MARKDOWN_CACHE_LIMIT","MARKDOWN_CACHE_MAX_CHARS","markdownCache","getCachedMarkdown","cached","setCachedMarkdown","oldest","installHooks","toSanitizedMarkdownHtml","markdown","escapeHtml","sanitized","rendered","htmlEscapeRenderer","COPIED_FOR_MS","ERROR_FOR_MS","COPY_LABEL","COPIED_LABEL","ERROR_LABEL","copyTextToClipboard","setButtonLabel","button","createCopyButton","idleLabel","btn","copied","renderCopyAsMarkdownButton","normalizeMessage","hasToolId","contentRaw","contentItems","hasToolContent","hasToolName","timestamp","normalizeRoleForGrouping","lower","isToolResultMessage","TOOL_DISPLAY_CONFIG","rawConfig","FALLBACK","TOOL_MAP","defaultTitle","normalizeVerb","coerceDisplayValue","firstLine","preview","lookupValueByPath","resolveDetailFromKeys","keys","display","resolveReadDetail","offset","resolveWriteDetail","resolveActionSpec","spec","action","resolveToolDisplay","icon","actionRaw","actionSpec","verb","detail","detailKeys","shortenHomeInString","formatToolDetail","TOOL_INLINE_THRESHOLD","PREVIEW_MAX_LINES","PREVIEW_MAX_CHARS","formatToolOutputForSidebar","getTruncatedPreview","allLines","extractToolCards","normalizeContent","cards","kind","coerceArgs","extractToolText","card","renderToolCardSidebar","onOpenSidebar","hasText","canClick","handleClick","info","isShort","showCollapsed","showInline","isEmpty","extractImages","images","block","source","mediaType","imageUrl","renderReadingIndicatorGroup","assistant","renderAvatar","renderStreamingGroup","startedAt","renderGroupedMessage","renderMessageGroup","normalizedRole","assistantName","who","roleClass","assistantAvatar","initial","className","isAvatarUrl","renderMessageImages","isToolResult","toolCards","hasToolCards","hasImages","extractedText","extractedThinking","markdownBase","reasoningMarkdown","canCopyMarkdown","bubbleClasses","unsafeHTML","renderMarkdownSidebar","ResizableDivider","LitElement","containerWidth","deltaRatio","newRatio","css","__decorateClass","customElement","adjustTextareaHeight","el","renderCompactionIndicator","generateAttachmentId","handlePaste","imageItems","reader","newAttachment","renderAttachmentPreview","renderChat","canCompose","isBusy","canAbort","reasoningLevel","showReasoning","assistantIdentity","composePlaceholder","splitRatio","sidebarOpen","thread","buildChatItems","ref","CHAT_HISTORY_RENDER_LIMIT","groupMessages","currentGroup","history","tools","historyStart","messageKey","messageId","sidebarIcons","SECTIONS","ALL_SUBSECTION","resolveSectionMeta","resolveSubsections","uiHints","subKey","order","computeDiff","changes","compare","orig","curr","origObj","currObj","allKeys","truncateValue","maxLen","str","renderConfig","validity","formUnsafe","schemaProps","availableSections","knownKeys","extraSections","allSections","activeSectionSchema","activeSectionMeta","subsections","allowSubnav","isAllSubsection","effectiveSubsection","hasRawChanges","hasChanges","canSaveForm","canSave","canApply","canUpdate","change","buildChannelOptions","renderCron","channelOptions","renderScheduleFields","renderJob","renderRun","itemClass","renderDebug","formatRemaining","totalSeconds","minutes","renderMetaRow","renderExecApprovalPrompt","remainingMs","queueCount","renderGatewayUrlConfirmPrompt","pendingUrl","currentUrl","renderInstances","renderEntry","lastInput","roles","scopesLabel","formatTime","date","matchesFilter","needle","renderLogs","levelFiltered","exportLabel","renderNodes","bindingState","resolveBindingsState","approvalsState","resolveExecApprovalsState","renderExecApprovals","renderBindings","renderDevices","paired","req","renderPendingDevice","renderPairedDevice","age","repair","tokens","renderTokenRow","deviceId","when","EXEC_APPROVALS_DEFAULT_SCOPE","SECURITY_OPTIONS","ASK_OPTIONS","nodes","resolveExecNodes","defaultBinding","resolveAgentBindings","ready","normalizeSecurity","normalizeAsk","resolveExecApprovalsDefaults","resolveConfigAgents","agentsNode","resolveExecApprovalsAgents","configAgents","approvalsAgents","aLabel","bLabel","resolveExecApprovalsScope","targetNodes","resolveExecApprovalsNodes","targetNodeId","selectedScope","supportsBinding","renderAgentBinding","targetReady","renderExecApprovalsTarget","renderExecApprovalsTabs","renderExecApprovalsPolicy","renderExecApprovalsAllowlist","hasNodes","nodeValue","first","isDefaults","agentSecurity","agentAsk","agentAskFallback","securityValue","askValue","askFallbackValue","autoOverride","autoEffective","autoIsDefault","allowlistPath","renderAllowlistEntry","lastUsed","lastCommand","lastPath","bindingValue","cmd","fallbackAgent","exec","execEntry","binding","caps","commands","renderOverview","uptime","tick","authHint","hasToken","hasPassword","insecureContextHint","THINK_LEVELS","BINARY_THINK_LEVELS","VERBOSE_LEVELS","REASONING_LEVELS","normalizeProviderId","provider","isBinaryThinkingProvider","resolveThinkLevelOptions","resolveThinkLevelDisplay","isBinary","resolveThinkLevelPatchValue","renderSessions","rows","renderRow","onDelete","rawThinking","isBinaryThinking","thinking","thinkLevels","verbose","reasoning","canLink","chatUrl","renderSkills","renderSkill","busy","canInstall","AVATAR_DATA_RE","AVATAR_HTTP_RE","resolveAssistantAvatarUrl","renderApp","presenceCount","sessionsCount","cronNext","chatDisabledReason","isChat","chatFocus","assistantAvatarUrl","chatAvatarUrl","logoBase","logoHref","resolvedAgentId","isGroupCollapsed","hasActiveTab","clearAllow","skillName","normalizedSkill","allSkills","agentIndex","ratio","injectedAssistantIdentity","resolveOnboardingMode","OpenClawApp","onPopStateInternal","connectGatewayInternal","handleChatScrollInternal","handleLogsScrollInternal","exportLogsInternal","resetToolStreamInternal","resetChatScrollInternal","scheduleChatScrollInternal","loadAssistantIdentityInternal","applySettingsInternal","setTabInternal","setThemeInternal","loadOverviewInternal","loadCronInternal","handleAbortChatInternal","removeQueuedMessageInternal","handleSendChatInternal","handleWhatsAppStartInternal","handleWhatsAppWaitInternal","handleWhatsAppLogoutInternal","handleChannelConfigSaveInternal","handleChannelConfigReloadInternal","handleNostrProfileEditInternal","handleNostrProfileCancelInternal","handleNostrProfileFieldChangeInternal","handleNostrProfileSaveInternal","handleNostrProfileImportInternal","handleNostrProfileToggleAdvancedInternal","decision","nextGatewayUrl"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,28,51,52,53,75,76,77,78,79]}